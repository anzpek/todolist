import{u as b,b as h,j as e}from"./index-CCUjBz3E.js";import{r as o,p as g,a9 as f,aa as p}from"./icons-CpcCsFSF.js";import"./react-DJG_os-6.js";import"./firebase-BNIW61Ac.js";import"./date-CFbvH-ln.js";const w=()=>{const[i,n]=o.useState(navigator.onLine),[r,a]=o.useState(!1);return o.useEffect(()=>{const l=()=>{n(!0),r&&a(!1)},t=()=>{n(!1),a(!0)};return window.addEventListener("online",l),window.addEventListener("offline",t),()=>{window.removeEventListener("online",l),window.removeEventListener("offline",t)}},[r]),{isOnline:i,wasOffline:r}},y=()=>{const{isOnline:i,wasOffline:n}=w(),{currentUser:r}=b(),{syncWithFirestore:a}=h(),[l,t]=o.useState(!1),[c,d]=o.useState("offline");o.useEffect(()=>{i?n&&r?(d("sync"),t(!0),u()):n&&(d("online"),t(!0),setTimeout(()=>t(!1),3e3)):(d("offline"),t(!0))},[i,n,r]);const u=async()=>{if(r)try{await a(),d("online"),setTimeout(()=>t(!1),3e3)}catch(m){console.error("자동 동기화 실패:",m),setTimeout(()=>t(!1),5e3)}},x=()=>{t(!1)};if(!l)return null;const s=(()=>{switch(c){case"offline":return{icon:e.jsx(p,{className:"w-5 h-5 text-red-500"}),title:"오프라인 모드",message:"인터넷 연결이 끊어졌습니다. 로컬에서 작업이 계속됩니다.",bgColor:"bg-red-50 dark:bg-red-900/20",borderColor:"border-red-200 dark:border-red-800",textColor:"text-red-700 dark:text-red-400",persistent:!0};case"sync":return{icon:e.jsx(f,{className:"w-5 h-5 text-blue-500 animate-pulse"}),title:"동기화 중...",message:"온라인 상태로 복구되었습니다. 데이터를 동기화하고 있습니다.",bgColor:"bg-blue-50 dark:bg-blue-900/20",borderColor:"border-blue-200 dark:border-blue-800",textColor:"text-blue-700 dark:text-blue-400",persistent:!1};case"online":return{icon:e.jsx(f,{className:"w-5 h-5 text-green-500"}),title:"온라인 복구",message:"인터넷 연결이 복구되었습니다. 모든 기능을 사용할 수 있습니다.",bgColor:"bg-green-50 dark:bg-green-900/20",borderColor:"border-green-200 dark:border-green-800",textColor:"text-green-700 dark:text-green-400",persistent:!1};default:return null}})();return s?e.jsx("div",{className:"fixed top-4 right-4 z-50 max-w-sm",children:e.jsxs("div",{className:`${s.bgColor} ${s.borderColor} ${s.textColor} border rounded-lg shadow-lg p-4 transition-all duration-300 transform translate-x-0`,children:[e.jsxs("div",{className:"flex items-start gap-3",children:[s.icon,e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-sm",children:s.title}),e.jsx("p",{className:"text-xs mt-1 opacity-90",children:s.message})]}),!s.persistent&&e.jsx("button",{onClick:x,className:"p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c==="offline"&&e.jsx("div",{className:"mt-3 pt-3 border-t border-red-200 dark:border-red-800",children:e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx(g,{className:"w-3 h-3"}),e.jsx("span",{children:"로컬 변경사항은 온라인 복구 시 자동 동기화됩니다."})]})})]})}):null};export{y as default};
