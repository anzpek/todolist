const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./web-BqQYDjVh.js","./firebase-BAGuws0L.js","./icons-CpcCsFSF.js","./react-DJG_os-6.js","./date-CFbvH-ln.js","./LoginScreen-BISThNY4.js","./Sidebar-EULcEUey.js","./PWAInstallPrompt-P4vCKElr.js","./ErrorBoundary-D0pCXtt5.js","./OfflineNotification-bx3vzkQ9.js","./BottomNavigation-Mz7_Nk7V.js"])))=>i.map(i=>d[i]);
import{r as I,P as Bt,C as gs,X as jt,a as Vp,A as bw,R as nh,S as No,T as an,b as Wp,c as ah,d as zu,F as Vl,U as Yo,e as mt,f as mo,g as Ha,h as Qp,i as Xp,M as rh,j as Bu,k as Po,l as ws,m as vw,n as ww,o as _w,p as kw,q as Nw,s as Tw,Z as Sw,t as jw,L as Kp,u as sh,v as Um,w as Dw,x as vu,y as To,z as Zp,B as Hm,D as Ew,E as Cw,G as Aw,H as Rw,I as Ow,J as Mw,K as Iw,N as Lw,O as Uw,Q as Hw,V as $w,W as $m,Y as zw,_ as Bw,$ as qw,a0 as Fw}from"./icons-CpcCsFSF.js";import{r as Gw,a as Jp}from"./react-DJG_os-6.js";import{_ as ey,C as ty,r as So,S as ny,a as ay,F as Yw,g as ry,b as Va,c as sy,d as ly,i as lh,p as iy,u as oy,e as cy,f as dy,h as uy,j as Pw,k as Vw,G as hy,o as Ww,s as Qw,l as Xw,m as Kw,n as Zw,q as Jw,t as e_,v as t_,w as et,x as Mt,y as $a,z as Nt,A as bt,B as Dn,D as wu,E as Ua,H as Dl,I as wo,J as ur,K as El,L as po,M as n_,N as zm,O as a_,P as ge,Q as Tt,R as ih,T as da,U as ms,V as jo,W as r_,X as s_,Y as l_,Z as Wl,$ as oh,a0 as i_,a1 as ch,a2 as o_,a3 as c_,a4 as d_,a5 as Bm,a6 as fy,a7 as u_,a8 as h_,a9 as Vo,aa as f_,ab as g_,ac as m_}from"./firebase-BAGuws0L.js";import{b as _u,a as vl,c as wl,d as p_,i as qm,s as ku,e as y_,f as Ll,g as Lt,h as gy,j as dh,k as uh,l as my,m as x_,n as qu,o as py,p as yy,q as Do,r as b_,t as v_,u as w_,v as Fm,w as xy,x as by}from"./date-CFbvH-ln.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))l(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&l(h)}).observe(document,{childList:!0,subtree:!0});function r(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function l(c){if(c.ep)return;c.ep=!0;const u=r(c);fetch(c.href,u)}})();var Nu={exports:{}},_l={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gm;function __(){if(Gm)return _l;Gm=1;var s=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(l,c,u){var h=null;if(u!==void 0&&(h=""+u),c.key!==void 0&&(h=""+c.key),"key"in c){u={};for(var g in c)g!=="key"&&(u[g]=c[g])}else u=c;return c=u.ref,{$$typeof:s,type:l,key:h,ref:c!==void 0?c:null,props:u}}return _l.Fragment=t,_l.jsx=r,_l.jsxs=r,_l}var Ym;function k_(){return Ym||(Ym=1,Nu.exports=__()),Nu.exports}var i=k_(),Tu={exports:{}},kl={},Su={exports:{}},ju={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pm;function N_(){return Pm||(Pm=1,function(s){function t(X,oe){var ye=X.length;X.push(oe);e:for(;0<ye;){var M=ye-1>>>1,Z=X[M];if(0<c(Z,oe))X[M]=oe,X[ye]=Z,ye=M;else break e}}function r(X){return X.length===0?null:X[0]}function l(X){if(X.length===0)return null;var oe=X[0],ye=X.pop();if(ye!==oe){X[0]=ye;e:for(var M=0,Z=X.length,E=Z>>>1;M<E;){var O=2*(M+1)-1,Q=X[O],pe=O+1,W=X[pe];if(0>c(Q,ye))pe<Z&&0>c(W,Q)?(X[M]=W,X[pe]=ye,M=pe):(X[M]=Q,X[O]=ye,M=O);else if(pe<Z&&0>c(W,ye))X[M]=W,X[pe]=ye,M=pe;else break e}}return oe}function c(X,oe){var ye=X.sortIndex-oe.sortIndex;return ye!==0?ye:X.id-oe.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var h=Date,g=h.now();s.unstable_now=function(){return h.now()-g}}var m=[],p=[],x=1,b=null,w=3,L=!1,T=!1,U=!1,Y=!1,k=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function D(X){for(var oe=r(p);oe!==null;){if(oe.callback===null)l(p);else if(oe.startTime<=X)l(p),oe.sortIndex=oe.expirationTime,t(m,oe);else break;oe=r(p)}}function _(X){if(U=!1,D(X),!T)if(r(m)!==null)T=!0,$||($=!0,ve());else{var oe=r(p);oe!==null&&Ee(_,oe.startTime-X)}}var $=!1,C=-1,ee=5,ie=-1;function xe(){return Y?!0:!(s.unstable_now()-ie<ee)}function _e(){if(Y=!1,$){var X=s.unstable_now();ie=X;var oe=!0;try{e:{T=!1,U&&(U=!1,S(C),C=-1),L=!0;var ye=w;try{t:{for(D(X),b=r(m);b!==null&&!(b.expirationTime>X&&xe());){var M=b.callback;if(typeof M=="function"){b.callback=null,w=b.priorityLevel;var Z=M(b.expirationTime<=X);if(X=s.unstable_now(),typeof Z=="function"){b.callback=Z,D(X),oe=!0;break t}b===r(m)&&l(m),D(X)}else l(m);b=r(m)}if(b!==null)oe=!0;else{var E=r(p);E!==null&&Ee(_,E.startTime-X),oe=!1}}break e}finally{b=null,w=ye,L=!1}oe=void 0}}finally{oe?ve():$=!1}}}var ve;if(typeof R=="function")ve=function(){R(_e)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,Te=he.port2;he.port1.onmessage=_e,ve=function(){Te.postMessage(null)}}else ve=function(){k(_e,0)};function Ee(X,oe){C=k(function(){X(s.unstable_now())},oe)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(X){X.callback=null},s.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<X?Math.floor(1e3/X):5},s.unstable_getCurrentPriorityLevel=function(){return w},s.unstable_next=function(X){switch(w){case 1:case 2:case 3:var oe=3;break;default:oe=w}var ye=w;w=oe;try{return X()}finally{w=ye}},s.unstable_requestPaint=function(){Y=!0},s.unstable_runWithPriority=function(X,oe){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var ye=w;w=X;try{return oe()}finally{w=ye}},s.unstable_scheduleCallback=function(X,oe,ye){var M=s.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?M+ye:M):ye=M,X){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=ye+Z,X={id:x++,callback:oe,priorityLevel:X,startTime:ye,expirationTime:Z,sortIndex:-1},ye>M?(X.sortIndex=ye,t(p,X),r(m)===null&&X===r(p)&&(U?(S(C),C=-1):U=!0,Ee(_,ye-M))):(X.sortIndex=Z,t(m,X),T||L||(T=!0,$||($=!0,ve()))),X},s.unstable_shouldYield=xe,s.unstable_wrapCallback=function(X){var oe=w;return function(){var ye=w;w=oe;try{return X.apply(this,arguments)}finally{w=ye}}}}(ju)),ju}var Vm;function T_(){return Vm||(Vm=1,Su.exports=N_()),Su.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wm;function S_(){if(Wm)return kl;Wm=1;var s=T_(),t=Gw(),r=Jp();function l(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)n+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function u(e){var n=e,a=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(a=n.return),e=n.return;while(e)}return n.tag===3?a:null}function h(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function g(e){if(u(e)!==e)throw Error(l(188))}function m(e){var n=e.alternate;if(!n){if(n=u(e),n===null)throw Error(l(188));return n!==e?null:e}for(var a=e,o=n;;){var d=a.return;if(d===null)break;var f=d.alternate;if(f===null){if(o=d.return,o!==null){a=o;continue}break}if(d.child===f.child){for(f=d.child;f;){if(f===a)return g(d),e;if(f===o)return g(d),n;f=f.sibling}throw Error(l(188))}if(a.return!==o.return)a=d,o=f;else{for(var y=!1,v=d.child;v;){if(v===a){y=!0,a=d,o=f;break}if(v===o){y=!0,o=d,a=f;break}v=v.sibling}if(!y){for(v=f.child;v;){if(v===a){y=!0,a=f,o=d;break}if(v===o){y=!0,o=f,a=d;break}v=v.sibling}if(!y)throw Error(l(189))}}if(a.alternate!==o)throw Error(l(190))}if(a.tag!==3)throw Error(l(188));return a.stateNode.current===a?e:n}function p(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=p(e),n!==null)return n;e=e.sibling}return null}var x=Object.assign,b=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),L=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),U=Symbol.for("react.strict_mode"),Y=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),S=Symbol.for("react.consumer"),R=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),$=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),ee=Symbol.for("react.lazy"),ie=Symbol.for("react.activity"),xe=Symbol.for("react.memo_cache_sentinel"),_e=Symbol.iterator;function ve(e){return e===null||typeof e!="object"?null:(e=_e&&e[_e]||e["@@iterator"],typeof e=="function"?e:null)}var he=Symbol.for("react.client.reference");function Te(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===he?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case T:return"Fragment";case Y:return"Profiler";case U:return"StrictMode";case _:return"Suspense";case $:return"SuspenseList";case ie:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case L:return"Portal";case R:return(e.displayName||"Context")+".Provider";case S:return(e._context.displayName||"Context")+".Consumer";case D:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case C:return n=e.displayName||null,n!==null?n:Te(e.type)||"Memo";case ee:n=e._payload,e=e._init;try{return Te(e(n))}catch{}}return null}var Ee=Array.isArray,X=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ye={pending:!1,data:null,method:null,action:null},M=[],Z=-1;function E(e){return{current:e}}function O(e){0>Z||(e.current=M[Z],M[Z]=null,Z--)}function Q(e,n){Z++,M[Z]=e.current,e.current=n}var pe=E(null),W=E(null),de=E(null),K=E(null);function ne(e,n){switch(Q(de,n),Q(W,e),Q(pe,null),n.nodeType){case 9:case 11:e=(e=n.documentElement)&&(e=e.namespaceURI)?um(e):0;break;default:if(e=n.tagName,n=n.namespaceURI)n=um(n),e=hm(n,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}O(pe),Q(pe,e)}function ce(){O(pe),O(W),O(de)}function Se(e){e.memoizedState!==null&&Q(K,e);var n=pe.current,a=hm(n,e.type);n!==a&&(Q(W,e),Q(pe,a))}function ue(e){W.current===e&&(O(pe),O(W)),K.current===e&&(O(K),ml._currentValue=ye)}var Ue=Object.prototype.hasOwnProperty,tt=s.unstable_scheduleCallback,st=s.unstable_cancelCallback,Xe=s.unstable_shouldYield,Pt=s.unstable_requestPaint,Dt=s.unstable_now,ic=s.unstable_getCurrentPriorityLevel,ti=s.unstable_ImmediatePriority,ni=s.unstable_UserBlockingPriority,_r=s.unstable_NormalPriority,oc=s.unstable_LowPriority,ai=s.unstable_IdlePriority,j=s.log,P=s.unstable_setDisableYieldValue,q=null,F=null;function le(e){if(typeof j=="function"&&P(e),F&&typeof F.setStrictMode=="function")try{F.setStrictMode(q,e)}catch{}}var re=Math.clz32?Math.clz32:be,te=Math.log,De=Math.LN2;function be(e){return e>>>=0,e===0?32:31-(te(e)/De|0)|0}var me=256,Ne=4194304;function fe(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function ke(e,n,a){var o=e.pendingLanes;if(o===0)return 0;var d=0,f=e.suspendedLanes,y=e.pingedLanes;e=e.warmLanes;var v=o&134217727;return v!==0?(o=v&~f,o!==0?d=fe(o):(y&=v,y!==0?d=fe(y):a||(a=v&~e,a!==0&&(d=fe(a))))):(v=o&~f,v!==0?d=fe(v):y!==0?d=fe(y):a||(a=o&~e,a!==0&&(d=fe(a)))),d===0?0:n!==0&&n!==d&&(n&f)===0&&(f=d&-d,a=n&-n,f>=a||f===32&&(a&4194048)!==0)?n:d}function He(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function qt(e,n){switch(e){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fa(){var e=me;return me<<=1,(me&4194048)===0&&(me=256),e}function Wh(){var e=Ne;return Ne<<=1,(Ne&62914560)===0&&(Ne=4194304),e}function cc(e){for(var n=[],a=0;31>a;a++)n.push(e);return n}function Ts(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function ib(e,n,a,o,d,f){var y=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var v=e.entanglements,N=e.expirationTimes,B=e.hiddenUpdates;for(a=y&~a;0<a;){var J=31-re(a),se=1<<J;v[J]=0,N[J]=-1;var G=B[J];if(G!==null)for(B[J]=null,J=0;J<G.length;J++){var V=G[J];V!==null&&(V.lane&=-536870913)}a&=~se}o!==0&&Qh(e,o,0),f!==0&&d===0&&e.tag!==0&&(e.suspendedLanes|=f&~(y&~n))}function Qh(e,n,a){e.pendingLanes|=n,e.suspendedLanes&=~n;var o=31-re(n);e.entangledLanes|=n,e.entanglements[o]=e.entanglements[o]|1073741824|a&4194090}function Xh(e,n){var a=e.entangledLanes|=n;for(e=e.entanglements;a;){var o=31-re(a),d=1<<o;d&n|e[o]&n&&(e[o]|=n),a&=~d}}function dc(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function uc(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Kh(){var e=oe.p;return e!==0?e:(e=window.event,e===void 0?32:Am(e.type))}function ob(e,n){var a=oe.p;try{return oe.p=e,n()}finally{oe.p=a}}var ga=Math.random().toString(36).slice(2),Ft="__reactFiber$"+ga,Xt="__reactProps$"+ga,kr="__reactContainer$"+ga,hc="__reactEvents$"+ga,cb="__reactListeners$"+ga,db="__reactHandles$"+ga,Zh="__reactResources$"+ga,Ss="__reactMarker$"+ga;function fc(e){delete e[Ft],delete e[Xt],delete e[hc],delete e[cb],delete e[db]}function Nr(e){var n=e[Ft];if(n)return n;for(var a=e.parentNode;a;){if(n=a[kr]||a[Ft]){if(a=n.alternate,n.child!==null||a!==null&&a.child!==null)for(e=pm(e);e!==null;){if(a=e[Ft])return a;e=pm(e)}return n}e=a,a=e.parentNode}return null}function Tr(e){if(e=e[Ft]||e[kr]){var n=e.tag;if(n===5||n===6||n===13||n===26||n===27||n===3)return e}return null}function js(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(l(33))}function Sr(e){var n=e[Zh];return n||(n=e[Zh]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function Et(e){e[Ss]=!0}var Jh=new Set,ef={};function Wa(e,n){jr(e,n),jr(e+"Capture",n)}function jr(e,n){for(ef[e]=n,e=0;e<n.length;e++)Jh.add(n[e])}var ub=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),tf={},nf={};function hb(e){return Ue.call(nf,e)?!0:Ue.call(tf,e)?!1:ub.test(e)?nf[e]=!0:(tf[e]=!0,!1)}function ri(e,n,a){if(hb(n))if(a===null)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var o=n.toLowerCase().slice(0,5);if(o!=="data-"&&o!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+a)}}function si(e,n,a){if(a===null)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+a)}}function Gn(e,n,a,o){if(o===null)e.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttributeNS(n,a,""+o)}}var gc,af;function Dr(e){if(gc===void 0)try{throw Error()}catch(a){var n=a.stack.trim().match(/\n( *(at )?)/);gc=n&&n[1]||"",af=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+gc+e+af}var mc=!1;function pc(e,n){if(!e||mc)return"";mc=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var o={DetermineComponentFrameRoot:function(){try{if(n){var se=function(){throw Error()};if(Object.defineProperty(se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(se,[])}catch(V){var G=V}Reflect.construct(e,[],se)}else{try{se.call()}catch(V){G=V}e.call(se.prototype)}}else{try{throw Error()}catch(V){G=V}(se=e())&&typeof se.catch=="function"&&se.catch(function(){})}}catch(V){if(V&&G&&typeof V.stack=="string")return[V.stack,G.stack]}return[null,null]}};o.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(o.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(o.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=o.DetermineComponentFrameRoot(),y=f[0],v=f[1];if(y&&v){var N=y.split(`
`),B=v.split(`
`);for(d=o=0;o<N.length&&!N[o].includes("DetermineComponentFrameRoot");)o++;for(;d<B.length&&!B[d].includes("DetermineComponentFrameRoot");)d++;if(o===N.length||d===B.length)for(o=N.length-1,d=B.length-1;1<=o&&0<=d&&N[o]!==B[d];)d--;for(;1<=o&&0<=d;o--,d--)if(N[o]!==B[d]){if(o!==1||d!==1)do if(o--,d--,0>d||N[o]!==B[d]){var J=`
`+N[o].replace(" at new "," at ");return e.displayName&&J.includes("<anonymous>")&&(J=J.replace("<anonymous>",e.displayName)),J}while(1<=o&&0<=d);break}}}finally{mc=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?Dr(a):""}function fb(e){switch(e.tag){case 26:case 27:case 5:return Dr(e.type);case 16:return Dr("Lazy");case 13:return Dr("Suspense");case 19:return Dr("SuspenseList");case 0:case 15:return pc(e.type,!1);case 11:return pc(e.type.render,!1);case 1:return pc(e.type,!0);case 31:return Dr("Activity");default:return""}}function rf(e){try{var n="";do n+=fb(e),e=e.return;while(e);return n}catch(a){return`
Error generating stack: `+a.message+`
`+a.stack}}function mn(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function sf(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function gb(e){var n=sf(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),o=""+e[n];if(!e.hasOwnProperty(n)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var d=a.get,f=a.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return d.call(this)},set:function(y){o=""+y,f.call(this,y)}}),Object.defineProperty(e,n,{enumerable:a.enumerable}),{getValue:function(){return o},setValue:function(y){o=""+y},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function li(e){e._valueTracker||(e._valueTracker=gb(e))}function lf(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var a=n.getValue(),o="";return e&&(o=sf(e)?e.checked?"true":"false":e.value),e=o,e!==a?(n.setValue(e),!0):!1}function ii(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var mb=/[\n"\\]/g;function pn(e){return e.replace(mb,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function yc(e,n,a,o,d,f,y,v){e.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?e.type=y:e.removeAttribute("type"),n!=null?y==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+mn(n)):e.value!==""+mn(n)&&(e.value=""+mn(n)):y!=="submit"&&y!=="reset"||e.removeAttribute("value"),n!=null?xc(e,y,mn(n)):a!=null?xc(e,y,mn(a)):o!=null&&e.removeAttribute("value"),d==null&&f!=null&&(e.defaultChecked=!!f),d!=null&&(e.checked=d&&typeof d!="function"&&typeof d!="symbol"),v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?e.name=""+mn(v):e.removeAttribute("name")}function of(e,n,a,o,d,f,y,v){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(e.type=f),n!=null||a!=null){if(!(f!=="submit"&&f!=="reset"||n!=null))return;a=a!=null?""+mn(a):"",n=n!=null?""+mn(n):a,v||n===e.value||(e.value=n),e.defaultValue=n}o=o??d,o=typeof o!="function"&&typeof o!="symbol"&&!!o,e.checked=v?e.checked:!!o,e.defaultChecked=!!o,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(e.name=y)}function xc(e,n,a){n==="number"&&ii(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function Er(e,n,a,o){if(e=e.options,n){n={};for(var d=0;d<a.length;d++)n["$"+a[d]]=!0;for(a=0;a<e.length;a++)d=n.hasOwnProperty("$"+e[a].value),e[a].selected!==d&&(e[a].selected=d),d&&o&&(e[a].defaultSelected=!0)}else{for(a=""+mn(a),n=null,d=0;d<e.length;d++){if(e[d].value===a){e[d].selected=!0,o&&(e[d].defaultSelected=!0);return}n!==null||e[d].disabled||(n=e[d])}n!==null&&(n.selected=!0)}}function cf(e,n,a){if(n!=null&&(n=""+mn(n),n!==e.value&&(e.value=n),a==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=a!=null?""+mn(a):""}function df(e,n,a,o){if(n==null){if(o!=null){if(a!=null)throw Error(l(92));if(Ee(o)){if(1<o.length)throw Error(l(93));o=o[0]}a=o}a==null&&(a=""),n=a}a=mn(n),e.defaultValue=a,o=e.textContent,o===a&&o!==""&&o!==null&&(e.value=o)}function Cr(e,n){if(n){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=n;return}}e.textContent=n}var pb=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function uf(e,n,a){var o=n.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?o?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":o?e.setProperty(n,a):typeof a!="number"||a===0||pb.has(n)?n==="float"?e.cssFloat=a:e[n]=(""+a).trim():e[n]=a+"px"}function hf(e,n,a){if(n!=null&&typeof n!="object")throw Error(l(62));if(e=e.style,a!=null){for(var o in a)!a.hasOwnProperty(o)||n!=null&&n.hasOwnProperty(o)||(o.indexOf("--")===0?e.setProperty(o,""):o==="float"?e.cssFloat="":e[o]="");for(var d in n)o=n[d],n.hasOwnProperty(d)&&a[d]!==o&&uf(e,d,o)}else for(var f in n)n.hasOwnProperty(f)&&uf(e,f,n[f])}function bc(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yb=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),xb=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function oi(e){return xb.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var vc=null;function wc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ar=null,Rr=null;function ff(e){var n=Tr(e);if(n&&(e=n.stateNode)){var a=e[Xt]||null;e:switch(e=n.stateNode,n.type){case"input":if(yc(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),n=a.name,a.type==="radio"&&n!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+pn(""+n)+'"][type="radio"]'),n=0;n<a.length;n++){var o=a[n];if(o!==e&&o.form===e.form){var d=o[Xt]||null;if(!d)throw Error(l(90));yc(o,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(n=0;n<a.length;n++)o=a[n],o.form===e.form&&lf(o)}break e;case"textarea":cf(e,a.value,a.defaultValue);break e;case"select":n=a.value,n!=null&&Er(e,!!a.multiple,n,!1)}}}var _c=!1;function gf(e,n,a){if(_c)return e(n,a);_c=!0;try{var o=e(n);return o}finally{if(_c=!1,(Ar!==null||Rr!==null)&&(Vi(),Ar&&(n=Ar,e=Rr,Rr=Ar=null,ff(n),e)))for(n=0;n<e.length;n++)ff(e[n])}}function Ds(e,n){var a=e.stateNode;if(a===null)return null;var o=a[Xt]||null;if(o===null)return null;a=o[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(l(231,n,typeof a));return a}var Yn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),kc=!1;if(Yn)try{var Es={};Object.defineProperty(Es,"passive",{get:function(){kc=!0}}),window.addEventListener("test",Es,Es),window.removeEventListener("test",Es,Es)}catch{kc=!1}var ma=null,Nc=null,ci=null;function mf(){if(ci)return ci;var e,n=Nc,a=n.length,o,d="value"in ma?ma.value:ma.textContent,f=d.length;for(e=0;e<a&&n[e]===d[e];e++);var y=a-e;for(o=1;o<=y&&n[a-o]===d[f-o];o++);return ci=d.slice(e,1<o?1-o:void 0)}function di(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function ui(){return!0}function pf(){return!1}function Kt(e){function n(a,o,d,f,y){this._reactName=a,this._targetInst=d,this.type=o,this.nativeEvent=f,this.target=y,this.currentTarget=null;for(var v in e)e.hasOwnProperty(v)&&(a=e[v],this[v]=a?a(f):f[v]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?ui:pf,this.isPropagationStopped=pf,this}return x(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=ui)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=ui)},persist:function(){},isPersistent:ui}),n}var Qa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hi=Kt(Qa),Cs=x({},Qa,{view:0,detail:0}),bb=Kt(Cs),Tc,Sc,As,fi=x({},Cs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Dc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==As&&(As&&e.type==="mousemove"?(Tc=e.screenX-As.screenX,Sc=e.screenY-As.screenY):Sc=Tc=0,As=e),Tc)},movementY:function(e){return"movementY"in e?e.movementY:Sc}}),yf=Kt(fi),vb=x({},fi,{dataTransfer:0}),wb=Kt(vb),_b=x({},Cs,{relatedTarget:0}),jc=Kt(_b),kb=x({},Qa,{animationName:0,elapsedTime:0,pseudoElement:0}),Nb=Kt(kb),Tb=x({},Qa,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Sb=Kt(Tb),jb=x({},Qa,{data:0}),xf=Kt(jb),Db={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Eb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ab(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=Cb[e])?!!n[e]:!1}function Dc(){return Ab}var Rb=x({},Cs,{key:function(e){if(e.key){var n=Db[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=di(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Eb[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Dc,charCode:function(e){return e.type==="keypress"?di(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?di(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Ob=Kt(Rb),Mb=x({},fi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bf=Kt(Mb),Ib=x({},Cs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Dc}),Lb=Kt(Ib),Ub=x({},Qa,{propertyName:0,elapsedTime:0,pseudoElement:0}),Hb=Kt(Ub),$b=x({},fi,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),zb=Kt($b),Bb=x({},Qa,{newState:0,oldState:0}),qb=Kt(Bb),Fb=[9,13,27,32],Ec=Yn&&"CompositionEvent"in window,Rs=null;Yn&&"documentMode"in document&&(Rs=document.documentMode);var Gb=Yn&&"TextEvent"in window&&!Rs,vf=Yn&&(!Ec||Rs&&8<Rs&&11>=Rs),wf=" ",_f=!1;function kf(e,n){switch(e){case"keyup":return Fb.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Nf(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Or=!1;function Yb(e,n){switch(e){case"compositionend":return Nf(n);case"keypress":return n.which!==32?null:(_f=!0,wf);case"textInput":return e=n.data,e===wf&&_f?null:e;default:return null}}function Pb(e,n){if(Or)return e==="compositionend"||!Ec&&kf(e,n)?(e=mf(),ci=Nc=ma=null,Or=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return vf&&n.locale!=="ko"?null:n.data;default:return null}}var Vb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Tf(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!Vb[e.type]:n==="textarea"}function Sf(e,n,a,o){Ar?Rr?Rr.push(o):Rr=[o]:Ar=o,n=Ji(n,"onChange"),0<n.length&&(a=new hi("onChange","change",null,a,o),e.push({event:a,listeners:n}))}var Os=null,Ms=null;function Wb(e){lm(e,0)}function gi(e){var n=js(e);if(lf(n))return e}function jf(e,n){if(e==="change")return n}var Df=!1;if(Yn){var Cc;if(Yn){var Ac="oninput"in document;if(!Ac){var Ef=document.createElement("div");Ef.setAttribute("oninput","return;"),Ac=typeof Ef.oninput=="function"}Cc=Ac}else Cc=!1;Df=Cc&&(!document.documentMode||9<document.documentMode)}function Cf(){Os&&(Os.detachEvent("onpropertychange",Af),Ms=Os=null)}function Af(e){if(e.propertyName==="value"&&gi(Ms)){var n=[];Sf(n,Ms,e,wc(e)),gf(Wb,n)}}function Qb(e,n,a){e==="focusin"?(Cf(),Os=n,Ms=a,Os.attachEvent("onpropertychange",Af)):e==="focusout"&&Cf()}function Xb(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return gi(Ms)}function Kb(e,n){if(e==="click")return gi(n)}function Zb(e,n){if(e==="input"||e==="change")return gi(n)}function Jb(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var sn=typeof Object.is=="function"?Object.is:Jb;function Is(e,n){if(sn(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var a=Object.keys(e),o=Object.keys(n);if(a.length!==o.length)return!1;for(o=0;o<a.length;o++){var d=a[o];if(!Ue.call(n,d)||!sn(e[d],n[d]))return!1}return!0}function Rf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Of(e,n){var a=Rf(e);e=0;for(var o;a;){if(a.nodeType===3){if(o=e+a.textContent.length,e<=n&&o>=n)return{node:a,offset:n-e};e=o}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Rf(a)}}function Mf(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?Mf(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function If(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=ii(e.document);n instanceof e.HTMLIFrameElement;){try{var a=typeof n.contentWindow.location.href=="string"}catch{a=!1}if(a)e=n.contentWindow;else break;n=ii(e.document)}return n}function Rc(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}var ev=Yn&&"documentMode"in document&&11>=document.documentMode,Mr=null,Oc=null,Ls=null,Mc=!1;function Lf(e,n,a){var o=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Mc||Mr==null||Mr!==ii(o)||(o=Mr,"selectionStart"in o&&Rc(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Ls&&Is(Ls,o)||(Ls=o,o=Ji(Oc,"onSelect"),0<o.length&&(n=new hi("onSelect","select",null,n,a),e.push({event:n,listeners:o}),n.target=Mr)))}function Xa(e,n){var a={};return a[e.toLowerCase()]=n.toLowerCase(),a["Webkit"+e]="webkit"+n,a["Moz"+e]="moz"+n,a}var Ir={animationend:Xa("Animation","AnimationEnd"),animationiteration:Xa("Animation","AnimationIteration"),animationstart:Xa("Animation","AnimationStart"),transitionrun:Xa("Transition","TransitionRun"),transitionstart:Xa("Transition","TransitionStart"),transitioncancel:Xa("Transition","TransitionCancel"),transitionend:Xa("Transition","TransitionEnd")},Ic={},Uf={};Yn&&(Uf=document.createElement("div").style,"AnimationEvent"in window||(delete Ir.animationend.animation,delete Ir.animationiteration.animation,delete Ir.animationstart.animation),"TransitionEvent"in window||delete Ir.transitionend.transition);function Ka(e){if(Ic[e])return Ic[e];if(!Ir[e])return e;var n=Ir[e],a;for(a in n)if(n.hasOwnProperty(a)&&a in Uf)return Ic[e]=n[a];return e}var Hf=Ka("animationend"),$f=Ka("animationiteration"),zf=Ka("animationstart"),tv=Ka("transitionrun"),nv=Ka("transitionstart"),av=Ka("transitioncancel"),Bf=Ka("transitionend"),qf=new Map,Lc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Lc.push("scrollEnd");function Tn(e,n){qf.set(e,n),Wa(n,[e])}var Ff=new WeakMap;function yn(e,n){if(typeof e=="object"&&e!==null){var a=Ff.get(e);return a!==void 0?a:(n={value:e,source:n,stack:rf(n)},Ff.set(e,n),n)}return{value:e,source:n,stack:rf(n)}}var xn=[],Lr=0,Uc=0;function mi(){for(var e=Lr,n=Uc=Lr=0;n<e;){var a=xn[n];xn[n++]=null;var o=xn[n];xn[n++]=null;var d=xn[n];xn[n++]=null;var f=xn[n];if(xn[n++]=null,o!==null&&d!==null){var y=o.pending;y===null?d.next=d:(d.next=y.next,y.next=d),o.pending=d}f!==0&&Gf(a,d,f)}}function pi(e,n,a,o){xn[Lr++]=e,xn[Lr++]=n,xn[Lr++]=a,xn[Lr++]=o,Uc|=o,e.lanes|=o,e=e.alternate,e!==null&&(e.lanes|=o)}function Hc(e,n,a,o){return pi(e,n,a,o),yi(e)}function Ur(e,n){return pi(e,null,null,n),yi(e)}function Gf(e,n,a){e.lanes|=a;var o=e.alternate;o!==null&&(o.lanes|=a);for(var d=!1,f=e.return;f!==null;)f.childLanes|=a,o=f.alternate,o!==null&&(o.childLanes|=a),f.tag===22&&(e=f.stateNode,e===null||e._visibility&1||(d=!0)),e=f,f=f.return;return e.tag===3?(f=e.stateNode,d&&n!==null&&(d=31-re(a),e=f.hiddenUpdates,o=e[d],o===null?e[d]=[n]:o.push(n),n.lane=a|536870912),f):null}function yi(e){if(50<il)throw il=0,Gd=null,Error(l(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var Hr={};function rv(e,n,a,o){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ln(e,n,a,o){return new rv(e,n,a,o)}function $c(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Pn(e,n){var a=e.alternate;return a===null?(a=ln(e.tag,n,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=n,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&65011712,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,n=e.dependencies,a.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function Yf(e,n){e.flags&=65011714;var a=e.alternate;return a===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,n=a.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function xi(e,n,a,o,d,f){var y=0;if(o=e,typeof e=="function")$c(e)&&(y=1);else if(typeof e=="string")y=lw(e,a,pe.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case ie:return e=ln(31,a,n,d),e.elementType=ie,e.lanes=f,e;case T:return Za(a.children,d,f,n);case U:y=8,d|=24;break;case Y:return e=ln(12,a,n,d|2),e.elementType=Y,e.lanes=f,e;case _:return e=ln(13,a,n,d),e.elementType=_,e.lanes=f,e;case $:return e=ln(19,a,n,d),e.elementType=$,e.lanes=f,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case k:case R:y=10;break e;case S:y=9;break e;case D:y=11;break e;case C:y=14;break e;case ee:y=16,o=null;break e}y=29,a=Error(l(130,e===null?"null":typeof e,"")),o=null}return n=ln(y,a,n,d),n.elementType=e,n.type=o,n.lanes=f,n}function Za(e,n,a,o){return e=ln(7,e,o,n),e.lanes=a,e}function zc(e,n,a){return e=ln(6,e,null,n),e.lanes=a,e}function Bc(e,n,a){return n=ln(4,e.children!==null?e.children:[],e.key,n),n.lanes=a,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}var $r=[],zr=0,bi=null,vi=0,bn=[],vn=0,Ja=null,Vn=1,Wn="";function er(e,n){$r[zr++]=vi,$r[zr++]=bi,bi=e,vi=n}function Pf(e,n,a){bn[vn++]=Vn,bn[vn++]=Wn,bn[vn++]=Ja,Ja=e;var o=Vn;e=Wn;var d=32-re(o)-1;o&=~(1<<d),a+=1;var f=32-re(n)+d;if(30<f){var y=d-d%5;f=(o&(1<<y)-1).toString(32),o>>=y,d-=y,Vn=1<<32-re(n)+d|a<<d|o,Wn=f+e}else Vn=1<<f|a<<d|o,Wn=e}function qc(e){e.return!==null&&(er(e,1),Pf(e,1,0))}function Fc(e){for(;e===bi;)bi=$r[--zr],$r[zr]=null,vi=$r[--zr],$r[zr]=null;for(;e===Ja;)Ja=bn[--vn],bn[vn]=null,Wn=bn[--vn],bn[vn]=null,Vn=bn[--vn],bn[vn]=null}var Vt=null,ft=null,Qe=!1,tr=null,Mn=!1,Gc=Error(l(519));function nr(e){var n=Error(l(418,""));throw $s(yn(n,e)),Gc}function Vf(e){var n=e.stateNode,a=e.type,o=e.memoizedProps;switch(n[Ft]=e,n[Xt]=o,a){case"dialog":Ge("cancel",n),Ge("close",n);break;case"iframe":case"object":case"embed":Ge("load",n);break;case"video":case"audio":for(a=0;a<cl.length;a++)Ge(cl[a],n);break;case"source":Ge("error",n);break;case"img":case"image":case"link":Ge("error",n),Ge("load",n);break;case"details":Ge("toggle",n);break;case"input":Ge("invalid",n),of(n,o.value,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name,!0),li(n);break;case"select":Ge("invalid",n);break;case"textarea":Ge("invalid",n),df(n,o.value,o.defaultValue,o.children),li(n)}a=o.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||n.textContent===""+a||o.suppressHydrationWarning===!0||dm(n.textContent,a)?(o.popover!=null&&(Ge("beforetoggle",n),Ge("toggle",n)),o.onScroll!=null&&Ge("scroll",n),o.onScrollEnd!=null&&Ge("scrollend",n),o.onClick!=null&&(n.onclick=eo),n=!0):n=!1,n||nr(e)}function Wf(e){for(Vt=e.return;Vt;)switch(Vt.tag){case 5:case 13:Mn=!1;return;case 27:case 3:Mn=!0;return;default:Vt=Vt.return}}function Us(e){if(e!==Vt)return!1;if(!Qe)return Wf(e),Qe=!0,!1;var n=e.tag,a;if((a=n!==3&&n!==27)&&((a=n===5)&&(a=e.type,a=!(a!=="form"&&a!=="button")||lu(e.type,e.memoizedProps)),a=!a),a&&ft&&nr(e),Wf(e),n===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8)if(a=e.data,a==="/$"){if(n===0){ft=jn(e.nextSibling);break e}n--}else a!=="$"&&a!=="$!"&&a!=="$?"||n++;e=e.nextSibling}ft=null}}else n===27?(n=ft,Aa(e.type)?(e=du,du=null,ft=e):ft=n):ft=Vt?jn(e.stateNode.nextSibling):null;return!0}function Hs(){ft=Vt=null,Qe=!1}function Qf(){var e=tr;return e!==null&&(en===null?en=e:en.push.apply(en,e),tr=null),e}function $s(e){tr===null?tr=[e]:tr.push(e)}var Yc=E(null),ar=null,Qn=null;function pa(e,n,a){Q(Yc,n._currentValue),n._currentValue=a}function Xn(e){e._currentValue=Yc.current,O(Yc)}function Pc(e,n,a){for(;e!==null;){var o=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,o!==null&&(o.childLanes|=n)):o!==null&&(o.childLanes&n)!==n&&(o.childLanes|=n),e===a)break;e=e.return}}function Vc(e,n,a,o){var d=e.child;for(d!==null&&(d.return=e);d!==null;){var f=d.dependencies;if(f!==null){var y=d.child;f=f.firstContext;e:for(;f!==null;){var v=f;f=d;for(var N=0;N<n.length;N++)if(v.context===n[N]){f.lanes|=a,v=f.alternate,v!==null&&(v.lanes|=a),Pc(f.return,a,e),o||(y=null);break e}f=v.next}}else if(d.tag===18){if(y=d.return,y===null)throw Error(l(341));y.lanes|=a,f=y.alternate,f!==null&&(f.lanes|=a),Pc(y,a,e),y=null}else y=d.child;if(y!==null)y.return=d;else for(y=d;y!==null;){if(y===e){y=null;break}if(d=y.sibling,d!==null){d.return=y.return,y=d;break}y=y.return}d=y}}function zs(e,n,a,o){e=null;for(var d=n,f=!1;d!==null;){if(!f){if((d.flags&524288)!==0)f=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var y=d.alternate;if(y===null)throw Error(l(387));if(y=y.memoizedProps,y!==null){var v=d.type;sn(d.pendingProps.value,y.value)||(e!==null?e.push(v):e=[v])}}else if(d===K.current){if(y=d.alternate,y===null)throw Error(l(387));y.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(e!==null?e.push(ml):e=[ml])}d=d.return}e!==null&&Vc(n,e,a,o),n.flags|=262144}function wi(e){for(e=e.firstContext;e!==null;){if(!sn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function rr(e){ar=e,Qn=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Gt(e){return Xf(ar,e)}function _i(e,n){return ar===null&&rr(e),Xf(e,n)}function Xf(e,n){var a=n._currentValue;if(n={context:n,memoizedValue:a,next:null},Qn===null){if(e===null)throw Error(l(308));Qn=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else Qn=Qn.next=n;return a}var sv=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(a,o){e.push(o)}};this.abort=function(){n.aborted=!0,e.forEach(function(a){return a()})}},lv=s.unstable_scheduleCallback,iv=s.unstable_NormalPriority,_t={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Wc(){return{controller:new sv,data:new Map,refCount:0}}function Bs(e){e.refCount--,e.refCount===0&&lv(iv,function(){e.controller.abort()})}var qs=null,Qc=0,Br=0,qr=null;function ov(e,n){if(qs===null){var a=qs=[];Qc=0,Br=Kd(),qr={status:"pending",value:void 0,then:function(o){a.push(o)}}}return Qc++,n.then(Kf,Kf),n}function Kf(){if(--Qc===0&&qs!==null){qr!==null&&(qr.status="fulfilled");var e=qs;qs=null,Br=0,qr=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function cv(e,n){var a=[],o={status:"pending",value:null,reason:null,then:function(d){a.push(d)}};return e.then(function(){o.status="fulfilled",o.value=n;for(var d=0;d<a.length;d++)(0,a[d])(n)},function(d){for(o.status="rejected",o.reason=d,d=0;d<a.length;d++)(0,a[d])(void 0)}),o}var Zf=X.S;X.S=function(e,n){typeof n=="object"&&n!==null&&typeof n.then=="function"&&ov(e,n),Zf!==null&&Zf(e,n)};var sr=E(null);function Xc(){var e=sr.current;return e!==null?e:ot.pooledCache}function ki(e,n){n===null?Q(sr,sr.current):Q(sr,n.pool)}function Jf(){var e=Xc();return e===null?null:{parent:_t._currentValue,pool:e}}var Fs=Error(l(460)),eg=Error(l(474)),Ni=Error(l(542)),Kc={then:function(){}};function tg(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Ti(){}function ng(e,n,a){switch(a=e[a],a===void 0?e.push(n):a!==n&&(n.then(Ti,Ti),n=a),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,rg(e),e;default:if(typeof n.status=="string")n.then(Ti,Ti);else{if(e=ot,e!==null&&100<e.shellSuspendCounter)throw Error(l(482));e=n,e.status="pending",e.then(function(o){if(n.status==="pending"){var d=n;d.status="fulfilled",d.value=o}},function(o){if(n.status==="pending"){var d=n;d.status="rejected",d.reason=o}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,rg(e),e}throw Gs=n,Fs}}var Gs=null;function ag(){if(Gs===null)throw Error(l(459));var e=Gs;return Gs=null,e}function rg(e){if(e===Fs||e===Ni)throw Error(l(483))}var ya=!1;function Zc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Jc(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function xa(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ba(e,n,a){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,(Ke&2)!==0){var d=o.pending;return d===null?n.next=n:(n.next=d.next,d.next=n),o.pending=n,n=yi(e),Gf(e,null,a),n}return pi(e,o,n,a),yi(e)}function Ys(e,n,a){if(n=n.updateQueue,n!==null&&(n=n.shared,(a&4194048)!==0)){var o=n.lanes;o&=e.pendingLanes,a|=o,n.lanes=a,Xh(e,a)}}function ed(e,n){var a=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,a===o)){var d=null,f=null;if(a=a.firstBaseUpdate,a!==null){do{var y={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};f===null?d=f=y:f=f.next=y,a=a.next}while(a!==null);f===null?d=f=n:f=f.next=n}else d=f=n;a={baseState:o.baseState,firstBaseUpdate:d,lastBaseUpdate:f,shared:o.shared,callbacks:o.callbacks},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=n:e.next=n,a.lastBaseUpdate=n}var td=!1;function Ps(){if(td){var e=qr;if(e!==null)throw e}}function Vs(e,n,a,o){td=!1;var d=e.updateQueue;ya=!1;var f=d.firstBaseUpdate,y=d.lastBaseUpdate,v=d.shared.pending;if(v!==null){d.shared.pending=null;var N=v,B=N.next;N.next=null,y===null?f=B:y.next=B,y=N;var J=e.alternate;J!==null&&(J=J.updateQueue,v=J.lastBaseUpdate,v!==y&&(v===null?J.firstBaseUpdate=B:v.next=B,J.lastBaseUpdate=N))}if(f!==null){var se=d.baseState;y=0,J=B=N=null,v=f;do{var G=v.lane&-536870913,V=G!==v.lane;if(V?(Pe&G)===G:(o&G)===G){G!==0&&G===Br&&(td=!0),J!==null&&(J=J.next={lane:0,tag:v.tag,payload:v.payload,callback:null,next:null});e:{var Le=e,Re=v;G=n;var rt=a;switch(Re.tag){case 1:if(Le=Re.payload,typeof Le=="function"){se=Le.call(rt,se,G);break e}se=Le;break e;case 3:Le.flags=Le.flags&-65537|128;case 0:if(Le=Re.payload,G=typeof Le=="function"?Le.call(rt,se,G):Le,G==null)break e;se=x({},se,G);break e;case 2:ya=!0}}G=v.callback,G!==null&&(e.flags|=64,V&&(e.flags|=8192),V=d.callbacks,V===null?d.callbacks=[G]:V.push(G))}else V={lane:G,tag:v.tag,payload:v.payload,callback:v.callback,next:null},J===null?(B=J=V,N=se):J=J.next=V,y|=G;if(v=v.next,v===null){if(v=d.shared.pending,v===null)break;V=v,v=V.next,V.next=null,d.lastBaseUpdate=V,d.shared.pending=null}}while(!0);J===null&&(N=se),d.baseState=N,d.firstBaseUpdate=B,d.lastBaseUpdate=J,f===null&&(d.shared.lanes=0),ja|=y,e.lanes=y,e.memoizedState=se}}function sg(e,n){if(typeof e!="function")throw Error(l(191,e));e.call(n)}function lg(e,n){var a=e.callbacks;if(a!==null)for(e.callbacks=null,e=0;e<a.length;e++)sg(a[e],n)}var Fr=E(null),Si=E(0);function ig(e,n){e=aa,Q(Si,e),Q(Fr,n),aa=e|n.baseLanes}function nd(){Q(Si,aa),Q(Fr,Fr.current)}function ad(){aa=Si.current,O(Fr),O(Si)}var va=0,$e=null,nt=null,vt=null,ji=!1,Gr=!1,lr=!1,Di=0,Ws=0,Yr=null,dv=0;function yt(){throw Error(l(321))}function rd(e,n){if(n===null)return!1;for(var a=0;a<n.length&&a<e.length;a++)if(!sn(e[a],n[a]))return!1;return!0}function sd(e,n,a,o,d,f){return va=f,$e=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,X.H=e===null||e.memoizedState===null?Gg:Yg,lr=!1,f=a(o,d),lr=!1,Gr&&(f=cg(n,a,o,d)),og(e),f}function og(e){X.H=Mi;var n=nt!==null&&nt.next!==null;if(va=0,vt=nt=$e=null,ji=!1,Ws=0,Yr=null,n)throw Error(l(300));e===null||Ct||(e=e.dependencies,e!==null&&wi(e)&&(Ct=!0))}function cg(e,n,a,o){$e=e;var d=0;do{if(Gr&&(Yr=null),Ws=0,Gr=!1,25<=d)throw Error(l(301));if(d+=1,vt=nt=null,e.updateQueue!=null){var f=e.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}X.H=yv,f=n(a,o)}while(Gr);return f}function uv(){var e=X.H,n=e.useState()[0];return n=typeof n.then=="function"?Qs(n):n,e=e.useState()[0],(nt!==null?nt.memoizedState:null)!==e&&($e.flags|=1024),n}function ld(){var e=Di!==0;return Di=0,e}function id(e,n,a){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~a}function od(e){if(ji){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}ji=!1}va=0,vt=nt=$e=null,Gr=!1,Ws=Di=0,Yr=null}function Zt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vt===null?$e.memoizedState=vt=e:vt=vt.next=e,vt}function wt(){if(nt===null){var e=$e.alternate;e=e!==null?e.memoizedState:null}else e=nt.next;var n=vt===null?$e.memoizedState:vt.next;if(n!==null)vt=n,nt=e;else{if(e===null)throw $e.alternate===null?Error(l(467)):Error(l(310));nt=e,e={memoizedState:nt.memoizedState,baseState:nt.baseState,baseQueue:nt.baseQueue,queue:nt.queue,next:null},vt===null?$e.memoizedState=vt=e:vt=vt.next=e}return vt}function cd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Qs(e){var n=Ws;return Ws+=1,Yr===null&&(Yr=[]),e=ng(Yr,e,n),n=$e,(vt===null?n.memoizedState:vt.next)===null&&(n=n.alternate,X.H=n===null||n.memoizedState===null?Gg:Yg),e}function Ei(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Qs(e);if(e.$$typeof===R)return Gt(e)}throw Error(l(438,String(e)))}function dd(e){var n=null,a=$e.updateQueue;if(a!==null&&(n=a.memoCache),n==null){var o=$e.alternate;o!==null&&(o=o.updateQueue,o!==null&&(o=o.memoCache,o!=null&&(n={data:o.data.map(function(d){return d.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),a===null&&(a=cd(),$e.updateQueue=a),a.memoCache=n,a=n.data[n.index],a===void 0)for(a=n.data[n.index]=Array(e),o=0;o<e;o++)a[o]=xe;return n.index++,a}function Kn(e,n){return typeof n=="function"?n(e):n}function Ci(e){var n=wt();return ud(n,nt,e)}function ud(e,n,a){var o=e.queue;if(o===null)throw Error(l(311));o.lastRenderedReducer=a;var d=e.baseQueue,f=o.pending;if(f!==null){if(d!==null){var y=d.next;d.next=f.next,f.next=y}n.baseQueue=d=f,o.pending=null}if(f=e.baseState,d===null)e.memoizedState=f;else{n=d.next;var v=y=null,N=null,B=n,J=!1;do{var se=B.lane&-536870913;if(se!==B.lane?(Pe&se)===se:(va&se)===se){var G=B.revertLane;if(G===0)N!==null&&(N=N.next={lane:0,revertLane:0,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null}),se===Br&&(J=!0);else if((va&G)===G){B=B.next,G===Br&&(J=!0);continue}else se={lane:0,revertLane:B.revertLane,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null},N===null?(v=N=se,y=f):N=N.next=se,$e.lanes|=G,ja|=G;se=B.action,lr&&a(f,se),f=B.hasEagerState?B.eagerState:a(f,se)}else G={lane:se,revertLane:B.revertLane,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null},N===null?(v=N=G,y=f):N=N.next=G,$e.lanes|=se,ja|=se;B=B.next}while(B!==null&&B!==n);if(N===null?y=f:N.next=v,!sn(f,e.memoizedState)&&(Ct=!0,J&&(a=qr,a!==null)))throw a;e.memoizedState=f,e.baseState=y,e.baseQueue=N,o.lastRenderedState=f}return d===null&&(o.lanes=0),[e.memoizedState,o.dispatch]}function hd(e){var n=wt(),a=n.queue;if(a===null)throw Error(l(311));a.lastRenderedReducer=e;var o=a.dispatch,d=a.pending,f=n.memoizedState;if(d!==null){a.pending=null;var y=d=d.next;do f=e(f,y.action),y=y.next;while(y!==d);sn(f,n.memoizedState)||(Ct=!0),n.memoizedState=f,n.baseQueue===null&&(n.baseState=f),a.lastRenderedState=f}return[f,o]}function dg(e,n,a){var o=$e,d=wt(),f=Qe;if(f){if(a===void 0)throw Error(l(407));a=a()}else a=n();var y=!sn((nt||d).memoizedState,a);y&&(d.memoizedState=a,Ct=!0),d=d.queue;var v=fg.bind(null,o,d,e);if(Xs(2048,8,v,[e]),d.getSnapshot!==n||y||vt!==null&&vt.memoizedState.tag&1){if(o.flags|=2048,Pr(9,Ai(),hg.bind(null,o,d,a,n),null),ot===null)throw Error(l(349));f||(va&124)!==0||ug(o,n,a)}return a}function ug(e,n,a){e.flags|=16384,e={getSnapshot:n,value:a},n=$e.updateQueue,n===null?(n=cd(),$e.updateQueue=n,n.stores=[e]):(a=n.stores,a===null?n.stores=[e]:a.push(e))}function hg(e,n,a,o){n.value=a,n.getSnapshot=o,gg(n)&&mg(e)}function fg(e,n,a){return a(function(){gg(n)&&mg(e)})}function gg(e){var n=e.getSnapshot;e=e.value;try{var a=n();return!sn(e,a)}catch{return!0}}function mg(e){var n=Ur(e,2);n!==null&&hn(n,e,2)}function fd(e){var n=Zt();if(typeof e=="function"){var a=e;if(e=a(),lr){le(!0);try{a()}finally{le(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Kn,lastRenderedState:e},n}function pg(e,n,a,o){return e.baseState=a,ud(e,nt,typeof o=="function"?o:Kn)}function hv(e,n,a,o,d){if(Oi(e))throw Error(l(485));if(e=n.action,e!==null){var f={payload:d,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){f.listeners.push(y)}};X.T!==null?a(!0):f.isTransition=!1,o(f),a=n.pending,a===null?(f.next=n.pending=f,yg(n,f)):(f.next=a.next,n.pending=a.next=f)}}function yg(e,n){var a=n.action,o=n.payload,d=e.state;if(n.isTransition){var f=X.T,y={};X.T=y;try{var v=a(d,o),N=X.S;N!==null&&N(y,v),xg(e,n,v)}catch(B){gd(e,n,B)}finally{X.T=f}}else try{f=a(d,o),xg(e,n,f)}catch(B){gd(e,n,B)}}function xg(e,n,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(o){bg(e,n,o)},function(o){return gd(e,n,o)}):bg(e,n,a)}function bg(e,n,a){n.status="fulfilled",n.value=a,vg(n),e.state=a,n=e.pending,n!==null&&(a=n.next,a===n?e.pending=null:(a=a.next,n.next=a,yg(e,a)))}function gd(e,n,a){var o=e.pending;if(e.pending=null,o!==null){o=o.next;do n.status="rejected",n.reason=a,vg(n),n=n.next;while(n!==o)}e.action=null}function vg(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function wg(e,n){return n}function _g(e,n){if(Qe){var a=ot.formState;if(a!==null){e:{var o=$e;if(Qe){if(ft){t:{for(var d=ft,f=Mn;d.nodeType!==8;){if(!f){d=null;break t}if(d=jn(d.nextSibling),d===null){d=null;break t}}f=d.data,d=f==="F!"||f==="F"?d:null}if(d){ft=jn(d.nextSibling),o=d.data==="F!";break e}}nr(o)}o=!1}o&&(n=a[0])}}return a=Zt(),a.memoizedState=a.baseState=n,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:wg,lastRenderedState:n},a.queue=o,a=Bg.bind(null,$e,o),o.dispatch=a,o=fd(!1),f=bd.bind(null,$e,!1,o.queue),o=Zt(),d={state:n,dispatch:null,action:e,pending:null},o.queue=d,a=hv.bind(null,$e,d,f,a),d.dispatch=a,o.memoizedState=e,[n,a,!1]}function kg(e){var n=wt();return Ng(n,nt,e)}function Ng(e,n,a){if(n=ud(e,n,wg)[0],e=Ci(Kn)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var o=Qs(n)}catch(y){throw y===Fs?Ni:y}else o=n;n=wt();var d=n.queue,f=d.dispatch;return a!==n.memoizedState&&($e.flags|=2048,Pr(9,Ai(),fv.bind(null,d,a),null)),[o,f,e]}function fv(e,n){e.action=n}function Tg(e){var n=wt(),a=nt;if(a!==null)return Ng(n,a,e);wt(),n=n.memoizedState,a=wt();var o=a.queue.dispatch;return a.memoizedState=e,[n,o,!1]}function Pr(e,n,a,o){return e={tag:e,create:a,deps:o,inst:n,next:null},n=$e.updateQueue,n===null&&(n=cd(),$e.updateQueue=n),a=n.lastEffect,a===null?n.lastEffect=e.next=e:(o=a.next,a.next=e,e.next=o,n.lastEffect=e),e}function Ai(){return{destroy:void 0,resource:void 0}}function Sg(){return wt().memoizedState}function Ri(e,n,a,o){var d=Zt();o=o===void 0?null:o,$e.flags|=e,d.memoizedState=Pr(1|n,Ai(),a,o)}function Xs(e,n,a,o){var d=wt();o=o===void 0?null:o;var f=d.memoizedState.inst;nt!==null&&o!==null&&rd(o,nt.memoizedState.deps)?d.memoizedState=Pr(n,f,a,o):($e.flags|=e,d.memoizedState=Pr(1|n,f,a,o))}function jg(e,n){Ri(8390656,8,e,n)}function Dg(e,n){Xs(2048,8,e,n)}function Eg(e,n){return Xs(4,2,e,n)}function Cg(e,n){return Xs(4,4,e,n)}function Ag(e,n){if(typeof n=="function"){e=e();var a=n(e);return function(){typeof a=="function"?a():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function Rg(e,n,a){a=a!=null?a.concat([e]):null,Xs(4,4,Ag.bind(null,n,e),a)}function md(){}function Og(e,n){var a=wt();n=n===void 0?null:n;var o=a.memoizedState;return n!==null&&rd(n,o[1])?o[0]:(a.memoizedState=[e,n],e)}function Mg(e,n){var a=wt();n=n===void 0?null:n;var o=a.memoizedState;if(n!==null&&rd(n,o[1]))return o[0];if(o=e(),lr){le(!0);try{e()}finally{le(!1)}}return a.memoizedState=[o,n],o}function pd(e,n,a){return a===void 0||(va&1073741824)!==0?e.memoizedState=n:(e.memoizedState=a,e=U0(),$e.lanes|=e,ja|=e,a)}function Ig(e,n,a,o){return sn(a,n)?a:Fr.current!==null?(e=pd(e,a,o),sn(e,n)||(Ct=!0),e):(va&42)===0?(Ct=!0,e.memoizedState=a):(e=U0(),$e.lanes|=e,ja|=e,n)}function Lg(e,n,a,o,d){var f=oe.p;oe.p=f!==0&&8>f?f:8;var y=X.T,v={};X.T=v,bd(e,!1,n,a);try{var N=d(),B=X.S;if(B!==null&&B(v,N),N!==null&&typeof N=="object"&&typeof N.then=="function"){var J=cv(N,o);Ks(e,n,J,un(e))}else Ks(e,n,o,un(e))}catch(se){Ks(e,n,{then:function(){},status:"rejected",reason:se},un())}finally{oe.p=f,X.T=y}}function gv(){}function yd(e,n,a,o){if(e.tag!==5)throw Error(l(476));var d=Ug(e).queue;Lg(e,d,n,ye,a===null?gv:function(){return Hg(e),a(o)})}function Ug(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:ye,baseState:ye,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Kn,lastRenderedState:ye},next:null};var a={};return n.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Kn,lastRenderedState:a},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function Hg(e){var n=Ug(e).next.queue;Ks(e,n,{},un())}function xd(){return Gt(ml)}function $g(){return wt().memoizedState}function zg(){return wt().memoizedState}function mv(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var a=un();e=xa(a);var o=ba(n,e,a);o!==null&&(hn(o,n,a),Ys(o,n,a)),n={cache:Wc()},e.payload=n;return}n=n.return}}function pv(e,n,a){var o=un();a={lane:o,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null},Oi(e)?qg(n,a):(a=Hc(e,n,a,o),a!==null&&(hn(a,e,o),Fg(a,n,o)))}function Bg(e,n,a){var o=un();Ks(e,n,a,o)}function Ks(e,n,a,o){var d={lane:o,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null};if(Oi(e))qg(n,d);else{var f=e.alternate;if(e.lanes===0&&(f===null||f.lanes===0)&&(f=n.lastRenderedReducer,f!==null))try{var y=n.lastRenderedState,v=f(y,a);if(d.hasEagerState=!0,d.eagerState=v,sn(v,y))return pi(e,n,d,0),ot===null&&mi(),!1}catch{}finally{}if(a=Hc(e,n,d,o),a!==null)return hn(a,e,o),Fg(a,n,o),!0}return!1}function bd(e,n,a,o){if(o={lane:2,revertLane:Kd(),action:o,hasEagerState:!1,eagerState:null,next:null},Oi(e)){if(n)throw Error(l(479))}else n=Hc(e,a,o,2),n!==null&&hn(n,e,2)}function Oi(e){var n=e.alternate;return e===$e||n!==null&&n===$e}function qg(e,n){Gr=ji=!0;var a=e.pending;a===null?n.next=n:(n.next=a.next,a.next=n),e.pending=n}function Fg(e,n,a){if((a&4194048)!==0){var o=n.lanes;o&=e.pendingLanes,a|=o,n.lanes=a,Xh(e,a)}}var Mi={readContext:Gt,use:Ei,useCallback:yt,useContext:yt,useEffect:yt,useImperativeHandle:yt,useLayoutEffect:yt,useInsertionEffect:yt,useMemo:yt,useReducer:yt,useRef:yt,useState:yt,useDebugValue:yt,useDeferredValue:yt,useTransition:yt,useSyncExternalStore:yt,useId:yt,useHostTransitionStatus:yt,useFormState:yt,useActionState:yt,useOptimistic:yt,useMemoCache:yt,useCacheRefresh:yt},Gg={readContext:Gt,use:Ei,useCallback:function(e,n){return Zt().memoizedState=[e,n===void 0?null:n],e},useContext:Gt,useEffect:jg,useImperativeHandle:function(e,n,a){a=a!=null?a.concat([e]):null,Ri(4194308,4,Ag.bind(null,n,e),a)},useLayoutEffect:function(e,n){return Ri(4194308,4,e,n)},useInsertionEffect:function(e,n){Ri(4,2,e,n)},useMemo:function(e,n){var a=Zt();n=n===void 0?null:n;var o=e();if(lr){le(!0);try{e()}finally{le(!1)}}return a.memoizedState=[o,n],o},useReducer:function(e,n,a){var o=Zt();if(a!==void 0){var d=a(n);if(lr){le(!0);try{a(n)}finally{le(!1)}}}else d=n;return o.memoizedState=o.baseState=d,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:d},o.queue=e,e=e.dispatch=pv.bind(null,$e,e),[o.memoizedState,e]},useRef:function(e){var n=Zt();return e={current:e},n.memoizedState=e},useState:function(e){e=fd(e);var n=e.queue,a=Bg.bind(null,$e,n);return n.dispatch=a,[e.memoizedState,a]},useDebugValue:md,useDeferredValue:function(e,n){var a=Zt();return pd(a,e,n)},useTransition:function(){var e=fd(!1);return e=Lg.bind(null,$e,e.queue,!0,!1),Zt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,a){var o=$e,d=Zt();if(Qe){if(a===void 0)throw Error(l(407));a=a()}else{if(a=n(),ot===null)throw Error(l(349));(Pe&124)!==0||ug(o,n,a)}d.memoizedState=a;var f={value:a,getSnapshot:n};return d.queue=f,jg(fg.bind(null,o,f,e),[e]),o.flags|=2048,Pr(9,Ai(),hg.bind(null,o,f,a,n),null),a},useId:function(){var e=Zt(),n=ot.identifierPrefix;if(Qe){var a=Wn,o=Vn;a=(o&~(1<<32-re(o)-1)).toString(32)+a,n=""+n+"R"+a,a=Di++,0<a&&(n+="H"+a.toString(32)),n+=""}else a=dv++,n=""+n+"r"+a.toString(32)+"";return e.memoizedState=n},useHostTransitionStatus:xd,useFormState:_g,useActionState:_g,useOptimistic:function(e){var n=Zt();n.memoizedState=n.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=a,n=bd.bind(null,$e,!0,a),a.dispatch=n,[e,n]},useMemoCache:dd,useCacheRefresh:function(){return Zt().memoizedState=mv.bind(null,$e)}},Yg={readContext:Gt,use:Ei,useCallback:Og,useContext:Gt,useEffect:Dg,useImperativeHandle:Rg,useInsertionEffect:Eg,useLayoutEffect:Cg,useMemo:Mg,useReducer:Ci,useRef:Sg,useState:function(){return Ci(Kn)},useDebugValue:md,useDeferredValue:function(e,n){var a=wt();return Ig(a,nt.memoizedState,e,n)},useTransition:function(){var e=Ci(Kn)[0],n=wt().memoizedState;return[typeof e=="boolean"?e:Qs(e),n]},useSyncExternalStore:dg,useId:$g,useHostTransitionStatus:xd,useFormState:kg,useActionState:kg,useOptimistic:function(e,n){var a=wt();return pg(a,nt,e,n)},useMemoCache:dd,useCacheRefresh:zg},yv={readContext:Gt,use:Ei,useCallback:Og,useContext:Gt,useEffect:Dg,useImperativeHandle:Rg,useInsertionEffect:Eg,useLayoutEffect:Cg,useMemo:Mg,useReducer:hd,useRef:Sg,useState:function(){return hd(Kn)},useDebugValue:md,useDeferredValue:function(e,n){var a=wt();return nt===null?pd(a,e,n):Ig(a,nt.memoizedState,e,n)},useTransition:function(){var e=hd(Kn)[0],n=wt().memoizedState;return[typeof e=="boolean"?e:Qs(e),n]},useSyncExternalStore:dg,useId:$g,useHostTransitionStatus:xd,useFormState:Tg,useActionState:Tg,useOptimistic:function(e,n){var a=wt();return nt!==null?pg(a,nt,e,n):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:dd,useCacheRefresh:zg},Vr=null,Zs=0;function Ii(e){var n=Zs;return Zs+=1,Vr===null&&(Vr=[]),ng(Vr,e,n)}function Js(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function Li(e,n){throw n.$$typeof===b?Error(l(525)):(e=Object.prototype.toString.call(n),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function Pg(e){var n=e._init;return n(e._payload)}function Vg(e){function n(H,A){if(e){var z=H.deletions;z===null?(H.deletions=[A],H.flags|=16):z.push(A)}}function a(H,A){if(!e)return null;for(;A!==null;)n(H,A),A=A.sibling;return null}function o(H){for(var A=new Map;H!==null;)H.key!==null?A.set(H.key,H):A.set(H.index,H),H=H.sibling;return A}function d(H,A){return H=Pn(H,A),H.index=0,H.sibling=null,H}function f(H,A,z){return H.index=z,e?(z=H.alternate,z!==null?(z=z.index,z<A?(H.flags|=67108866,A):z):(H.flags|=67108866,A)):(H.flags|=1048576,A)}function y(H){return e&&H.alternate===null&&(H.flags|=67108866),H}function v(H,A,z,ae){return A===null||A.tag!==6?(A=zc(z,H.mode,ae),A.return=H,A):(A=d(A,z),A.return=H,A)}function N(H,A,z,ae){var we=z.type;return we===T?J(H,A,z.props.children,ae,z.key):A!==null&&(A.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===ee&&Pg(we)===A.type)?(A=d(A,z.props),Js(A,z),A.return=H,A):(A=xi(z.type,z.key,z.props,null,H.mode,ae),Js(A,z),A.return=H,A)}function B(H,A,z,ae){return A===null||A.tag!==4||A.stateNode.containerInfo!==z.containerInfo||A.stateNode.implementation!==z.implementation?(A=Bc(z,H.mode,ae),A.return=H,A):(A=d(A,z.children||[]),A.return=H,A)}function J(H,A,z,ae,we){return A===null||A.tag!==7?(A=Za(z,H.mode,ae,we),A.return=H,A):(A=d(A,z),A.return=H,A)}function se(H,A,z){if(typeof A=="string"&&A!==""||typeof A=="number"||typeof A=="bigint")return A=zc(""+A,H.mode,z),A.return=H,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case w:return z=xi(A.type,A.key,A.props,null,H.mode,z),Js(z,A),z.return=H,z;case L:return A=Bc(A,H.mode,z),A.return=H,A;case ee:var ae=A._init;return A=ae(A._payload),se(H,A,z)}if(Ee(A)||ve(A))return A=Za(A,H.mode,z,null),A.return=H,A;if(typeof A.then=="function")return se(H,Ii(A),z);if(A.$$typeof===R)return se(H,_i(H,A),z);Li(H,A)}return null}function G(H,A,z,ae){var we=A!==null?A.key:null;if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return we!==null?null:v(H,A,""+z,ae);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case w:return z.key===we?N(H,A,z,ae):null;case L:return z.key===we?B(H,A,z,ae):null;case ee:return we=z._init,z=we(z._payload),G(H,A,z,ae)}if(Ee(z)||ve(z))return we!==null?null:J(H,A,z,ae,null);if(typeof z.then=="function")return G(H,A,Ii(z),ae);if(z.$$typeof===R)return G(H,A,_i(H,z),ae);Li(H,z)}return null}function V(H,A,z,ae,we){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return H=H.get(z)||null,v(A,H,""+ae,we);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case w:return H=H.get(ae.key===null?z:ae.key)||null,N(A,H,ae,we);case L:return H=H.get(ae.key===null?z:ae.key)||null,B(A,H,ae,we);case ee:var ze=ae._init;return ae=ze(ae._payload),V(H,A,z,ae,we)}if(Ee(ae)||ve(ae))return H=H.get(z)||null,J(A,H,ae,we,null);if(typeof ae.then=="function")return V(H,A,z,Ii(ae),we);if(ae.$$typeof===R)return V(H,A,z,_i(A,ae),we);Li(A,ae)}return null}function Le(H,A,z,ae){for(var we=null,ze=null,je=A,Me=A=0,Rt=null;je!==null&&Me<z.length;Me++){je.index>Me?(Rt=je,je=null):Rt=je.sibling;var Ve=G(H,je,z[Me],ae);if(Ve===null){je===null&&(je=Rt);break}e&&je&&Ve.alternate===null&&n(H,je),A=f(Ve,A,Me),ze===null?we=Ve:ze.sibling=Ve,ze=Ve,je=Rt}if(Me===z.length)return a(H,je),Qe&&er(H,Me),we;if(je===null){for(;Me<z.length;Me++)je=se(H,z[Me],ae),je!==null&&(A=f(je,A,Me),ze===null?we=je:ze.sibling=je,ze=je);return Qe&&er(H,Me),we}for(je=o(je);Me<z.length;Me++)Rt=V(je,H,Me,z[Me],ae),Rt!==null&&(e&&Rt.alternate!==null&&je.delete(Rt.key===null?Me:Rt.key),A=f(Rt,A,Me),ze===null?we=Rt:ze.sibling=Rt,ze=Rt);return e&&je.forEach(function(La){return n(H,La)}),Qe&&er(H,Me),we}function Re(H,A,z,ae){if(z==null)throw Error(l(151));for(var we=null,ze=null,je=A,Me=A=0,Rt=null,Ve=z.next();je!==null&&!Ve.done;Me++,Ve=z.next()){je.index>Me?(Rt=je,je=null):Rt=je.sibling;var La=G(H,je,Ve.value,ae);if(La===null){je===null&&(je=Rt);break}e&&je&&La.alternate===null&&n(H,je),A=f(La,A,Me),ze===null?we=La:ze.sibling=La,ze=La,je=Rt}if(Ve.done)return a(H,je),Qe&&er(H,Me),we;if(je===null){for(;!Ve.done;Me++,Ve=z.next())Ve=se(H,Ve.value,ae),Ve!==null&&(A=f(Ve,A,Me),ze===null?we=Ve:ze.sibling=Ve,ze=Ve);return Qe&&er(H,Me),we}for(je=o(je);!Ve.done;Me++,Ve=z.next())Ve=V(je,H,Me,Ve.value,ae),Ve!==null&&(e&&Ve.alternate!==null&&je.delete(Ve.key===null?Me:Ve.key),A=f(Ve,A,Me),ze===null?we=Ve:ze.sibling=Ve,ze=Ve);return e&&je.forEach(function(xw){return n(H,xw)}),Qe&&er(H,Me),we}function rt(H,A,z,ae){if(typeof z=="object"&&z!==null&&z.type===T&&z.key===null&&(z=z.props.children),typeof z=="object"&&z!==null){switch(z.$$typeof){case w:e:{for(var we=z.key;A!==null;){if(A.key===we){if(we=z.type,we===T){if(A.tag===7){a(H,A.sibling),ae=d(A,z.props.children),ae.return=H,H=ae;break e}}else if(A.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===ee&&Pg(we)===A.type){a(H,A.sibling),ae=d(A,z.props),Js(ae,z),ae.return=H,H=ae;break e}a(H,A);break}else n(H,A);A=A.sibling}z.type===T?(ae=Za(z.props.children,H.mode,ae,z.key),ae.return=H,H=ae):(ae=xi(z.type,z.key,z.props,null,H.mode,ae),Js(ae,z),ae.return=H,H=ae)}return y(H);case L:e:{for(we=z.key;A!==null;){if(A.key===we)if(A.tag===4&&A.stateNode.containerInfo===z.containerInfo&&A.stateNode.implementation===z.implementation){a(H,A.sibling),ae=d(A,z.children||[]),ae.return=H,H=ae;break e}else{a(H,A);break}else n(H,A);A=A.sibling}ae=Bc(z,H.mode,ae),ae.return=H,H=ae}return y(H);case ee:return we=z._init,z=we(z._payload),rt(H,A,z,ae)}if(Ee(z))return Le(H,A,z,ae);if(ve(z)){if(we=ve(z),typeof we!="function")throw Error(l(150));return z=we.call(z),Re(H,A,z,ae)}if(typeof z.then=="function")return rt(H,A,Ii(z),ae);if(z.$$typeof===R)return rt(H,A,_i(H,z),ae);Li(H,z)}return typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint"?(z=""+z,A!==null&&A.tag===6?(a(H,A.sibling),ae=d(A,z),ae.return=H,H=ae):(a(H,A),ae=zc(z,H.mode,ae),ae.return=H,H=ae),y(H)):a(H,A)}return function(H,A,z,ae){try{Zs=0;var we=rt(H,A,z,ae);return Vr=null,we}catch(je){if(je===Fs||je===Ni)throw je;var ze=ln(29,je,null,H.mode);return ze.lanes=ae,ze.return=H,ze}finally{}}}var Wr=Vg(!0),Wg=Vg(!1),wn=E(null),In=null;function wa(e){var n=e.alternate;Q(kt,kt.current&1),Q(wn,e),In===null&&(n===null||Fr.current!==null||n.memoizedState!==null)&&(In=e)}function Qg(e){if(e.tag===22){if(Q(kt,kt.current),Q(wn,e),In===null){var n=e.alternate;n!==null&&n.memoizedState!==null&&(In=e)}}else _a()}function _a(){Q(kt,kt.current),Q(wn,wn.current)}function Zn(e){O(wn),In===e&&(In=null),O(kt)}var kt=E(0);function Ui(e){for(var n=e;n!==null;){if(n.tag===13){var a=n.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||cu(a)))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}function vd(e,n,a,o){n=e.memoizedState,a=a(o,n),a=a==null?n:x({},n,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var wd={enqueueSetState:function(e,n,a){e=e._reactInternals;var o=un(),d=xa(o);d.payload=n,a!=null&&(d.callback=a),n=ba(e,d,o),n!==null&&(hn(n,e,o),Ys(n,e,o))},enqueueReplaceState:function(e,n,a){e=e._reactInternals;var o=un(),d=xa(o);d.tag=1,d.payload=n,a!=null&&(d.callback=a),n=ba(e,d,o),n!==null&&(hn(n,e,o),Ys(n,e,o))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var a=un(),o=xa(a);o.tag=2,n!=null&&(o.callback=n),n=ba(e,o,a),n!==null&&(hn(n,e,a),Ys(n,e,a))}};function Xg(e,n,a,o,d,f,y){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,f,y):n.prototype&&n.prototype.isPureReactComponent?!Is(a,o)||!Is(d,f):!0}function Kg(e,n,a,o){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(a,o),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(a,o),n.state!==e&&wd.enqueueReplaceState(n,n.state,null)}function ir(e,n){var a=n;if("ref"in n){a={};for(var o in n)o!=="ref"&&(a[o]=n[o])}if(e=e.defaultProps){a===n&&(a=x({},a));for(var d in e)a[d]===void 0&&(a[d]=e[d])}return a}var Hi=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function Zg(e){Hi(e)}function Jg(e){console.error(e)}function e0(e){Hi(e)}function $i(e,n){try{var a=e.onUncaughtError;a(n.value,{componentStack:n.stack})}catch(o){setTimeout(function(){throw o})}}function t0(e,n,a){try{var o=e.onCaughtError;o(a.value,{componentStack:a.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function _d(e,n,a){return a=xa(a),a.tag=3,a.payload={element:null},a.callback=function(){$i(e,n)},a}function n0(e){return e=xa(e),e.tag=3,e}function a0(e,n,a,o){var d=a.type.getDerivedStateFromError;if(typeof d=="function"){var f=o.value;e.payload=function(){return d(f)},e.callback=function(){t0(n,a,o)}}var y=a.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(e.callback=function(){t0(n,a,o),typeof d!="function"&&(Da===null?Da=new Set([this]):Da.add(this));var v=o.stack;this.componentDidCatch(o.value,{componentStack:v!==null?v:""})})}function xv(e,n,a,o,d){if(a.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){if(n=a.alternate,n!==null&&zs(n,a,d,!0),a=wn.current,a!==null){switch(a.tag){case 13:return In===null?Pd():a.alternate===null&&gt===0&&(gt=3),a.flags&=-257,a.flags|=65536,a.lanes=d,o===Kc?a.flags|=16384:(n=a.updateQueue,n===null?a.updateQueue=new Set([o]):n.add(o),Wd(e,o,d)),!1;case 22:return a.flags|=65536,o===Kc?a.flags|=16384:(n=a.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([o])},a.updateQueue=n):(a=n.retryQueue,a===null?n.retryQueue=new Set([o]):a.add(o)),Wd(e,o,d)),!1}throw Error(l(435,a.tag))}return Wd(e,o,d),Pd(),!1}if(Qe)return n=wn.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=d,o!==Gc&&(e=Error(l(422),{cause:o}),$s(yn(e,a)))):(o!==Gc&&(n=Error(l(423),{cause:o}),$s(yn(n,a))),e=e.current.alternate,e.flags|=65536,d&=-d,e.lanes|=d,o=yn(o,a),d=_d(e.stateNode,o,d),ed(e,d),gt!==4&&(gt=2)),!1;var f=Error(l(520),{cause:o});if(f=yn(f,a),ll===null?ll=[f]:ll.push(f),gt!==4&&(gt=2),n===null)return!0;o=yn(o,a),a=n;do{switch(a.tag){case 3:return a.flags|=65536,e=d&-d,a.lanes|=e,e=_d(a.stateNode,o,e),ed(a,e),!1;case 1:if(n=a.type,f=a.stateNode,(a.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Da===null||!Da.has(f))))return a.flags|=65536,d&=-d,a.lanes|=d,d=n0(d),a0(d,e,a,o),ed(a,d),!1}a=a.return}while(a!==null);return!1}var r0=Error(l(461)),Ct=!1;function Ht(e,n,a,o){n.child=e===null?Wg(n,null,a,o):Wr(n,e.child,a,o)}function s0(e,n,a,o,d){a=a.render;var f=n.ref;if("ref"in o){var y={};for(var v in o)v!=="ref"&&(y[v]=o[v])}else y=o;return rr(n),o=sd(e,n,a,y,f,d),v=ld(),e!==null&&!Ct?(id(e,n,d),Jn(e,n,d)):(Qe&&v&&qc(n),n.flags|=1,Ht(e,n,o,d),n.child)}function l0(e,n,a,o,d){if(e===null){var f=a.type;return typeof f=="function"&&!$c(f)&&f.defaultProps===void 0&&a.compare===null?(n.tag=15,n.type=f,i0(e,n,f,o,d)):(e=xi(a.type,null,o,n,n.mode,d),e.ref=n.ref,e.return=n,n.child=e)}if(f=e.child,!Cd(e,d)){var y=f.memoizedProps;if(a=a.compare,a=a!==null?a:Is,a(y,o)&&e.ref===n.ref)return Jn(e,n,d)}return n.flags|=1,e=Pn(f,o),e.ref=n.ref,e.return=n,n.child=e}function i0(e,n,a,o,d){if(e!==null){var f=e.memoizedProps;if(Is(f,o)&&e.ref===n.ref)if(Ct=!1,n.pendingProps=o=f,Cd(e,d))(e.flags&131072)!==0&&(Ct=!0);else return n.lanes=e.lanes,Jn(e,n,d)}return kd(e,n,a,o,d)}function o0(e,n,a){var o=n.pendingProps,d=o.children,f=e!==null?e.memoizedState:null;if(o.mode==="hidden"){if((n.flags&128)!==0){if(o=f!==null?f.baseLanes|a:a,e!==null){for(d=n.child=e.child,f=0;d!==null;)f=f|d.lanes|d.childLanes,d=d.sibling;n.childLanes=f&~o}else n.childLanes=0,n.child=null;return c0(e,n,o,a)}if((a&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&ki(n,f!==null?f.cachePool:null),f!==null?ig(n,f):nd(),Qg(n);else return n.lanes=n.childLanes=536870912,c0(e,n,f!==null?f.baseLanes|a:a,a)}else f!==null?(ki(n,f.cachePool),ig(n,f),_a(),n.memoizedState=null):(e!==null&&ki(n,null),nd(),_a());return Ht(e,n,d,a),n.child}function c0(e,n,a,o){var d=Xc();return d=d===null?null:{parent:_t._currentValue,pool:d},n.memoizedState={baseLanes:a,cachePool:d},e!==null&&ki(n,null),nd(),Qg(n),e!==null&&zs(e,n,o,!0),null}function zi(e,n){var a=n.ref;if(a===null)e!==null&&e.ref!==null&&(n.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(l(284));(e===null||e.ref!==a)&&(n.flags|=4194816)}}function kd(e,n,a,o,d){return rr(n),a=sd(e,n,a,o,void 0,d),o=ld(),e!==null&&!Ct?(id(e,n,d),Jn(e,n,d)):(Qe&&o&&qc(n),n.flags|=1,Ht(e,n,a,d),n.child)}function d0(e,n,a,o,d,f){return rr(n),n.updateQueue=null,a=cg(n,o,a,d),og(e),o=ld(),e!==null&&!Ct?(id(e,n,f),Jn(e,n,f)):(Qe&&o&&qc(n),n.flags|=1,Ht(e,n,a,f),n.child)}function u0(e,n,a,o,d){if(rr(n),n.stateNode===null){var f=Hr,y=a.contextType;typeof y=="object"&&y!==null&&(f=Gt(y)),f=new a(o,f),n.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=wd,n.stateNode=f,f._reactInternals=n,f=n.stateNode,f.props=o,f.state=n.memoizedState,f.refs={},Zc(n),y=a.contextType,f.context=typeof y=="object"&&y!==null?Gt(y):Hr,f.state=n.memoizedState,y=a.getDerivedStateFromProps,typeof y=="function"&&(vd(n,a,y,o),f.state=n.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(y=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),y!==f.state&&wd.enqueueReplaceState(f,f.state,null),Vs(n,o,f,d),Ps(),f.state=n.memoizedState),typeof f.componentDidMount=="function"&&(n.flags|=4194308),o=!0}else if(e===null){f=n.stateNode;var v=n.memoizedProps,N=ir(a,v);f.props=N;var B=f.context,J=a.contextType;y=Hr,typeof J=="object"&&J!==null&&(y=Gt(J));var se=a.getDerivedStateFromProps;J=typeof se=="function"||typeof f.getSnapshotBeforeUpdate=="function",v=n.pendingProps!==v,J||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(v||B!==y)&&Kg(n,f,o,y),ya=!1;var G=n.memoizedState;f.state=G,Vs(n,o,f,d),Ps(),B=n.memoizedState,v||G!==B||ya?(typeof se=="function"&&(vd(n,a,se,o),B=n.memoizedState),(N=ya||Xg(n,a,N,o,G,B,y))?(J||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(n.flags|=4194308)):(typeof f.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=o,n.memoizedState=B),f.props=o,f.state=B,f.context=y,o=N):(typeof f.componentDidMount=="function"&&(n.flags|=4194308),o=!1)}else{f=n.stateNode,Jc(e,n),y=n.memoizedProps,J=ir(a,y),f.props=J,se=n.pendingProps,G=f.context,B=a.contextType,N=Hr,typeof B=="object"&&B!==null&&(N=Gt(B)),v=a.getDerivedStateFromProps,(B=typeof v=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(y!==se||G!==N)&&Kg(n,f,o,N),ya=!1,G=n.memoizedState,f.state=G,Vs(n,o,f,d),Ps();var V=n.memoizedState;y!==se||G!==V||ya||e!==null&&e.dependencies!==null&&wi(e.dependencies)?(typeof v=="function"&&(vd(n,a,v,o),V=n.memoizedState),(J=ya||Xg(n,a,J,o,G,V,N)||e!==null&&e.dependencies!==null&&wi(e.dependencies))?(B||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(o,V,N),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(o,V,N)),typeof f.componentDidUpdate=="function"&&(n.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&G===e.memoizedState||(n.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&G===e.memoizedState||(n.flags|=1024),n.memoizedProps=o,n.memoizedState=V),f.props=o,f.state=V,f.context=N,o=J):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&G===e.memoizedState||(n.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&G===e.memoizedState||(n.flags|=1024),o=!1)}return f=o,zi(e,n),o=(n.flags&128)!==0,f||o?(f=n.stateNode,a=o&&typeof a.getDerivedStateFromError!="function"?null:f.render(),n.flags|=1,e!==null&&o?(n.child=Wr(n,e.child,null,d),n.child=Wr(n,null,a,d)):Ht(e,n,a,d),n.memoizedState=f.state,e=n.child):e=Jn(e,n,d),e}function h0(e,n,a,o){return Hs(),n.flags|=256,Ht(e,n,a,o),n.child}var Nd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Td(e){return{baseLanes:e,cachePool:Jf()}}function Sd(e,n,a){return e=e!==null?e.childLanes&~a:0,n&&(e|=_n),e}function f0(e,n,a){var o=n.pendingProps,d=!1,f=(n.flags&128)!==0,y;if((y=f)||(y=e!==null&&e.memoizedState===null?!1:(kt.current&2)!==0),y&&(d=!0,n.flags&=-129),y=(n.flags&32)!==0,n.flags&=-33,e===null){if(Qe){if(d?wa(n):_a(),Qe){var v=ft,N;if(N=v){e:{for(N=v,v=Mn;N.nodeType!==8;){if(!v){v=null;break e}if(N=jn(N.nextSibling),N===null){v=null;break e}}v=N}v!==null?(n.memoizedState={dehydrated:v,treeContext:Ja!==null?{id:Vn,overflow:Wn}:null,retryLane:536870912,hydrationErrors:null},N=ln(18,null,null,0),N.stateNode=v,N.return=n,n.child=N,Vt=n,ft=null,N=!0):N=!1}N||nr(n)}if(v=n.memoizedState,v!==null&&(v=v.dehydrated,v!==null))return cu(v)?n.lanes=32:n.lanes=536870912,null;Zn(n)}return v=o.children,o=o.fallback,d?(_a(),d=n.mode,v=Bi({mode:"hidden",children:v},d),o=Za(o,d,a,null),v.return=n,o.return=n,v.sibling=o,n.child=v,d=n.child,d.memoizedState=Td(a),d.childLanes=Sd(e,y,a),n.memoizedState=Nd,o):(wa(n),jd(n,v))}if(N=e.memoizedState,N!==null&&(v=N.dehydrated,v!==null)){if(f)n.flags&256?(wa(n),n.flags&=-257,n=Dd(e,n,a)):n.memoizedState!==null?(_a(),n.child=e.child,n.flags|=128,n=null):(_a(),d=o.fallback,v=n.mode,o=Bi({mode:"visible",children:o.children},v),d=Za(d,v,a,null),d.flags|=2,o.return=n,d.return=n,o.sibling=d,n.child=o,Wr(n,e.child,null,a),o=n.child,o.memoizedState=Td(a),o.childLanes=Sd(e,y,a),n.memoizedState=Nd,n=d);else if(wa(n),cu(v)){if(y=v.nextSibling&&v.nextSibling.dataset,y)var B=y.dgst;y=B,o=Error(l(419)),o.stack="",o.digest=y,$s({value:o,source:null,stack:null}),n=Dd(e,n,a)}else if(Ct||zs(e,n,a,!1),y=(a&e.childLanes)!==0,Ct||y){if(y=ot,y!==null&&(o=a&-a,o=(o&42)!==0?1:dc(o),o=(o&(y.suspendedLanes|a))!==0?0:o,o!==0&&o!==N.retryLane))throw N.retryLane=o,Ur(e,o),hn(y,e,o),r0;v.data==="$?"||Pd(),n=Dd(e,n,a)}else v.data==="$?"?(n.flags|=192,n.child=e.child,n=null):(e=N.treeContext,ft=jn(v.nextSibling),Vt=n,Qe=!0,tr=null,Mn=!1,e!==null&&(bn[vn++]=Vn,bn[vn++]=Wn,bn[vn++]=Ja,Vn=e.id,Wn=e.overflow,Ja=n),n=jd(n,o.children),n.flags|=4096);return n}return d?(_a(),d=o.fallback,v=n.mode,N=e.child,B=N.sibling,o=Pn(N,{mode:"hidden",children:o.children}),o.subtreeFlags=N.subtreeFlags&65011712,B!==null?d=Pn(B,d):(d=Za(d,v,a,null),d.flags|=2),d.return=n,o.return=n,o.sibling=d,n.child=o,o=d,d=n.child,v=e.child.memoizedState,v===null?v=Td(a):(N=v.cachePool,N!==null?(B=_t._currentValue,N=N.parent!==B?{parent:B,pool:B}:N):N=Jf(),v={baseLanes:v.baseLanes|a,cachePool:N}),d.memoizedState=v,d.childLanes=Sd(e,y,a),n.memoizedState=Nd,o):(wa(n),a=e.child,e=a.sibling,a=Pn(a,{mode:"visible",children:o.children}),a.return=n,a.sibling=null,e!==null&&(y=n.deletions,y===null?(n.deletions=[e],n.flags|=16):y.push(e)),n.child=a,n.memoizedState=null,a)}function jd(e,n){return n=Bi({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function Bi(e,n){return e=ln(22,e,null,n),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Dd(e,n,a){return Wr(n,e.child,null,a),e=jd(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function g0(e,n,a){e.lanes|=n;var o=e.alternate;o!==null&&(o.lanes|=n),Pc(e.return,n,a)}function Ed(e,n,a,o,d){var f=e.memoizedState;f===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:o,tail:a,tailMode:d}:(f.isBackwards=n,f.rendering=null,f.renderingStartTime=0,f.last=o,f.tail=a,f.tailMode=d)}function m0(e,n,a){var o=n.pendingProps,d=o.revealOrder,f=o.tail;if(Ht(e,n,o.children,a),o=kt.current,(o&2)!==0)o=o&1|2,n.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&g0(e,a,n);else if(e.tag===19)g0(e,a,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}switch(Q(kt,o),d){case"forwards":for(a=n.child,d=null;a!==null;)e=a.alternate,e!==null&&Ui(e)===null&&(d=a),a=a.sibling;a=d,a===null?(d=n.child,n.child=null):(d=a.sibling,a.sibling=null),Ed(n,!1,d,a,f);break;case"backwards":for(a=null,d=n.child,n.child=null;d!==null;){if(e=d.alternate,e!==null&&Ui(e)===null){n.child=d;break}e=d.sibling,d.sibling=a,a=d,d=e}Ed(n,!0,a,null,f);break;case"together":Ed(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function Jn(e,n,a){if(e!==null&&(n.dependencies=e.dependencies),ja|=n.lanes,(a&n.childLanes)===0)if(e!==null){if(zs(e,n,a,!1),(a&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(l(153));if(n.child!==null){for(e=n.child,a=Pn(e,e.pendingProps),n.child=a,a.return=n;e.sibling!==null;)e=e.sibling,a=a.sibling=Pn(e,e.pendingProps),a.return=n;a.sibling=null}return n.child}function Cd(e,n){return(e.lanes&n)!==0?!0:(e=e.dependencies,!!(e!==null&&wi(e)))}function bv(e,n,a){switch(n.tag){case 3:ne(n,n.stateNode.containerInfo),pa(n,_t,e.memoizedState.cache),Hs();break;case 27:case 5:Se(n);break;case 4:ne(n,n.stateNode.containerInfo);break;case 10:pa(n,n.type,n.memoizedProps.value);break;case 13:var o=n.memoizedState;if(o!==null)return o.dehydrated!==null?(wa(n),n.flags|=128,null):(a&n.child.childLanes)!==0?f0(e,n,a):(wa(n),e=Jn(e,n,a),e!==null?e.sibling:null);wa(n);break;case 19:var d=(e.flags&128)!==0;if(o=(a&n.childLanes)!==0,o||(zs(e,n,a,!1),o=(a&n.childLanes)!==0),d){if(o)return m0(e,n,a);n.flags|=128}if(d=n.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),Q(kt,kt.current),o)break;return null;case 22:case 23:return n.lanes=0,o0(e,n,a);case 24:pa(n,_t,e.memoizedState.cache)}return Jn(e,n,a)}function p0(e,n,a){if(e!==null)if(e.memoizedProps!==n.pendingProps)Ct=!0;else{if(!Cd(e,a)&&(n.flags&128)===0)return Ct=!1,bv(e,n,a);Ct=(e.flags&131072)!==0}else Ct=!1,Qe&&(n.flags&1048576)!==0&&Pf(n,vi,n.index);switch(n.lanes=0,n.tag){case 16:e:{e=n.pendingProps;var o=n.elementType,d=o._init;if(o=d(o._payload),n.type=o,typeof o=="function")$c(o)?(e=ir(o,e),n.tag=1,n=u0(null,n,o,e,a)):(n.tag=0,n=kd(null,n,o,e,a));else{if(o!=null){if(d=o.$$typeof,d===D){n.tag=11,n=s0(null,n,o,e,a);break e}else if(d===C){n.tag=14,n=l0(null,n,o,e,a);break e}}throw n=Te(o)||o,Error(l(306,n,""))}}return n;case 0:return kd(e,n,n.type,n.pendingProps,a);case 1:return o=n.type,d=ir(o,n.pendingProps),u0(e,n,o,d,a);case 3:e:{if(ne(n,n.stateNode.containerInfo),e===null)throw Error(l(387));o=n.pendingProps;var f=n.memoizedState;d=f.element,Jc(e,n),Vs(n,o,null,a);var y=n.memoizedState;if(o=y.cache,pa(n,_t,o),o!==f.cache&&Vc(n,[_t],a,!0),Ps(),o=y.element,f.isDehydrated)if(f={element:o,isDehydrated:!1,cache:y.cache},n.updateQueue.baseState=f,n.memoizedState=f,n.flags&256){n=h0(e,n,o,a);break e}else if(o!==d){d=yn(Error(l(424)),n),$s(d),n=h0(e,n,o,a);break e}else{switch(e=n.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(ft=jn(e.firstChild),Vt=n,Qe=!0,tr=null,Mn=!0,a=Wg(n,null,o,a),n.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(Hs(),o===d){n=Jn(e,n,a);break e}Ht(e,n,o,a)}n=n.child}return n;case 26:return zi(e,n),e===null?(a=vm(n.type,null,n.pendingProps,null))?n.memoizedState=a:Qe||(a=n.type,e=n.pendingProps,o=to(de.current).createElement(a),o[Ft]=n,o[Xt]=e,zt(o,a,e),Et(o),n.stateNode=o):n.memoizedState=vm(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return Se(n),e===null&&Qe&&(o=n.stateNode=ym(n.type,n.pendingProps,de.current),Vt=n,Mn=!0,d=ft,Aa(n.type)?(du=d,ft=jn(o.firstChild)):ft=d),Ht(e,n,n.pendingProps.children,a),zi(e,n),e===null&&(n.flags|=4194304),n.child;case 5:return e===null&&Qe&&((d=o=ft)&&(o=Vv(o,n.type,n.pendingProps,Mn),o!==null?(n.stateNode=o,Vt=n,ft=jn(o.firstChild),Mn=!1,d=!0):d=!1),d||nr(n)),Se(n),d=n.type,f=n.pendingProps,y=e!==null?e.memoizedProps:null,o=f.children,lu(d,f)?o=null:y!==null&&lu(d,y)&&(n.flags|=32),n.memoizedState!==null&&(d=sd(e,n,uv,null,null,a),ml._currentValue=d),zi(e,n),Ht(e,n,o,a),n.child;case 6:return e===null&&Qe&&((e=a=ft)&&(a=Wv(a,n.pendingProps,Mn),a!==null?(n.stateNode=a,Vt=n,ft=null,e=!0):e=!1),e||nr(n)),null;case 13:return f0(e,n,a);case 4:return ne(n,n.stateNode.containerInfo),o=n.pendingProps,e===null?n.child=Wr(n,null,o,a):Ht(e,n,o,a),n.child;case 11:return s0(e,n,n.type,n.pendingProps,a);case 7:return Ht(e,n,n.pendingProps,a),n.child;case 8:return Ht(e,n,n.pendingProps.children,a),n.child;case 12:return Ht(e,n,n.pendingProps.children,a),n.child;case 10:return o=n.pendingProps,pa(n,n.type,o.value),Ht(e,n,o.children,a),n.child;case 9:return d=n.type._context,o=n.pendingProps.children,rr(n),d=Gt(d),o=o(d),n.flags|=1,Ht(e,n,o,a),n.child;case 14:return l0(e,n,n.type,n.pendingProps,a);case 15:return i0(e,n,n.type,n.pendingProps,a);case 19:return m0(e,n,a);case 31:return o=n.pendingProps,a=n.mode,o={mode:o.mode,children:o.children},e===null?(a=Bi(o,a),a.ref=n.ref,n.child=a,a.return=n,n=a):(a=Pn(e.child,o),a.ref=n.ref,n.child=a,a.return=n,n=a),n;case 22:return o0(e,n,a);case 24:return rr(n),o=Gt(_t),e===null?(d=Xc(),d===null&&(d=ot,f=Wc(),d.pooledCache=f,f.refCount++,f!==null&&(d.pooledCacheLanes|=a),d=f),n.memoizedState={parent:o,cache:d},Zc(n),pa(n,_t,d)):((e.lanes&a)!==0&&(Jc(e,n),Vs(n,null,null,a),Ps()),d=e.memoizedState,f=n.memoizedState,d.parent!==o?(d={parent:o,cache:o},n.memoizedState=d,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=d),pa(n,_t,o)):(o=f.cache,pa(n,_t,o),o!==d.cache&&Vc(n,[_t],a,!0))),Ht(e,n,n.pendingProps.children,a),n.child;case 29:throw n.pendingProps}throw Error(l(156,n.tag))}function ea(e){e.flags|=4}function y0(e,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Tm(n)){if(n=wn.current,n!==null&&((Pe&4194048)===Pe?In!==null:(Pe&62914560)!==Pe&&(Pe&536870912)===0||n!==In))throw Gs=Kc,eg;e.flags|=8192}}function qi(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?Wh():536870912,e.lanes|=n,Zr|=n)}function el(e,n){if(!Qe)switch(e.tailMode){case"hidden":n=e.tail;for(var a=null;n!==null;)n.alternate!==null&&(a=n),n=n.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function ht(e){var n=e.alternate!==null&&e.alternate.child===e.child,a=0,o=0;if(n)for(var d=e.child;d!==null;)a|=d.lanes|d.childLanes,o|=d.subtreeFlags&65011712,o|=d.flags&65011712,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)a|=d.lanes|d.childLanes,o|=d.subtreeFlags,o|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=o,e.childLanes=a,n}function vv(e,n,a){var o=n.pendingProps;switch(Fc(n),n.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ht(n),null;case 1:return ht(n),null;case 3:return a=n.stateNode,o=null,e!==null&&(o=e.memoizedState.cache),n.memoizedState.cache!==o&&(n.flags|=2048),Xn(_t),ce(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Us(n)?ea(n):e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Qf())),ht(n),null;case 26:return a=n.memoizedState,e===null?(ea(n),a!==null?(ht(n),y0(n,a)):(ht(n),n.flags&=-16777217)):a?a!==e.memoizedState?(ea(n),ht(n),y0(n,a)):(ht(n),n.flags&=-16777217):(e.memoizedProps!==o&&ea(n),ht(n),n.flags&=-16777217),null;case 27:ue(n),a=de.current;var d=n.type;if(e!==null&&n.stateNode!=null)e.memoizedProps!==o&&ea(n);else{if(!o){if(n.stateNode===null)throw Error(l(166));return ht(n),null}e=pe.current,Us(n)?Vf(n):(e=ym(d,o,a),n.stateNode=e,ea(n))}return ht(n),null;case 5:if(ue(n),a=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==o&&ea(n);else{if(!o){if(n.stateNode===null)throw Error(l(166));return ht(n),null}if(e=pe.current,Us(n))Vf(n);else{switch(d=to(de.current),e){case 1:e=d.createElementNS("http://www.w3.org/2000/svg",a);break;case 2:e=d.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;default:switch(a){case"svg":e=d.createElementNS("http://www.w3.org/2000/svg",a);break;case"math":e=d.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;case"script":e=d.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof o.is=="string"?d.createElement("select",{is:o.is}):d.createElement("select"),o.multiple?e.multiple=!0:o.size&&(e.size=o.size);break;default:e=typeof o.is=="string"?d.createElement(a,{is:o.is}):d.createElement(a)}}e[Ft]=n,e[Xt]=o;e:for(d=n.child;d!==null;){if(d.tag===5||d.tag===6)e.appendChild(d.stateNode);else if(d.tag!==4&&d.tag!==27&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}n.stateNode=e;e:switch(zt(e,a,o),a){case"button":case"input":case"select":case"textarea":e=!!o.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&ea(n)}}return ht(n),n.flags&=-16777217,null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==o&&ea(n);else{if(typeof o!="string"&&n.stateNode===null)throw Error(l(166));if(e=de.current,Us(n)){if(e=n.stateNode,a=n.memoizedProps,o=null,d=Vt,d!==null)switch(d.tag){case 27:case 5:o=d.memoizedProps}e[Ft]=n,e=!!(e.nodeValue===a||o!==null&&o.suppressHydrationWarning===!0||dm(e.nodeValue,a)),e||nr(n)}else e=to(e).createTextNode(o),e[Ft]=n,n.stateNode=e}return ht(n),null;case 13:if(o=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(d=Us(n),o!==null&&o.dehydrated!==null){if(e===null){if(!d)throw Error(l(318));if(d=n.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(l(317));d[Ft]=n}else Hs(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;ht(n),d=!1}else d=Qf(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=d),d=!0;if(!d)return n.flags&256?(Zn(n),n):(Zn(n),null)}if(Zn(n),(n.flags&128)!==0)return n.lanes=a,n;if(a=o!==null,e=e!==null&&e.memoizedState!==null,a){o=n.child,d=null,o.alternate!==null&&o.alternate.memoizedState!==null&&o.alternate.memoizedState.cachePool!==null&&(d=o.alternate.memoizedState.cachePool.pool);var f=null;o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),f!==d&&(o.flags|=2048)}return a!==e&&a&&(n.child.flags|=8192),qi(n,n.updateQueue),ht(n),null;case 4:return ce(),e===null&&tu(n.stateNode.containerInfo),ht(n),null;case 10:return Xn(n.type),ht(n),null;case 19:if(O(kt),d=n.memoizedState,d===null)return ht(n),null;if(o=(n.flags&128)!==0,f=d.rendering,f===null)if(o)el(d,!1);else{if(gt!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(f=Ui(e),f!==null){for(n.flags|=128,el(d,!1),e=f.updateQueue,n.updateQueue=e,qi(n,e),n.subtreeFlags=0,e=a,a=n.child;a!==null;)Yf(a,e),a=a.sibling;return Q(kt,kt.current&1|2),n.child}e=e.sibling}d.tail!==null&&Dt()>Yi&&(n.flags|=128,o=!0,el(d,!1),n.lanes=4194304)}else{if(!o)if(e=Ui(f),e!==null){if(n.flags|=128,o=!0,e=e.updateQueue,n.updateQueue=e,qi(n,e),el(d,!0),d.tail===null&&d.tailMode==="hidden"&&!f.alternate&&!Qe)return ht(n),null}else 2*Dt()-d.renderingStartTime>Yi&&a!==536870912&&(n.flags|=128,o=!0,el(d,!1),n.lanes=4194304);d.isBackwards?(f.sibling=n.child,n.child=f):(e=d.last,e!==null?e.sibling=f:n.child=f,d.last=f)}return d.tail!==null?(n=d.tail,d.rendering=n,d.tail=n.sibling,d.renderingStartTime=Dt(),n.sibling=null,e=kt.current,Q(kt,o?e&1|2:e&1),n):(ht(n),null);case 22:case 23:return Zn(n),ad(),o=n.memoizedState!==null,e!==null?e.memoizedState!==null!==o&&(n.flags|=8192):o&&(n.flags|=8192),o?(a&536870912)!==0&&(n.flags&128)===0&&(ht(n),n.subtreeFlags&6&&(n.flags|=8192)):ht(n),a=n.updateQueue,a!==null&&qi(n,a.retryQueue),a=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),o=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),o!==a&&(n.flags|=2048),e!==null&&O(sr),null;case 24:return a=null,e!==null&&(a=e.memoizedState.cache),n.memoizedState.cache!==a&&(n.flags|=2048),Xn(_t),ht(n),null;case 25:return null;case 30:return null}throw Error(l(156,n.tag))}function wv(e,n){switch(Fc(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Xn(_t),ce(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return ue(n),null;case 13:if(Zn(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(l(340));Hs()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return O(kt),null;case 4:return ce(),null;case 10:return Xn(n.type),null;case 22:case 23:return Zn(n),ad(),e!==null&&O(sr),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return Xn(_t),null;case 25:return null;default:return null}}function x0(e,n){switch(Fc(n),n.tag){case 3:Xn(_t),ce();break;case 26:case 27:case 5:ue(n);break;case 4:ce();break;case 13:Zn(n);break;case 19:O(kt);break;case 10:Xn(n.type);break;case 22:case 23:Zn(n),ad(),e!==null&&O(sr);break;case 24:Xn(_t)}}function tl(e,n){try{var a=n.updateQueue,o=a!==null?a.lastEffect:null;if(o!==null){var d=o.next;a=d;do{if((a.tag&e)===e){o=void 0;var f=a.create,y=a.inst;o=f(),y.destroy=o}a=a.next}while(a!==d)}}catch(v){lt(n,n.return,v)}}function ka(e,n,a){try{var o=n.updateQueue,d=o!==null?o.lastEffect:null;if(d!==null){var f=d.next;o=f;do{if((o.tag&e)===e){var y=o.inst,v=y.destroy;if(v!==void 0){y.destroy=void 0,d=n;var N=a,B=v;try{B()}catch(J){lt(d,N,J)}}}o=o.next}while(o!==f)}}catch(J){lt(n,n.return,J)}}function b0(e){var n=e.updateQueue;if(n!==null){var a=e.stateNode;try{lg(n,a)}catch(o){lt(e,e.return,o)}}}function v0(e,n,a){a.props=ir(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(o){lt(e,n,o)}}function nl(e,n){try{var a=e.ref;if(a!==null){switch(e.tag){case 26:case 27:case 5:var o=e.stateNode;break;case 30:o=e.stateNode;break;default:o=e.stateNode}typeof a=="function"?e.refCleanup=a(o):a.current=o}}catch(d){lt(e,n,d)}}function Ln(e,n){var a=e.ref,o=e.refCleanup;if(a!==null)if(typeof o=="function")try{o()}catch(d){lt(e,n,d)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(d){lt(e,n,d)}else a.current=null}function w0(e){var n=e.type,a=e.memoizedProps,o=e.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":a.autoFocus&&o.focus();break e;case"img":a.src?o.src=a.src:a.srcSet&&(o.srcset=a.srcSet)}}catch(d){lt(e,e.return,d)}}function Ad(e,n,a){try{var o=e.stateNode;qv(o,e.type,a,n),o[Xt]=n}catch(d){lt(e,e.return,d)}}function _0(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Aa(e.type)||e.tag===4}function Rd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||_0(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Aa(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Od(e,n,a){var o=e.tag;if(o===5||o===6)e=e.stateNode,n?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(e,n):(n=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,n.appendChild(e),a=a._reactRootContainer,a!=null||n.onclick!==null||(n.onclick=eo));else if(o!==4&&(o===27&&Aa(e.type)&&(a=e.stateNode,n=null),e=e.child,e!==null))for(Od(e,n,a),e=e.sibling;e!==null;)Od(e,n,a),e=e.sibling}function Fi(e,n,a){var o=e.tag;if(o===5||o===6)e=e.stateNode,n?a.insertBefore(e,n):a.appendChild(e);else if(o!==4&&(o===27&&Aa(e.type)&&(a=e.stateNode),e=e.child,e!==null))for(Fi(e,n,a),e=e.sibling;e!==null;)Fi(e,n,a),e=e.sibling}function k0(e){var n=e.stateNode,a=e.memoizedProps;try{for(var o=e.type,d=n.attributes;d.length;)n.removeAttributeNode(d[0]);zt(n,o,a),n[Ft]=e,n[Xt]=a}catch(f){lt(e,e.return,f)}}var ta=!1,xt=!1,Md=!1,N0=typeof WeakSet=="function"?WeakSet:Set,At=null;function _v(e,n){if(e=e.containerInfo,ru=io,e=If(e),Rc(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var o=a.getSelection&&a.getSelection();if(o&&o.rangeCount!==0){a=o.anchorNode;var d=o.anchorOffset,f=o.focusNode;o=o.focusOffset;try{a.nodeType,f.nodeType}catch{a=null;break e}var y=0,v=-1,N=-1,B=0,J=0,se=e,G=null;t:for(;;){for(var V;se!==a||d!==0&&se.nodeType!==3||(v=y+d),se!==f||o!==0&&se.nodeType!==3||(N=y+o),se.nodeType===3&&(y+=se.nodeValue.length),(V=se.firstChild)!==null;)G=se,se=V;for(;;){if(se===e)break t;if(G===a&&++B===d&&(v=y),G===f&&++J===o&&(N=y),(V=se.nextSibling)!==null)break;se=G,G=se.parentNode}se=V}a=v===-1||N===-1?null:{start:v,end:N}}else a=null}a=a||{start:0,end:0}}else a=null;for(su={focusedElem:e,selectionRange:a},io=!1,At=n;At!==null;)if(n=At,e=n.child,(n.subtreeFlags&1024)!==0&&e!==null)e.return=n,At=e;else for(;At!==null;){switch(n=At,f=n.alternate,e=n.flags,n.tag){case 0:break;case 11:case 15:break;case 1:if((e&1024)!==0&&f!==null){e=void 0,a=n,d=f.memoizedProps,f=f.memoizedState,o=a.stateNode;try{var Le=ir(a.type,d,a.elementType===a.type);e=o.getSnapshotBeforeUpdate(Le,f),o.__reactInternalSnapshotBeforeUpdate=e}catch(Re){lt(a,a.return,Re)}}break;case 3:if((e&1024)!==0){if(e=n.stateNode.containerInfo,a=e.nodeType,a===9)ou(e);else if(a===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":ou(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(l(163))}if(e=n.sibling,e!==null){e.return=n.return,At=e;break}At=n.return}}function T0(e,n,a){var o=a.flags;switch(a.tag){case 0:case 11:case 15:Na(e,a),o&4&&tl(5,a);break;case 1:if(Na(e,a),o&4)if(e=a.stateNode,n===null)try{e.componentDidMount()}catch(y){lt(a,a.return,y)}else{var d=ir(a.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(d,n,e.__reactInternalSnapshotBeforeUpdate)}catch(y){lt(a,a.return,y)}}o&64&&b0(a),o&512&&nl(a,a.return);break;case 3:if(Na(e,a),o&64&&(e=a.updateQueue,e!==null)){if(n=null,a.child!==null)switch(a.child.tag){case 27:case 5:n=a.child.stateNode;break;case 1:n=a.child.stateNode}try{lg(e,n)}catch(y){lt(a,a.return,y)}}break;case 27:n===null&&o&4&&k0(a);case 26:case 5:Na(e,a),n===null&&o&4&&w0(a),o&512&&nl(a,a.return);break;case 12:Na(e,a);break;case 13:Na(e,a),o&4&&D0(e,a),o&64&&(e=a.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(a=Av.bind(null,a),Qv(e,a))));break;case 22:if(o=a.memoizedState!==null||ta,!o){n=n!==null&&n.memoizedState!==null||xt,d=ta;var f=xt;ta=o,(xt=n)&&!f?Ta(e,a,(a.subtreeFlags&8772)!==0):Na(e,a),ta=d,xt=f}break;case 30:break;default:Na(e,a)}}function S0(e){var n=e.alternate;n!==null&&(e.alternate=null,S0(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&fc(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var ut=null,Jt=!1;function na(e,n,a){for(a=a.child;a!==null;)j0(e,n,a),a=a.sibling}function j0(e,n,a){if(F&&typeof F.onCommitFiberUnmount=="function")try{F.onCommitFiberUnmount(q,a)}catch{}switch(a.tag){case 26:xt||Ln(a,n),na(e,n,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:xt||Ln(a,n);var o=ut,d=Jt;Aa(a.type)&&(ut=a.stateNode,Jt=!1),na(e,n,a),ul(a.stateNode),ut=o,Jt=d;break;case 5:xt||Ln(a,n);case 6:if(o=ut,d=Jt,ut=null,na(e,n,a),ut=o,Jt=d,ut!==null)if(Jt)try{(ut.nodeType===9?ut.body:ut.nodeName==="HTML"?ut.ownerDocument.body:ut).removeChild(a.stateNode)}catch(f){lt(a,n,f)}else try{ut.removeChild(a.stateNode)}catch(f){lt(a,n,f)}break;case 18:ut!==null&&(Jt?(e=ut,mm(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,a.stateNode),bl(e)):mm(ut,a.stateNode));break;case 4:o=ut,d=Jt,ut=a.stateNode.containerInfo,Jt=!0,na(e,n,a),ut=o,Jt=d;break;case 0:case 11:case 14:case 15:xt||ka(2,a,n),xt||ka(4,a,n),na(e,n,a);break;case 1:xt||(Ln(a,n),o=a.stateNode,typeof o.componentWillUnmount=="function"&&v0(a,n,o)),na(e,n,a);break;case 21:na(e,n,a);break;case 22:xt=(o=xt)||a.memoizedState!==null,na(e,n,a),xt=o;break;default:na(e,n,a)}}function D0(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{bl(e)}catch(a){lt(n,n.return,a)}}function kv(e){switch(e.tag){case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new N0),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new N0),n;default:throw Error(l(435,e.tag))}}function Id(e,n){var a=kv(e);n.forEach(function(o){var d=Rv.bind(null,e,o);a.has(o)||(a.add(o),o.then(d,d))})}function on(e,n){var a=n.deletions;if(a!==null)for(var o=0;o<a.length;o++){var d=a[o],f=e,y=n,v=y;e:for(;v!==null;){switch(v.tag){case 27:if(Aa(v.type)){ut=v.stateNode,Jt=!1;break e}break;case 5:ut=v.stateNode,Jt=!1;break e;case 3:case 4:ut=v.stateNode.containerInfo,Jt=!0;break e}v=v.return}if(ut===null)throw Error(l(160));j0(f,y,d),ut=null,Jt=!1,f=d.alternate,f!==null&&(f.return=null),d.return=null}if(n.subtreeFlags&13878)for(n=n.child;n!==null;)E0(n,e),n=n.sibling}var Sn=null;function E0(e,n){var a=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:on(n,e),cn(e),o&4&&(ka(3,e,e.return),tl(3,e),ka(5,e,e.return));break;case 1:on(n,e),cn(e),o&512&&(xt||a===null||Ln(a,a.return)),o&64&&ta&&(e=e.updateQueue,e!==null&&(o=e.callbacks,o!==null&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=a===null?o:a.concat(o))));break;case 26:var d=Sn;if(on(n,e),cn(e),o&512&&(xt||a===null||Ln(a,a.return)),o&4){var f=a!==null?a.memoizedState:null;if(o=e.memoizedState,a===null)if(o===null)if(e.stateNode===null){e:{o=e.type,a=e.memoizedProps,d=d.ownerDocument||d;t:switch(o){case"title":f=d.getElementsByTagName("title")[0],(!f||f[Ss]||f[Ft]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=d.createElement(o),d.head.insertBefore(f,d.querySelector("head > title"))),zt(f,o,a),f[Ft]=e,Et(f),o=f;break e;case"link":var y=km("link","href",d).get(o+(a.href||""));if(y){for(var v=0;v<y.length;v++)if(f=y[v],f.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&f.getAttribute("rel")===(a.rel==null?null:a.rel)&&f.getAttribute("title")===(a.title==null?null:a.title)&&f.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){y.splice(v,1);break t}}f=d.createElement(o),zt(f,o,a),d.head.appendChild(f);break;case"meta":if(y=km("meta","content",d).get(o+(a.content||""))){for(v=0;v<y.length;v++)if(f=y[v],f.getAttribute("content")===(a.content==null?null:""+a.content)&&f.getAttribute("name")===(a.name==null?null:a.name)&&f.getAttribute("property")===(a.property==null?null:a.property)&&f.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&f.getAttribute("charset")===(a.charSet==null?null:a.charSet)){y.splice(v,1);break t}}f=d.createElement(o),zt(f,o,a),d.head.appendChild(f);break;default:throw Error(l(468,o))}f[Ft]=e,Et(f),o=f}e.stateNode=o}else Nm(d,e.type,e.stateNode);else e.stateNode=_m(d,o,e.memoizedProps);else f!==o?(f===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):f.count--,o===null?Nm(d,e.type,e.stateNode):_m(d,o,e.memoizedProps)):o===null&&e.stateNode!==null&&Ad(e,e.memoizedProps,a.memoizedProps)}break;case 27:on(n,e),cn(e),o&512&&(xt||a===null||Ln(a,a.return)),a!==null&&o&4&&Ad(e,e.memoizedProps,a.memoizedProps);break;case 5:if(on(n,e),cn(e),o&512&&(xt||a===null||Ln(a,a.return)),e.flags&32){d=e.stateNode;try{Cr(d,"")}catch(V){lt(e,e.return,V)}}o&4&&e.stateNode!=null&&(d=e.memoizedProps,Ad(e,d,a!==null?a.memoizedProps:d)),o&1024&&(Md=!0);break;case 6:if(on(n,e),cn(e),o&4){if(e.stateNode===null)throw Error(l(162));o=e.memoizedProps,a=e.stateNode;try{a.nodeValue=o}catch(V){lt(e,e.return,V)}}break;case 3:if(ro=null,d=Sn,Sn=no(n.containerInfo),on(n,e),Sn=d,cn(e),o&4&&a!==null&&a.memoizedState.isDehydrated)try{bl(n.containerInfo)}catch(V){lt(e,e.return,V)}Md&&(Md=!1,C0(e));break;case 4:o=Sn,Sn=no(e.stateNode.containerInfo),on(n,e),cn(e),Sn=o;break;case 12:on(n,e),cn(e);break;case 13:on(n,e),cn(e),e.child.flags&8192&&e.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(Bd=Dt()),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,Id(e,o)));break;case 22:d=e.memoizedState!==null;var N=a!==null&&a.memoizedState!==null,B=ta,J=xt;if(ta=B||d,xt=J||N,on(n,e),xt=J,ta=B,cn(e),o&8192)e:for(n=e.stateNode,n._visibility=d?n._visibility&-2:n._visibility|1,d&&(a===null||N||ta||xt||or(e)),a=null,n=e;;){if(n.tag===5||n.tag===26){if(a===null){N=a=n;try{if(f=N.stateNode,d)y=f.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{v=N.stateNode;var se=N.memoizedProps.style,G=se!=null&&se.hasOwnProperty("display")?se.display:null;v.style.display=G==null||typeof G=="boolean"?"":(""+G).trim()}}catch(V){lt(N,N.return,V)}}}else if(n.tag===6){if(a===null){N=n;try{N.stateNode.nodeValue=d?"":N.memoizedProps}catch(V){lt(N,N.return,V)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;a===n&&(a=null),n=n.return}a===n&&(a=null),n.sibling.return=n.return,n=n.sibling}o&4&&(o=e.updateQueue,o!==null&&(a=o.retryQueue,a!==null&&(o.retryQueue=null,Id(e,a))));break;case 19:on(n,e),cn(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,Id(e,o)));break;case 30:break;case 21:break;default:on(n,e),cn(e)}}function cn(e){var n=e.flags;if(n&2){try{for(var a,o=e.return;o!==null;){if(_0(o)){a=o;break}o=o.return}if(a==null)throw Error(l(160));switch(a.tag){case 27:var d=a.stateNode,f=Rd(e);Fi(e,f,d);break;case 5:var y=a.stateNode;a.flags&32&&(Cr(y,""),a.flags&=-33);var v=Rd(e);Fi(e,v,y);break;case 3:case 4:var N=a.stateNode.containerInfo,B=Rd(e);Od(e,B,N);break;default:throw Error(l(161))}}catch(J){lt(e,e.return,J)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function C0(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;C0(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function Na(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)T0(e,n.alternate,n),n=n.sibling}function or(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:ka(4,n,n.return),or(n);break;case 1:Ln(n,n.return);var a=n.stateNode;typeof a.componentWillUnmount=="function"&&v0(n,n.return,a),or(n);break;case 27:ul(n.stateNode);case 26:case 5:Ln(n,n.return),or(n);break;case 22:n.memoizedState===null&&or(n);break;case 30:or(n);break;default:or(n)}e=e.sibling}}function Ta(e,n,a){for(a=a&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var o=n.alternate,d=e,f=n,y=f.flags;switch(f.tag){case 0:case 11:case 15:Ta(d,f,a),tl(4,f);break;case 1:if(Ta(d,f,a),o=f,d=o.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(B){lt(o,o.return,B)}if(o=f,d=o.updateQueue,d!==null){var v=o.stateNode;try{var N=d.shared.hiddenCallbacks;if(N!==null)for(d.shared.hiddenCallbacks=null,d=0;d<N.length;d++)sg(N[d],v)}catch(B){lt(o,o.return,B)}}a&&y&64&&b0(f),nl(f,f.return);break;case 27:k0(f);case 26:case 5:Ta(d,f,a),a&&o===null&&y&4&&w0(f),nl(f,f.return);break;case 12:Ta(d,f,a);break;case 13:Ta(d,f,a),a&&y&4&&D0(d,f);break;case 22:f.memoizedState===null&&Ta(d,f,a),nl(f,f.return);break;case 30:break;default:Ta(d,f,a)}n=n.sibling}}function Ld(e,n){var a=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==a&&(e!=null&&e.refCount++,a!=null&&Bs(a))}function Ud(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Bs(e))}function Un(e,n,a,o){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)A0(e,n,a,o),n=n.sibling}function A0(e,n,a,o){var d=n.flags;switch(n.tag){case 0:case 11:case 15:Un(e,n,a,o),d&2048&&tl(9,n);break;case 1:Un(e,n,a,o);break;case 3:Un(e,n,a,o),d&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Bs(e)));break;case 12:if(d&2048){Un(e,n,a,o),e=n.stateNode;try{var f=n.memoizedProps,y=f.id,v=f.onPostCommit;typeof v=="function"&&v(y,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(N){lt(n,n.return,N)}}else Un(e,n,a,o);break;case 13:Un(e,n,a,o);break;case 23:break;case 22:f=n.stateNode,y=n.alternate,n.memoizedState!==null?f._visibility&2?Un(e,n,a,o):al(e,n):f._visibility&2?Un(e,n,a,o):(f._visibility|=2,Qr(e,n,a,o,(n.subtreeFlags&10256)!==0)),d&2048&&Ld(y,n);break;case 24:Un(e,n,a,o),d&2048&&Ud(n.alternate,n);break;default:Un(e,n,a,o)}}function Qr(e,n,a,o,d){for(d=d&&(n.subtreeFlags&10256)!==0,n=n.child;n!==null;){var f=e,y=n,v=a,N=o,B=y.flags;switch(y.tag){case 0:case 11:case 15:Qr(f,y,v,N,d),tl(8,y);break;case 23:break;case 22:var J=y.stateNode;y.memoizedState!==null?J._visibility&2?Qr(f,y,v,N,d):al(f,y):(J._visibility|=2,Qr(f,y,v,N,d)),d&&B&2048&&Ld(y.alternate,y);break;case 24:Qr(f,y,v,N,d),d&&B&2048&&Ud(y.alternate,y);break;default:Qr(f,y,v,N,d)}n=n.sibling}}function al(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var a=e,o=n,d=o.flags;switch(o.tag){case 22:al(a,o),d&2048&&Ld(o.alternate,o);break;case 24:al(a,o),d&2048&&Ud(o.alternate,o);break;default:al(a,o)}n=n.sibling}}var rl=8192;function Xr(e){if(e.subtreeFlags&rl)for(e=e.child;e!==null;)R0(e),e=e.sibling}function R0(e){switch(e.tag){case 26:Xr(e),e.flags&rl&&e.memoizedState!==null&&ow(Sn,e.memoizedState,e.memoizedProps);break;case 5:Xr(e);break;case 3:case 4:var n=Sn;Sn=no(e.stateNode.containerInfo),Xr(e),Sn=n;break;case 22:e.memoizedState===null&&(n=e.alternate,n!==null&&n.memoizedState!==null?(n=rl,rl=16777216,Xr(e),rl=n):Xr(e));break;default:Xr(e)}}function O0(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function sl(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var a=0;a<n.length;a++){var o=n[a];At=o,I0(o,e)}O0(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)M0(e),e=e.sibling}function M0(e){switch(e.tag){case 0:case 11:case 15:sl(e),e.flags&2048&&ka(9,e,e.return);break;case 3:sl(e);break;case 12:sl(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&2&&(e.return===null||e.return.tag!==13)?(n._visibility&=-3,Gi(e)):sl(e);break;default:sl(e)}}function Gi(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var a=0;a<n.length;a++){var o=n[a];At=o,I0(o,e)}O0(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:ka(8,n,n.return),Gi(n);break;case 22:a=n.stateNode,a._visibility&2&&(a._visibility&=-3,Gi(n));break;default:Gi(n)}e=e.sibling}}function I0(e,n){for(;At!==null;){var a=At;switch(a.tag){case 0:case 11:case 15:ka(8,a,n);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var o=a.memoizedState.cachePool.pool;o!=null&&o.refCount++}break;case 24:Bs(a.memoizedState.cache)}if(o=a.child,o!==null)o.return=a,At=o;else e:for(a=e;At!==null;){o=At;var d=o.sibling,f=o.return;if(S0(o),o===a){At=null;break e}if(d!==null){d.return=f,At=d;break e}At=f}}}var Nv={getCacheForType:function(e){var n=Gt(_t),a=n.data.get(e);return a===void 0&&(a=e(),n.data.set(e,a)),a}},Tv=typeof WeakMap=="function"?WeakMap:Map,Ke=0,ot=null,Fe=null,Pe=0,Ze=0,dn=null,Sa=!1,Kr=!1,Hd=!1,aa=0,gt=0,ja=0,cr=0,$d=0,_n=0,Zr=0,ll=null,en=null,zd=!1,Bd=0,Yi=1/0,Pi=null,Da=null,$t=0,Ea=null,Jr=null,es=0,qd=0,Fd=null,L0=null,il=0,Gd=null;function un(){if((Ke&2)!==0&&Pe!==0)return Pe&-Pe;if(X.T!==null){var e=Br;return e!==0?e:Kd()}return Kh()}function U0(){_n===0&&(_n=(Pe&536870912)===0||Qe?fa():536870912);var e=wn.current;return e!==null&&(e.flags|=32),_n}function hn(e,n,a){(e===ot&&(Ze===2||Ze===9)||e.cancelPendingCommit!==null)&&(ts(e,0),Ca(e,Pe,_n,!1)),Ts(e,a),((Ke&2)===0||e!==ot)&&(e===ot&&((Ke&2)===0&&(cr|=a),gt===4&&Ca(e,Pe,_n,!1)),Hn(e))}function H0(e,n,a){if((Ke&6)!==0)throw Error(l(327));var o=!a&&(n&124)===0&&(n&e.expiredLanes)===0||He(e,n),d=o?Dv(e,n):Vd(e,n,!0),f=o;do{if(d===0){Kr&&!o&&Ca(e,n,0,!1);break}else{if(a=e.current.alternate,f&&!Sv(a)){d=Vd(e,n,!1),f=!1;continue}if(d===2){if(f=n,e.errorRecoveryDisabledLanes&f)var y=0;else y=e.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){n=y;e:{var v=e;d=ll;var N=v.current.memoizedState.isDehydrated;if(N&&(ts(v,y).flags|=256),y=Vd(v,y,!1),y!==2){if(Hd&&!N){v.errorRecoveryDisabledLanes|=f,cr|=f,d=4;break e}f=en,en=d,f!==null&&(en===null?en=f:en.push.apply(en,f))}d=y}if(f=!1,d!==2)continue}}if(d===1){ts(e,0),Ca(e,n,0,!0);break}e:{switch(o=e,f=d,f){case 0:case 1:throw Error(l(345));case 4:if((n&4194048)!==n)break;case 6:Ca(o,n,_n,!Sa);break e;case 2:en=null;break;case 3:case 5:break;default:throw Error(l(329))}if((n&62914560)===n&&(d=Bd+300-Dt(),10<d)){if(Ca(o,n,_n,!Sa),ke(o,0,!0)!==0)break e;o.timeoutHandle=fm($0.bind(null,o,a,en,Pi,zd,n,_n,cr,Zr,Sa,f,2,-0,0),d);break e}$0(o,a,en,Pi,zd,n,_n,cr,Zr,Sa,f,0,-0,0)}}break}while(!0);Hn(e)}function $0(e,n,a,o,d,f,y,v,N,B,J,se,G,V){if(e.timeoutHandle=-1,se=n.subtreeFlags,(se&8192||(se&16785408)===16785408)&&(gl={stylesheets:null,count:0,unsuspend:iw},R0(n),se=cw(),se!==null)){e.cancelPendingCommit=se(P0.bind(null,e,n,f,a,o,d,y,v,N,J,1,G,V)),Ca(e,f,y,!B);return}P0(e,n,f,a,o,d,y,v,N)}function Sv(e){for(var n=e;;){var a=n.tag;if((a===0||a===11||a===15)&&n.flags&16384&&(a=n.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var o=0;o<a.length;o++){var d=a[o],f=d.getSnapshot;d=d.value;try{if(!sn(f(),d))return!1}catch{return!1}}if(a=n.child,n.subtreeFlags&16384&&a!==null)a.return=n,n=a;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Ca(e,n,a,o){n&=~$d,n&=~cr,e.suspendedLanes|=n,e.pingedLanes&=~n,o&&(e.warmLanes|=n),o=e.expirationTimes;for(var d=n;0<d;){var f=31-re(d),y=1<<f;o[f]=-1,d&=~y}a!==0&&Qh(e,a,n)}function Vi(){return(Ke&6)===0?(ol(0),!1):!0}function Yd(){if(Fe!==null){if(Ze===0)var e=Fe.return;else e=Fe,Qn=ar=null,od(e),Vr=null,Zs=0,e=Fe;for(;e!==null;)x0(e.alternate,e),e=e.return;Fe=null}}function ts(e,n){var a=e.timeoutHandle;a!==-1&&(e.timeoutHandle=-1,Gv(a)),a=e.cancelPendingCommit,a!==null&&(e.cancelPendingCommit=null,a()),Yd(),ot=e,Fe=a=Pn(e.current,null),Pe=n,Ze=0,dn=null,Sa=!1,Kr=He(e,n),Hd=!1,Zr=_n=$d=cr=ja=gt=0,en=ll=null,zd=!1,(n&8)!==0&&(n|=n&32);var o=e.entangledLanes;if(o!==0)for(e=e.entanglements,o&=n;0<o;){var d=31-re(o),f=1<<d;n|=e[d],o&=~f}return aa=n,mi(),a}function z0(e,n){$e=null,X.H=Mi,n===Fs||n===Ni?(n=ag(),Ze=3):n===eg?(n=ag(),Ze=4):Ze=n===r0?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,dn=n,Fe===null&&(gt=1,$i(e,yn(n,e.current)))}function B0(){var e=X.H;return X.H=Mi,e===null?Mi:e}function q0(){var e=X.A;return X.A=Nv,e}function Pd(){gt=4,Sa||(Pe&4194048)!==Pe&&wn.current!==null||(Kr=!0),(ja&134217727)===0&&(cr&134217727)===0||ot===null||Ca(ot,Pe,_n,!1)}function Vd(e,n,a){var o=Ke;Ke|=2;var d=B0(),f=q0();(ot!==e||Pe!==n)&&(Pi=null,ts(e,n)),n=!1;var y=gt;e:do try{if(Ze!==0&&Fe!==null){var v=Fe,N=dn;switch(Ze){case 8:Yd(),y=6;break e;case 3:case 2:case 9:case 6:wn.current===null&&(n=!0);var B=Ze;if(Ze=0,dn=null,ns(e,v,N,B),a&&Kr){y=0;break e}break;default:B=Ze,Ze=0,dn=null,ns(e,v,N,B)}}jv(),y=gt;break}catch(J){z0(e,J)}while(!0);return n&&e.shellSuspendCounter++,Qn=ar=null,Ke=o,X.H=d,X.A=f,Fe===null&&(ot=null,Pe=0,mi()),y}function jv(){for(;Fe!==null;)F0(Fe)}function Dv(e,n){var a=Ke;Ke|=2;var o=B0(),d=q0();ot!==e||Pe!==n?(Pi=null,Yi=Dt()+500,ts(e,n)):Kr=He(e,n);e:do try{if(Ze!==0&&Fe!==null){n=Fe;var f=dn;t:switch(Ze){case 1:Ze=0,dn=null,ns(e,n,f,1);break;case 2:case 9:if(tg(f)){Ze=0,dn=null,G0(n);break}n=function(){Ze!==2&&Ze!==9||ot!==e||(Ze=7),Hn(e)},f.then(n,n);break e;case 3:Ze=7;break e;case 4:Ze=5;break e;case 7:tg(f)?(Ze=0,dn=null,G0(n)):(Ze=0,dn=null,ns(e,n,f,7));break;case 5:var y=null;switch(Fe.tag){case 26:y=Fe.memoizedState;case 5:case 27:var v=Fe;if(!y||Tm(y)){Ze=0,dn=null;var N=v.sibling;if(N!==null)Fe=N;else{var B=v.return;B!==null?(Fe=B,Wi(B)):Fe=null}break t}}Ze=0,dn=null,ns(e,n,f,5);break;case 6:Ze=0,dn=null,ns(e,n,f,6);break;case 8:Yd(),gt=6;break e;default:throw Error(l(462))}}Ev();break}catch(J){z0(e,J)}while(!0);return Qn=ar=null,X.H=o,X.A=d,Ke=a,Fe!==null?0:(ot=null,Pe=0,mi(),gt)}function Ev(){for(;Fe!==null&&!Xe();)F0(Fe)}function F0(e){var n=p0(e.alternate,e,aa);e.memoizedProps=e.pendingProps,n===null?Wi(e):Fe=n}function G0(e){var n=e,a=n.alternate;switch(n.tag){case 15:case 0:n=d0(a,n,n.pendingProps,n.type,void 0,Pe);break;case 11:n=d0(a,n,n.pendingProps,n.type.render,n.ref,Pe);break;case 5:od(n);default:x0(a,n),n=Fe=Yf(n,aa),n=p0(a,n,aa)}e.memoizedProps=e.pendingProps,n===null?Wi(e):Fe=n}function ns(e,n,a,o){Qn=ar=null,od(n),Vr=null,Zs=0;var d=n.return;try{if(xv(e,d,n,a,Pe)){gt=1,$i(e,yn(a,e.current)),Fe=null;return}}catch(f){if(d!==null)throw Fe=d,f;gt=1,$i(e,yn(a,e.current)),Fe=null;return}n.flags&32768?(Qe||o===1?e=!0:Kr||(Pe&536870912)!==0?e=!1:(Sa=e=!0,(o===2||o===9||o===3||o===6)&&(o=wn.current,o!==null&&o.tag===13&&(o.flags|=16384))),Y0(n,e)):Wi(n)}function Wi(e){var n=e;do{if((n.flags&32768)!==0){Y0(n,Sa);return}e=n.return;var a=vv(n.alternate,n,aa);if(a!==null){Fe=a;return}if(n=n.sibling,n!==null){Fe=n;return}Fe=n=e}while(n!==null);gt===0&&(gt=5)}function Y0(e,n){do{var a=wv(e.alternate,e);if(a!==null){a.flags&=32767,Fe=a;return}if(a=e.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!n&&(e=e.sibling,e!==null)){Fe=e;return}Fe=e=a}while(e!==null);gt=6,Fe=null}function P0(e,n,a,o,d,f,y,v,N){e.cancelPendingCommit=null;do Qi();while($t!==0);if((Ke&6)!==0)throw Error(l(327));if(n!==null){if(n===e.current)throw Error(l(177));if(f=n.lanes|n.childLanes,f|=Uc,ib(e,a,f,y,v,N),e===ot&&(Fe=ot=null,Pe=0),Jr=n,Ea=e,es=a,qd=f,Fd=d,L0=o,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Ov(_r,function(){return K0(),null})):(e.callbackNode=null,e.callbackPriority=0),o=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||o){o=X.T,X.T=null,d=oe.p,oe.p=2,y=Ke,Ke|=4;try{_v(e,n,a)}finally{Ke=y,oe.p=d,X.T=o}}$t=1,V0(),W0(),Q0()}}function V0(){if($t===1){$t=0;var e=Ea,n=Jr,a=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||a){a=X.T,X.T=null;var o=oe.p;oe.p=2;var d=Ke;Ke|=4;try{E0(n,e);var f=su,y=If(e.containerInfo),v=f.focusedElem,N=f.selectionRange;if(y!==v&&v&&v.ownerDocument&&Mf(v.ownerDocument.documentElement,v)){if(N!==null&&Rc(v)){var B=N.start,J=N.end;if(J===void 0&&(J=B),"selectionStart"in v)v.selectionStart=B,v.selectionEnd=Math.min(J,v.value.length);else{var se=v.ownerDocument||document,G=se&&se.defaultView||window;if(G.getSelection){var V=G.getSelection(),Le=v.textContent.length,Re=Math.min(N.start,Le),rt=N.end===void 0?Re:Math.min(N.end,Le);!V.extend&&Re>rt&&(y=rt,rt=Re,Re=y);var H=Of(v,Re),A=Of(v,rt);if(H&&A&&(V.rangeCount!==1||V.anchorNode!==H.node||V.anchorOffset!==H.offset||V.focusNode!==A.node||V.focusOffset!==A.offset)){var z=se.createRange();z.setStart(H.node,H.offset),V.removeAllRanges(),Re>rt?(V.addRange(z),V.extend(A.node,A.offset)):(z.setEnd(A.node,A.offset),V.addRange(z))}}}}for(se=[],V=v;V=V.parentNode;)V.nodeType===1&&se.push({element:V,left:V.scrollLeft,top:V.scrollTop});for(typeof v.focus=="function"&&v.focus(),v=0;v<se.length;v++){var ae=se[v];ae.element.scrollLeft=ae.left,ae.element.scrollTop=ae.top}}io=!!ru,su=ru=null}finally{Ke=d,oe.p=o,X.T=a}}e.current=n,$t=2}}function W0(){if($t===2){$t=0;var e=Ea,n=Jr,a=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||a){a=X.T,X.T=null;var o=oe.p;oe.p=2;var d=Ke;Ke|=4;try{T0(e,n.alternate,n)}finally{Ke=d,oe.p=o,X.T=a}}$t=3}}function Q0(){if($t===4||$t===3){$t=0,Pt();var e=Ea,n=Jr,a=es,o=L0;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?$t=5:($t=0,Jr=Ea=null,X0(e,e.pendingLanes));var d=e.pendingLanes;if(d===0&&(Da=null),uc(a),n=n.stateNode,F&&typeof F.onCommitFiberRoot=="function")try{F.onCommitFiberRoot(q,n,void 0,(n.current.flags&128)===128)}catch{}if(o!==null){n=X.T,d=oe.p,oe.p=2,X.T=null;try{for(var f=e.onRecoverableError,y=0;y<o.length;y++){var v=o[y];f(v.value,{componentStack:v.stack})}}finally{X.T=n,oe.p=d}}(es&3)!==0&&Qi(),Hn(e),d=e.pendingLanes,(a&4194090)!==0&&(d&42)!==0?e===Gd?il++:(il=0,Gd=e):il=0,ol(0)}}function X0(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,Bs(n)))}function Qi(e){return V0(),W0(),Q0(),K0()}function K0(){if($t!==5)return!1;var e=Ea,n=qd;qd=0;var a=uc(es),o=X.T,d=oe.p;try{oe.p=32>a?32:a,X.T=null,a=Fd,Fd=null;var f=Ea,y=es;if($t=0,Jr=Ea=null,es=0,(Ke&6)!==0)throw Error(l(331));var v=Ke;if(Ke|=4,M0(f.current),A0(f,f.current,y,a),Ke=v,ol(0,!1),F&&typeof F.onPostCommitFiberRoot=="function")try{F.onPostCommitFiberRoot(q,f)}catch{}return!0}finally{oe.p=d,X.T=o,X0(e,n)}}function Z0(e,n,a){n=yn(a,n),n=_d(e.stateNode,n,2),e=ba(e,n,2),e!==null&&(Ts(e,2),Hn(e))}function lt(e,n,a){if(e.tag===3)Z0(e,e,a);else for(;n!==null;){if(n.tag===3){Z0(n,e,a);break}else if(n.tag===1){var o=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Da===null||!Da.has(o))){e=yn(a,e),a=n0(2),o=ba(n,a,2),o!==null&&(a0(a,o,n,e),Ts(o,2),Hn(o));break}}n=n.return}}function Wd(e,n,a){var o=e.pingCache;if(o===null){o=e.pingCache=new Tv;var d=new Set;o.set(n,d)}else d=o.get(n),d===void 0&&(d=new Set,o.set(n,d));d.has(a)||(Hd=!0,d.add(a),e=Cv.bind(null,e,n,a),n.then(e,e))}function Cv(e,n,a){var o=e.pingCache;o!==null&&o.delete(n),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,ot===e&&(Pe&a)===a&&(gt===4||gt===3&&(Pe&62914560)===Pe&&300>Dt()-Bd?(Ke&2)===0&&ts(e,0):$d|=a,Zr===Pe&&(Zr=0)),Hn(e)}function J0(e,n){n===0&&(n=Wh()),e=Ur(e,n),e!==null&&(Ts(e,n),Hn(e))}function Av(e){var n=e.memoizedState,a=0;n!==null&&(a=n.retryLane),J0(e,a)}function Rv(e,n){var a=0;switch(e.tag){case 13:var o=e.stateNode,d=e.memoizedState;d!==null&&(a=d.retryLane);break;case 19:o=e.stateNode;break;case 22:o=e.stateNode._retryCache;break;default:throw Error(l(314))}o!==null&&o.delete(n),J0(e,a)}function Ov(e,n){return tt(e,n)}var Xi=null,as=null,Qd=!1,Ki=!1,Xd=!1,dr=0;function Hn(e){e!==as&&e.next===null&&(as===null?Xi=as=e:as=as.next=e),Ki=!0,Qd||(Qd=!0,Iv())}function ol(e,n){if(!Xd&&Ki){Xd=!0;do for(var a=!1,o=Xi;o!==null;){if(e!==0){var d=o.pendingLanes;if(d===0)var f=0;else{var y=o.suspendedLanes,v=o.pingedLanes;f=(1<<31-re(42|e)+1)-1,f&=d&~(y&~v),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(a=!0,am(o,f))}else f=Pe,f=ke(o,o===ot?f:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),(f&3)===0||He(o,f)||(a=!0,am(o,f));o=o.next}while(a);Xd=!1}}function Mv(){em()}function em(){Ki=Qd=!1;var e=0;dr!==0&&(Fv()&&(e=dr),dr=0);for(var n=Dt(),a=null,o=Xi;o!==null;){var d=o.next,f=tm(o,n);f===0?(o.next=null,a===null?Xi=d:a.next=d,d===null&&(as=a)):(a=o,(e!==0||(f&3)!==0)&&(Ki=!0)),o=d}ol(e)}function tm(e,n){for(var a=e.suspendedLanes,o=e.pingedLanes,d=e.expirationTimes,f=e.pendingLanes&-62914561;0<f;){var y=31-re(f),v=1<<y,N=d[y];N===-1?((v&a)===0||(v&o)!==0)&&(d[y]=qt(v,n)):N<=n&&(e.expiredLanes|=v),f&=~v}if(n=ot,a=Pe,a=ke(e,e===n?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o=e.callbackNode,a===0||e===n&&(Ze===2||Ze===9)||e.cancelPendingCommit!==null)return o!==null&&o!==null&&st(o),e.callbackNode=null,e.callbackPriority=0;if((a&3)===0||He(e,a)){if(n=a&-a,n===e.callbackPriority)return n;switch(o!==null&&st(o),uc(a)){case 2:case 8:a=ni;break;case 32:a=_r;break;case 268435456:a=ai;break;default:a=_r}return o=nm.bind(null,e),a=tt(a,o),e.callbackPriority=n,e.callbackNode=a,n}return o!==null&&o!==null&&st(o),e.callbackPriority=2,e.callbackNode=null,2}function nm(e,n){if($t!==0&&$t!==5)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(Qi()&&e.callbackNode!==a)return null;var o=Pe;return o=ke(e,e===ot?o:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o===0?null:(H0(e,o,n),tm(e,Dt()),e.callbackNode!=null&&e.callbackNode===a?nm.bind(null,e):null)}function am(e,n){if(Qi())return null;H0(e,n,!0)}function Iv(){Yv(function(){(Ke&6)!==0?tt(ti,Mv):em()})}function Kd(){return dr===0&&(dr=fa()),dr}function rm(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:oi(""+e)}function sm(e,n){var a=n.ownerDocument.createElement("input");return a.name=n.name,a.value=n.value,e.id&&a.setAttribute("form",e.id),n.parentNode.insertBefore(a,n),e=new FormData(e),a.parentNode.removeChild(a),e}function Lv(e,n,a,o,d){if(n==="submit"&&a&&a.stateNode===d){var f=rm((d[Xt]||null).action),y=o.submitter;y&&(n=(n=y[Xt]||null)?rm(n.formAction):y.getAttribute("formAction"),n!==null&&(f=n,y=null));var v=new hi("action","action",null,o,d);e.push({event:v,listeners:[{instance:null,listener:function(){if(o.defaultPrevented){if(dr!==0){var N=y?sm(d,y):new FormData(d);yd(a,{pending:!0,data:N,method:d.method,action:f},null,N)}}else typeof f=="function"&&(v.preventDefault(),N=y?sm(d,y):new FormData(d),yd(a,{pending:!0,data:N,method:d.method,action:f},f,N))},currentTarget:d}]})}}for(var Zd=0;Zd<Lc.length;Zd++){var Jd=Lc[Zd],Uv=Jd.toLowerCase(),Hv=Jd[0].toUpperCase()+Jd.slice(1);Tn(Uv,"on"+Hv)}Tn(Hf,"onAnimationEnd"),Tn($f,"onAnimationIteration"),Tn(zf,"onAnimationStart"),Tn("dblclick","onDoubleClick"),Tn("focusin","onFocus"),Tn("focusout","onBlur"),Tn(tv,"onTransitionRun"),Tn(nv,"onTransitionStart"),Tn(av,"onTransitionCancel"),Tn(Bf,"onTransitionEnd"),jr("onMouseEnter",["mouseout","mouseover"]),jr("onMouseLeave",["mouseout","mouseover"]),jr("onPointerEnter",["pointerout","pointerover"]),jr("onPointerLeave",["pointerout","pointerover"]),Wa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Wa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Wa("onBeforeInput",["compositionend","keypress","textInput","paste"]),Wa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Wa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Wa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$v=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(cl));function lm(e,n){n=(n&4)!==0;for(var a=0;a<e.length;a++){var o=e[a],d=o.event;o=o.listeners;e:{var f=void 0;if(n)for(var y=o.length-1;0<=y;y--){var v=o[y],N=v.instance,B=v.currentTarget;if(v=v.listener,N!==f&&d.isPropagationStopped())break e;f=v,d.currentTarget=B;try{f(d)}catch(J){Hi(J)}d.currentTarget=null,f=N}else for(y=0;y<o.length;y++){if(v=o[y],N=v.instance,B=v.currentTarget,v=v.listener,N!==f&&d.isPropagationStopped())break e;f=v,d.currentTarget=B;try{f(d)}catch(J){Hi(J)}d.currentTarget=null,f=N}}}}function Ge(e,n){var a=n[hc];a===void 0&&(a=n[hc]=new Set);var o=e+"__bubble";a.has(o)||(im(n,e,2,!1),a.add(o))}function eu(e,n,a){var o=0;n&&(o|=4),im(a,e,o,n)}var Zi="_reactListening"+Math.random().toString(36).slice(2);function tu(e){if(!e[Zi]){e[Zi]=!0,Jh.forEach(function(a){a!=="selectionchange"&&($v.has(a)||eu(a,!1,e),eu(a,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[Zi]||(n[Zi]=!0,eu("selectionchange",!1,n))}}function im(e,n,a,o){switch(Am(n)){case 2:var d=hw;break;case 8:d=fw;break;default:d=mu}a=d.bind(null,n,a,e),d=void 0,!kc||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(d=!0),o?d!==void 0?e.addEventListener(n,a,{capture:!0,passive:d}):e.addEventListener(n,a,!0):d!==void 0?e.addEventListener(n,a,{passive:d}):e.addEventListener(n,a,!1)}function nu(e,n,a,o,d){var f=o;if((n&1)===0&&(n&2)===0&&o!==null)e:for(;;){if(o===null)return;var y=o.tag;if(y===3||y===4){var v=o.stateNode.containerInfo;if(v===d)break;if(y===4)for(y=o.return;y!==null;){var N=y.tag;if((N===3||N===4)&&y.stateNode.containerInfo===d)return;y=y.return}for(;v!==null;){if(y=Nr(v),y===null)return;if(N=y.tag,N===5||N===6||N===26||N===27){o=f=y;continue e}v=v.parentNode}}o=o.return}gf(function(){var B=f,J=wc(a),se=[];e:{var G=qf.get(e);if(G!==void 0){var V=hi,Le=e;switch(e){case"keypress":if(di(a)===0)break e;case"keydown":case"keyup":V=Ob;break;case"focusin":Le="focus",V=jc;break;case"focusout":Le="blur",V=jc;break;case"beforeblur":case"afterblur":V=jc;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":V=yf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":V=wb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":V=Lb;break;case Hf:case $f:case zf:V=Nb;break;case Bf:V=Hb;break;case"scroll":case"scrollend":V=bb;break;case"wheel":V=zb;break;case"copy":case"cut":case"paste":V=Sb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":V=bf;break;case"toggle":case"beforetoggle":V=qb}var Re=(n&4)!==0,rt=!Re&&(e==="scroll"||e==="scrollend"),H=Re?G!==null?G+"Capture":null:G;Re=[];for(var A=B,z;A!==null;){var ae=A;if(z=ae.stateNode,ae=ae.tag,ae!==5&&ae!==26&&ae!==27||z===null||H===null||(ae=Ds(A,H),ae!=null&&Re.push(dl(A,ae,z))),rt)break;A=A.return}0<Re.length&&(G=new V(G,Le,null,a,J),se.push({event:G,listeners:Re}))}}if((n&7)===0){e:{if(G=e==="mouseover"||e==="pointerover",V=e==="mouseout"||e==="pointerout",G&&a!==vc&&(Le=a.relatedTarget||a.fromElement)&&(Nr(Le)||Le[kr]))break e;if((V||G)&&(G=J.window===J?J:(G=J.ownerDocument)?G.defaultView||G.parentWindow:window,V?(Le=a.relatedTarget||a.toElement,V=B,Le=Le?Nr(Le):null,Le!==null&&(rt=u(Le),Re=Le.tag,Le!==rt||Re!==5&&Re!==27&&Re!==6)&&(Le=null)):(V=null,Le=B),V!==Le)){if(Re=yf,ae="onMouseLeave",H="onMouseEnter",A="mouse",(e==="pointerout"||e==="pointerover")&&(Re=bf,ae="onPointerLeave",H="onPointerEnter",A="pointer"),rt=V==null?G:js(V),z=Le==null?G:js(Le),G=new Re(ae,A+"leave",V,a,J),G.target=rt,G.relatedTarget=z,ae=null,Nr(J)===B&&(Re=new Re(H,A+"enter",Le,a,J),Re.target=z,Re.relatedTarget=rt,ae=Re),rt=ae,V&&Le)t:{for(Re=V,H=Le,A=0,z=Re;z;z=rs(z))A++;for(z=0,ae=H;ae;ae=rs(ae))z++;for(;0<A-z;)Re=rs(Re),A--;for(;0<z-A;)H=rs(H),z--;for(;A--;){if(Re===H||H!==null&&Re===H.alternate)break t;Re=rs(Re),H=rs(H)}Re=null}else Re=null;V!==null&&om(se,G,V,Re,!1),Le!==null&&rt!==null&&om(se,rt,Le,Re,!0)}}e:{if(G=B?js(B):window,V=G.nodeName&&G.nodeName.toLowerCase(),V==="select"||V==="input"&&G.type==="file")var we=jf;else if(Tf(G))if(Df)we=Zb;else{we=Xb;var ze=Qb}else V=G.nodeName,!V||V.toLowerCase()!=="input"||G.type!=="checkbox"&&G.type!=="radio"?B&&bc(B.elementType)&&(we=jf):we=Kb;if(we&&(we=we(e,B))){Sf(se,we,a,J);break e}ze&&ze(e,G,B),e==="focusout"&&B&&G.type==="number"&&B.memoizedProps.value!=null&&xc(G,"number",G.value)}switch(ze=B?js(B):window,e){case"focusin":(Tf(ze)||ze.contentEditable==="true")&&(Mr=ze,Oc=B,Ls=null);break;case"focusout":Ls=Oc=Mr=null;break;case"mousedown":Mc=!0;break;case"contextmenu":case"mouseup":case"dragend":Mc=!1,Lf(se,a,J);break;case"selectionchange":if(ev)break;case"keydown":case"keyup":Lf(se,a,J)}var je;if(Ec)e:{switch(e){case"compositionstart":var Me="onCompositionStart";break e;case"compositionend":Me="onCompositionEnd";break e;case"compositionupdate":Me="onCompositionUpdate";break e}Me=void 0}else Or?kf(e,a)&&(Me="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(Me="onCompositionStart");Me&&(vf&&a.locale!=="ko"&&(Or||Me!=="onCompositionStart"?Me==="onCompositionEnd"&&Or&&(je=mf()):(ma=J,Nc="value"in ma?ma.value:ma.textContent,Or=!0)),ze=Ji(B,Me),0<ze.length&&(Me=new xf(Me,e,null,a,J),se.push({event:Me,listeners:ze}),je?Me.data=je:(je=Nf(a),je!==null&&(Me.data=je)))),(je=Gb?Yb(e,a):Pb(e,a))&&(Me=Ji(B,"onBeforeInput"),0<Me.length&&(ze=new xf("onBeforeInput","beforeinput",null,a,J),se.push({event:ze,listeners:Me}),ze.data=je)),Lv(se,e,B,a,J)}lm(se,n)})}function dl(e,n,a){return{instance:e,listener:n,currentTarget:a}}function Ji(e,n){for(var a=n+"Capture",o=[];e!==null;){var d=e,f=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||f===null||(d=Ds(e,a),d!=null&&o.unshift(dl(e,d,f)),d=Ds(e,n),d!=null&&o.push(dl(e,d,f))),e.tag===3)return o;e=e.return}return[]}function rs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function om(e,n,a,o,d){for(var f=n._reactName,y=[];a!==null&&a!==o;){var v=a,N=v.alternate,B=v.stateNode;if(v=v.tag,N!==null&&N===o)break;v!==5&&v!==26&&v!==27||B===null||(N=B,d?(B=Ds(a,f),B!=null&&y.unshift(dl(a,B,N))):d||(B=Ds(a,f),B!=null&&y.push(dl(a,B,N)))),a=a.return}y.length!==0&&e.push({event:n,listeners:y})}var zv=/\r\n?/g,Bv=/\u0000|\uFFFD/g;function cm(e){return(typeof e=="string"?e:""+e).replace(zv,`
`).replace(Bv,"")}function dm(e,n){return n=cm(n),cm(e)===n}function eo(){}function at(e,n,a,o,d,f){switch(a){case"children":typeof o=="string"?n==="body"||n==="textarea"&&o===""||Cr(e,o):(typeof o=="number"||typeof o=="bigint")&&n!=="body"&&Cr(e,""+o);break;case"className":si(e,"class",o);break;case"tabIndex":si(e,"tabindex",o);break;case"dir":case"role":case"viewBox":case"width":case"height":si(e,a,o);break;case"style":hf(e,o,f);break;case"data":if(n!=="object"){si(e,"data",o);break}case"src":case"href":if(o===""&&(n!=="a"||a!=="href")){e.removeAttribute(a);break}if(o==null||typeof o=="function"||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(a);break}o=oi(""+o),e.setAttribute(a,o);break;case"action":case"formAction":if(typeof o=="function"){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(a==="formAction"?(n!=="input"&&at(e,n,"name",d.name,d,null),at(e,n,"formEncType",d.formEncType,d,null),at(e,n,"formMethod",d.formMethod,d,null),at(e,n,"formTarget",d.formTarget,d,null)):(at(e,n,"encType",d.encType,d,null),at(e,n,"method",d.method,d,null),at(e,n,"target",d.target,d,null)));if(o==null||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(a);break}o=oi(""+o),e.setAttribute(a,o);break;case"onClick":o!=null&&(e.onclick=eo);break;case"onScroll":o!=null&&Ge("scroll",e);break;case"onScrollEnd":o!=null&&Ge("scrollend",e);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(l(61));if(a=o.__html,a!=null){if(d.children!=null)throw Error(l(60));e.innerHTML=a}}break;case"multiple":e.multiple=o&&typeof o!="function"&&typeof o!="symbol";break;case"muted":e.muted=o&&typeof o!="function"&&typeof o!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(o==null||typeof o=="function"||typeof o=="boolean"||typeof o=="symbol"){e.removeAttribute("xlink:href");break}a=oi(""+o),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,""+o):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":o&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":o===!0?e.setAttribute(a,""):o!==!1&&o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,o):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":o!=null&&typeof o!="function"&&typeof o!="symbol"&&!isNaN(o)&&1<=o?e.setAttribute(a,o):e.removeAttribute(a);break;case"rowSpan":case"start":o==null||typeof o=="function"||typeof o=="symbol"||isNaN(o)?e.removeAttribute(a):e.setAttribute(a,o);break;case"popover":Ge("beforetoggle",e),Ge("toggle",e),ri(e,"popover",o);break;case"xlinkActuate":Gn(e,"http://www.w3.org/1999/xlink","xlink:actuate",o);break;case"xlinkArcrole":Gn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",o);break;case"xlinkRole":Gn(e,"http://www.w3.org/1999/xlink","xlink:role",o);break;case"xlinkShow":Gn(e,"http://www.w3.org/1999/xlink","xlink:show",o);break;case"xlinkTitle":Gn(e,"http://www.w3.org/1999/xlink","xlink:title",o);break;case"xlinkType":Gn(e,"http://www.w3.org/1999/xlink","xlink:type",o);break;case"xmlBase":Gn(e,"http://www.w3.org/XML/1998/namespace","xml:base",o);break;case"xmlLang":Gn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",o);break;case"xmlSpace":Gn(e,"http://www.w3.org/XML/1998/namespace","xml:space",o);break;case"is":ri(e,"is",o);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=yb.get(a)||a,ri(e,a,o))}}function au(e,n,a,o,d,f){switch(a){case"style":hf(e,o,f);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(l(61));if(a=o.__html,a!=null){if(d.children!=null)throw Error(l(60));e.innerHTML=a}}break;case"children":typeof o=="string"?Cr(e,o):(typeof o=="number"||typeof o=="bigint")&&Cr(e,""+o);break;case"onScroll":o!=null&&Ge("scroll",e);break;case"onScrollEnd":o!=null&&Ge("scrollend",e);break;case"onClick":o!=null&&(e.onclick=eo);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ef.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(d=a.endsWith("Capture"),n=a.slice(2,d?a.length-7:void 0),f=e[Xt]||null,f=f!=null?f[a]:null,typeof f=="function"&&e.removeEventListener(n,f,d),typeof o=="function")){typeof f!="function"&&f!==null&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(n,o,d);break e}a in e?e[a]=o:o===!0?e.setAttribute(a,""):ri(e,a,o)}}}function zt(e,n,a){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ge("error",e),Ge("load",e);var o=!1,d=!1,f;for(f in a)if(a.hasOwnProperty(f)){var y=a[f];if(y!=null)switch(f){case"src":o=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,n));default:at(e,n,f,y,a,null)}}d&&at(e,n,"srcSet",a.srcSet,a,null),o&&at(e,n,"src",a.src,a,null);return;case"input":Ge("invalid",e);var v=f=y=d=null,N=null,B=null;for(o in a)if(a.hasOwnProperty(o)){var J=a[o];if(J!=null)switch(o){case"name":d=J;break;case"type":y=J;break;case"checked":N=J;break;case"defaultChecked":B=J;break;case"value":f=J;break;case"defaultValue":v=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(l(137,n));break;default:at(e,n,o,J,a,null)}}of(e,f,v,N,B,y,d,!1),li(e);return;case"select":Ge("invalid",e),o=y=f=null;for(d in a)if(a.hasOwnProperty(d)&&(v=a[d],v!=null))switch(d){case"value":f=v;break;case"defaultValue":y=v;break;case"multiple":o=v;default:at(e,n,d,v,a,null)}n=f,a=y,e.multiple=!!o,n!=null?Er(e,!!o,n,!1):a!=null&&Er(e,!!o,a,!0);return;case"textarea":Ge("invalid",e),f=d=o=null;for(y in a)if(a.hasOwnProperty(y)&&(v=a[y],v!=null))switch(y){case"value":o=v;break;case"defaultValue":d=v;break;case"children":f=v;break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(l(91));break;default:at(e,n,y,v,a,null)}df(e,o,d,f),li(e);return;case"option":for(N in a)if(a.hasOwnProperty(N)&&(o=a[N],o!=null))switch(N){case"selected":e.selected=o&&typeof o!="function"&&typeof o!="symbol";break;default:at(e,n,N,o,a,null)}return;case"dialog":Ge("beforetoggle",e),Ge("toggle",e),Ge("cancel",e),Ge("close",e);break;case"iframe":case"object":Ge("load",e);break;case"video":case"audio":for(o=0;o<cl.length;o++)Ge(cl[o],e);break;case"image":Ge("error",e),Ge("load",e);break;case"details":Ge("toggle",e);break;case"embed":case"source":case"link":Ge("error",e),Ge("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(B in a)if(a.hasOwnProperty(B)&&(o=a[B],o!=null))switch(B){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,n));default:at(e,n,B,o,a,null)}return;default:if(bc(n)){for(J in a)a.hasOwnProperty(J)&&(o=a[J],o!==void 0&&au(e,n,J,o,a,void 0));return}}for(v in a)a.hasOwnProperty(v)&&(o=a[v],o!=null&&at(e,n,v,o,a,null))}function qv(e,n,a,o){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,f=null,y=null,v=null,N=null,B=null,J=null;for(V in a){var se=a[V];if(a.hasOwnProperty(V)&&se!=null)switch(V){case"checked":break;case"value":break;case"defaultValue":N=se;default:o.hasOwnProperty(V)||at(e,n,V,null,o,se)}}for(var G in o){var V=o[G];if(se=a[G],o.hasOwnProperty(G)&&(V!=null||se!=null))switch(G){case"type":f=V;break;case"name":d=V;break;case"checked":B=V;break;case"defaultChecked":J=V;break;case"value":y=V;break;case"defaultValue":v=V;break;case"children":case"dangerouslySetInnerHTML":if(V!=null)throw Error(l(137,n));break;default:V!==se&&at(e,n,G,V,o,se)}}yc(e,y,v,N,B,J,f,d);return;case"select":V=y=v=G=null;for(f in a)if(N=a[f],a.hasOwnProperty(f)&&N!=null)switch(f){case"value":break;case"multiple":V=N;default:o.hasOwnProperty(f)||at(e,n,f,null,o,N)}for(d in o)if(f=o[d],N=a[d],o.hasOwnProperty(d)&&(f!=null||N!=null))switch(d){case"value":G=f;break;case"defaultValue":v=f;break;case"multiple":y=f;default:f!==N&&at(e,n,d,f,o,N)}n=v,a=y,o=V,G!=null?Er(e,!!a,G,!1):!!o!=!!a&&(n!=null?Er(e,!!a,n,!0):Er(e,!!a,a?[]:"",!1));return;case"textarea":V=G=null;for(v in a)if(d=a[v],a.hasOwnProperty(v)&&d!=null&&!o.hasOwnProperty(v))switch(v){case"value":break;case"children":break;default:at(e,n,v,null,o,d)}for(y in o)if(d=o[y],f=a[y],o.hasOwnProperty(y)&&(d!=null||f!=null))switch(y){case"value":G=d;break;case"defaultValue":V=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(l(91));break;default:d!==f&&at(e,n,y,d,o,f)}cf(e,G,V);return;case"option":for(var Le in a)if(G=a[Le],a.hasOwnProperty(Le)&&G!=null&&!o.hasOwnProperty(Le))switch(Le){case"selected":e.selected=!1;break;default:at(e,n,Le,null,o,G)}for(N in o)if(G=o[N],V=a[N],o.hasOwnProperty(N)&&G!==V&&(G!=null||V!=null))switch(N){case"selected":e.selected=G&&typeof G!="function"&&typeof G!="symbol";break;default:at(e,n,N,G,o,V)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Re in a)G=a[Re],a.hasOwnProperty(Re)&&G!=null&&!o.hasOwnProperty(Re)&&at(e,n,Re,null,o,G);for(B in o)if(G=o[B],V=a[B],o.hasOwnProperty(B)&&G!==V&&(G!=null||V!=null))switch(B){case"children":case"dangerouslySetInnerHTML":if(G!=null)throw Error(l(137,n));break;default:at(e,n,B,G,o,V)}return;default:if(bc(n)){for(var rt in a)G=a[rt],a.hasOwnProperty(rt)&&G!==void 0&&!o.hasOwnProperty(rt)&&au(e,n,rt,void 0,o,G);for(J in o)G=o[J],V=a[J],!o.hasOwnProperty(J)||G===V||G===void 0&&V===void 0||au(e,n,J,G,o,V);return}}for(var H in a)G=a[H],a.hasOwnProperty(H)&&G!=null&&!o.hasOwnProperty(H)&&at(e,n,H,null,o,G);for(se in o)G=o[se],V=a[se],!o.hasOwnProperty(se)||G===V||G==null&&V==null||at(e,n,se,G,o,V)}var ru=null,su=null;function to(e){return e.nodeType===9?e:e.ownerDocument}function um(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function hm(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function lu(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var iu=null;function Fv(){var e=window.event;return e&&e.type==="popstate"?e===iu?!1:(iu=e,!0):(iu=null,!1)}var fm=typeof setTimeout=="function"?setTimeout:void 0,Gv=typeof clearTimeout=="function"?clearTimeout:void 0,gm=typeof Promise=="function"?Promise:void 0,Yv=typeof queueMicrotask=="function"?queueMicrotask:typeof gm<"u"?function(e){return gm.resolve(null).then(e).catch(Pv)}:fm;function Pv(e){setTimeout(function(){throw e})}function Aa(e){return e==="head"}function mm(e,n){var a=n,o=0,d=0;do{var f=a.nextSibling;if(e.removeChild(a),f&&f.nodeType===8)if(a=f.data,a==="/$"){if(0<o&&8>o){a=o;var y=e.ownerDocument;if(a&1&&ul(y.documentElement),a&2&&ul(y.body),a&4)for(a=y.head,ul(a),y=a.firstChild;y;){var v=y.nextSibling,N=y.nodeName;y[Ss]||N==="SCRIPT"||N==="STYLE"||N==="LINK"&&y.rel.toLowerCase()==="stylesheet"||a.removeChild(y),y=v}}if(d===0){e.removeChild(f),bl(n);return}d--}else a==="$"||a==="$?"||a==="$!"?d++:o=a.charCodeAt(0)-48;else o=0;a=f}while(a);bl(n)}function ou(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var a=n;switch(n=n.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":ou(a),fc(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}e.removeChild(a)}}function Vv(e,n,a,o){for(;e.nodeType===1;){var d=a;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!o&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(o){if(!e[Ss])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(f=e.getAttribute("rel"),f==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(f!==d.rel||e.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||e.getAttribute("title")!==(d.title==null?null:d.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(f=e.getAttribute("src"),(f!==(d.src==null?null:d.src)||e.getAttribute("type")!==(d.type==null?null:d.type)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&f&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var f=d.name==null?null:""+d.name;if(d.type==="hidden"&&e.getAttribute("name")===f)return e}else return e;if(e=jn(e.nextSibling),e===null)break}return null}function Wv(e,n,a){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=jn(e.nextSibling),e===null))return null;return e}function cu(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function Qv(e,n){var a=e.ownerDocument;if(e.data!=="$?"||a.readyState==="complete")n();else{var o=function(){n(),a.removeEventListener("DOMContentLoaded",o)};a.addEventListener("DOMContentLoaded",o),e._reactRetry=o}}function jn(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="F!"||n==="F")break;if(n==="/$")return null}}return e}var du=null;function pm(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"){if(n===0)return e;n--}else a==="/$"&&n++}e=e.previousSibling}return null}function ym(e,n,a){switch(n=to(a),e){case"html":if(e=n.documentElement,!e)throw Error(l(452));return e;case"head":if(e=n.head,!e)throw Error(l(453));return e;case"body":if(e=n.body,!e)throw Error(l(454));return e;default:throw Error(l(451))}}function ul(e){for(var n=e.attributes;n.length;)e.removeAttributeNode(n[0]);fc(e)}var kn=new Map,xm=new Set;function no(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ra=oe.d;oe.d={f:Xv,r:Kv,D:Zv,C:Jv,L:ew,m:tw,X:aw,S:nw,M:rw};function Xv(){var e=ra.f(),n=Vi();return e||n}function Kv(e){var n=Tr(e);n!==null&&n.tag===5&&n.type==="form"?Hg(n):ra.r(e)}var ss=typeof document>"u"?null:document;function bm(e,n,a){var o=ss;if(o&&typeof n=="string"&&n){var d=pn(n);d='link[rel="'+e+'"][href="'+d+'"]',typeof a=="string"&&(d+='[crossorigin="'+a+'"]'),xm.has(d)||(xm.add(d),e={rel:e,crossOrigin:a,href:n},o.querySelector(d)===null&&(n=o.createElement("link"),zt(n,"link",e),Et(n),o.head.appendChild(n)))}}function Zv(e){ra.D(e),bm("dns-prefetch",e,null)}function Jv(e,n){ra.C(e,n),bm("preconnect",e,n)}function ew(e,n,a){ra.L(e,n,a);var o=ss;if(o&&e&&n){var d='link[rel="preload"][as="'+pn(n)+'"]';n==="image"&&a&&a.imageSrcSet?(d+='[imagesrcset="'+pn(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(d+='[imagesizes="'+pn(a.imageSizes)+'"]')):d+='[href="'+pn(e)+'"]';var f=d;switch(n){case"style":f=ls(e);break;case"script":f=is(e)}kn.has(f)||(e=x({rel:"preload",href:n==="image"&&a&&a.imageSrcSet?void 0:e,as:n},a),kn.set(f,e),o.querySelector(d)!==null||n==="style"&&o.querySelector(hl(f))||n==="script"&&o.querySelector(fl(f))||(n=o.createElement("link"),zt(n,"link",e),Et(n),o.head.appendChild(n)))}}function tw(e,n){ra.m(e,n);var a=ss;if(a&&e){var o=n&&typeof n.as=="string"?n.as:"script",d='link[rel="modulepreload"][as="'+pn(o)+'"][href="'+pn(e)+'"]',f=d;switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=is(e)}if(!kn.has(f)&&(e=x({rel:"modulepreload",href:e},n),kn.set(f,e),a.querySelector(d)===null)){switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(fl(f)))return}o=a.createElement("link"),zt(o,"link",e),Et(o),a.head.appendChild(o)}}}function nw(e,n,a){ra.S(e,n,a);var o=ss;if(o&&e){var d=Sr(o).hoistableStyles,f=ls(e);n=n||"default";var y=d.get(f);if(!y){var v={loading:0,preload:null};if(y=o.querySelector(hl(f)))v.loading=5;else{e=x({rel:"stylesheet",href:e,"data-precedence":n},a),(a=kn.get(f))&&uu(e,a);var N=y=o.createElement("link");Et(N),zt(N,"link",e),N._p=new Promise(function(B,J){N.onload=B,N.onerror=J}),N.addEventListener("load",function(){v.loading|=1}),N.addEventListener("error",function(){v.loading|=2}),v.loading|=4,ao(y,n,o)}y={type:"stylesheet",instance:y,count:1,state:v},d.set(f,y)}}}function aw(e,n){ra.X(e,n);var a=ss;if(a&&e){var o=Sr(a).hoistableScripts,d=is(e),f=o.get(d);f||(f=a.querySelector(fl(d)),f||(e=x({src:e,async:!0},n),(n=kn.get(d))&&hu(e,n),f=a.createElement("script"),Et(f),zt(f,"link",e),a.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},o.set(d,f))}}function rw(e,n){ra.M(e,n);var a=ss;if(a&&e){var o=Sr(a).hoistableScripts,d=is(e),f=o.get(d);f||(f=a.querySelector(fl(d)),f||(e=x({src:e,async:!0,type:"module"},n),(n=kn.get(d))&&hu(e,n),f=a.createElement("script"),Et(f),zt(f,"link",e),a.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},o.set(d,f))}}function vm(e,n,a,o){var d=(d=de.current)?no(d):null;if(!d)throw Error(l(446));switch(e){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(n=ls(a.href),a=Sr(d).hoistableStyles,o=a.get(n),o||(o={type:"style",instance:null,count:0,state:null},a.set(n,o)),o):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){e=ls(a.href);var f=Sr(d).hoistableStyles,y=f.get(e);if(y||(d=d.ownerDocument||d,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(e,y),(f=d.querySelector(hl(e)))&&!f._p&&(y.instance=f,y.state.loading=5),kn.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},kn.set(e,a),f||sw(d,e,a,y.state))),n&&o===null)throw Error(l(528,""));return y}if(n&&o!==null)throw Error(l(529,""));return null;case"script":return n=a.async,a=a.src,typeof a=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=is(a),a=Sr(d).hoistableScripts,o=a.get(n),o||(o={type:"script",instance:null,count:0,state:null},a.set(n,o)),o):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,e))}}function ls(e){return'href="'+pn(e)+'"'}function hl(e){return'link[rel="stylesheet"]['+e+"]"}function wm(e){return x({},e,{"data-precedence":e.precedence,precedence:null})}function sw(e,n,a,o){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?o.loading=1:(n=e.createElement("link"),o.preload=n,n.addEventListener("load",function(){return o.loading|=1}),n.addEventListener("error",function(){return o.loading|=2}),zt(n,"link",a),Et(n),e.head.appendChild(n))}function is(e){return'[src="'+pn(e)+'"]'}function fl(e){return"script[async]"+e}function _m(e,n,a){if(n.count++,n.instance===null)switch(n.type){case"style":var o=e.querySelector('style[data-href~="'+pn(a.href)+'"]');if(o)return n.instance=o,Et(o),o;var d=x({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return o=(e.ownerDocument||e).createElement("style"),Et(o),zt(o,"style",d),ao(o,a.precedence,e),n.instance=o;case"stylesheet":d=ls(a.href);var f=e.querySelector(hl(d));if(f)return n.state.loading|=4,n.instance=f,Et(f),f;o=wm(a),(d=kn.get(d))&&uu(o,d),f=(e.ownerDocument||e).createElement("link"),Et(f);var y=f;return y._p=new Promise(function(v,N){y.onload=v,y.onerror=N}),zt(f,"link",o),n.state.loading|=4,ao(f,a.precedence,e),n.instance=f;case"script":return f=is(a.src),(d=e.querySelector(fl(f)))?(n.instance=d,Et(d),d):(o=a,(d=kn.get(f))&&(o=x({},a),hu(o,d)),e=e.ownerDocument||e,d=e.createElement("script"),Et(d),zt(d,"link",o),e.head.appendChild(d),n.instance=d);case"void":return null;default:throw Error(l(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(o=n.instance,n.state.loading|=4,ao(o,a.precedence,e));return n.instance}function ao(e,n,a){for(var o=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=o.length?o[o.length-1]:null,f=d,y=0;y<o.length;y++){var v=o[y];if(v.dataset.precedence===n)f=v;else if(f!==d)break}f?f.parentNode.insertBefore(e,f.nextSibling):(n=a.nodeType===9?a.head:a,n.insertBefore(e,n.firstChild))}function uu(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function hu(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var ro=null;function km(e,n,a){if(ro===null){var o=new Map,d=ro=new Map;d.set(a,o)}else d=ro,o=d.get(a),o||(o=new Map,d.set(a,o));if(o.has(e))return o;for(o.set(e,null),a=a.getElementsByTagName(e),d=0;d<a.length;d++){var f=a[d];if(!(f[Ss]||f[Ft]||e==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var y=f.getAttribute(n)||"";y=e+y;var v=o.get(y);v?v.push(f):o.set(y,[f])}}return o}function Nm(e,n,a){e=e.ownerDocument||e,e.head.insertBefore(a,n==="title"?e.querySelector("head > title"):null)}function lw(e,n,a){if(a===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return e=n.disabled,typeof n.precedence=="string"&&e==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function Tm(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}var gl=null;function iw(){}function ow(e,n,a){if(gl===null)throw Error(l(475));var o=gl;if(n.type==="stylesheet"&&(typeof a.media!="string"||matchMedia(a.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var d=ls(a.href),f=e.querySelector(hl(d));if(f){e=f._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(o.count++,o=so.bind(o),e.then(o,o)),n.state.loading|=4,n.instance=f,Et(f);return}f=e.ownerDocument||e,a=wm(a),(d=kn.get(d))&&uu(a,d),f=f.createElement("link"),Et(f);var y=f;y._p=new Promise(function(v,N){y.onload=v,y.onerror=N}),zt(f,"link",a),n.instance=f}o.stylesheets===null&&(o.stylesheets=new Map),o.stylesheets.set(n,e),(e=n.state.preload)&&(n.state.loading&3)===0&&(o.count++,n=so.bind(o),e.addEventListener("load",n),e.addEventListener("error",n))}}function cw(){if(gl===null)throw Error(l(475));var e=gl;return e.stylesheets&&e.count===0&&fu(e,e.stylesheets),0<e.count?function(n){var a=setTimeout(function(){if(e.stylesheets&&fu(e,e.stylesheets),e.unsuspend){var o=e.unsuspend;e.unsuspend=null,o()}},6e4);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(a)}}:null}function so(){if(this.count--,this.count===0){if(this.stylesheets)fu(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var lo=null;function fu(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,lo=new Map,n.forEach(dw,e),lo=null,so.call(e))}function dw(e,n){if(!(n.state.loading&4)){var a=lo.get(e);if(a)var o=a.get(null);else{a=new Map,lo.set(e,a);for(var d=e.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<d.length;f++){var y=d[f];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(a.set(y.dataset.precedence,y),o=y)}o&&a.set(null,o)}d=n.instance,y=d.getAttribute("data-precedence"),f=a.get(y)||o,f===o&&a.set(null,d),a.set(y,d),this.count++,o=so.bind(this),d.addEventListener("load",o),d.addEventListener("error",o),f?f.parentNode.insertBefore(d,f.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(d,e.firstChild)),n.state.loading|=4}}var ml={$$typeof:R,Provider:null,Consumer:null,_currentValue:ye,_currentValue2:ye,_threadCount:0};function uw(e,n,a,o,d,f,y,v){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=cc(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cc(0),this.hiddenUpdates=cc(null),this.identifierPrefix=o,this.onUncaughtError=d,this.onCaughtError=f,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=v,this.incompleteTransitions=new Map}function Sm(e,n,a,o,d,f,y,v,N,B,J,se){return e=new uw(e,n,a,y,v,N,B,se),n=1,f===!0&&(n|=24),f=ln(3,null,null,n),e.current=f,f.stateNode=e,n=Wc(),n.refCount++,e.pooledCache=n,n.refCount++,f.memoizedState={element:o,isDehydrated:a,cache:n},Zc(f),e}function jm(e){return e?(e=Hr,e):Hr}function Dm(e,n,a,o,d,f){d=jm(d),o.context===null?o.context=d:o.pendingContext=d,o=xa(n),o.payload={element:a},f=f===void 0?null:f,f!==null&&(o.callback=f),a=ba(e,o,n),a!==null&&(hn(a,e,n),Ys(a,e,n))}function Em(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<n?a:n}}function gu(e,n){Em(e,n),(e=e.alternate)&&Em(e,n)}function Cm(e){if(e.tag===13){var n=Ur(e,67108864);n!==null&&hn(n,e,67108864),gu(e,67108864)}}var io=!0;function hw(e,n,a,o){var d=X.T;X.T=null;var f=oe.p;try{oe.p=2,mu(e,n,a,o)}finally{oe.p=f,X.T=d}}function fw(e,n,a,o){var d=X.T;X.T=null;var f=oe.p;try{oe.p=8,mu(e,n,a,o)}finally{oe.p=f,X.T=d}}function mu(e,n,a,o){if(io){var d=pu(o);if(d===null)nu(e,n,o,oo,a),Rm(e,o);else if(mw(d,e,n,a,o))o.stopPropagation();else if(Rm(e,o),n&4&&-1<gw.indexOf(e)){for(;d!==null;){var f=Tr(d);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var y=fe(f.pendingLanes);if(y!==0){var v=f;for(v.pendingLanes|=2,v.entangledLanes|=2;y;){var N=1<<31-re(y);v.entanglements[1]|=N,y&=~N}Hn(f),(Ke&6)===0&&(Yi=Dt()+500,ol(0))}}break;case 13:v=Ur(f,2),v!==null&&hn(v,f,2),Vi(),gu(f,2)}if(f=pu(o),f===null&&nu(e,n,o,oo,a),f===d)break;d=f}d!==null&&o.stopPropagation()}else nu(e,n,o,null,a)}}function pu(e){return e=wc(e),yu(e)}var oo=null;function yu(e){if(oo=null,e=Nr(e),e!==null){var n=u(e);if(n===null)e=null;else{var a=n.tag;if(a===13){if(e=h(n),e!==null)return e;e=null}else if(a===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return oo=e,null}function Am(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ic()){case ti:return 2;case ni:return 8;case _r:case oc:return 32;case ai:return 268435456;default:return 32}default:return 32}}var xu=!1,Ra=null,Oa=null,Ma=null,pl=new Map,yl=new Map,Ia=[],gw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Rm(e,n){switch(e){case"focusin":case"focusout":Ra=null;break;case"dragenter":case"dragleave":Oa=null;break;case"mouseover":case"mouseout":Ma=null;break;case"pointerover":case"pointerout":pl.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":yl.delete(n.pointerId)}}function xl(e,n,a,o,d,f){return e===null||e.nativeEvent!==f?(e={blockedOn:n,domEventName:a,eventSystemFlags:o,nativeEvent:f,targetContainers:[d]},n!==null&&(n=Tr(n),n!==null&&Cm(n)),e):(e.eventSystemFlags|=o,n=e.targetContainers,d!==null&&n.indexOf(d)===-1&&n.push(d),e)}function mw(e,n,a,o,d){switch(n){case"focusin":return Ra=xl(Ra,e,n,a,o,d),!0;case"dragenter":return Oa=xl(Oa,e,n,a,o,d),!0;case"mouseover":return Ma=xl(Ma,e,n,a,o,d),!0;case"pointerover":var f=d.pointerId;return pl.set(f,xl(pl.get(f)||null,e,n,a,o,d)),!0;case"gotpointercapture":return f=d.pointerId,yl.set(f,xl(yl.get(f)||null,e,n,a,o,d)),!0}return!1}function Om(e){var n=Nr(e.target);if(n!==null){var a=u(n);if(a!==null){if(n=a.tag,n===13){if(n=h(a),n!==null){e.blockedOn=n,ob(e.priority,function(){if(a.tag===13){var o=un();o=dc(o);var d=Ur(a,o);d!==null&&hn(d,a,o),gu(a,o)}});return}}else if(n===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function co(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var a=pu(e.nativeEvent);if(a===null){a=e.nativeEvent;var o=new a.constructor(a.type,a);vc=o,a.target.dispatchEvent(o),vc=null}else return n=Tr(a),n!==null&&Cm(n),e.blockedOn=a,!1;n.shift()}return!0}function Mm(e,n,a){co(e)&&a.delete(n)}function pw(){xu=!1,Ra!==null&&co(Ra)&&(Ra=null),Oa!==null&&co(Oa)&&(Oa=null),Ma!==null&&co(Ma)&&(Ma=null),pl.forEach(Mm),yl.forEach(Mm)}function uo(e,n){e.blockedOn===n&&(e.blockedOn=null,xu||(xu=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,pw)))}var ho=null;function Im(e){ho!==e&&(ho=e,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){ho===e&&(ho=null);for(var n=0;n<e.length;n+=3){var a=e[n],o=e[n+1],d=e[n+2];if(typeof o!="function"){if(yu(o||a)===null)continue;break}var f=Tr(a);f!==null&&(e.splice(n,3),n-=3,yd(f,{pending:!0,data:d,method:a.method,action:o},o,d))}}))}function bl(e){function n(N){return uo(N,e)}Ra!==null&&uo(Ra,e),Oa!==null&&uo(Oa,e),Ma!==null&&uo(Ma,e),pl.forEach(n),yl.forEach(n);for(var a=0;a<Ia.length;a++){var o=Ia[a];o.blockedOn===e&&(o.blockedOn=null)}for(;0<Ia.length&&(a=Ia[0],a.blockedOn===null);)Om(a),a.blockedOn===null&&Ia.shift();if(a=(e.ownerDocument||e).$$reactFormReplay,a!=null)for(o=0;o<a.length;o+=3){var d=a[o],f=a[o+1],y=d[Xt]||null;if(typeof f=="function")y||Im(a);else if(y){var v=null;if(f&&f.hasAttribute("formAction")){if(d=f,y=f[Xt]||null)v=y.formAction;else if(yu(d)!==null)continue}else v=y.action;typeof v=="function"?a[o+1]=v:(a.splice(o,3),o-=3),Im(a)}}}function bu(e){this._internalRoot=e}fo.prototype.render=bu.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(l(409));var a=n.current,o=un();Dm(a,o,e,n,null,null)},fo.prototype.unmount=bu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;Dm(e.current,2,null,e,null,null),Vi(),n[kr]=null}};function fo(e){this._internalRoot=e}fo.prototype.unstable_scheduleHydration=function(e){if(e){var n=Kh();e={blockedOn:null,target:e,priority:n};for(var a=0;a<Ia.length&&n!==0&&n<Ia[a].priority;a++);Ia.splice(a,0,e),a===0&&Om(e)}};var Lm=t.version;if(Lm!=="19.1.0")throw Error(l(527,Lm,"19.1.0"));oe.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=m(n),e=e!==null?p(e):null,e=e===null?null:e.stateNode,e};var yw={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:X,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var go=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!go.isDisabled&&go.supportsFiber)try{q=go.inject(yw),F=go}catch{}}return kl.createRoot=function(e,n){if(!c(e))throw Error(l(299));var a=!1,o="",d=Zg,f=Jg,y=e0,v=null;return n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onUncaughtError!==void 0&&(d=n.onUncaughtError),n.onCaughtError!==void 0&&(f=n.onCaughtError),n.onRecoverableError!==void 0&&(y=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(v=n.unstable_transitionCallbacks)),n=Sm(e,1,!1,null,null,a,o,d,f,y,v,null),e[kr]=n.current,tu(e),new bu(n)},kl.hydrateRoot=function(e,n,a){if(!c(e))throw Error(l(299));var o=!1,d="",f=Zg,y=Jg,v=e0,N=null,B=null;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onUncaughtError!==void 0&&(f=a.onUncaughtError),a.onCaughtError!==void 0&&(y=a.onCaughtError),a.onRecoverableError!==void 0&&(v=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(N=a.unstable_transitionCallbacks),a.formState!==void 0&&(B=a.formState)),n=Sm(e,1,!0,n,a??null,o,d,f,y,v,N,B),n.context=jm(null),a=n.current,o=un(),o=dc(o),d=xa(o),d.callback=null,ba(a,d,o),a=o,n.current.lanes=a,Ts(n,a),Hn(n),e[kr]=n.current,tu(e),new fo(n)},kl.version="19.1.0",kl}var Qm;function j_(){if(Qm)return Tu.exports;Qm=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(t){console.error(t)}}return s(),Tu.exports=S_(),Tu.exports}var D_=j_();const E_="modulepreload",C_=function(s,t){return new URL(s,t).href},Xm={},ua=function(t,r,l){let c=Promise.resolve();if(r&&r.length>0){let p=function(x){return Promise.all(x.map(b=>Promise.resolve(b).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};const h=document.getElementsByTagName("link"),g=document.querySelector("meta[property=csp-nonce]"),m=g?.nonce||g?.getAttribute("nonce");c=p(r.map(x=>{if(x=C_(x,l),x in Xm)return;Xm[x]=!0;const b=x.endsWith(".css"),w=b?'[rel="stylesheet"]':"";if(!!l)for(let U=h.length-1;U>=0;U--){const Y=h[U];if(Y.href===x&&(!b||Y.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${x}"]${w}`))return;const T=document.createElement("link");if(T.rel=b?"stylesheet":E_,b||(T.as="script"),T.crossOrigin="",T.href=x,m&&T.setAttribute("nonce",m),document.head.appendChild(T),b)return new Promise((U,Y)=>{T.addEventListener("load",U),T.addEventListener("error",()=>Y(new Error(`Unable to preload CSS for ${x}`)))})}))}function u(h){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=h,window.dispatchEvent(g),!g.defaultPrevented)throw h}return c.then(h=>{for(const g of h||[])g.status==="rejected"&&u(g.reason);return t().catch(u)})};function Du(){return Date.now().toString(36)+Math.random().toString(36).substr(2,9)}function A_(s){return s.toLocaleString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}function Wo(s){switch(s){case 1:return"";case 2:return"";case 3:return"";case 4:return"";case 5:return"";case-1:return"";default:return`${s}`}}function R_(s){return{2024:["2024-01-01","2024-02-09","2024-02-10","2024-02-11","2024-02-12","2024-03-01","2024-04-10","2024-05-05","2024-05-06","2024-05-15","2024-06-06","2024-08-15","2024-09-16","2024-09-17","2024-09-18","2024-10-03","2024-10-09","2024-12-25"],2025:["2025-01-01","2025-01-28","2025-01-29","2025-01-30","2025-03-01","2025-05-05","2025-05-13","2025-06-06","2025-08-15","2025-10-05","2025-10-06","2025-10-07","2025-10-08","2025-10-03","2025-10-09","2025-12-25"],2026:["2026-01-01","2026-02-16","2026-02-17","2026-02-18","2026-03-01","2026-05-05","2026-05-02","2026-06-06","2026-08-15","2026-09-24","2026-09-25","2026-09-26","2026-10-03","2026-10-09","2026-12-25"]}[s.toString()]||[]}function O_(s){return{2024:[{date:"2024-01-01",name:"",isHoliday:!0},{date:"2024-02-09",name:"",isHoliday:!0},{date:"2024-02-10",name:"",isHoliday:!0},{date:"2024-02-11",name:"",isHoliday:!0},{date:"2024-02-12",name:"",isHoliday:!0},{date:"2024-03-01",name:"",isHoliday:!0},{date:"2024-04-10",name:"",isHoliday:!0},{date:"2024-05-05",name:"",isHoliday:!0},{date:"2024-05-06",name:"",isHoliday:!0},{date:"2024-05-15",name:"",isHoliday:!0},{date:"2024-06-06",name:"",isHoliday:!0},{date:"2024-08-15",name:"",isHoliday:!0},{date:"2024-09-16",name:"",isHoliday:!0},{date:"2024-09-17",name:"",isHoliday:!0},{date:"2024-09-18",name:"",isHoliday:!0},{date:"2024-10-03",name:"",isHoliday:!0},{date:"2024-10-09",name:"",isHoliday:!0},{date:"2024-12-25",name:"",isHoliday:!0}],2025:[{date:"2025-01-01",name:"",isHoliday:!0},{date:"2025-01-28",name:"",isHoliday:!0},{date:"2025-01-29",name:"",isHoliday:!0},{date:"2025-01-30",name:"",isHoliday:!0},{date:"2025-03-01",name:"",isHoliday:!0},{date:"2025-05-05",name:"",isHoliday:!0},{date:"2025-05-13",name:"",isHoliday:!0},{date:"2025-06-06",name:"",isHoliday:!0},{date:"2025-08-15",name:"",isHoliday:!0},{date:"2025-10-05",name:"",isHoliday:!0},{date:"2025-10-06",name:"",isHoliday:!0},{date:"2025-10-07",name:"",isHoliday:!0},{date:"2025-10-08",name:"",isHoliday:!0},{date:"2025-10-03",name:"",isHoliday:!0},{date:"2025-10-09",name:"",isHoliday:!0},{date:"2025-12-25",name:"",isHoliday:!0}],2026:[{date:"2026-01-01",name:"",isHoliday:!0},{date:"2026-02-16",name:"",isHoliday:!0},{date:"2026-02-17",name:"",isHoliday:!0},{date:"2026-02-18",name:"",isHoliday:!0},{date:"2026-03-01",name:"",isHoliday:!0},{date:"2026-05-05",name:"",isHoliday:!0},{date:"2026-05-02",name:"",isHoliday:!0},{date:"2026-06-06",name:"",isHoliday:!0},{date:"2026-08-15",name:"",isHoliday:!0},{date:"2026-09-24",name:"",isHoliday:!0},{date:"2026-09-25",name:"",isHoliday:!0},{date:"2026-09-26",name:"",isHoliday:!0},{date:"2026-10-03",name:"",isHoliday:!0},{date:"2026-10-09",name:"",isHoliday:!0},{date:"2026-12-25",name:"",isHoliday:!0}]}[s.toString()]||[]}function vy(s){const t=s.getFullYear(),r=(s.getMonth()+1).toString().padStart(2,"0"),l=s.getDate().toString().padStart(2,"0"),c=`${t}-${r}-${l}`;return R_(t).includes(c)}function za(s){const t=s.getDay();return t===0||t===6}function wy(s){return za(s)||vy(s)}function hh(s){const t=s.getFullYear(),r=(s.getMonth()+1).toString().padStart(2,"0"),l=s.getDate().toString().padStart(2,"0"),c=`${t}-${r}-${l}`;return O_(t).find(h=>h.date===c)||null}function _y(s,t){const r=new Date(s,t-1,1);let l=new Date(r);for(;wy(l);)l.setDate(l.getDate()+1);return l}function ky(s,t){const r=new Date(s,t,0);let l=new Date(r);for(;wy(l);)l.setDate(l.getDate()-1);return l}function Eo(s,t){if(vy(s))return!0;const r=s.getFullYear(),l=(s.getMonth()+1).toString().padStart(2,"0"),c=s.getDate().toString().padStart(2,"0"),u=`${r}-${l}-${c}`,h=`${l}-${c}`;return t.some(g=>{if(!!g.isRecurring){const p=g.date.split("-");if(p.length===3){const x=p[1].padStart(2,"0"),b=p[2].padStart(2,"0");return`${x}-${b}`===h}return g.date.endsWith(h)}return g.date===u})}class M_{templates=[];setTemplates(t){this.templates=t}hasConflictingInstance(t,r,l){const c=this.templates.find(h=>h.title===l.targetTemplateTitle&&h.id!==r);if(!c)return!1;const u=this.generateInstancesForTemplate(c);for(const h of u)if(this.checkDateConflict(t,h.date,l.scope))return console.log(`[Conflict] ${t.toDateString()} ${c.title}()  `),!0;return!1}checkDateConflict(t,r,l){switch(l){case"same_date":return t.toDateString()===r.toDateString();case"same_week":const c=new Date(t);c.setDate(t.getDate()-t.getDay());const u=new Date(r);return u.setDate(r.getDate()-r.getDay()),c.toDateString()===u.toDateString();case"same_month":return t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth();default:return!1}}generateInstancesForTemplate(t,r=[]){if(!t.isActive)return[];switch(t.recurrenceType){case"daily":return this.generateDailyInstancesRaw(t,r);case"weekly":return this.generateWeeklyInstancesRaw(t,r);case"monthly":return this.generateMonthlyInstancesRaw(t,r);default:return[]}}calculateWeekOfMonth(t){const r=t.getFullYear(),l=t.getMonth(),c=t.getDate();console.log(`calculateWeekOfMonth: ${t.toDateString()}, year=${r}, month=${l+1}, day=${c}`);const u=new Date(r,l,1),h=new Date(r,l+1,0),g=u.getDay(),m=Math.ceil((c+g)/7),p=h.getDate(),x=Math.ceil((p+g)/7);return console.log(`  firstWeekday=${g}, weekOfMonth=${m}, totalWeeks=${x}`),m===x?(console.log("   : -1 "),-1):(console.log(`   : ${m} `),m)}isLastOccurrenceOfWeekdayInMonth(t){const r=t.getFullYear(),l=t.getMonth(),c=t.getDay(),u=new Date(r,l+1,0);for(let h=u.getDate();h>=1;h--){const g=new Date(r,l,h);if(g.getDay()===c){const m=t.getDate()===h;return console.log(`  ${t.toDateString()}:  (${c})   ${g.toDateString()}, : ${m}`),m}}return!1}adjustForHolidays(t,r="show",l=[]){let c=new Date(t);if(r==="show")return console.log(`  'show' : ${c.toDateString()}  `),c;console.log(`   : ${t.toDateString()}, : ${r}`);const u=Eo(c,l),h=za(c);if(console.log(`     : =${u}, =${h}`),!u&&!h)return console.log("       "),c;c.getMonth();let g=0;const m=15;for(;g<m;){r==="before"?(c.setDate(c.getDate()-1),console.log(`     : ${c.toDateString()}`)):(c.setDate(c.getDate()+1),console.log(`     : ${c.toDateString()}`));const p=Eo(c,l),x=za(c);if(console.log(`   : =${p}, =${x}`),!p&&!x){console.log(`     : ${c.toDateString()}`);break}g++}return g>=m?(console.warn(`      (${m}),   `),console.log(`     : ${t.toDateString()}`),t):(console.log(`   : ${t.toDateString()}  ${c.toDateString()}`),c)}hasDuplicateOnDate(t,r,l){return!1}isExceptionDate(t,r,l){if(!r||r.length===0)return!1;for(const c of r)switch(c.type){case"date":const u=t.getDate();if(c.values.includes(u))return!0;break;case"weekday":const h=t.getDay();if(c.values.includes(h))return!0;break;case"week":const g=this.calculateWeekOfMonth(t);if(console.log(" :",t.toDateString(),":",g," :",c.values),c.values.includes(-1)){const p=this.isLastOccurrenceOfWeekdayInMonth(t);if(console.log(" :",t.toDateString(),"   :",p),p)return console.log("   ():",t.toDateString()),!0}if(c.values.includes(g))return console.log("  :",t.toDateString(),":",g),!0;break;case"month":const m=t.getMonth()+1;if(c.values.includes(m))return!0;break;case"conflict":if(l){const p=c.values;for(const x of p)if(console.log("  :",t.toDateString(),x),this.hasConflictingInstance(t,l,x))return console.log("   :",t.toDateString()),!0}break}return!1}generateDailyInstancesRaw(t,r=[]){if(t.recurrenceType!=="daily")return[];const l=[],c=new Date,u=new Date(t.createdAt),h=new Date(c);h.setFullYear(c.getFullYear()+1);let g=new Date(u);for(;g<=h;){const m=new Date(c.getFullYear(),c.getMonth(),c.getDate());if(new Date(g.getFullYear(),g.getMonth(),g.getDate())>=m&&!this.isExceptionDate(g,t.exceptions,t.id)){const x=t.holidayHandling||"show",b=this.adjustForHolidays(g,x,r);if(!this.hasDuplicateOnDate(b,t.id,t.title)){const w=`${b.getFullYear()}-${(b.getMonth()+1).toString().padStart(2,"0")}-${b.getDate().toString().padStart(2,"0")}`,L=`${t.id}_${w}`;l.push({id:L,templateId:t.id,date:b,completed:!1,createdAt:new Date,updatedAt:new Date,order:-1e3})}}g.setDate(g.getDate()+1)}return l}generateWeeklyInstancesRaw(t,r=[]){if(t.recurrenceType!=="weekly"||t.weekday===void 0)return[];const l=[],c=new Date,u=new Date(t.createdAt),h=new Date(c);h.setFullYear(c.getFullYear()+1);const g=t.weekday;let m=new Date(u);const p=(g-u.getDay()+7)%7;p>0&&m.setDate(u.getDate()+p);let x=new Date(m);for(;x<=h;){const b=new Date(c.getFullYear(),c.getMonth(),c.getDate());if(new Date(x.getFullYear(),x.getMonth(),x.getDate())>=b&&!this.isExceptionDate(x,t.exceptions,t.id)){const L=t.holidayHandling||"show";console.log(`[${t.title}]  : ${x.toDateString()},  : ${L}`),console.log(`[${t.title}]   :`,t);const T=hh(x)!==null,U=za(x);console.log(`[${t.title}]  : ${T},  : ${U}`);const Y=this.adjustForHolidays(x,L,r);if(Y.getTime()!==x.getTime()&&console.log(`[${t.title}]  : ${x.toDateString()}  ${Y.toDateString()}`),this.hasDuplicateOnDate(Y,t.id,t.title))console.log(`     : "${t.title}" - ${Y.toDateString()}`);else{const k=`${Y.getFullYear()}-${(Y.getMonth()+1).toString().padStart(2,"0")}-${Y.getDate().toString().padStart(2,"0")}`,S=`${t.id}_${k}`;t.title.includes("")&&(console.log("   :"),console.log(`    : ${Y.toDateString()} (${Y.getDate()})`),console.log(`    ID: ${S}`)),l.push({id:S,templateId:t.id,date:Y,completed:!1,createdAt:new Date,updatedAt:new Date,order:-1e3})}}x.setDate(x.getDate()+7)}return l}findNthWeekdayOfMonth(t,r,l,c){const u=new Date(t,r-1,1),h=u.getDay();if(console.log(`   findNthWeekdayOfMonth: ${t} ${r}, ${l}  ${["","","","","","",""][c]}`),console.log(`    : ${u.toDateString()},   : ${["","","","","","",""][h]}`),l==="last"){const g=new Date(t,r,0);console.log(`    : ${g.toDateString()}`);for(let m=g.getDate();m>=1;m--){const p=new Date(t,r-1,m);if(p.getDay()===c)return console.log(`    ${["","","","","","",""][c]}: ${p.toDateString()}`),p}}else{const m={first:1,second:2,third:3,fourth:4}[l];let p=(c-h+7)%7,x=new Date(t,r-1,1+p);console.log(`     ${["","","","","","",""][c]}: ${x.toDateString()}`);let b=new Date(x);return b.setDate(b.getDate()+(m-1)*7),console.log(`   ${m} ${["","","","","","",""][c]}: ${b.toDateString()}`),b.getMonth()===r-1?b:(console.log(`    ${m}    `),null)}return null}generateMonthlyInstancesRaw(t,r=[]){if(t.recurrenceType!=="monthly")return[];console.log(`
 [${t.title}]     `),console.log("     :",JSON.stringify(t,null,2)),console.log(`   monthlyDate: ${t.monthlyDate}`),console.log(`   monthlyPattern: ${t.monthlyPattern}`),console.log(`   monthlyWeek: ${t.monthlyWeek}`),console.log(`   monthlyWeekday: ${t.monthlyWeekday}`);const l=[],c=new Set,u=new Date,h=u.getFullYear(),g=u.getMonth()+1,m=u.getDate();console.log(`   : ${h} ${g} ${m}`);for(let p=0;p<12;p++){let x=h,b=g+p;b>12&&(x+=Math.floor((b-1)/12),b=(b-1)%12+1),console.log(`
  : ${x} ${b}`);let w=null;if(t.monthlyPattern==="weekday"&&t.monthlyWeek&&t.monthlyWeekday!==void 0)console.log(`   :  ${t.monthlyWeek}  ${["","","","","","",""][t.monthlyWeekday]}`),w=this.findNthWeekdayOfMonth(x,b,t.monthlyWeek,t.monthlyWeekday),console.log(w?`   ${t.monthlyWeek}  ${["","","","","","",""][t.monthlyWeekday]}: ${w.toDateString()}`:`    ${x} ${b} ${t.monthlyWeek}  ${["","","","","","",""][t.monthlyWeekday]} `);else if(t.monthlyDate===-1)w=new Date(x,b,0),console.log(`   : ${w.toDateString()}`);else if(t.monthlyDate===-2)w=_y(x,b),console.log(`     : ${w.toDateString()}`);else if(t.monthlyDate===-3)w=ky(x,b),console.log(`    : ${w.toDateString()}`);else if(t.monthlyDate&&t.monthlyDate>0){if(w=new Date(x,b-1,t.monthlyDate),w.getMonth()!==b-1){console.log(`    ${x} ${b} ${t.monthlyDate} `);continue}console.log(`     ${t.monthlyDate}: ${w.toDateString()}`)}else w=new Date(x,b-1,1),console.log(`    ( 1): ${w.toDateString()}`);if(!w){console.log("      ");continue}const L=new Date(h,g-1,m);if(w<L){console.log(`      : ${w.toDateString()}`);continue}let T=w;if(t.monthlyDate&&t.monthlyDate>0){const k=t.holidayHandling||"show";T=this.adjustForHolidays(w,k,r),T.getTime()!==w.getTime()&&console.log(`     : ${w.toDateString()}  ${T.toDateString()}`)}if(this.isExceptionDate(T,t.exceptions,t.id)){console.log(`      : ${T.toDateString()}`);continue}const U=`${T.getFullYear()}-${(T.getMonth()+1).toString().padStart(2,"0")}-${T.getDate().toString().padStart(2,"0")}`;if(c.has(U)){console.log(`     : ${U}  `);continue}const Y=`${t.id}_${U}`;c.add(U),l.push({id:Y,templateId:t.id,date:T,completed:!1,createdAt:new Date,updatedAt:new Date,order:-1e3}),console.log(`     : ${T.toDateString()} (ID: ${Y})`)}return console.log(` [${t.title}]  ${l.length}   `),l}calculateMonthlyWeekday(t,r,l,c){const u=r-1,h=new Date(t,u+1,0);if(console.log(` calculateMonthlyWeekday: ${t} ${r} ${l}  ${["","","","","","",""][c]}`),console.log(`    : ${h.getDate()}`),l==="last"){console.log(`   ${["","","","","","",""][c]}  ...`);for(let g=h.getDate();g>=1;g--){const m=new Date(t,u,g);if(m.getDay()===c)return console.log(`  ${["","","","","","",""][c]} : ${m.getFullYear()} ${m.getMonth()+1} ${m.getDate()}`),m}}else{const m={first:1,second:2,third:3,fourth:4}[l];let p=0;for(let x=1;x<=h.getDate();x++){const b=new Date(t,u,x);if(b.getDay()===c&&(p++,p===m))return b}}return null}generateDailyInstances(t,r=[]){return this.generateDailyInstancesRaw(t,r)}generateWeeklyInstances(t,r=[]){return this.generateWeeklyInstancesRaw(t,r)}generateMonthlyInstances(t,r=[]){return this.generateMonthlyInstancesRaw(t,r)}generateInstances(t,r=[]){if(!t.isActive)return[];let l=[];switch(t.recurrenceType){case"daily":l=this.generateDailyInstances(t,r);break;case"weekly":l=this.generateWeeklyInstances(t,r);break;case"monthly":l=this.generateMonthlyInstances(t,r);break;default:return[]}return this.removeDuplicateInstances(l)}removeDuplicateInstances(t){const r=new Map;for(const l of t){const c=`${l.templateId}_${l.date.toDateString()}`;(!r.has(c)||r.get(c).createdAt<l.createdAt)&&(r.has(c)&&console.log(`   : ${l.date.toDateString()}`),r.set(c,l))}return Array.from(r.values()).sort((l,c)=>l.date.getTime()-c.date.getTime())}convertToTodo(t,r){const l=`recurring_${t.id}`;t.id==="PUH4xT3lVY5aK2vuQyUe_2025-08-21"&&(console.log(" convertToTodo  - "),console.log("   instance.completed:",t.completed,typeof t.completed),console.log("   instance :",JSON.stringify(t,null,2)),console.log("   :",r.title)),r.title.includes("")&&console.log("  convertToTodo - ID:",t.id,":",t.completed);const c=r.title.includes("")||r.title.includes(" ")||r.title.includes("")||r.title.includes(" "),u=c?"urgent":r.priority;c&&r.priority!=="urgent"&&console.log(`    : ${r.priority}  urgent`);const h={id:l,title:r.title,description:r.description,completed:t.completed,priority:u,type:r.type,dueDate:void 0,startDate:t.date,createdAt:t.createdAt,updatedAt:t.updatedAt,completedAt:t.completedAt,tags:[...r.tags||[]],order:t.order,_isRecurringInstance:!0,_instanceId:t.id,_templateId:r.id};return t.id==="PUH4xT3lVY5aK2vuQyUe_2025-08-21"&&(console.log(" convertToTodo  - "),console.log("   todo.completed:",h.completed,typeof h.completed),console.log("   todo :",JSON.stringify(h,null,2))),h}getTodayInstances(t){const l=new Date().toDateString();return t.filter(c=>c.date.toDateString()===l)}getWeekInstances(t){const r=new Date,l=new Date(r);l.setDate(r.getDate()-r.getDay());const c=new Date(l);return c.setDate(l.getDate()+6),t.filter(u=>u.date>=l&&u.date<=c)}getMonthInstances(t){const r=new Date,l=new Date(r.getFullYear(),r.getMonth(),1),c=new Date(r.getFullYear(),r.getMonth()+1,0);return t.filter(u=>u.date>=l&&u.date<=c)}removeDuplicateTodos(t){const r=new Map,l=[];for(const h of t){if(!h._isRecurringInstance){l.push(h);continue}const g=`${h.title}_${h.dueDate?.toDateString()||"no-date"}`;r.has(g)?console.log(`    : "${h.title}" - ${h.dueDate?.toDateString()}`):(r.set(g,h),console.log(`   : "${h.title}" - ${h.dueDate?.toDateString()}`))}const c=Array.from(r.values()),u=[...l,...c];return console.log(`   : ${t.length}  ${u.length} (${t.length-u.length} )`),u.sort((h,g)=>{const m=h.order||0,p=g.order||0;if(m!==p)return m-p;const x=h.dueDate||new Date(0),b=g.dueDate||new Date(0);return x.getTime()-b.getTime()})}}const cs=new M_;/*! Capacitor: https://capacitorjs.com/ - MIT License */const I_=s=>{const t=new Map;t.set("web",{name:"web"});const r=s.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:t},l=(u,h)=>{r.platforms.set(u,h)},c=u=>{r.platforms.has(u)&&(r.currentPlatform=r.platforms.get(u))};return r.addPlatform=l,r.setPlatform=c,r},L_=s=>s.CapacitorPlatforms=I_(s),Ny=L_(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});Ny.addPlatform;Ny.setPlatform;var ps;(function(s){s.Unimplemented="UNIMPLEMENTED",s.Unavailable="UNAVAILABLE"})(ps||(ps={}));class Eu extends Error{constructor(t,r,l){super(t),this.message=t,this.code=r,this.data=l}}const U_=s=>{var t,r;return s?.androidBridge?"android":!((r=(t=s?.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||r===void 0)&&r.bridge?"ios":"web"},H_=s=>{var t,r,l,c,u;const h=s.CapacitorCustomPlatform||null,g=s.Capacitor||{},m=g.Plugins=g.Plugins||{},p=s.CapacitorPlatforms,x=()=>h!==null?h.name:U_(s),b=((t=p?.currentPlatform)===null||t===void 0?void 0:t.getPlatform)||x,w=()=>b()!=="web",L=((r=p?.currentPlatform)===null||r===void 0?void 0:r.isNativePlatform)||w,T=C=>{const ee=D.get(C);return!!(ee?.platforms.has(b())||k(C))},U=((l=p?.currentPlatform)===null||l===void 0?void 0:l.isPluginAvailable)||T,Y=C=>{var ee;return(ee=g.PluginHeaders)===null||ee===void 0?void 0:ee.find(ie=>ie.name===C)},k=((c=p?.currentPlatform)===null||c===void 0?void 0:c.getPluginHeader)||Y,S=C=>s.console.error(C),R=(C,ee,ie)=>Promise.reject(`${ie} does not have an implementation of "${ee}".`),D=new Map,_=(C,ee={})=>{const ie=D.get(C);if(ie)return console.warn(`Capacitor plugin "${C}" already registered. Cannot register plugins twice.`),ie.proxy;const xe=b(),_e=k(C);let ve;const he=async()=>(!ve&&xe in ee?ve=typeof ee[xe]=="function"?ve=await ee[xe]():ve=ee[xe]:h!==null&&!ve&&"web"in ee&&(ve=typeof ee.web=="function"?ve=await ee.web():ve=ee.web),ve),Te=(Z,E)=>{var O,Q;if(_e){const pe=_e?.methods.find(W=>E===W.name);if(pe)return pe.rtype==="promise"?W=>g.nativePromise(C,E.toString(),W):(W,de)=>g.nativeCallback(C,E.toString(),W,de);if(Z)return(O=Z[E])===null||O===void 0?void 0:O.bind(Z)}else{if(Z)return(Q=Z[E])===null||Q===void 0?void 0:Q.bind(Z);throw new Eu(`"${C}" plugin is not implemented on ${xe}`,ps.Unimplemented)}},Ee=Z=>{let E;const O=(...Q)=>{const pe=he().then(W=>{const de=Te(W,Z);if(de){const K=de(...Q);return E=K?.remove,K}else throw new Eu(`"${C}.${Z}()" is not implemented on ${xe}`,ps.Unimplemented)});return Z==="addListener"&&(pe.remove=async()=>E()),pe};return O.toString=()=>`${Z.toString()}() { [capacitor code] }`,Object.defineProperty(O,"name",{value:Z,writable:!1,configurable:!1}),O},X=Ee("addListener"),oe=Ee("removeListener"),ye=(Z,E)=>{const O=X({eventName:Z},E),Q=async()=>{const W=await O;oe({eventName:Z,callbackId:W},E)},pe=new Promise(W=>O.then(()=>W({remove:Q})));return pe.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await Q()},pe},M=new Proxy({},{get(Z,E){switch(E){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return _e?ye:X;case"removeListener":return oe;default:return Ee(E)}}});return m[C]=M,D.set(C,{name:C,proxy:M,platforms:new Set([...Object.keys(ee),..._e?[xe]:[]])}),M},$=((u=p?.currentPlatform)===null||u===void 0?void 0:u.registerPlugin)||_;return g.convertFileSrc||(g.convertFileSrc=C=>C),g.getPlatform=b,g.handleError=S,g.isNativePlatform=L,g.isPluginAvailable=U,g.pluginMethodNoop=R,g.registerPlugin=$,g.Exception=Eu,g.DEBUG=!!g.DEBUG,g.isLoggingEnabled=!!g.isLoggingEnabled,g.platform=g.getPlatform(),g.isNative=g.isNativePlatform(),g},$_=s=>s.Capacitor=H_(s),ys=$_(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),fh=ys.registerPlugin;ys.Plugins;class Ty{constructor(t){this.listeners={},this.retainedEventArguments={},this.windowListeners={},t&&(console.warn(`Capacitor WebPlugin "${t.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=t)}addListener(t,r){let l=!1;this.listeners[t]||(this.listeners[t]=[],l=!0),this.listeners[t].push(r);const u=this.windowListeners[t];u&&!u.registered&&this.addWindowListener(u),l&&this.sendRetainedArgumentsForEvent(t);const h=async()=>this.removeListener(t,r);return Promise.resolve({remove:h})}async removeAllListeners(){this.listeners={};for(const t in this.windowListeners)this.removeWindowListener(this.windowListeners[t]);this.windowListeners={}}notifyListeners(t,r,l){const c=this.listeners[t];if(!c){if(l){let u=this.retainedEventArguments[t];u||(u=[]),u.push(r),this.retainedEventArguments[t]=u}return}c.forEach(u=>u(r))}hasListeners(t){return!!this.listeners[t].length}registerWindowListener(t,r){this.windowListeners[r]={registered:!1,windowEventName:t,pluginEventName:r,handler:l=>{this.notifyListeners(r,l)}}}unimplemented(t="not implemented"){return new ys.Exception(t,ps.Unimplemented)}unavailable(t="not available"){return new ys.Exception(t,ps.Unavailable)}async removeListener(t,r){const l=this.listeners[t];if(!l)return;const c=l.indexOf(r);this.listeners[t].splice(c,1),this.listeners[t].length||this.removeWindowListener(this.windowListeners[t])}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}sendRetainedArgumentsForEvent(t){const r=this.retainedEventArguments[t];r&&(delete this.retainedEventArguments[t],r.forEach(l=>{this.notifyListeners(t,l)}))}}const Km=s=>encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Zm=s=>s.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class z_ extends Ty{async getCookies(){const t=document.cookie,r={};return t.split(";").forEach(l=>{if(l.length<=0)return;let[c,u]=l.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");c=Zm(c).trim(),u=Zm(u).trim(),r[c]=u}),r}async setCookie(t){try{const r=Km(t.key),l=Km(t.value),c=`; expires=${(t.expires||"").replace("expires=","")}`,u=(t.path||"/").replace("path=",""),h=t.url!=null&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${r}=${l||""}${c}; path=${u}; ${h};`}catch(r){return Promise.reject(r)}}async deleteCookie(t){try{document.cookie=`${t.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}}async clearCookies(){try{const t=document.cookie.split(";")||[];for(const r of t)document.cookie=r.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(t){return Promise.reject(t)}}async clearAllCookies(){try{await this.clearCookies()}catch(t){return Promise.reject(t)}}}fh("CapacitorCookies",{web:()=>new z_});const B_=async s=>new Promise((t,r)=>{const l=new FileReader;l.onload=()=>{const c=l.result;t(c.indexOf(",")>=0?c.split(",")[1]:c)},l.onerror=c=>r(c),l.readAsDataURL(s)}),q_=(s={})=>{const t=Object.keys(s);return Object.keys(s).map(c=>c.toLocaleLowerCase()).reduce((c,u,h)=>(c[u]=s[t[h]],c),{})},F_=(s,t=!0)=>s?Object.entries(s).reduce((l,c)=>{const[u,h]=c;let g,m;return Array.isArray(h)?(m="",h.forEach(p=>{g=t?encodeURIComponent(p):p,m+=`${u}=${g}&`}),m.slice(0,-1)):(g=t?encodeURIComponent(h):h,m=`${u}=${g}`),`${l}&${m}`},"").substr(1):null,G_=(s,t={})=>{const r=Object.assign({method:s.method||"GET",headers:s.headers},t),c=q_(s.headers)["content-type"]||"";if(typeof s.data=="string")r.body=s.data;else if(c.includes("application/x-www-form-urlencoded")){const u=new URLSearchParams;for(const[h,g]of Object.entries(s.data||{}))u.set(h,g);r.body=u.toString()}else if(c.includes("multipart/form-data")||s.data instanceof FormData){const u=new FormData;if(s.data instanceof FormData)s.data.forEach((g,m)=>{u.append(m,g)});else for(const g of Object.keys(s.data))u.append(g,s.data[g]);r.body=u;const h=new Headers(r.headers);h.delete("content-type"),r.headers=h}else(c.includes("application/json")||typeof s.data=="object")&&(r.body=JSON.stringify(s.data));return r};class Y_ extends Ty{async request(t){const r=G_(t,t.webFetchExtra),l=F_(t.params,t.shouldEncodeUrlParams),c=l?`${t.url}?${l}`:t.url,u=await fetch(c,r),h=u.headers.get("content-type")||"";let{responseType:g="text"}=u.ok?t:{};h.includes("application/json")&&(g="json");let m,p;switch(g){case"arraybuffer":case"blob":p=await u.blob(),m=await B_(p);break;case"json":m=await u.json();break;case"document":case"text":default:m=await u.text()}const x={};return u.headers.forEach((b,w)=>{x[w]=b}),{data:m,headers:x,status:u.status,url:u.url}}async get(t){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))}async post(t){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))}async put(t){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))}async patch(t){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))}async delete(t){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))}}fh("CapacitorHttp",{web:()=>new Y_});var Jm;(function(s){s.IndexedDbLocal="INDEXED_DB_LOCAL",s.InMemory="IN_MEMORY",s.BrowserLocal="BROWSER_LOCAL",s.BrowserSession="BROWSER_SESSION"})(Jm||(Jm={}));var ep;(function(s){s.APPLE="apple.com",s.FACEBOOK="facebook.com",s.GAME_CENTER="gc.apple.com",s.GITHUB="github.com",s.GOOGLE="google.com",s.MICROSOFT="microsoft.com",s.PLAY_GAMES="playgames.google.com",s.TWITTER="twitter.com",s.YAHOO="yahoo.com",s.PASSWORD="password",s.PHONE="phone"})(ep||(ep={}));const tp=fh("FirebaseAuthentication",{web:()=>ua(()=>import("./web-BqQYDjVh.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url).then(s=>new s.FirebaseAuthenticationWeb)});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sy="firebasestorage.googleapis.com",P_="storageBucket",V_=120*1e3,W_=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn extends Yw{constructor(t,r,l=0){super(Cu(t),`Firebase Storage: ${r} (${Cu(t)})`),this.status_=l,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Fn.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return Cu(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Bn;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Bn||(Bn={}));function Cu(s){return"storage/"+s}function Q_(){const s="An unknown error occurred, please check the error payload for server response.";return new Fn(Bn.UNKNOWN,s)}function X_(){return new Fn(Bn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function K_(){return new Fn(Bn.CANCELED,"User canceled the upload/download.")}function Z_(s){return new Fn(Bn.INVALID_URL,"Invalid URL '"+s+"'.")}function J_(s){return new Fn(Bn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function np(s){return new Fn(Bn.INVALID_ARGUMENT,s)}function jy(){return new Fn(Bn.APP_DELETED,"The Firebase app was deleted.")}function ek(s){return new Fn(Bn.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(t,r){this.bucket=t,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,r){let l;try{l=Cn.makeFromUrl(t,r)}catch{return new Cn(t,"")}if(l.path==="")return l;throw J_(t)}static makeFromUrl(t,r){let l=null;const c="([A-Za-z0-9.\\-_]+)";function u(D){D.path.charAt(D.path.length-1)==="/"&&(D.path_=D.path_.slice(0,-1))}const h="(/(.*))?$",g=new RegExp("^gs://"+c+h,"i"),m={bucket:1,path:3};function p(D){D.path_=decodeURIComponent(D.path)}const x="v[A-Za-z0-9_]+",b=r.replace(/[.]/g,"\\."),w="(/([^?#]*).*)?$",L=new RegExp(`^https?://${b}/${x}/b/${c}/o${w}`,"i"),T={bucket:1,path:3},U=r===Sy?"(?:storage.googleapis.com|storage.cloud.google.com)":r,Y="([^?#]*)",k=new RegExp(`^https?://${U}/${c}/${Y}`,"i"),R=[{regex:g,indices:m,postModify:u},{regex:L,indices:T,postModify:p},{regex:k,indices:{bucket:1,path:2},postModify:p}];for(let D=0;D<R.length;D++){const _=R[D],$=_.regex.exec(t);if($){const C=$[_.indices.bucket];let ee=$[_.indices.path];ee||(ee=""),l=new Cn(C,ee),_.postModify(l);break}}if(l==null)throw Z_(t);return l}}class tk{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nk(s,t,r){let l=1,c=null,u=null,h=!1,g=0;function m(){return g===2}let p=!1;function x(...Y){p||(p=!0,t.apply(null,Y))}function b(Y){c=setTimeout(()=>{c=null,s(L,m())},Y)}function w(){u&&clearTimeout(u)}function L(Y,...k){if(p){w();return}if(Y){w(),x.call(null,Y,...k);return}if(m()||h){w(),x.call(null,Y,...k);return}l<64&&(l*=2);let R;g===1?(g=2,R=0):R=(l+Math.random())*1e3,b(R)}let T=!1;function U(Y){T||(T=!0,w(),!p&&(c!==null?(Y||(g=2),clearTimeout(c),b(0)):Y||(g=1)))}return b(0),u=setTimeout(()=>{h=!0,U(!0)},r),U}function ak(s){s(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rk(s){return s!==void 0}function ap(s,t,r,l){if(l<t)throw np(`Invalid value for '${s}'. Expected ${t} or greater.`);if(l>r)throw np(`Invalid value for '${s}'. Expected ${r} or less.`)}function sk(s){const t=encodeURIComponent;let r="?";for(const l in s)if(s.hasOwnProperty(l)){const c=t(l)+"="+t(s[l]);r=r+c+"&"}return r=r.slice(0,-1),r}var Co;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(Co||(Co={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lk(s,t){const r=s>=500&&s<600,c=[408,429].indexOf(s)!==-1,u=t.indexOf(s)!==-1;return r||c||u}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{constructor(t,r,l,c,u,h,g,m,p,x,b,w=!0,L=!1){this.url_=t,this.method_=r,this.headers_=l,this.body_=c,this.successCodes_=u,this.additionalRetryCodes_=h,this.callback_=g,this.errorCallback_=m,this.timeout_=p,this.progressCallback_=x,this.connectionFactory_=b,this.retry=w,this.isUsingEmulator=L,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,U)=>{this.resolve_=T,this.reject_=U,this.start_()})}start_(){const t=(l,c)=>{if(c){l(!1,new yo(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const h=g=>{const m=g.loaded,p=g.lengthComputable?g.total:-1;this.progressCallback_!==null&&this.progressCallback_(m,p)};this.progressCallback_!==null&&u.addUploadProgressListener(h),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(h),this.pendingConnection_=null;const g=u.getErrorCode()===Co.NO_ERROR,m=u.getStatus();if(!g||lk(m,this.additionalRetryCodes_)&&this.retry){const x=u.getErrorCode()===Co.ABORT;l(!1,new yo(!1,null,x));return}const p=this.successCodes_.indexOf(m)!==-1;l(!0,new yo(p,u))})},r=(l,c)=>{const u=this.resolve_,h=this.reject_,g=c.connection;if(c.wasSuccessCode)try{const m=this.callback_(g,g.getResponse());rk(m)?u(m):u()}catch(m){h(m)}else if(g!==null){const m=Q_();m.serverResponse=g.getErrorText(),this.errorCallback_?h(this.errorCallback_(g,m)):h(m)}else if(c.canceled){const m=this.appDelete_?jy():K_();h(m)}else{const m=X_();h(m)}};this.canceled_?r(!1,new yo(!1,null,!0)):this.backoffId_=nk(t,r,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&ak(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class yo{constructor(t,r,l){this.wasSuccessCode=t,this.connection=r,this.canceled=!!l}}function ok(s,t){t!==null&&t.length>0&&(s.Authorization="Firebase "+t)}function ck(s,t){s["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function dk(s,t){t&&(s["X-Firebase-GMPID"]=t)}function uk(s,t){t!==null&&(s["X-Firebase-AppCheck"]=t)}function hk(s,t,r,l,c,u,h=!0,g=!1){const m=sk(s.urlParams),p=s.url+m,x=Object.assign({},s.headers);return dk(x,t),ok(x,r),ck(x,u),uk(x,l),new ik(p,s.method,x,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,c,h,g)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fk(s){if(s.length===0)return null;const t=s.lastIndexOf("/");return t===-1?"":s.slice(0,t)}function gk(s){const t=s.lastIndexOf("/",s.length-2);return t===-1?s:s.slice(t+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(t,r){this._service=t,r instanceof Cn?this._location=r:this._location=Cn.makeFromUrl(r,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,r){return new Ao(t,r)}get root(){const t=new Cn(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return gk(this._location.path)}get storage(){return this._service}get parent(){const t=fk(this._location.path);if(t===null)return null;const r=new Cn(this._location.bucket,t);return new Ao(this._service,r)}_throwIfRoot(t){if(this._location.path==="")throw ek(t)}}function rp(s,t){const r=t?.[P_];return r==null?null:Cn.makeFromBucketSpec(r,s)}function mk(s,t,r,l={}){s.host=`${t}:${r}`;const c=lh(t);c&&(iy(`https://${s.host}/b`),oy("Storage",!0)),s._isUsingEmulator=!0,s._protocol=c?"https":"http";const{mockUserToken:u}=l;u&&(s._overrideAuthToken=typeof u=="string"?u:cy(u,s.app.options.projectId))}class pk{constructor(t,r,l,c,u,h=!1){this.app=t,this._authProvider=r,this._appCheckProvider=l,this._url=c,this._firebaseVersion=u,this._isUsingEmulator=h,this._bucket=null,this._host=Sy,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=V_,this._maxUploadRetryTime=W_,this._requests=new Set,c!=null?this._bucket=Cn.makeFromBucketSpec(c,this._host):this._bucket=rp(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=Cn.makeFromBucketSpec(this._url,t):this._bucket=rp(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){ap("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){ap("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const r=await t.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(ay(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Ao(this,t)}_makeRequest(t,r,l,c,u=!0){if(this._deleted)return new tk(jy());{const h=hk(t,this._appId,l,c,r,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(h),h.getPromise().then(()=>this._requests.delete(h),()=>this._requests.delete(h)),h}}async makeRequestWithTokens(t,r){const[l,c]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,r,l,c).getPromise()}}const sp="@firebase/storage",lp="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dy="storage";function yk(s=ry(),t){s=Va(s);const l=sy(s,Dy).getImmediate({identifier:t}),c=ly("storage");return c&&xk(l,...c),l}function xk(s,t,r,l={}){mk(s,t,r,l)}function bk(s,{instanceIdentifier:t}){const r=s.getProvider("app").getImmediate(),l=s.getProvider("auth-internal"),c=s.getProvider("app-check-internal");return new pk(r,l,c,t,ny)}function vk(){ey(new ty(Dy,bk,"PUBLIC").setMultipleInstances(!0)),So(sp,lp,""),So(sp,lp,"esm2020")}vk();const Ce={log:(s,t)=>{},warn:(s,t)=>{},error:(s,t)=>{console.error(s,t?.message||t)},info:(s,t)=>{},time:s=>{},timeEnd:s=>{}},Fu={apiKey:"AIzaSyD8aBPw-o13mciSdV8gzRJN6TfaAy3OoWg",authDomain:"todolist-116f3.firebaseapp.com",databaseURL:"https://todolist-116f3-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"todolist-116f3",storageBucket:"todolist-116f3.firebasestorage.app",messagingSenderId:"470825187407",appId:"1:470825187407:web:4bd3f8c621c96890b2d23a",measurementId:"G-HS8CDYHDT1"},wk=()=>{const s=["apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId"];for(const t of s)if(!Fu[t])throw new Error(`Firebase configuration missing: ${t}`);if(!Fu.apiKey.startsWith("AIzaSy"))throw new Error("Invalid Firebase API key format")};let Ul;try{wk();const s=dy();s.length===0?(Ul=uy(Fu),Ce.log("Firebase app initialized")):(Ul=s[0],Ce.log("Using existing Firebase app"))}catch(s){throw Ce.error("Firebase initialization failed:",s),s}const fn=Pw(Ul),Ae=Vw(Ul);yk(Ul);const yr=new hy;yr.addScope("email");yr.addScope("profile");yr.addScope("https://www.googleapis.com/auth/userinfo.email");yr.addScope("https://www.googleapis.com/auth/userinfo.profile");yr.setCustomParameters({prompt:"select_account"});const _k=()=>{};try{_k(),Ce.log("Firebase    ")}catch(s){Ce.error("Firebase security validation failed:",s)}const Ey=I.createContext(void 0),kk=({children:s})=>{const[t,r]=I.useState(null),[l,c]=I.useState(!0),[u,h]=I.useState(!1);I.useEffect(()=>{if(!fn){console.log("Auth: Firebase disabled, using localStorage only"),c(!1);return}const U=Ww(fn,Y=>{Y?(r({uid:Y.uid,email:Y.email,displayName:Y.displayName,photoURL:Y.photoURL,isAnonymous:Y.isAnonymous}),h(Y.isAnonymous)):(r(null),h(!1)),c(!1)});return()=>U()},[]),I.useEffect(()=>{typeof window<"u"&&(window.authContext={signInWithGoogle:w})},[]);const g=async()=>{console.log("Auth: Use signInWithGoogle or signIn instead")},m=async()=>{if(fn){if(await t_(fn),ys.isNativePlatform())try{await tp.signOut()}catch(U){console.log("GoogleAuth signOut failed (maybe not signed in)",U)}}else r(null)},p=async()=>{fn?await e_(fn):(r({uid:"local-user",email:null,displayName:"Local User",isAnonymous:!0}),h(!0))},x=async(U,Y)=>{fn?await Jw(fn,U,Y):console.log("Auth: SignIn not available in localStorage mode",{email:U,password:Y})},b=async(U,Y,k)=>{if(fn){const S=await Kw(fn,U,Y);k&&S.user&&await Zw(S.user,{displayName:k})}else console.log("Auth: SignUp not available in localStorage mode",{email:U,password:Y,displayName:k})},w=async()=>{if(!fn)throw new Error("Firebase   .");try{if(ys.isNativePlatform()){console.log("Starting Native Google Sign-In (Capacitor Firebase)...");const U=await tp.signInWithGoogle();console.log("FirebaseAuthentication Result:",U);const Y=hy.credential(U.credential?.idToken),k=await Qw(fn,Y);return console.log("Mobile Google Sign-In Success:",k.user),k.user}else{if(!yr)throw new Error("Google Provider missing");const U=await Xw(fn,yr);return console.log("  :",U.user),U.user}}catch(U){throw console.error("  :",U),U.code==="auth/popup-closed-by-user"||U.code==="auth/cancelled-popup-request"?new Error(" ."):U.code==="auth/network-request-failed"?new Error("  ."):new Error("   : "+(U.message||JSON.stringify(U)))}},T={currentUser:t,loading:l,isAnonymous:u,login:g,logout:m,loginAnonymously:p,signIn:x,signUp:b,signInWithGoogle:w,signInAsGuest:async()=>{await p()}};return i.jsx(Ey.Provider,{value:T,children:s})},Nn=()=>{const s=I.useContext(Ey);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s};class sa extends Error{constructor(t,r="UNKNOWN_ERROR",l){super(t),this.code=r,this.originalError=l,this.name="TodoError"}}const Cl=(s,t)=>{if(s&&typeof s=="object"&&"code"in s){const r=s;switch(r.code){case"permission-denied":return new sa(" .   .","PERMISSION_DENIED",s);case"not-found":return new sa("    .","NOT_FOUND",s);case"unavailable":return new sa("    .    .","UNAVAILABLE",s);case"failed-precondition":return new sa("   .","FAILED_PRECONDITION",s);case"already-exists":return new sa("  .","ALREADY_EXISTS",s);default:return new sa(`${t}   : ${r.message}`,r.code||"FIRESTORE_ERROR",s)}}return s instanceof Error?new sa(`${t}   : ${s.message}`,"GENERAL_ERROR",s):new sa(`${t}      .`,"UNKNOWN_ERROR",s)},Nk=s=>["unavailable","deadline-exceeded","internal","NETWORK_ERROR"].includes(s.code.toLowerCase()),xo=async(s,t=3,r=1e3)=>{let l;for(let c=1;c<=t;c++)try{return await s()}catch(u){const h=u instanceof sa?u:Cl(u,"Operation");if(l=h,!Nk(h)||c===t)throw h;const g=r*Math.pow(2,c-1);await new Promise(m=>setTimeout(m,g))}throw l},Je=s=>{if(s){if(s instanceof Date)return s;if(typeof s?.toDate=="function")return s.toDate();if(typeof s=="string")return new Date(s)}},la=s=>{if(s==null)return s;if(Array.isArray(s))return s.map(la);if(s instanceof Date)return s;if(typeof s=="object"){const t={};return Object.keys(s).forEach(r=>{const l=s[r];l!==void 0&&(t[r]=la(l))}),t}return s},Tk=(s,t,r)=>{switch(r){case"same_date":return s.toDateString()===t.toDateString();case"same_week":const l=new Date(s);l.setDate(s.getDate()-s.getDay());const c=new Date(t);return c.setDate(t.getDate()-t.getDay()),l.toDateString()===c.toDateString();case"same_month":return s.getFullYear()===t.getFullYear()&&s.getMonth()===t.getMonth();default:return!1}},Sk=s=>{const r=new Date(s.getFullYear(),s.getMonth(),1).getDay();return Math.ceil((s.getDate()+r)/7)},jk=s=>{const t=s.getFullYear(),r=s.getMonth(),l=s.getDay(),c=new Date(t,r+1,0);for(let u=c.getDate();u>=1;u--)if(new Date(t,r,u).getDay()===l)return s.getDate()===u;return!1},Dk=(s,t,r,l)=>{const c=t-1;if(r==="last"){const u=new Date(s,c+1,0);for(let h=u.getDate();h>=1;h--){const g=new Date(s,c,h);if(g.getDay()===l)return g}}else{const h={first:1,second:2,third:3,fourth:4}[r];let g=0;const m=new Date(s,c+1,0).getDate();for(let p=1;p<=m;p++){const x=new Date(s,c,p);if(x.getDay()===l&&(g++,g===h))return x}}return null},Ek=(s,t="show",r=[])=>{let l=new Date(s);if(t==="show")return l;const c=Eo(l,r),u=za(l);if(!c&&!u)return l;let h=0;for(;h<15;){t==="before"?l.setDate(l.getDate()-1):l.setDate(l.getDate()+1);const g=Eo(l,r),m=za(l);if(!g&&!m)break;h++}return l},Oe={getTodos:async s=>xo(async()=>{try{if(!s)throw new Error("User ID is required");const t=et(Ae,`users/${s}/todos`),r=Dn(t,Ua("createdAt","desc")),c=(await Mt(r)).docs.map(u=>{const h=u.data();return{id:u.id,...h,createdAt:Je(h.createdAt)||new Date,updatedAt:Je(h.updatedAt)||new Date,dueDate:Je(h.dueDate),startDate:Je(h.startDate),completedAt:Je(h.completedAt),subTasks:h.subTasks?h.subTasks.map(g=>({...g,createdAt:Je(g.createdAt)||new Date,updatedAt:Je(g.updatedAt)||new Date,completedAt:g.completedAt?Je(g.completedAt):null})):[]}});return Ce.log("Firestore getTodos :",{count:c.length,uid:s}),c}catch(t){throw Ce.error("Firestore getTodos :",t),Cl(t,"getTodos")}}),addTodo:async(s,t)=>xo(async()=>{try{if(!t||!s.title?.trim())throw new Error("User ID and todo title are required");const r=et(Ae,`users/${t}/todos`),c={...la(s),createdAt:bt(),updatedAt:bt()},u=await El(r,c);return Ce.log("Firestore addTodo :",u.id),u.id}catch(r){throw Ce.error("Firestore addTodo :",r),Cl(r,"addTodo")}}),updateTodo:async(s,t,r)=>{try{const l=Nt(Ae,`users/${r}/todos`,s);if(!(await po(l)).exists()){Ce.warn(`  ${s}  .  .`);return}const u={...t,updatedAt:bt()};await ur(l,u)}catch(l){throw Ce.error("Firestore updateTodo :",l),l}},deleteTodo:async(s,t)=>{try{const r=Nt(Ae,`users/${t}/todos`,s);await wo(r)}catch(r){throw console.error(" Firestore deleteTodo :",r),r}},subscribeTodos:(s,t)=>{try{const r=et(Ae,`users/${s}/todos`),l=Dn(r,Ua("createdAt","desc"));return Dl(l,u=>{const h=u.docs.map(g=>{const m=g.data();return{...m,id:g.id,createdAt:Je(m.createdAt)||new Date,updatedAt:Je(m.updatedAt)||new Date,dueDate:Je(m.dueDate),startDate:Je(m.startDate),completedAt:Je(m.completedAt),subTasks:m.subTasks?m.subTasks.map(p=>({...p,createdAt:Je(p.createdAt)||new Date,updatedAt:Je(p.updatedAt)||new Date,completedAt:p.completedAt?Je(p.completedAt):null})):[]}});t(h)},u=>{console.error(" Firestore  :",u),t([])})}catch(r){return console.error(" Firestore subscribeTodos  :",r),t([]),()=>{}}},addSubTask:async(s,t,r)=>{const l=Nt(Ae,`users/${t}/todos`,r);await ur(l,{subTasks:n_(s),updatedAt:bt()})},updateSubTask:async(s,t,r,l)=>{const c=Nt(Ae,`users/${r}/todos`,l),u=await po(c);if(!u.exists())throw new Error("   .");const m=(u.data().subTasks||[]).map(p=>p.id===s?{...p,...t,updatedAt:new Date}:p);await ur(c,{subTasks:m,updatedAt:bt()})},deleteSubTask:async(s,t,r)=>{const l=Nt(Ae,`users/${t}/todos`,r),c=await po(l);if(!c.exists())throw new Error("   .");const g=(c.data().subTasks||[]).filter(m=>m.id!==s);await ur(l,{subTasks:g,updatedAt:bt()})},getRecurringTemplates:async s=>{const t=et(Ae,`users/${s}/recurringTemplates`),r=Dn(t,Ua("createdAt","desc"));return(await Mt(r)).docs.map(c=>({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate()||new Date,updatedAt:c.data().updatedAt?.toDate()||new Date}))},addRecurringTemplate:async(s,t)=>{const r=et(Ae,`users/${t}/recurringTemplates`),c={...la(s),createdAt:bt(),updatedAt:bt()};return(await El(r,c)).id},updateRecurringTemplate:async(s,t,r)=>{const l=Nt(Ae,`users/${r}/recurringTemplates`,s),c=la(t);await ur(l,{...c,updatedAt:bt()})},deleteRecurringTemplate:async(s,t)=>{const r=$a(Ae),l=Nt(Ae,`users/${t}/recurringTemplates`,s);r.delete(l);const c=et(Ae,`users/${t}/recurringInstances`),u=Dn(c,wu("templateId","==",s));(await Mt(u)).forEach(g=>r.delete(g.ref)),await r.commit()},subscribeProjectTemplates:(s,t)=>{try{Ce.log("   ",{uid:s});const r=et(Ae,`users/${s}/projectTemplates`),l=Dn(r,Ua("createdAt","desc"));return Dl(l,u=>{const h=u.docs.map(g=>{const m=g.data();return{id:g.id,...m,createdAt:Je(m.createdAt)||new Date,updatedAt:Je(m.updatedAt)||new Date}});Ce.log("   ",{count:h.length}),t(h)},u=>{Ce.error("   :",u),t([])})}catch(r){return Ce.error("    :",r),t([]),()=>{}}},addProjectTemplate:async(s,t)=>{const r=et(Ae,`users/${t}/projectTemplates`),c={...la(s),createdAt:bt(),updatedAt:bt()};return(await El(r,c)).id},updateProjectTemplate:async(s,t,r)=>{const l=Nt(Ae,`users/${r}/projectTemplates`,s),c=la(t);await ur(l,{...c,updatedAt:bt()})},deleteProjectTemplate:async(s,t)=>{const r=Nt(Ae,`users/${t}/projectTemplates`,s);await wo(r)},subscribeRecurringTemplates:(s,t)=>{const r=et(Ae,`users/${s}/recurringTemplates`),l=Dn(r,Ua("createdAt","desc"));return Dl(l,c=>{const u=c.docs.map(h=>({id:h.id,...h.data(),createdAt:Je(h.data().createdAt)||new Date,updatedAt:Je(h.data().updatedAt)||new Date}));t(u)})},getRecurringInstances:async s=>{const t=et(Ae,`users/${s}/recurringInstances`),r=Dn(t,Ua("date","asc"));return(await Mt(r)).docs.map(c=>({id:c.id,...c.data(),date:Je(c.data().date)||new Date,createdAt:Je(c.data().createdAt)||new Date,updatedAt:Je(c.data().updatedAt)||new Date,completedAt:Je(c.data().completedAt)}))},addRecurringInstance:async(s,t)=>{const r=et(Ae,`users/${t}/recurringInstances`),l=la(s);return(await El(r,{...l,createdAt:bt(),updatedAt:bt()})).id},updateRecurringInstance:async(s,t,r)=>{const l=Nt(Ae,`users/${r}/recurringInstances`,s),c=la(t);await ur(l,{...c,updatedAt:bt()})},deleteRecurringInstance:async(s,t)=>{const r=Nt(Ae,`users/${t}/recurringInstances`,s);await wo(r)},subscribeRecurringInstances:(s,t)=>{const r=et(Ae,`users/${s}/recurringInstances`),l=Dn(r,Ua("date","asc"));return Dl(l,c=>{const u=c.docs.map(h=>({id:h.id,...h.data(),date:Je(h.data().date)||new Date,createdAt:Je(h.data().createdAt)||new Date,updatedAt:Je(h.data().updatedAt)||new Date,completedAt:Je(h.data().completedAt)}));t(u)})},async _isExceptionDate(s,t,r,l){if(l||!t.exceptions)return!1;for(const c of t.exceptions)switch(c.type){case"date":if(c.values.includes(s.getDate()))return!0;break;case"weekday":if(c.values.includes(s.getDay()))return!0;break;case"week":const u=Sk(s);if(c.values.includes(u)||c.values.includes(-1)&&jk(s))return!0;break;case"month":if(c.values.includes(s.getMonth()+1))return!0;break;case"conflict":const h=c.values;for(const g of h)if(await this._hasConflictingInstance(s,t.id,g,r))return!0;break}return!1},async _hasConflictingInstance(s,t,r,l){const c=et(Ae,`users/${l}/recurringTemplates`),u=Dn(c,wu("title","==",r.targetTemplateTitle)),g=(await Mt(u)).docs.find(x=>x.id!==t);if(!g)return!1;const m={id:g.id,...g.data()},p=await this.generateInstancesForTemplate(m,l,!0,[]);for(const x of p)if(Tk(s,x.date,r.scope))return Ce.log(`[Conflict] ${s.toDateString()} on ${t} conflicts with ${m.title}`),!0;return!1},async generateInstancesForTemplate(s,t,r=!1,l=[]){if(!s.isActive)return[];const c=[],u=new Set,h=new Date,g=new Date(h);g.setFullYear(h.getFullYear()+1);let m=new Date(h.getFullYear(),h.getMonth(),1);for(;m<=g;){let p=null;if(s.recurrenceType==="daily")p=new Date(m);else if(s.recurrenceType==="weekly")m.getDay()===s.weekday&&(p=new Date(m));else if(s.recurrenceType==="monthly"){let x=null;if(s.monthlyPattern==="weekday"&&s.monthlyWeek&&s.monthlyWeekday!==void 0)x=Dk(m.getFullYear(),m.getMonth()+1,s.monthlyWeek,s.monthlyWeekday);else{const b=s.monthlyDate;if(b===-1)x=new Date(m.getFullYear(),m.getMonth()+1,0);else if(b===-2)x=_y(m.getFullYear(),m.getMonth()+1);else if(b===-3)x=ky(m.getFullYear(),m.getMonth()+1);else if(b&&b>0){const w=new Date(m.getFullYear(),m.getMonth(),b);w.getMonth()===m.getMonth()&&(x=w)}}x&&x.getFullYear()===m.getFullYear()&&x.getMonth()===m.getMonth()&&(p=x)}if(p&&p>=new Date(new Date().setHours(0,0,0,0))){let x=Ek(p,s.holidayHandling,l);if(!await this._isExceptionDate(x,s,t,r)){const w=`${x.getFullYear()}-${(x.getMonth()+1).toString().padStart(2,"0")}-${x.getDate().toString().padStart(2,"0")}`;u.has(w)||(c.push({id:`${s.id}_${w}`,templateId:s.id,date:x,completed:!1,createdAt:new Date,updatedAt:new Date}),u.add(w))}}s.recurrenceType==="monthly"?(m.setMonth(m.getMonth()+1),m.setDate(1)):m.setDate(m.getDate()+1)}return c},async _copyCollection(s,t,r){const l=et(Ae,`users/${s}/${r}`),c=et(Ae,`users/${t}/${r}`),u=await Mt(l),h=$a(Ae);u.forEach(g=>{const m=g.data();h.set(Nt(c,g.id),{...m,createdAt:m.createdAt||bt(),updatedAt:bt()})}),await h.commit()},async _deleteCollection(s,t){const r=et(Ae,`users/${s}/${t}`),l=await Mt(r),c=$a(Ae);l.forEach(u=>{c.delete(u.ref)}),await c.commit()},migrateUserData:async(s,t)=>xo(async()=>{try{if(!s||!t)throw new Error("Old UID and New UID are required for migration.");if(s===t)throw new Error("Cannot migrate data to the same UID.");Ce.log(`Starting data migration from old UID: ${s} to new UID: ${t}`),await Oe._copyCollection(s,t,"todos"),await Oe._copyCollection(s,t,"recurringTemplates"),await Oe._copyCollection(s,t,"recurringInstances"),await Oe._copyCollection(s,t,"projectTemplates"),Ce.log(`Deleting old data for UID: ${s}`),await Oe._deleteCollection(s,"todos"),await Oe._deleteCollection(s,"recurringTemplates"),await Oe._deleteCollection(s,"recurringInstances"),await Oe._deleteCollection(s,"projectTemplates"),Ce.log(`Data migration completed successfully from ${s} to ${t}`)}catch(r){throw Ce.error("Data migration failed:",r),Cl(r,"migrateUserData")}}),regenerateRecurringInstances:async(s,t)=>xo(async()=>{try{if(!t||!s)throw new Error("User ID and template ID are required");Ce.log("    ",{templateId:s,uid:t});const r=et(Ae,`users/${t}/recurringInstances`),l=Nt(Ae,`users/${t}/recurringTemplates`,s),c=Dn(r,wu("templateId","==",s)),u=await Mt(c),h=new Map;u.forEach(U=>{h.set(U.id,U.data())}),Ce.log("    ",{count:h.size});const g=await po(l);if(!g.exists())throw new Error(`Template ${s} not found`);const m={id:g.id,...g.data()},p=et(Ae,`users/${t}/custom_holidays`),b=(await Mt(p)).docs.map(U=>{const Y=U.data();return{id:U.id,date:Y.date,name:Y.name,isRecurring:Y.isRecurring,createdAt:Y.createdAt}}),w=await Oe.generateInstancesForTemplate(m,t,!1,b);Ce.log("   ",{count:w.length});const L=$a(Ae),T=new Set;w.forEach(U=>{const Y=Nt(r,U.id),k=h.get(U.id);k?(T.add(U.id),L.update(Y,{...U,completed:k.completed||!1,completedAt:k.completedAt||null,updatedAt:bt()})):(T.add(U.id),L.set(Y,{...U,createdAt:bt(),updatedAt:bt()}))}),h.forEach((U,Y)=>{if(!T.has(Y)){const k=Je(U.date),S=new Date;S.setHours(0,0,0,0),U.completed||k&&k>=S?(L.delete(Nt(r,Y)),Ce.log("    (  )",{id:Y})):Ce.log("     ",{id:Y})}}),await L.commit(),Ce.log("    ",{templateId:s})}catch(r){throw Ce.error("    :",r),Cl(r,"regenerateRecurringInstances")}})},Au={cleanupOrphanedInstances:async s=>{try{console.log("    ");const t=et(Ae,`users/${s}/recurringTemplates`),r=await Mt(t),l=new Set;r.forEach(x=>{l.add(x.id)}),console.log(` : ${l.size}`);const c=et(Ae,`users/${s}/recurringInstances`),u=await Mt(c),h=[];u.forEach(x=>{const b=x.data();l.has(b.templateId)||(h.push(x.id),console.log(`  : ${x.id} (: ${b.templateId})`))});const g=et(Ae,`users/${s}/todos`),m=await Mt(g),p=[];if(m.forEach(x=>{const b=x.data();b._templateId&&!l.has(b._templateId)&&(p.push(x.id),console.log(`  : ${b.title} (: ${b._templateId})`))}),h.length>0||p.length>0){const x=$a(Ae);h.forEach(b=>{const w=Nt(Ae,`users/${s}/recurringInstances`,b);x.delete(w)}),p.forEach(b=>{const w=Nt(Ae,`users/${s}/todos`,b);x.delete(w)}),await x.commit(),console.log(`  :  ${h.length},  ${p.length}`)}else console.log("    ");return{orphanedInstances:h.length,orphanedTodos:p.length,totalCleaned:h.length+p.length}}catch(t){throw console.error("    :",t),t}},validateTemplateConsistency:async s=>{try{console.log("     ");const t=et(Ae,`users/${s}/recurringTemplates`),r=await Mt(t),l=et(Ae,`users/${s}/recurringInstances`),c=await Mt(l),u=et(Ae,`users/${s}/todos`),h=await Mt(u),g=new Map;return r.forEach(m=>{const p=m.data();g.set(m.id,{templateTitle:p.title,instances:0,todos:0,isActive:p.isActive!==!1})}),c.forEach(m=>{const x=m.data().templateId;g.has(x)&&g.get(x).instances++}),h.forEach(m=>{const x=m.data()._templateId;x&&g.has(x)&&g.get(x).todos++}),console.log(`
   :`),console.log("=".repeat(60)),g.forEach((m,p)=>{console.log(`${m.templateTitle} (${p}):`),console.log(`  : ${m.isActive}`),console.log(`  : ${m.instances}`),console.log(`  : ${m.todos}`),m.instances>0&&m.todos===0&&console.log("   :     "),console.log("")}),g}catch(t){throw console.error("    :",t),t}},regenerateAllInstances:async s=>{try{console.log("    ");const t=et(Ae,`users/${s}/recurringInstances`),r=await Mt(t),l=$a(Ae);r.forEach(c=>{l.delete(c.ref)}),await l.commit(),console.log(`   ${r.size}  `),console.log("       ")}catch(t){throw console.error("   :",t),t}},smartCleanupInstances:async s=>{try{console.log("    "),console.log("    ...");const t=et(Ae,`users/${s}/recurringTemplates`),r=await Mt(t),l=new Set;r.forEach(m=>{const p=m.data();p.isActive!==!1&&(l.add(m.id),console.log(` : ${p.title} (${m.id})`))}),console.log(` : ${l.size}`),console.log("2     ...");const c=et(Ae,`users/${s}/recurringInstances`),u=await Mt(c),h=[],g=[];if(u.forEach(m=>{const p=m.data(),x=p.templateId,b=p.completed===!0;!l.has(x)?h.push(m.id):g.push(m.id)}),console.log(`  :  ${h.length},  ${g.length}`),h.length>0){console.log("3    ...");const m=[];let p=$a(Ae),x=0;h.forEach(b=>{const w=Nt(Ae,`users/${s}/recurringInstances`,b);p.delete(w),x++,x>=500&&(m.push(p),p=$a(Ae),x=0)}),x>0&&m.push(p);for(let b=0;b<m.length;b++)await m[b].commit(),console.log(` ${b+1}/${m.length}  `);console.log(`  ${h.length}   `)}else console.log("  ");return console.log("   !"),console.log(`-  : ${l.size}`),console.log(`-  : ${h.length}`),console.log(`-  : ${g.length}`),console.log(`-  : ${u.size}`),{activeTemplates:l.size,deletedInstances:h.length,keptInstances:g.length,totalInstances:u.size}}catch(t){throw console.error("    :",t),t}}},Cy=I.createContext(void 0),Ck=({children:s})=>{const[t,r]=I.useState([]),[l,c]=I.useState(!0),{currentUser:u}=Nn();I.useEffect(()=>{if(!u){r([]),c(!1);return}const p=Dn(et(Ae,`users/${u.uid}/custom_holidays`),Ua("date","asc")),x=Dl(p,b=>{const w=b.docs.map(L=>({id:L.id,...L.data()}));r(w),c(!1)},b=>{console.error("Error fetching custom holidays:",b),c(!1)});return()=>x()},[u]);const h=async(p,x,b=!1)=>{if(u)try{await El(et(Ae,`users/${u.uid}/custom_holidays`),{date:p,name:x,isRecurring:b,createdAt:bt()})}catch(w){throw console.error("Error adding custom holiday:",w),w}},g=async p=>{if(u)try{await wo(Nt(Ae,`users/${u.uid}/custom_holidays`,p))}catch(x){throw console.error("Error deleting custom holiday:",x),x}},m=p=>t.find(x=>{const b=new Date(x.date);b.setHours(0,0,0,0);const w=new Date(p);return w.setHours(0,0,0,0),b.getTime()===w.getTime()});return i.jsx(Cy.Provider,{value:{customHolidays:t,addCustomHoliday:h,deleteCustomHoliday:g,getCustomHoliday:m,loading:l},children:s})},Qo=()=>{const s=I.useContext(Cy);if(s===void 0)throw new Error("useCustomHolidays must be used within a CustomHolidayProvider");return s},Ay=I.createContext(void 0),Ak={todos:[],recurringTemplates:[],recurringInstances:[],loading:!1,error:null,syncing:!1};function Rk(s,t){switch(t.type){case"SET_LOADING":return{...s,loading:t.payload};case"SET_SYNCING":return{...s,syncing:t.payload};case"SET_ERROR":return{...s,error:t.payload};case"SET_TODOS":const r=t.payload.filter((u,h,g)=>g.findIndex(m=>m.id===u.id)===h);return r.length!==t.payload.length&&console.warn(` SET_TODOS  : ${t.payload.length}  ${r.length}`),{...s,todos:r};case"ADD_TODO":return s.todos.some(u=>u.id===t.payload.id)?(console.warn(` ADD_TODO  : ${t.payload.id}  `),s):{...s,todos:[t.payload,...s.todos]};case"UPDATE_TODO":return{...s,todos:s.todos.map(u=>u.id===t.payload.id?{...u,...t.payload.updates,updatedAt:new Date}:u)};case"DELETE_TODO":return{...s,todos:s.todos.filter(u=>u.id!==t.payload)};case"TOGGLE_TODO":{const u=new Date;return{...s,todos:s.todos.map(h=>{if(h.id===t.payload){const g=!h.completed;return g&&setTimeout(()=>{ua(async()=>{const{notificationManager:m}=await Promise.resolve().then(()=>WS);return{notificationManager:m}},void 0,import.meta.url).then(({notificationManager:m})=>{m.showCompletionCelebration(h)})},0),{...h,completed:g,completedAt:g?u:void 0,updatedAt:u}}return h})}}case"ADD_SUBTASK":return{...s,todos:s.todos.map(u=>u.id===t.payload.todoId?{...u,subTasks:[...u.subTasks||[],t.payload.subTask],updatedAt:new Date}:u)};case"UPDATE_SUBTASK":return{...s,todos:s.todos.map(u=>u.id===t.payload.todoId?{...u,subTasks:u.subTasks?.map(h=>h.id===t.payload.subTaskId?{...h,...t.payload.updates,updatedAt:new Date}:h)||[],updatedAt:new Date}:u)};case"DELETE_SUBTASK":return{...s,todos:s.todos.map(u=>u.id===t.payload.todoId?{...u,subTasks:u.subTasks?.filter(h=>h.id!==t.payload.subTaskId)||[],updatedAt:new Date}:u)};case"TOGGLE_SUBTASK":return{...s,todos:s.todos.map(u=>u.id===t.payload.todoId?{...u,subTasks:u.subTasks?.map(h=>h.id===t.payload.subTaskId?{...h,completed:!h.completed,updatedAt:new Date}:h)||[],updatedAt:new Date}:u)};case"SET_RECURRING_TEMPLATES":return{...s,recurringTemplates:t.payload};case"ADD_RECURRING_TEMPLATE":return{...s,recurringTemplates:[t.payload,...s.recurringTemplates]};case"UPDATE_RECURRING_TEMPLATE":return{...s,recurringTemplates:s.recurringTemplates.map(u=>u.id===t.payload.id?{...u,...t.payload.updates,updatedAt:new Date}:u)};case"DELETE_RECURRING_TEMPLATE":return{...s,recurringTemplates:s.recurringTemplates.filter(u=>u.id!==t.payload),recurringInstances:s.recurringInstances.filter(u=>u.templateId!==t.payload)};case"SET_RECURRING_INSTANCES":console.log(" SET_RECURRING_INSTANCES - Firebase  state "),console.log(`     : ${s.recurringInstances.length}`),console.log(`    Firebase  : ${t.payload.length}`);const c=t.payload.find(u=>u.id==="vCyWLYn3LuDq1nVUPSyE_2025-08-26");return c&&console.log(`    Firebase  : completed=${c.completed}`),{...s,recurringInstances:t.payload};case"UPDATE_RECURRING_INSTANCE":return{...s,recurringInstances:s.recurringInstances.map(u=>u.id===t.payload.id?{...u,...t.payload.updates,updatedAt:new Date}:u)};case"GENERATE_RECURRING_INSTANCES":{let u=[],h=[];try{const g=localStorage.getItem("recurringInstances");g&&(h=JSON.parse(g).map(p=>({...p,date:new Date(p.date),createdAt:new Date(p.createdAt),updatedAt:new Date(p.updatedAt),completedAt:p.completedAt?new Date(p.completedAt):void 0})),console.log(" localStorage   :",h.length,""))}catch(g){console.error(" localStorage   :",g)}return console.log("   -    "),s.recurringTemplates.filter(g=>g.isActive).forEach(g=>{try{const p=cs.generateInstances(g).map(x=>{const b=h.find(w=>w.id===x.id);return b?(console.log(` localStorage   : ${x.id} (: ${b.completed})`),{...x,completed:b.completed,completedAt:b.completedAt,updatedAt:b.updatedAt}):x});u=[...u,...p]}catch(m){console.error(` ${g.id}   :`,m)}}),{...s,recurringInstances:u}}default:return s}}const Ok=({children:s})=>{const[t,r]=I.useReducer(Rk,Ak),{currentUser:l,loading:c}=Nn(),{customHolidays:u}=Qo(),[h,g]=I.useState(""),[m,p]=I.useState("all"),[x,b]=I.useState("all"),[w,L]=I.useState([]),T=I.useRef(null),U=I.useRef(null),Y=I.useRef(null);I.useEffect(()=>{if(c)return;if(!l){console.log("  "),k();return}return console.log("   - :",l.uid),r({type:"SET_LOADING",payload:!0}),T.current&&(T.current(),T.current=null),U.current&&(U.current(),U.current=null),Y.current&&(Y.current(),Y.current=null),(async()=>{try{if(await R(),!l)return;console.log("     - :",l.uid),console.log(" Firestore    -  ID:",l.uid),T.current=Oe.subscribeTodos(l.uid,re=>{console.log(" Firestore   :",re.length,""),console.log(" Firestore    ID:",re.map(te=>te.id)),r({type:"SET_TODOS",payload:re}),r({type:"SET_LOADING",payload:!1}),r({type:"SET_ERROR",payload:null})}),U.current=Oe.subscribeRecurringTemplates(l.uid,re=>{r({type:"SET_RECURRING_TEMPLATES",payload:re}),console.log("  Firestore :",re.length,"")}),console.log("      ..."),console.log("       ..."),console.log("   :"),console.log("  UID:",l.uid),console.log("  Email:",l.email),console.log("  DisplayName:",l.displayName),console.log(" Firestore : users/"+l.uid+"/recurringInstances");const P=await Oe.getRecurringInstances(l.uid),q=P.find(re=>re.id==="PUH4xT3lVY5aK2vuQyUe_2025-08-21");q&&(console.log("    :"),console.log("  completed:",q.completed,typeof q.completed),console.log("  completedAt:",q.completedAt),console.log("   :",JSON.stringify(q,null,2)),console.log("    : users/"+l.uid+"/recurringInstances/PUH4xT3lVY5aK2vuQyUe_2025-08-21"));const F=P.find(re=>re.id==="vCyWLYn3LuDq1nVUPSyE_2025-08-26");F?(console.log("    :"),console.log("  ID:",F.id),console.log("  completed:",F.completed,typeof F.completed),console.log("  completedAt:",F.completedAt),console.log("  updatedAt:",F.updatedAt)):(console.log("      "),console.log("    :",P.map(re=>re.id)));const le=Oe.subscribeRecurringInstances(l.uid,re=>{console.log("     - :",re.length),console.log("   :",new Date().toISOString());const te=re.filter(De=>De.templateId==="vCyWLYn3LuDq1nVUPSyE");te.length>0&&(console.log(" Firebase  - :"),te.forEach(De=>{console.log(`   ID: ${De.id}, : ${De.completed}`);const be=t.recurringInstances.find(me=>me.id===De.id);be&&be.completed!==De.completed&&console.log(`     : (${be.completed}) vs Firebase(${De.completed})`)})),r({type:"SET_RECURRING_INSTANCES",payload:re}),console.log(" Firebase   dispatch ")});le?(console.log("      "),Y.current=le,setTimeout(async()=>{try{console.log(" Firebase   ...");const re=await Oe.getRecurringInstances(l.uid),te=re.find(De=>De.id==="vCyWLYn3LuDq1nVUPSyE_2025-08-26");te&&console.log(` Firebase : ID=${te.id}, =${te.completed}`),r({type:"SET_RECURRING_INSTANCES",payload:re}),console.log(" Firebase   ")}catch(re){console.error(" Firebase   :",re)}},3e3)):console.error("      ")}catch(P){console.error("Firestore  :",P),r({type:"SET_LOADING",payload:!1}),r({type:"SET_ERROR",payload:"Firebase  ."})}})(),()=>{T.current&&T.current(),U.current&&U.current(),Y.current&&Y.current()}},[l,c]),I.useEffect(()=>{if(t.recurringTemplates.length===0)return;console.log("     -   "),console.log("   :",t.recurringTemplates.length),(async()=>{try{if(!l){const P=[];for(const q of t.recurringTemplates)try{console.log(`   : ${q.title}`);const F=cs.generateInstances(q,u);P.push(...F),console.log(`  ${q.title}: ${F.length}  `)}catch(F){console.error(`  ${q.title}   :`,F)}console.log("   :",P.length),r({type:"SET_RECURRING_INSTANCES",payload:P});return}for(const P of t.recurringTemplates)try{console.log(` Firebase  : ${P.title}`),await Oe.regenerateRecurringInstances(P.id,l.uid)}catch(q){console.error(` Firebase  ${P.title}  :`,q)}console.log("    ")}catch(P){console.error("    :",P)}})()},[t.recurringTemplates,l,u]),I.useEffect(()=>{if(!l||t.recurringInstances.length===0)return;const P=setTimeout(async()=>{try{console.log(`   Firebase   ... ( ${t.recurringInstances.length})`);const q=await Oe.getRecurringInstances(l.uid),F=new Set(q.map(re=>re.id));console.log(` Firebase  : ${q.length}`),console.log(`  : ${t.recurringInstances.length}`);const le=t.recurringInstances.filter(re=>{const te=!F.has(re.id);return te&&console.log(`   : ${re.id} (: ${re.date})`),te});if(le.length>0){console.log(` Firebase    ${le.length}  ...`);for(const re of le)try{const te=await Oe.addRecurringInstance({...re,id:re.id},l.uid);console.log(`   Firebase  : ${re.id} -> Firestore ID: ${te}`)}catch(te){console.error(`   Firebase  : ${re.id}`,te)}console.log("   Firebase  !")}else console.log("     Firebase  ")}catch(q){console.error("   Firebase  :",q)}},500);return()=>clearTimeout(P)},[t.recurringInstances,l]);const k=()=>{try{if(console.log("=== localStorage    ==="),l){console.log("   -  Firebase  "),r({type:"SET_TODOS",payload:[]}),r({type:"SET_RECURRING_TEMPLATES",payload:[]}),r({type:"SET_LOADING",payload:!1});return}if(l)console.log("  - localStorage    (Firestore )");else{const j=localStorage.getItem("todos");if(j){const q=JSON.parse(j).map(F=>({...F,createdAt:new Date(F.createdAt),updatedAt:new Date(F.updatedAt),dueDate:F.dueDate?new Date(F.dueDate):void 0,startDate:F.startDate?new Date(F.startDate):void 0,completedAt:F.completedAt?new Date(F.completedAt):void 0}));console.log("localStorage   ():",q.length,""),r({type:"SET_TODOS",payload:q})}}if(l)console.log("   - localStorage     (Firestore )");else{const j=localStorage.getItem("recurringTemplates");if(j){const q=JSON.parse(j).map(F=>({...F,createdAt:new Date(F.createdAt),updatedAt:new Date(F.updatedAt)}));console.log("localStorage   :",q.length,""),r({type:"SET_RECURRING_TEMPLATES",payload:q})}}r({type:"SET_LOADING",payload:!1}),console.log("=== localStorage    ===")}catch(j){console.error("localStorage   :",j),r({type:"SET_ERROR",payload:"localStorage     ."}),r({type:"SET_LOADING",payload:!1})}},S=()=>{if(l){console.log("  - localStorage  ");return}try{localStorage.setItem("todos",JSON.stringify(t.todos)),localStorage.setItem("recurringTemplates",JSON.stringify(t.recurringTemplates)),console.log("localStorage    ()")}catch(j){console.error("localStorage  :",j)}},R=async()=>{if(l)try{if(console.log("=== localStorage  Firestore   ==="),!l)return;if(console.log("   - localStorage   "),localStorage.getItem(`migrated_${l.uid}`)){console.log("   :",l.uid);return}console.log("  - :",l.uid);const P=localStorage.getItem("todos"),q=localStorage.getItem("recurringTemplates");if(P||q){if(console.log(" localStorage  "),P){const le=JSON.parse(P);if(le.length>0){console.log(`${le.length}  Firestore `);for(const re of le)try{await Oe.addTodo({...re,createdAt:new Date(re.createdAt),updatedAt:new Date(re.updatedAt),dueDate:re.dueDate?new Date(re.dueDate):void 0,startDate:re.startDate?new Date(re.startDate):void 0,completedAt:re.completedAt?new Date(re.completedAt):void 0},l.uid),console.log(`  : ${re.title}`)}catch(te){console.error(`  : ${re.title}`,te)}}}if(q){const le=JSON.parse(q);if(le.length>0){console.log(`${le.length}   Firestore `);for(const re of le)try{await Oe.addRecurringTemplate({...re,createdAt:new Date(re.createdAt),updatedAt:new Date(re.updatedAt)},l.uid),console.log(`   : ${re.title}`)}catch(te){console.error(`   : ${re.title}`,te)}}}const F={todos:P?JSON.parse(P):[],recurringTemplates:q?JSON.parse(q):[],migratedAt:new Date().toISOString(),userId:l.uid};localStorage.setItem(`migrated_backup_${l.uid}`,JSON.stringify(F)),localStorage.setItem(`migrated_${l.uid}`,new Date().toISOString()),localStorage.removeItem("todos"),localStorage.removeItem("recurringTemplates"),console.log("===  : localStorage   ===")}else console.log(" localStorage  "),localStorage.setItem(`migrated_${l.uid}`,new Date().toISOString())}catch(j){console.error(" :",j),r({type:"SET_ERROR",payload:"    ."})}};I.useEffect(()=>{if(l){console.log("   - simpleRecurringSystem  !");return}cs.setTemplates(t.recurringTemplates)},[t.recurringTemplates,l]),I.useEffect(()=>{!l&&!c&&(console.log(" localStorage   - todos :",t.todos.length),S())},[t.todos,l,c]),I.useEffect(()=>{!l&&!c&&(console.log(" localStorage   -  :",t.recurringTemplates.length),S())},[t.recurringTemplates,l,c]);const D=async()=>{if(l){r({type:"SET_SYNCING",payload:!0});try{const j=await Oe.getTodos(l.uid);r({type:"SET_TODOS",payload:j}),r({type:"SET_ERROR",payload:null}),setTimeout(()=>{Se()},500),typeof window<"u"&&(window.initializeOrderValues=Se,window.forceFirebaseSync=async()=>{if(!l){console.log("  ");return}try{console.log("  Firebase   ...");const P=await Oe.getRecurringInstances(l.uid),q=P.find(F=>F.id==="vCyWLYn3LuDq1nVUPSyE_2025-08-26");q&&console.log("   - Firebase  :",q.completed),r({type:"SET_RECURRING_INSTANCES",payload:P}),console.log("  Firebase  !"),setTimeout(()=>{const F=P.find(le=>le.id==="vCyWLYn3LuDq1nVUPSyE_2025-08-26");F&&console.log("    :",F.completed)},1e3)}catch(P){console.error("  Firebase  :",P)}},console.log("   : window.forceFirebaseSync()"))}catch(j){console.error("Firestore  :",j),r({type:"SET_ERROR",payload:"   ."})}finally{r({type:"SET_SYNCING",payload:!1})}}},_=async j=>{console.log("addTodo :",j,":",l?.uid);const P=F=>{const le=t.todos.filter(te=>te.priority===F&&!te.completed);if(le.length===0)return{urgent:0,high:1e3,medium:2e3,low:3e3}[F]||2e3;const re=Math.min(...le.map(te=>te.order||999));return Math.max(0,re-1)},q={...j,id:Du(),createdAt:new Date,updatedAt:new Date,order:P(j.priority)};try{if(l){console.log("Firestore   :",q.title);try{const F=await Oe.addTodo(q,l.uid);console.log("Firestore   , ID:",F);const le={...q,id:F};r({type:"ADD_TODO",payload:le}),console.log("     - Firestore ID :",F)}catch(F){throw console.error("Firestore  :",F),F}}else console.log(" :   "),r({type:"ADD_TODO",payload:q}),console.log("   - localStorage   ")}catch(F){console.error("  :",F),r({type:"SET_ERROR",payload:"    ."})}},$=async(j,P)=>{try{l?await Oe.updateTodo(j,P,l.uid):(console.log(" :   "),r({type:"UPDATE_TODO",payload:{id:j,updates:P}}))}catch(q){console.error("  :",q),r({type:"SET_ERROR",payload:"    ."})}},C=async j=>{try{const q=[...t.todos,...ce()].find(le=>le.id===j);if(j.startsWith("recurring_")||q?._isRecurringInstance){console.log('   "" :',j);let le=q?._instanceId;if(!le&&j.startsWith("recurring_")&&(le=j.replace("recurring_","")),!le){console.error("  ID      :",j);return}const re={skipped:!0,skippedReason:"manual_deletion"},te=t.recurringInstances.map(De=>De.id===le?{...De,...re}:De);if(r({type:"SET_RECURRING_INSTANCES",payload:te}),l)try{await Oe.updateRecurringInstance(le,re,l.uid),console.log(' Firestore   "skipped"  :',le)}catch(De){console.error(" Firestore    :",De),r({type:"SET_RECURRING_INSTANCES",payload:t.recurringInstances}),r({type:"SET_ERROR",payload:"   ."})}return}l?await Oe.deleteTodo(j,l.uid):r({type:"DELETE_TODO",payload:j}),console.log("    :",j)}catch(P){console.error("  :",P),r({type:"SET_ERROR",payload:"    ."})}},ee=async j=>{console.log("   :",j),(j.includes("")||j.includes("vCyWLYn3LuDq1nVUPSyE"))&&(console.log("   !"),console.log("    ID:",j));const q=[...t.todos,...ce()].find(te=>te.id===j),F=t.todos.find(te=>te.id===j);if(F&&F.startDate&&F.dueDate&&!F._isRecurringInstance){console.log("   :",j,":",F.startDate,":",F.dueDate);const te={completed:!F.completed,...F.completed?{completedAt:zm()}:{completedAt:new Date}};try{r({type:"TOGGLE_TODO",payload:j}),l?(await Oe.updateTodo(j,te,l.uid),console.log("   Firestore  :",j)):console.log("  :    "),console.log(`    : ${j}`);return}catch(De){console.error("    :",De),r({type:"TOGGLE_TODO",payload:j}),r({type:"SET_ERROR",payload:"     ."});return}}if(q&&q._isRecurringInstance){console.log("   :",j);let te=q._instanceId;!te&&j.startsWith("recurring_")?(te=j.replace("recurring_",""),console.log(" ID  ID :",te)):console.log("   ID:",te);const De=t.recurringInstances.find(be=>be.id===te);if(De){console.log("   :",De);const be={...De,completed:!De.completed,completedAt:De.completed?void 0:new Date,updatedAt:new Date};if(l)try{console.log(` Firebase     : ${te}`),console.log("  :",{completed:be.completed,completedAt:be.completedAt});const me={completed:be.completed};be.completedAt===void 0?(console.log(" completedAt undefined -> null "),me.completedAt=null):(console.log(" completedAt :",be.completedAt),me.completedAt=be.completedAt),console.log("   :",me),console.log("  UI     ");const Ne=t.recurringInstances.map(fe=>fe.id===te?be:fe);r({type:"SET_RECURRING_INSTANCES",payload:Ne}),console.log("      (Firebase   )"),console.log(` Firestore   - instanceId: ${te}`),console.log("  :",me),console.log(`   : ${new Date().toISOString()}`),await Oe.updateRecurringInstance(te,me,l.uid),console.log("    Firebase  "),console.log(`   : ${new Date().toISOString()}`),q?.title.includes("")&&console.log("   :",be.completed),te.includes("weekly_work_report")&&console.log(`  Firestore : completed=${me.completed}`),console.log(" Firestore   -   ")}catch(me){console.error(" Firebase  :",me),r({type:"SET_RECURRING_INSTANCES",payload:t.recurringInstances}),r({type:"SET_ERROR",payload:"      ."})}else{const me=t.recurringInstances.map(Ne=>Ne.id===te?be:Ne);r({type:"SET_RECURRING_INSTANCES",payload:me}),console.log("   - localStorage  ,  ")}console.log("     ");return}else{console.log("   .   :",te);const be=te.split("_");if(be.length>=2){const me=be[0],Ne=be.slice(1).join("_"),fe=t.recurringTemplates.find(ke=>ke.id===me);if(fe){console.log("  :",fe);const ke={id:te,templateId:me,date:new Date(Ne),completed:!0,completedAt:new Date,createdAt:new Date,updatedAt:new Date};if(l)try{console.log(` Firebase     : ${te}`),console.log("   :",ke);const He=[...t.recurringInstances,ke];r({type:"SET_RECURRING_INSTANCES",payload:He}),console.log("       "),await Oe.updateRecurringInstance(te,{templateId:ke.templateId,date:ke.date,completed:ke.completed,completedAt:ke.completedAt},l.uid),console.log("     Firebase  "),console.log("      -   ")}catch(He){console.error("   Firebase  :",He),r({type:"SET_RECURRING_INSTANCES",payload:t.recurringInstances}),r({type:"SET_ERROR",payload:"       ."})}else{const He=[...t.recurringInstances,ke];r({type:"SET_RECURRING_INSTANCES",payload:He}),console.log("   - localStorage  ,  ")}console.log("     ");return}else console.error("    :",me)}else console.error("  ID  :",te);console.error("     :",te),console.log("   :",t.recurringInstances.map(me=>me.id)),console.log("   :",t.recurringTemplates.map(me=>me.id));return}}const le=t.todos.find(te=>te.id===j);if(!le){console.error("Todo not found:",j);return}const re={completed:!le.completed,...le.completed?{completedAt:zm()}:{completedAt:new Date}};try{r({type:"TOGGLE_TODO",payload:j});const De=[...t.todos,...ce()].find(me=>me.id===j),be=j.startsWith("recurring_")||De?._isRecurringInstance;l&&!be?(await Oe.updateTodo(j,re,l.uid),console.log("Firestore  :",j)):be?(console.log("   :",j),re.order!==void 0&&(console.log("  order :",j," order:",re.order),r({type:"UPDATE_RECURRING_INSTANCE",payload:{id:j,updates:{order:re.order}}}))):console.log(" :   "),console.log(`  : ${j} (: ${be})`)}catch(te){console.error("  :",te),r({type:"TOGGLE_TODO",payload:j}),r({type:"SET_ERROR",payload:"     ."})}},ie=async(j,P)=>{const q={id:Du(),title:P,completed:!1,priority:"medium",createdAt:new Date,updatedAt:new Date};try{l?await Oe.addSubTask(q,l.uid,j):r({type:"ADD_SUBTASK",payload:{todoId:j,subTask:q}})}catch(F){console.error("  :",F),r({type:"SET_ERROR",payload:"     ."})}},xe=async(j,P,q)=>{try{l?await Oe.updateSubTask(P,q,l.uid,j):r({type:"UPDATE_SUBTASK",payload:{todoId:j,subTaskId:P,updates:q}})}catch(F){console.error("  :",F),r({type:"SET_ERROR",payload:"     ."})}},_e=async(j,P)=>{try{l?await Oe.deleteSubTask(P,l.uid,j):r({type:"DELETE_SUBTASK",payload:{todoId:j,subTaskId:P}})}catch(q){console.error("  :",q),r({type:"SET_ERROR",payload:"     ."})}},ve=async(j,P)=>{console.log("   :",{todoId:j,subTaskId:P});const F=t.todos.find(te=>te.id===j)?.subTasks?.find(te=>te.id===P);if(!F){console.error("    :",{todoId:j,subTaskId:P});return}const le=!F.completed;console.log("  :",{:F.completed,:le,:F.completedAt});const re={completed:le,completedAt:le?new Date:null};console.log("  :",re),await xe(j,P,re)},he=j=>{const P=new Map,q=[];j.forEach(le=>{const re=le._isRecurringInstance||le.id.startsWith("recurring_"),te=le._templateId;re&&te?(P.has(te)||P.set(te,[]),P.get(te).push(le)):q.push(le)});const F=[];return P.forEach(le=>{const re=le.filter(De=>De.completed);F.push(...re);const te=le.filter(De=>!De.completed);te.length>0&&(te.sort((De,be)=>{const me=De.startDate?new Date(De.startDate).getTime():0,Ne=be.startDate?new Date(be.startDate).getTime():0;return me-Ne}),F.push(te[0]),te.length>1&&console.log(`  : ${te[0].title} (), ${te.length-1} `))}),[...q,...F]},Te=j=>{const P=j?new Date(j):new Date;P.setHours(0,0,0,0),console.log(" getTodayTodos ,  :",P.toDateString());const q=t.todos.filter(be=>{if(console.log(`  : "${be.title}"`),console.log(`  startDate: ${be.startDate?new Date(be.startDate).toDateString():"null"}`),console.log(`  dueDate: ${be.dueDate?new Date(be.dueDate).toDateString():"null"}`),console.log(`  completed: ${be.completed}`),be.completed){if(be.completedAt){const fe=new Date(be.completedAt);if(fe.setHours(0,0,0,0),fe.getTime()===P.getTime())return!0}return be.subTasks&&be.subTasks.length>0&&be.subTasks.some(ke=>{if(ke.completed&&ke.completedAt&&ke.completedAt!==null)try{const He=new Date(ke.completedAt);return He.setHours(0,0,0,0),He.getTime()===P.getTime()}catch{return!1}return!1})?(console.log(` "${be.title}" -    `),!0):!1}const me=be.startDate?new Date(be.startDate):null,Ne=be.dueDate?new Date(be.dueDate):null;if(me&&me.setHours(0,0,0,0),Ne&&Ne.setHours(0,0,0,0),console.log(`   startDate: ${me?me.toDateString():"null"}`),console.log(`   dueDate: ${Ne?Ne.toDateString():"null"}`),me&&Ne){const fe=P.getTime()>=me.getTime()&&P.getTime()<=Ne.getTime();return console.log(`   : "${be.title}"`),console.log(`  : ${me.toDateString()}, : ${Ne.toDateString()}`),console.log(`  : ${P.toDateString()},   : ${fe}`),fe}return me&&!Ne?P.getTime()>=me.getTime():!me&&Ne?Ne.getTime()>=P.getTime()?(console.log(`   : "${be.title}" -  `),console.log(`  : ${Ne.toDateString()}, : ${P.toDateString()}`),!0):(console.log(`   : "${be.title}" -   `),!1):!be.dueDate&&!be.startDate}),le=ce().filter(be=>{if(be.startDate){const me=new Date(be.startDate);if(me.setHours(0,0,0,0),me.getTime()===P.getTime())return!0;if(me.getTime()<P.getTime()&&!be.completed)return console.log(`   : "${be.title}" (${me.toLocaleDateString()})`),!0}return!1}),re=new Set,De=[...q,...le].filter(be=>re.has(be.id)?(console.warn(`     : ${be.id}`),!1):(re.add(be.id),!0));return he(De)},Ee=()=>{const j=new Date;j.setHours(0,0,0,0),console.log(" getWeekTodos ");const q=ce().filter(fe=>fe.title.includes(""));q.length>0&&console.log(" getWeekTodos - :",q[0]?.priority||"none");const F=new Date(j);F.setDate(j.getDate()-j.getDay()),F.setHours(0,0,0,0);const le=new Date(F);le.setDate(F.getDate()+6),le.setHours(0,0,0,0);const re=t.todos.filter(fe=>{if(fe.completed&&fe.completedAt){const ke=new Date(fe.completedAt);return ke.setHours(0,0,0,0),ke>=F&&ke<=le}if(!fe.completed){const ke=fe.startDate?new Date(fe.startDate):null,He=fe.dueDate?new Date(fe.dueDate):null;if(ke&&ke.setHours(0,0,0,0),He&&He.setHours(0,0,0,0),ke&&He)return He.getTime()>=F.getTime()&&ke.getTime()<=le.getTime();if(ke&&!He)return ke<=le;if(!ke&&He)return He>=j;if(!ke&&!He)return!0}return!1}),De=ce().filter(fe=>{if(fe.title.includes("")&&console.log(`  -  : completed=${fe.completed}, completedAt=${fe.completedAt}`),fe.completed){if(fe.completedAt){const qt=new Date(fe.completedAt);qt.setHours(0,0,0,0);const fa=qt>=F&&qt<=le;return fe.title.includes("")&&console.log(`     : =${qt.toDateString()}, =${fa}`),fa}return fe.title.includes("")&&console.log("     :   -  "),!1}const ke=fe.startDate?new Date(fe.startDate):null,He=fe.dueDate?new Date(fe.dueDate):null;if(ke&&ke.setHours(0,0,0,0),He&&He.setHours(0,0,0,0),ke&&He){const qt=He.getTime()>=F.getTime()&&ke.getTime()<=le.getTime();return console.log(`     : "${fe.title}"`),console.log(`   : ${ke.toDateString()} ~ ${He.toDateString()}`),console.log(`   : ${F.toDateString()} ~ ${le.toDateString()}`),console.log(`   : ${qt}`),qt}return ke&&!He?ke<=le:!ke&&He?He>=F:!ke&&!He}),be=[...re,...De];console.log(" getWeekTodos    :",be.filter(fe=>fe.title.includes("")).length);const me={urgent:0,high:1,medium:2,low:3},Ne=be.sort((fe,ke)=>{const He=me[fe.priority]-me[ke.priority];if(He!==0)return He;const qt=fe.order||0,fa=ke.order||0;return qt!==fa?qt-fa:new Date(fe.createdAt).getTime()-new Date(ke.createdAt).getTime()});return console.log(" getWeekTodos   :",Ne.filter(fe=>fe.title.includes("")).map(fe=>`${fe.title}: ${fe.priority}`)),he(Ne)},X=()=>{const j=new Date;j.setHours(0,0,0,0),console.log(" getMonthTodos ");const P=new Date(j.getFullYear(),j.getMonth(),1);P.setHours(0,0,0,0);const q=new Date(j.getFullYear(),j.getMonth()+1,0);q.setHours(0,0,0,0);const F=t.todos.filter(me=>{if(me.completed&&me.completedAt){const Ne=new Date(me.completedAt);return Ne.setHours(0,0,0,0),Ne>=P&&Ne<=q}if(!me.completed){const Ne=me.startDate?new Date(me.startDate):null,fe=me.dueDate?new Date(me.dueDate):null;if(Ne&&Ne.setHours(0,0,0,0),fe&&fe.setHours(0,0,0,0),Ne&&fe)return fe.getTime()>=P.getTime()&&Ne.getTime()<=q.getTime();if(Ne&&!fe)return Ne<=q;if(!Ne&&fe)return fe>=j;if(!Ne&&!fe)return!0}return!1}),re=ce().filter(me=>{if(me.completed){if(me.completedAt){const ke=new Date(me.completedAt);return ke.setHours(0,0,0,0),ke>=P&&ke<=q}return!1}const Ne=me.startDate?new Date(me.startDate):null,fe=me.dueDate?new Date(me.dueDate):null;if(Ne&&Ne.setHours(0,0,0,0),fe&&fe.setHours(0,0,0,0),Ne&&fe){const ke=fe.getTime()>=P.getTime()&&Ne.getTime()<=q.getTime();return console.log(`     : "${me.title}"`),console.log(`   : ${Ne.toDateString()} ~ ${fe.toDateString()}`),console.log(`   : ${P.toDateString()} ~ ${q.toDateString()}`),console.log(`   : ${ke}`),ke}return Ne&&!fe?Ne<=q:!Ne&&fe?fe>=P:!Ne&&!fe}),te=[...F,...re];console.log(" getMonthTodos    :",te.filter(me=>me.title.includes("")).length);const De={urgent:0,high:1,medium:2,low:3},be=te.sort((me,Ne)=>{const fe=De[me.priority]-De[Ne.priority];if(fe!==0)return fe;const ke=me.order||0,He=Ne.order||0;return ke!==He?ke-He:new Date(me.createdAt).getTime()-new Date(Ne.createdAt).getTime()});return console.log(" getMonthTodos   :",be.filter(me=>me.title.includes("")).map(me=>`${me.title}: ${me.priority}`)),he(be)},oe=()=>{const j=new Date;return j.setHours(0,0,0,0),t.todos.filter(P=>{if(!P.dueDate||P.completed)return!1;const q=new Date(P.dueDate);return q.setHours(0,0,0,0),q<j})},ye=j=>{const P=j||new Date,q=new Date(P);return q.setDate(q.getDate()+1),t.todos.filter(F=>F.dueDate?new Date(F.dueDate).toDateString()===q.toDateString():!1)},M=j=>{const P=j||new Date,q=new Date(P);return q.setHours(0,0,0,0),t.todos.filter(F=>{if(F.completed||!F.dueDate)return!1;const le=new Date(F.dueDate);return le.setHours(0,0,0,0),le.getTime()<q.getTime()})},Z=j=>{if(j.completed||!j.dueDate)return!1;const P=new Date;P.setHours(0,0,0,0);const q=new Date(j.dueDate);return q.setHours(0,0,0,0),q.getTime()<P.getTime()},E=async(j,P)=>{if(j.startsWith("recurring_")){const F=j.replace("recurring_","");r({type:"UPDATE_RECURRING_INSTANCE",payload:{id:F,updates:{order:P}}}),console.log("    ",{todoId:j,instanceId:F,newOrder:P})}else if(r({type:"UPDATE_TODO",payload:{id:j,updates:{order:P,updatedAt:new Date}}}),l?.uid)try{await Oe.updateTodo(j,{order:P},l.uid),console.log("  Firestore  ",{todoId:j,newOrder:P})}catch(F){console.error("  Firestore  :",F)}},O=async(j,P,q)=>{const F=Array.from(q),[le]=F.splice(j,1);F.splice(P,0,le);const re=F.map((te,De)=>E(te.id,De));try{await Promise.all(re),console.log("    ",{count:re.length})}catch(te){console.error("     :",te)}},Q=j=>{const P=[...t.todos,...ce()],q=new Date;return q.setHours(0,0,0,0),P.filter(F=>{if(F.startDate&&!j.completionDateFilter){const le=new Date(F.startDate);if(le.setHours(0,0,0,0),le>q)return!1}if(j.searchTerm){const le=j.searchTerm.toLowerCase(),re=F.title.toLowerCase().includes(le),te=F.description?.toLowerCase().includes(le)||!1,De=F.tags?.some(be=>be.toLowerCase().includes(le))||!1;if(!re&&!te&&!De)return!1}if(j.priorityFilter&&j.priorityFilter!=="all"&&F.priority!==j.priorityFilter||j.typeFilter&&j.typeFilter!=="all"&&F.type!==j.typeFilter||j.projectFilter&&j.projectFilter!=="all"&&F.project!==j.projectFilter)return!1;if(j.tagFilter&&j.tagFilter.length>0){const le=F.tags||[];if(!j.tagFilter.some(te=>le.includes(te)))return!1}if(j.completionDateFilter&&j.completionDateFilter!=="all"&&F.completedAt){const le=new Date(F.completedAt),re=new Date;switch(j.completionDateFilter){case"today":if(le.toDateString()!==re.toDateString())return!1;break;case"yesterday":const te=new Date;if(te.setDate(re.getDate()-1),le.toDateString()!==te.toDateString())return!1;break;case"thisWeek":const De=new Date(re);if(De.setDate(re.getDate()-re.getDay()),De.setHours(0,0,0,0),le<De)return!1;break;case"lastWeek":const be=new Date(re);be.setDate(re.getDate()-re.getDay()-7),be.setHours(0,0,0,0);const me=new Date(re);if(me.setDate(re.getDate()-re.getDay()-1),me.setHours(23,59,59,999),le<be||le>me)return!1;break;case"thisMonth":const Ne=new Date(re.getFullYear(),re.getMonth(),1);if(le<Ne)return!1;break}}return!(j.includeCompleted===!1&&F.completed)})},pe=async j=>{console.log("===     ==="),console.log("currentUser:",l),console.log("templateData:",j);try{if(l){console.log("Firestore   ");const P=await Oe.addRecurringTemplate(j,l.uid);console.log("  Firestore  :",P),console.log("    -  useEffect  ")}else{console.log(" :    ");const P={...j,id:Du(),createdAt:new Date,updatedAt:new Date};r({type:"ADD_RECURRING_TEMPLATE",payload:P})}console.log("===     ===")}catch(P){console.error("   :",P),r({type:"SET_ERROR",payload:"     ."})}},W=async(j,P)=>{console.log("    "),console.log(" ID:",j),console.log(" :",P);try{if(l)console.log(" Firebase  -   ( useEffect  )"),console.log("1 Firestore   "),await Oe.updateRecurringTemplate(j,P,l.uid),console.log("   Firestore  :",j),console.log("2    "),r({type:"UPDATE_RECURRING_TEMPLATE",payload:{id:j,updates:P}}),console.log("     "),console.log("   useEffect  .");else{console.log(" :    ");const q=t.todos.filter(F=>F._templateId===j);console.log(` ${j}   ${q.length} `);for(const F of q)console.log(` : ${F.title} (${F.id})`),r({type:"DELETE_TODO",payload:F.id});r({type:"UPDATE_RECURRING_TEMPLATE",payload:{id:j,updates:P}}),setTimeout(()=>{console.log("     "),ne()},100)}console.log("===     ===")}catch(q){console.error("   :",q),r({type:"SET_ERROR",payload:"     ."})}},de=async j=>{try{l?(r({type:"DELETE_RECURRING_TEMPLATE",payload:j}),console.log("  UI   :",j),await Oe.deleteRecurringTemplate(j,l.uid),console.log("   Firestore  :",j)):(console.log(" :    "),r({type:"DELETE_RECURRING_TEMPLATE",payload:j}),console.log("   - localStorage  ,  "))}catch(P){console.error("   :",P),r({type:"SET_ERROR",payload:"     ."})}},K=async()=>{if(!l)return;console.log("      (Deep Check)");const j={};t.recurringTemplates.forEach(q=>{const le=[q.title,q.recurrenceType,q.recurrenceType==="weekly"?q.weekday:"",q.recurrenceType==="monthly"?`${q.monthlyDate}-${q.monthlyPattern}-${q.monthlyWeek}-${q.monthlyWeekday}`:""].join("|");j[le]||(j[le]=[]),j[le].push(q)});const P=Object.values(j).filter(q=>q.length>1);if(P.length>0){console.log(` ${P.length}    `);for(const q of P){const F=q.sort((te,De)=>new Date(De.createdAt).getTime()-new Date(te.createdAt).getTime()),le=F[0],re=F.slice(1);console.log(` '${le.title}'  ${re.length}  `);for(const te of re)await de(te.id)}console.log("   ")}else console.log("   .")};I.useEffect(()=>{if(t.recurringTemplates.length>0&&l){const j=setTimeout(()=>{K()},2e3);return()=>clearTimeout(j)}},[t.recurringTemplates,l]);const ne=()=>{if(l){console.log("   -     !");return}if(c){console.log("    -   ");return}let j=[];t.recurringTemplates.filter(P=>P.isActive).forEach(P=>{try{const q=cs.generateInstances(P);j=[...j,...q]}catch(q){console.error(` ${P.id}   :`,q)}}),r({type:"SET_RECURRING_INSTANCES",payload:j})},ce=()=>t.recurringTemplates.length===0||t.recurringInstances.length===0?[]:t.recurringInstances.filter(q=>!q.skipped).map(q=>{const F=t.recurringTemplates.find(le=>le.id===q.templateId);return F?cs.convertToTodo(q,F):null}).filter(q=>q!==null),Se=()=>{const j=t.todos.filter(te=>!te.completed&&(te.order===void 0||te.order===null)),P=ce().filter(te=>!te.completed&&(te.order===void 0||te.order===null)),q=[...j,...P];if(q.length===0)return;console.log(" Order   :",q.length,"");const F={urgent:q.filter(te=>te.priority==="urgent"),high:q.filter(te=>te.priority==="high"),medium:q.filter(te=>te.priority==="medium"),low:q.filter(te=>te.priority==="low")},le=[],re=[];Object.entries(F).forEach(([te,De],be)=>{if(De.length===0)return;const me=De.sort((fe,ke)=>new Date(fe.createdAt).getTime()-new Date(ke.createdAt).getTime()),Ne=be*1e3;me.forEach((fe,ke)=>{const He=Ne+ke*10;if(fe._isRecurringInstance){console.log("  order :",fe.title,"",He);const qt=fe._instanceId;re.push(qt),r({type:"UPDATE_RECURRING_INSTANCE",payload:{id:qt,updates:{order:He}}})}else le.push({...fe,order:He})})}),le.forEach(async te=>{try{l&&await Oe.updateTodo(te.id,{order:te.order},l.uid),r({type:"UPDATE_TODO",payload:{id:te.id,updates:{order:te.order}}})}catch(De){console.error("Order   :",te.id,De)}}),console.log(" Order  :",le.length,"  ,",re.length," ")},ue=async()=>{if(!l){console.log("   ");return}console.log(" Firestore   ..."),r({type:"SET_LOADING",payload:!0});try{const j=await Oe.getTodos(l.uid);console.log("   :",j.length," "),r({type:"SET_TODOS",payload:j}),r({type:"SET_ERROR",payload:null})}catch(j){console.error("   :",j),r({type:"SET_ERROR",payload:"  ."})}finally{r({type:"SET_LOADING",payload:!1})}},Ue=async()=>{if(!l){console.log("   ");return}console.log("  : Firebase     ");try{console.log("1      ...");const j=await Oe.getRecurringInstances(l.uid);console.log(`  : ${j.length}`);for(const q of j)await Oe.deleteRecurringInstance(q.id,l.uid),console.log(`  : ${q.id}`);console.log("2    ...");const P=t.recurringTemplates.filter(q=>q.isActive);console.log(`  : ${P.length}`);for(const q of P){console.log(`  : ${q.title} (monthlyDate: ${q.monthlyDate})`);const F=cs.generateInstances(q);console.log(` : ${F.length}`);for(const le of F){const re={templateId:le.templateId,date:le.date,completed:!1,createdAt:le.createdAt,updatedAt:le.updatedAt},te=await Oe.addRecurringInstance(re,l.uid);console.log(`  : ${te} - ${le.date.toDateString()}`)}}console.log("3    ..."),await ue(),console.log("   !"),alert(`    !
 .`)}catch(j){console.error("   :",j),alert("    .")}},tt=async()=>{if(!l){console.log("   ");return}console.log("    (  )");try{const j=await Oe.getTodos(l.uid);console.log("   :",j.length," "),r({type:"SET_TODOS",payload:j})}catch(j){console.error("   :",j)}},st=I.useCallback(async()=>{if(!l?.uid){console.log("  ...");return}try{console.log("    ");const j=await Au.cleanupOrphanedInstances(l.uid);console.log("    :",j),alert(`  !
-  : ${j.orphanedInstances}
-  : ${j.orphanedTodos}
-  : ${j.totalCleaned}`),await ue()}catch(j){console.error("    :",j),alert("    .")}},[l]),Xe=I.useCallback(async()=>{if(!l?.uid){console.log("  ...");return}try{console.log("    ");const j=await Au.validateTemplateConsistency(l.uid);console.log("     -  "),alert(`  !
 ${j.size}     .`)}catch(j){console.error("    :",j),alert("    .")}},[l]),Pt=I.useCallback(async()=>{if(!l?.uid){console.log("  ...");return}if(!window.confirm(`   :

 :    
 :    

   . ?`)){console.log("  ");return}try{console.log("   ");const P=await Au.smartCleanupInstances(l.uid);console.log("   :",P),alert(`   !

: ${P.deletedInstances}  
: ${P.keptInstances}  

   ! `),setTimeout(()=>{window.location.reload()},1e3)}catch(P){console.error("   :",P),alert("     .")}},[l]);I.useEffect(()=>{typeof window<"u"&&(window.fixRecurringInstances=Ue,window.cleanupOrphanedData=st,window.validateDataConsistency=Xe,window.smartCleanupInstances=Pt,window.checkLoginStatus=()=>{console.log(" :",l?" ":"  "),l&&console.log(":",l.email)},window.forceRegenerateInstances=async()=>{if(!l?.uid){console.log("   ");return}console.log("     ...");try{await Promise.all(t.recurringTemplates.filter(j=>j.isActive!==!1).map(j=>Oe.regenerateRecurringInstances(j.id,l.uid))),console.log("   !  ."),setTimeout(()=>window.location.reload(),1e3)}catch(j){console.error("   :",j)}},window.fixBusinessTripTemplate=async()=>{if(!l?.uid){console.log("   ");return}try{console.log("      ...");const j=t.recurringTemplates.find(q=>q.title.includes("")&&q.title.includes("")&&q.title.includes(""));if(!j){console.log("       "),console.log("  :",t.recurringTemplates.map(q=>q.title));return}console.log("   :",j);const P={monthlyPattern:"weekday",monthlyWeek:"fourth",monthlyWeekday:2,monthlyDate:void 0};console.log("  :"),console.log("  0=, 1=, 2=, 3=, 4=, 5=, 6="),console.log(`   2 = ${["","","","","","",""][2]}`),console.log("  :",P),await Oe.updateRecurringTemplate(j.id,P,l.uid),console.log("      !"),console.log("   ..."),await Oe.regenerateRecurringInstances(j.id,l.uid),console.log("   !  ."),setTimeout(()=>window.location.reload(),1e3)}catch(j){console.error("   :",j)}},console.log("  - cleanupOrphanedData():   "))},[]);const Dt=I.useCallback(()=>{const j={todos:t.todos,recurringTemplates:t.recurringTemplates,recurringInstances:t.recurringInstances,exportedAt:new Date().toISOString(),version:"1.0.0"};return JSON.stringify(j,null,2)},[t]),ic=I.useCallback(async j=>{try{const P=JSON.parse(j);if(!P.todos)throw new Error("Invalid data format");const q=P.todos.map(F=>({...F,createdAt:new Date(F.createdAt),updatedAt:new Date(F.updatedAt),dueDate:F.dueDate?new Date(F.dueDate):void 0,startDate:F.startDate?new Date(F.startDate):void 0,completedAt:F.completedAt?new Date(F.completedAt):void 0}));return r(l?{type:"SET_TODOS",payload:q}:{type:"SET_TODOS",payload:q}),!0}catch(P){return console.error("Import failed:",P),!1}},[l]),ti=I.useCallback(async()=>{const j=t.todos.filter(P=>P.completed);for(const P of j)await C(P.id)},[t.todos,C]),ni=I.useCallback(async()=>{await D()},[D]),_r=I.useMemo(()=>({total:t.todos.length,completed:t.todos.filter(j=>j.completed).length,pending:t.todos.filter(j=>!j.completed).length}),[t.todos]),oc=I.useMemo(()=>{const j=new Set;return t.todos.forEach(P=>{P.tags?.forEach(q=>j.add(q))}),Array.from(j).sort()},[t.todos]),ai={...t,addTodo:_,updateTodo:$,deleteTodo:C,toggleTodo:ee,addSubTask:ie,updateSubTask:xe,deleteSubTask:_e,toggleSubTask:ve,syncWithFirestore:D,getTodayTodos:Te,getWeekTodos:Ee,getMonthTodos:X,getOverdueTodos:oe,getTomorrowTodos:ye,getYesterdayIncompleteTodos:M,isYesterdayIncompleteTodo:Z,updateTodoOrder:E,reorderTodos:O,getFilteredTodos:Q,addRecurringTemplate:pe,updateRecurringTemplate:W,deleteRecurringTemplate:de,generateRecurringInstances:ne,getRecurringTodos:ce,cleanupDuplicateTemplates:K,forceRefresh:ue,manualRefresh:tt,initializeOrderValues:Se,fixRecurringInstances:Ue,cleanupOrphanedData:st,validateDataConsistency:Xe,smartCleanupInstances:Pt,exportData:Dt,importData:ic,clearCompleted:ti,syncWithCloud:ni,stats:_r,searchQuery:h,setSearchQuery:g,filterStatus:m,setFilterStatus:p,filterPriority:x,setFilterPriority:b,filterTags:w,setFilterTags:L,allTags:oc};return i.jsx(Ay.Provider,{value:ai,children:s})},Qt=()=>{const s=I.useContext(Ay);if(s===void 0)throw new Error("useTodos must be used within a TodoProvider");return s},Ry=I.createContext(void 0),Oy=()=>{const s=I.useContext(Ry);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s},Mk=({children:s})=>{const[t,r]=I.useState(()=>localStorage.getItem("theme")||"system"),[l,c]=I.useState(!1);return I.useEffect(()=>{const u=window.document.documentElement,h=()=>{u.classList.remove("dark");let g;t==="system"?g=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":g=t,g==="dark"&&u.classList.add("dark"),c(g==="dark")};if(h(),t==="system"){const g=window.matchMedia("(prefers-color-scheme: dark)"),m=()=>h();return g.addEventListener("change",m),()=>g.removeEventListener("change",m)}},[t]),I.useEffect(()=>{localStorage.setItem("theme",t)},[t]),i.jsx(Ry.Provider,{value:{theme:t,setTheme:r,isDark:l},children:s})},Ik=["lkd0115lkd@gmail.com"],Ba=s=>s?Ik.includes(s):!1;var ip={};const op="@firebase/database",cp="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let My="";function Lk(s){My=s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uk{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,r){r==null?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),Tt(r))}get(t){const r=this.domStorage_.getItem(this.prefixedName_(t));return r==null?null:ih(r)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,r){r==null?delete this.cache_[t]:this.cache_[t]=r}get(t){return da(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iy=function(s){try{if(typeof window<"u"&&typeof window[s]<"u"){const t=window[s];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Uk(t)}}catch{}return new Hk},mr=Iy("localStorage"),$k=Iy("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hs=new a_("@firebase/database"),zk=function(){let s=1;return function(){return s++}}(),Ly=function(s){const t=r_(s),r=new s_;r.update(t);const l=r.digest();return l_.encodeByteArray(l)},Ql=function(...s){let t="";for(let r=0;r<s.length;r++){const l=s[r];Array.isArray(l)||l&&typeof l=="object"&&typeof l.length=="number"?t+=Ql.apply(null,l):typeof l=="object"?t+=Tt(l):t+=l,t+=" "}return t};let Al=null,dp=!0;const Bk=function(s,t){ge(!0,"Can't turn on custom loggers persistently."),hs.logLevel=i_.VERBOSE,Al=hs.log.bind(hs)},Yt=function(...s){if(dp===!0&&(dp=!1,Al===null&&$k.get("logging_enabled")===!0&&Bk()),Al){const t=Ql.apply(null,s);Al(t)}},Xl=function(s){return function(...t){Yt(s,...t)}},Gu=function(...s){const t="FIREBASE INTERNAL ERROR: "+Ql(...s);hs.error(t)},ca=function(...s){const t=`FIREBASE FATAL ERROR: ${Ql(...s)}`;throw hs.error(t),new Error(t)},nn=function(...s){const t="FIREBASE WARNING: "+Ql(...s);hs.warn(t)},qk=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&nn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Uy=function(s){return typeof s=="number"&&(s!==s||s===Number.POSITIVE_INFINITY||s===Number.NEGATIVE_INFINITY)},Fk=function(s){if(document.readyState==="complete")s();else{let t=!1;const r=function(){if(!document.body){setTimeout(r,Math.floor(10));return}t||(t=!0,s())};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&r()}),window.attachEvent("onload",r))}},xs="[MIN_NAME]",xr="[MAX_NAME]",_s=function(s,t){if(s===t)return 0;if(s===xs||t===xr)return-1;if(t===xs||s===xr)return 1;{const r=up(s),l=up(t);return r!==null?l!==null?r-l===0?s.length-t.length:r-l:-1:l!==null?1:s<t?-1:1}},Gk=function(s,t){return s===t?0:s<t?-1:1},Nl=function(s,t){if(t&&s in t)return t[s];throw new Error("Missing required key ("+s+") in object: "+Tt(t))},gh=function(s){if(typeof s!="object"||s===null)return Tt(s);const t=[];for(const l in s)t.push(l);t.sort();let r="{";for(let l=0;l<t.length;l++)l!==0&&(r+=","),r+=Tt(t[l]),r+=":",r+=gh(s[t[l]]);return r+="}",r},Hy=function(s,t){const r=s.length;if(r<=t)return[s];const l=[];for(let c=0;c<r;c+=t)c+t>r?l.push(s.substring(c,r)):l.push(s.substring(c,c+t));return l};function rn(s,t){for(const r in s)s.hasOwnProperty(r)&&t(r,s[r])}const $y=function(s){ge(!Uy(s),"Invalid JSON number");const t=11,r=52,l=(1<<t-1)-1;let c,u,h,g,m;s===0?(u=0,h=0,c=1/s===-1/0?1:0):(c=s<0,s=Math.abs(s),s>=Math.pow(2,1-l)?(g=Math.min(Math.floor(Math.log(s)/Math.LN2),l),u=g+l,h=Math.round(s*Math.pow(2,r-g)-Math.pow(2,r))):(u=0,h=Math.round(s/Math.pow(2,1-l-r))));const p=[];for(m=r;m;m-=1)p.push(h%2?1:0),h=Math.floor(h/2);for(m=t;m;m-=1)p.push(u%2?1:0),u=Math.floor(u/2);p.push(c?1:0),p.reverse();const x=p.join("");let b="";for(m=0;m<64;m+=8){let w=parseInt(x.substr(m,8),2).toString(16);w.length===1&&(w="0"+w),b=b+w}return b.toLowerCase()},Yk=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Pk=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function Vk(s,t){let r="Unknown Error";s==="too_big"?r="The data requested exceeds the maximum size that can be accessed with a single request.":s==="permission_denied"?r="Client doesn't have permission to access the desired data.":s==="unavailable"&&(r="The service is unavailable");const l=new Error(s+" at "+t._path.toString()+": "+r);return l.code=s.toUpperCase(),l}const Wk=new RegExp("^-?(0*)\\d{1,10}$"),Qk=-2147483648,Xk=2147483647,up=function(s){if(Wk.test(s)){const t=Number(s);if(t>=Qk&&t<=Xk)return t}return null},ks=function(s){try{s()}catch(t){setTimeout(()=>{const r=t.stack||"";throw nn("Exception was thrown by user callback.",r),t},Math.floor(0))}},Kk=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Rl=function(s,t){const r=setTimeout(s,t);return typeof r=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(r):typeof r=="object"&&r.unref&&r.unref(),r};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zk{constructor(t,r){this.appCheckProvider=r,this.appName=t.name,ay(t)&&t.settings.appCheckToken&&(this.serverAppAppCheckToken=t.settings.appCheckToken),this.appCheck=r?.getImmediate({optional:!0}),this.appCheck||r?.get().then(l=>this.appCheck=l)}getToken(t){if(this.serverAppAppCheckToken){if(t)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(t):new Promise((r,l)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(r,l):r(null)},0)})}addTokenChangeListener(t){this.appCheckProvider?.get().then(r=>r.addTokenListener(t))}notifyForInvalidToken(){nn(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jk{constructor(t,r,l){this.appName_=t,this.firebaseOptions_=r,this.authProvider_=l,this.auth_=null,this.auth_=l.getImmediate({optional:!0}),this.auth_||l.onInit(c=>this.auth_=c)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(r=>r&&r.code==="auth/token-not-initialized"?(Yt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(r)):new Promise((r,l)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(r,l):r(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(r=>r.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(r=>r.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',nn(t)}}class _o{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}_o.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh="5",zy="v",By="s",qy="r",Fy="f",Gy=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Yy="ls",Py="p",Yu="ac",Vy="websocket",Wy="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{constructor(t,r,l,c,u=!1,h="",g=!1,m=!1,p=null){this.secure=r,this.namespace=l,this.webSocketOnly=c,this.nodeAdmin=u,this.persistenceKey=h,this.includeNamespaceInQueryParams=g,this.isUsingEmulator=m,this.emulatorOptions=p,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=mr.get("host:"+t)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&mr.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",r=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${r}`}}function eN(s){return s.host!==s.internalHost||s.isCustomHost()||s.includeNamespaceInQueryParams}function Xy(s,t,r){ge(typeof t=="string","typeof type must == string"),ge(typeof r=="object","typeof params must == object");let l;if(t===Vy)l=(s.secure?"wss://":"ws://")+s.internalHost+"/.ws?";else if(t===Wy)l=(s.secure?"https://":"http://")+s.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+t);eN(s)&&(r.ns=s.namespace);const c=[];return rn(r,(u,h)=>{c.push(u+"="+h)}),l+c.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tN{constructor(){this.counters_={}}incrementCounter(t,r=1){da(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=r}get(){return h_(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ru={},Ou={};function ph(s){const t=s.toString();return Ru[t]||(Ru[t]=new tN),Ru[t]}function nN(s,t){const r=s.toString();return Ou[r]||(Ou[r]=t()),Ou[r]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,r){this.closeAfterResponse=t,this.onClose=r,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,r){for(this.pendingResponses[t]=r;this.pendingResponses[this.currentResponseNum];){const l=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let c=0;c<l.length;++c)l[c]&&ks(()=>{this.onMessage_(l[c])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hp="start",rN="close",sN="pLPCommand",lN="pRTLPCB",Ky="id",Zy="pw",Jy="ser",iN="cb",oN="seg",cN="ts",dN="d",uN="dframe",ex=1870,tx=30,hN=ex-tx,fN=25e3,gN=3e4;class us{constructor(t,r,l,c,u,h,g){this.connId=t,this.repoInfo=r,this.applicationId=l,this.appCheckToken=c,this.authToken=u,this.transportSessionId=h,this.lastSessionId=g,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Xl(t),this.stats_=ph(r),this.urlFn=m=>(this.appCheckToken&&(m[Yu]=this.appCheckToken),Xy(r,Wy,m))}open(t,r){this.curSegmentNum=0,this.onDisconnect_=r,this.myPacketOrderer=new aN(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(gN)),Fk(()=>{if(this.isClosed_)return;this.scriptTagHolder=new yh((...u)=>{const[h,g,m,p,x]=u;if(this.incrementIncomingBytes_(u),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,h===hp)this.id=g,this.password=m;else if(h===rN)g?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(g,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+h)},(...u)=>{const[h,g]=u;this.incrementIncomingBytes_(u),this.myPacketOrderer.handleResponse(h,g)},()=>{this.onClosed_()},this.urlFn);const l={};l[hp]="t",l[Jy]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(l[iN]=this.scriptTagHolder.uniqueCallbackIdentifier),l[zy]=mh,this.transportSessionId&&(l[By]=this.transportSessionId),this.lastSessionId&&(l[Yy]=this.lastSessionId),this.applicationId&&(l[Py]=this.applicationId),this.appCheckToken&&(l[Yu]=this.appCheckToken),typeof location<"u"&&location.hostname&&Gy.test(location.hostname)&&(l[qy]=Fy);const c=this.urlFn(l);this.log_("Connecting via long-poll to "+c),this.scriptTagHolder.addTag(c,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){us.forceAllow_=!0}static forceDisallow(){us.forceDisallow_=!0}static isAvailable(){return us.forceAllow_?!0:!us.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Yk()&&!Pk()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const r=Tt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const l=f_(r),c=Hy(l,hN);for(let u=0;u<c.length;u++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,c.length,c[u]),this.curSegmentNum++}addDisconnectPingFrame(t,r){this.myDisconnFrame=document.createElement("iframe");const l={};l[uN]="t",l[Ky]=t,l[Zy]=r,this.myDisconnFrame.src=this.urlFn(l),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const r=Tt(t).length;this.bytesReceived+=r,this.stats_.incrementCounter("bytes_received",r)}}class yh{constructor(t,r,l,c){this.onDisconnect=l,this.urlFn=c,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=zk(),window[sN+this.uniqueCallbackIdentifier]=t,window[lN+this.uniqueCallbackIdentifier]=r,this.myIFrame=yh.createIFrame_();let u="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(u='<script>document.domain="'+document.domain+'";<\/script>');const h="<html><body>"+u+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(h),this.myIFrame.doc.close()}catch(g){Yt("frame writing exception"),g.stack&&Yt(g.stack),Yt(g)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",document.body){document.body.appendChild(t);try{t.contentWindow.document||Yt("No IE domain setting required")}catch{const l=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+l+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,r){for(this.myID=t,this.myPW=r,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t[Ky]=this.myID,t[Zy]=this.myPW,t[Jy]=this.currentSerial;let r=this.urlFn(t),l="",c=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+tx+l.length<=ex;){const h=this.pendingSegs.shift();l=l+"&"+oN+c+"="+h.seg+"&"+cN+c+"="+h.ts+"&"+dN+c+"="+h.d,c++}return r=r+l,this.addLongPollTag_(r,this.currentSerial),!0}else return!1}enqueueSegment(t,r,l){this.pendingSegs.push({seg:t,ts:r,d:l}),this.alive&&this.newRequest_()}addLongPollTag_(t,r){this.outstandingRequests.add(r);const l=()=>{this.outstandingRequests.delete(r),this.newRequest_()},c=setTimeout(l,Math.floor(fN)),u=()=>{clearTimeout(c),l()};this.addTag(t,u)}addTag(t,r){setTimeout(()=>{try{if(!this.sendNewPolls)return;const l=this.myIFrame.doc.createElement("script");l.type="text/javascript",l.async=!0,l.src=t,l.onload=l.onreadystatechange=function(){const c=l.readyState;(!c||c==="loaded"||c==="complete")&&(l.onload=l.onreadystatechange=null,l.parentNode&&l.parentNode.removeChild(l),r())},l.onerror=()=>{Yt("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(l)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mN=16384,pN=45e3;let Ro=null;typeof MozWebSocket<"u"?Ro=MozWebSocket:typeof WebSocket<"u"&&(Ro=WebSocket);class En{constructor(t,r,l,c,u,h,g){this.connId=t,this.applicationId=l,this.appCheckToken=c,this.authToken=u,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Xl(this.connId),this.stats_=ph(r),this.connURL=En.connectionURL_(r,h,g,c,l),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,l,c,u){const h={};return h[zy]=mh,typeof location<"u"&&location.hostname&&Gy.test(location.hostname)&&(h[qy]=Fy),r&&(h[By]=r),l&&(h[Yy]=l),c&&(h[Yu]=c),u&&(h[Py]=u),Xy(t,Vy,h)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,mr.set("previous_websocket_failure",!0);try{let l;g_(),this.mySock=new Ro(this.connURL,[],l)}catch(l){this.log_("Error instantiating WebSocket.");const c=l.message||l.data;c&&this.log_(c),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=l=>{this.handleIncomingFrame(l)},this.mySock.onerror=l=>{this.log_("WebSocket error.  Closing connection.");const c=l.message||l.data;c&&this.log_(c),this.onClosed_()}}start(){}static forceDisallow(){En.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const r=/Android ([0-9]{0,}\.[0-9]{0,})/,l=navigator.userAgent.match(r);l&&l.length>1&&parseFloat(l[1])<4.4&&(t=!0)}return!t&&Ro!==null&&!En.forceDisallow_}static previouslyFailed(){return mr.isInMemoryStorage||mr.get("previous_websocket_failure")===!0}markConnectionHealthy(){mr.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const l=ih(r);this.onMessage(l)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(ge(this.frames===null,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{const l=this.extractFrameCount_(r);l!==null&&this.appendFrame_(l)}}send(t){this.resetKeepAlive();const r=Tt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const l=Hy(r,mN);l.length>1&&this.sendString_(String(l.length));for(let c=0;c<l.length;c++)this.sendString_(l[c])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(pN))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}En.responsesRequiredToBeHealthy=2;En.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{static get ALL_TRANSPORTS(){return[us,En]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){const r=En&&En.isAvailable();let l=r&&!En.previouslyFailed();if(t.webSocketOnly&&(r||nn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),l=!0),l)this.transports_=[En];else{const c=this.transports_=[];for(const u of Hl.ALL_TRANSPORTS)u&&u.isAvailable()&&c.push(u);Hl.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Hl.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yN=6e4,xN=5e3,bN=10*1024,vN=100*1024,Mu="t",fp="d",wN="s",gp="r",_N="e",mp="o",pp="a",yp="n",xp="p",kN="h";class NN{constructor(t,r,l,c,u,h,g,m,p,x){this.id=t,this.repoInfo_=r,this.applicationId_=l,this.appCheckToken_=c,this.authToken_=u,this.onMessage_=h,this.onReady_=g,this.onDisconnect_=m,this.onKill_=p,this.lastSessionId=x,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Xl("c:"+this.id+":"),this.transportManager_=new Hl(r),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.conn_),l=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(r,l)},Math.floor(0));const c=t.healthyTimeout||0;c>0&&(this.healthyTimeout_=Rl(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>vN?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>bN?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(c)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return r=>{t===this.conn_?this.onConnectionLost_(r):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return r=>{this.state_!==2&&(t===this.rx_?this.onPrimaryMessageReceived_(r):t===this.secondaryConn_?this.onSecondaryMessageReceived_(r):this.log_("message on old connection"))}}sendRequest(t){const r={t:"d",d:t};this.sendData_(r)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if(Mu in t){const r=t[Mu];r===pp?this.upgradeIfSecondaryHealthy_():r===gp?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):r===mp&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const r=Nl("t",t),l=Nl("d",t);if(r==="c")this.onSecondaryControl_(l);else if(r==="d")this.pendingDataMessages.push(l);else throw new Error("Unknown protocol layer: "+r)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:xp,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:pp,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:yp,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const r=Nl("t",t),l=Nl("d",t);r==="c"?this.onControl_(l):r==="d"&&this.onDataMessage_(l)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const r=Nl(Mu,t);if(fp in t){const l=t[fp];if(r===kN){const c={...l};this.repoInfo_.isUsingEmulator&&(c.h=this.repoInfo_.host),this.onHandshake_(c)}else if(r===yp){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let c=0;c<this.pendingDataMessages.length;++c)this.onDataMessage_(this.pendingDataMessages[c]);this.pendingDataMessages=[],this.tryCleanupConnection()}else r===wN?this.onConnectionShutdown_(l):r===gp?this.onReset_(l):r===_N?Gu("Server Error: "+l):r===mp?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Gu("Unknown control packet command: "+r)}}onHandshake_(t){const r=t.ts,l=t.v,c=t.h;this.sessionId=t.s,this.repoInfo_.host=c,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,r),mh!==l&&nn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.secondaryConn_),l=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(r,l),Rl(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(yN))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,r){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(r,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Rl(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(xN))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:xp,d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,!t&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(mr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(t)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nx{put(t,r,l,c){}merge(t,r,l,c){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,r,l){}onDisconnectMerge(t,r,l){}onDisconnectCancel(t,r){}reportStats(t){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ax{constructor(t){this.allowedEvents_=t,this.listeners_={},ge(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...r){if(Array.isArray(this.listeners_[t])){const l=[...this.listeners_[t]];for(let c=0;c<l.length;c++)l[c].callback.apply(l[c].context,r)}}on(t,r,l){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:r,context:l});const c=this.getInitialEvent(t);c&&r.apply(l,c)}off(t,r,l){this.validateEventType_(t);const c=this.listeners_[t]||[];for(let u=0;u<c.length;u++)if(c[u].callback===r&&(!l||l===c[u].context)){c.splice(u,1);return}}validateEventType_(t){ge(this.allowedEvents_.find(r=>r===t),"Unknown event: "+t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo extends ax{static getInstance(){return new Oo}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!fy()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(t){return ge(t==="online","Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bp=32,vp=768;class it{constructor(t,r){if(r===void 0){this.pieces_=t.split("/");let l=0;for(let c=0;c<this.pieces_.length;c++)this.pieces_[c].length>0&&(this.pieces_[l]=this.pieces_[c],l++);this.pieces_.length=l,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=r}toString(){let t="";for(let r=this.pieceNum_;r<this.pieces_.length;r++)this.pieces_[r]!==""&&(t+="/"+this.pieces_[r]);return t||"/"}}function We(){return new it("")}function Be(s){return s.pieceNum_>=s.pieces_.length?null:s.pieces_[s.pieceNum_]}function Ga(s){return s.pieces_.length-s.pieceNum_}function ct(s){let t=s.pieceNum_;return t<s.pieces_.length&&t++,new it(s.pieces_,t)}function rx(s){return s.pieceNum_<s.pieces_.length?s.pieces_[s.pieces_.length-1]:null}function TN(s){let t="";for(let r=s.pieceNum_;r<s.pieces_.length;r++)s.pieces_[r]!==""&&(t+="/"+encodeURIComponent(String(s.pieces_[r])));return t||"/"}function sx(s,t=0){return s.pieces_.slice(s.pieceNum_+t)}function lx(s){if(s.pieceNum_>=s.pieces_.length)return null;const t=[];for(let r=s.pieceNum_;r<s.pieces_.length-1;r++)t.push(s.pieces_[r]);return new it(t,0)}function St(s,t){const r=[];for(let l=s.pieceNum_;l<s.pieces_.length;l++)r.push(s.pieces_[l]);if(t instanceof it)for(let l=t.pieceNum_;l<t.pieces_.length;l++)r.push(t.pieces_[l]);else{const l=t.split("/");for(let c=0;c<l.length;c++)l[c].length>0&&r.push(l[c])}return new it(r,0)}function Ye(s){return s.pieceNum_>=s.pieces_.length}function Wt(s,t){const r=Be(s),l=Be(t);if(r===null)return t;if(r===l)return Wt(ct(s),ct(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+s+")")}function xh(s,t){if(Ga(s)!==Ga(t))return!1;for(let r=s.pieceNum_,l=t.pieceNum_;r<=s.pieces_.length;r++,l++)if(s.pieces_[r]!==t.pieces_[l])return!1;return!0}function An(s,t){let r=s.pieceNum_,l=t.pieceNum_;if(Ga(s)>Ga(t))return!1;for(;r<s.pieces_.length;){if(s.pieces_[r]!==t.pieces_[l])return!1;++r,++l}return!0}class SN{constructor(t,r){this.errorPrefix_=r,this.parts_=sx(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let l=0;l<this.parts_.length;l++)this.byteLength_+=Vo(this.parts_[l]);ix(this)}}function jN(s,t){s.parts_.length>0&&(s.byteLength_+=1),s.parts_.push(t),s.byteLength_+=Vo(t),ix(s)}function DN(s){const t=s.parts_.pop();s.byteLength_-=Vo(t),s.parts_.length>0&&(s.byteLength_-=1)}function ix(s){if(s.byteLength_>vp)throw new Error(s.errorPrefix_+"has a key path longer than "+vp+" bytes ("+s.byteLength_+").");if(s.parts_.length>bp)throw new Error(s.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+bp+") or object contains a cycle "+hr(s))}function hr(s){return s.parts_.length===0?"":"in property '"+s.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh extends ax{static getInstance(){return new bh}constructor(){super(["visible"]);let t,r;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(r="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(r="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(r="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(r="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,r&&document.addEventListener(r,()=>{const l=!document[t];l!==this.visible_&&(this.visible_=l,this.trigger("visible",l))},!1)}getInitialEvent(t){return ge(t==="visible","Unknown event type: "+t),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tl=1e3,EN=300*1e3,wp=30*1e3,CN=1.3,AN=3e4,RN="server_kill",_p=3;class oa extends nx{constructor(t,r,l,c,u,h,g,m){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=l,this.onConnectStatus_=c,this.onServerInfoUpdate_=u,this.authTokenProvider_=h,this.appCheckTokenProvider_=g,this.authOverride_=m,this.id=oa.nextPersistentConnectionId_++,this.log_=Xl("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Tl,this.maxReconnectDelay_=EN,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,m)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");bh.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&Oo.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,l){const c=++this.requestNumber_,u={r:c,a:t,b:r};this.log_(Tt(u)),ge(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(u),l&&(this.requestCBHash_[c]=l)}get(t){this.initConnection_();const r=new ch,c={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:h=>{const g=h.d;h.s==="ok"?r.resolve(g):r.reject(g)}};this.outstandingGets_.push(c),this.outstandingGetCount_++;const u=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(u),r.promise}listen(t,r,l,c){this.initConnection_();const u=t._queryIdentifier,h=t._path.toString();this.log_("Listen called for "+h+" "+u),this.listens.has(h)||this.listens.set(h,new Map),ge(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ge(!this.listens.get(h).has(u),"listen() called twice for same path/queryId.");const g={onComplete:c,hashFn:r,query:t,tag:l};this.listens.get(h).set(u,g),this.connected_&&this.sendListen_(g)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,l=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(l)})}sendListen_(t){const r=t.query,l=r._path.toString(),c=r._queryIdentifier;this.log_("Listen on "+l+" for "+c);const u={p:l},h="q";t.tag&&(u.q=r._queryObject,u.t=t.tag),u.h=t.hashFn(),this.sendRequest(h,u,g=>{const m=g.d,p=g.s;oa.warnOnListenWarnings_(m,r),(this.listens.get(l)&&this.listens.get(l).get(c))===t&&(this.log_("listen response",g),p!=="ok"&&this.removeListen_(l,c),t.onComplete&&t.onComplete(p,m))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&da(t,"w")){const l=ms(t,"w");if(Array.isArray(l)&&~l.indexOf("no_index")){const c='".indexOn": "'+r._queryParams.getIndex().toString()+'"',u=r._path.toString();nn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${c} at ${u} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||c_(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=wp)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=d_(t)?"auth":"gauth",l={cred:t};this.authOverride_===null?l.noauth=!0:typeof this.authOverride_=="object"&&(l.authvar=this.authOverride_),this.sendRequest(r,l,c=>{const u=c.s,h=c.d||"error";this.authToken_===t&&(u==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(u,h))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,l=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,l)})}unlisten(t,r){const l=t._path.toString(),c=t._queryIdentifier;this.log_("Unlisten called for "+l+" "+c),ge(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(l,c)&&this.connected_&&this.sendUnlisten_(l,c,t._queryObject,r)}sendUnlisten_(t,r,l,c){this.log_("Unlisten on "+t+" for "+r);const u={p:t},h="n";c&&(u.q=l,u.t=c),this.sendRequest(h,u)}onDisconnectPut(t,r,l){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,l):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:l})}onDisconnectMerge(t,r,l){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,l):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:l})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,l,c){const u={p:r,d:l};this.log_("onDisconnect "+t,u),this.sendRequest(t,u,h=>{c&&setTimeout(()=>{c(h.s,h.d)},Math.floor(0))})}put(t,r,l,c){this.putInternal("p",t,r,l,c)}merge(t,r,l,c){this.putInternal("m",t,r,l,c)}putInternal(t,r,l,c,u){this.initConnection_();const h={p:r,d:l};u!==void 0&&(h.h=u),this.outstandingPuts_.push({action:t,request:h,onComplete:c}),this.outstandingPutCount_++;const g=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(g):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,l=this.outstandingPuts_[t].request,c=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,l,u=>{this.log_(r+" response",u),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),c&&c(u.s,u.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,l=>{if(l.s!=="ok"){const u=l.d;this.log_("reportStats","Error sending stats: "+u)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+Tt(t));const r=t.r,l=this.requestCBHash_[r];l&&(delete this.requestCBHash_[r],l(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):Gu("Unrecognized action received from server: "+Tt(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){ge(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Tl,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Tl,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>AN&&(this.reconnectDelay_=Tl),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const t=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*CN)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),l=this.onRealtimeDisconnect_.bind(this),c=this.id+":"+oa.nextConnectionId_++,u=this.lastSessionId;let h=!1,g=null;const m=function(){g?g.close():(h=!0,l())},p=function(b){ge(g,"sendRequest call when we're not connected not allowed."),g.sendRequest(b)};this.realtime_={close:m,sendRequest:p};const x=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[b,w]=await Promise.all([this.authTokenProvider_.getToken(x),this.appCheckTokenProvider_.getToken(x)]);h?Yt("getToken() completed but was canceled"):(Yt("getToken() completed. Creating connection."),this.authToken_=b&&b.accessToken,this.appCheckToken_=w&&w.token,g=new NN(c,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,l,L=>{nn(L+" ("+this.repoInfo_.toString()+")"),this.interrupt(RN)},u))}catch(b){this.log_("Failed to get token: "+b),h||(this.repoInfo_.nodeAdmin&&nn(b),m())}}}interrupt(t){Yt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Yt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Bm(this.interruptReasons_)&&(this.reconnectDelay_=Tl,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let l;r?l=r.map(u=>gh(u)).join("$"):l="default";const c=this.removeListen_(t,l);c&&c.onComplete&&c.onComplete("permission_denied")}removeListen_(t,r){const l=new it(t).toString();let c;if(this.listens.has(l)){const u=this.listens.get(l);c=u.get(r),u.delete(r),u.size===0&&this.listens.delete(l)}else c=void 0;return c}onAuthRevoked_(t,r){Yt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=_p&&(this.reconnectDelay_=wp,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Yt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=_p&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";t["sdk."+r+"."+My.replace(/\./g,"-")]=1,fy()?t["framework.cordova"]=1:u_()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=Oo.getInstance().currentlyOnline();return Bm(this.interruptReasons_)&&t}}oa.nextPersistentConnectionId_=0;oa.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(t,r){this.name=t,this.node=r}static Wrap(t,r){return new qe(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,r){const l=new qe(xs,t),c=new qe(xs,r);return this.compare(l,c)!==0}minPost(){return qe.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bo;class ox extends Xo{static get __EMPTY_NODE(){return bo}static set __EMPTY_NODE(t){bo=t}compare(t,r){return _s(t.name,r.name)}isDefinedOn(t){throw Wl("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,r){return!1}minPost(){return qe.MIN}maxPost(){return new qe(xr,bo)}makePost(t,r){return ge(typeof t=="string","KeyIndex indexValue must always be a string."),new qe(t,bo)}toString(){return".key"}}const fs=new ox;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(t,r,l,c,u=null){this.isReverse_=c,this.resultGenerator_=u,this.nodeStack_=[];let h=1;for(;!t.isEmpty();)if(t=t,h=r?l(t.key,r):1,c&&(h*=-1),h<0)this.isReverse_?t=t.left:t=t.right;else if(h===0){this.nodeStack_.push(t);break}else this.nodeStack_.push(t),this.isReverse_?t=t.right:t=t.left}getNext(){if(this.nodeStack_.length===0)return null;let t=this.nodeStack_.pop(),r;if(this.resultGenerator_?r=this.resultGenerator_(t.key,t.value):r={key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return r}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class It{constructor(t,r,l,c,u){this.key=t,this.value=r,this.color=l??It.RED,this.left=c??tn.EMPTY_NODE,this.right=u??tn.EMPTY_NODE}copy(t,r,l,c,u){return new It(t??this.key,r??this.value,l??this.color,c??this.left,u??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,l){let c=this;const u=l(t,c.key);return u<0?c=c.copy(null,null,null,c.left.insert(t,r,l),null):u===0?c=c.copy(null,r,null,null,null):c=c.copy(null,null,null,null,c.right.insert(t,r,l)),c.fixUp_()}removeMin_(){if(this.left.isEmpty())return tn.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let l,c;if(l=this,r(t,l.key)<0)!l.left.isEmpty()&&!l.left.isRed_()&&!l.left.left.isRed_()&&(l=l.moveRedLeft_()),l=l.copy(null,null,null,l.left.remove(t,r),null);else{if(l.left.isRed_()&&(l=l.rotateRight_()),!l.right.isEmpty()&&!l.right.isRed_()&&!l.right.left.isRed_()&&(l=l.moveRedRight_()),r(t,l.key)===0){if(l.right.isEmpty())return tn.EMPTY_NODE;c=l.right.min_(),l=l.copy(c.key,c.value,null,null,l.right.removeMin_())}l=l.copy(null,null,null,null,l.right.remove(t,r))}return l.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,It.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,It.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}It.RED=!0;It.BLACK=!1;class ON{copy(t,r,l,c,u){return this}insert(t,r,l){return new It(t,r,null)}remove(t,r){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class tn{constructor(t,r=tn.EMPTY_NODE){this.comparator_=t,this.root_=r}insert(t,r){return new tn(this.comparator_,this.root_.insert(t,r,this.comparator_).copy(null,null,It.BLACK,null,null))}remove(t){return new tn(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,It.BLACK,null,null))}get(t){let r,l=this.root_;for(;!l.isEmpty();){if(r=this.comparator_(t,l.key),r===0)return l.value;r<0?l=l.left:r>0&&(l=l.right)}return null}getPredecessorKey(t){let r,l=this.root_,c=null;for(;!l.isEmpty();)if(r=this.comparator_(t,l.key),r===0){if(l.left.isEmpty())return c?c.key:null;for(l=l.left;!l.right.isEmpty();)l=l.right;return l.key}else r<0?l=l.left:r>0&&(c=l,l=l.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new vo(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,r){return new vo(this.root_,t,this.comparator_,!1,r)}getReverseIteratorFrom(t,r){return new vo(this.root_,t,this.comparator_,!0,r)}getReverseIterator(t){return new vo(this.root_,null,this.comparator_,!0,t)}}tn.EMPTY_NODE=new ON;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MN(s,t){return _s(s.name,t.name)}function vh(s,t){return _s(s,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pu;function IN(s){Pu=s}const cx=function(s){return typeof s=="number"?"number:"+$y(s):"string:"+s},dx=function(s){if(s.isLeafNode()){const t=s.val();ge(typeof t=="string"||typeof t=="number"||typeof t=="object"&&da(t,".sv"),"Priority must be a string or number.")}else ge(s===Pu||s.isEmpty(),"priority of unexpected type.");ge(s===Pu||s.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kp;class Ot{static set __childrenNodeConstructor(t){kp=t}static get __childrenNodeConstructor(){return kp}constructor(t,r=Ot.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,ge(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),dx(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new Ot(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:Ot.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Ye(t)?this:Be(t)===".priority"?this.priorityNode_:Ot.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:Ot.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const l=Be(t);return l===null?r:r.isEmpty()&&l!==".priority"?this:(ge(l!==".priority"||Ga(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(l,Ot.__childrenNodeConstructor.EMPTY_NODE.updateChild(ct(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+cx(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",r==="number"?t+=$y(this.value_):t+=this.value_,this.lazyHash_=Ly(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===Ot.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof Ot.__childrenNodeConstructor?-1:(ge(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,l=typeof this.value_,c=Ot.VALUE_TYPE_ORDER.indexOf(r),u=Ot.VALUE_TYPE_ORDER.indexOf(l);return ge(c>=0,"Unknown leaf type: "+r),ge(u>=0,"Unknown leaf type: "+l),c===u?l==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:u-c}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}Ot.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ux,hx;function LN(s){ux=s}function UN(s){hx=s}class HN extends Xo{compare(t,r){const l=t.node.getPriority(),c=r.node.getPriority(),u=l.compareTo(c);return u===0?_s(t.name,r.name):u}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,r){return!t.getPriority().equals(r.getPriority())}minPost(){return qe.MIN}maxPost(){return new qe(xr,new Ot("[PRIORITY-POST]",hx))}makePost(t,r){const l=ux(t);return new qe(r,new Ot("[PRIORITY-POST]",l))}toString(){return".priority"}}const pt=new HN;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $N=Math.log(2);class zN{constructor(t){const r=u=>parseInt(Math.log(u)/$N,10),l=u=>parseInt(Array(u+1).join("1"),2);this.count=r(t+1),this.current_=this.count-1;const c=l(this.count);this.bits_=t+1&c}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const Mo=function(s,t,r,l){s.sort(t);const c=function(m,p){const x=p-m;let b,w;if(x===0)return null;if(x===1)return b=s[m],w=r?r(b):b,new It(w,b.node,It.BLACK,null,null);{const L=parseInt(x/2,10)+m,T=c(m,L),U=c(L+1,p);return b=s[L],w=r?r(b):b,new It(w,b.node,It.BLACK,T,U)}},u=function(m){let p=null,x=null,b=s.length;const w=function(T,U){const Y=b-T,k=b;b-=T;const S=c(Y+1,k),R=s[Y],D=r?r(R):R;L(new It(D,R.node,U,null,S))},L=function(T){p?(p.left=T,p=T):(x=T,p=T)};for(let T=0;T<m.count;++T){const U=m.nextBitIsOne(),Y=Math.pow(2,m.count-(T+1));U?w(Y,It.BLACK):(w(Y,It.BLACK),w(Y,It.RED))}return x},h=new zN(s.length),g=u(h);return new tn(l||t,g)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Iu;const os={};class ia{static get Default(){return ge(os&&pt,"ChildrenNode.ts has not been loaded"),Iu=Iu||new ia({".priority":os},{".priority":pt}),Iu}constructor(t,r){this.indexes_=t,this.indexSet_=r}get(t){const r=ms(this.indexes_,t);if(!r)throw new Error("No index defined for "+t);return r instanceof tn?r:null}hasIndex(t){return da(this.indexSet_,t.toString())}addIndex(t,r){ge(t!==fs,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const l=[];let c=!1;const u=r.getIterator(qe.Wrap);let h=u.getNext();for(;h;)c=c||t.isDefinedOn(h.node),l.push(h),h=u.getNext();let g;c?g=Mo(l,t.getCompare()):g=os;const m=t.toString(),p={...this.indexSet_};p[m]=t;const x={...this.indexes_};return x[m]=g,new ia(x,p)}addToIndexes(t,r){const l=jo(this.indexes_,(c,u)=>{const h=ms(this.indexSet_,u);if(ge(h,"Missing index implementation for "+u),c===os)if(h.isDefinedOn(t.node)){const g=[],m=r.getIterator(qe.Wrap);let p=m.getNext();for(;p;)p.name!==t.name&&g.push(p),p=m.getNext();return g.push(t),Mo(g,h.getCompare())}else return os;else{const g=r.get(t.name);let m=c;return g&&(m=m.remove(new qe(t.name,g))),m.insert(t,t.node)}});return new ia(l,this.indexSet_)}removeFromIndexes(t,r){const l=jo(this.indexes_,c=>{if(c===os)return c;{const u=r.get(t.name);return u?c.remove(new qe(t.name,u)):c}});return new ia(l,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sl;class Ie{static get EMPTY_NODE(){return Sl||(Sl=new Ie(new tn(vh),null,ia.Default))}constructor(t,r,l){this.children_=t,this.priorityNode_=r,this.indexMap_=l,this.lazyHash_=null,this.priorityNode_&&dx(this.priorityNode_),this.children_.isEmpty()&&ge(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Sl}updatePriority(t){return this.children_.isEmpty()?this:new Ie(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{const r=this.children_.get(t);return r===null?Sl:r}}getChild(t){const r=Be(t);return r===null?this:this.getImmediateChild(r).getChild(ct(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(ge(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{const l=new qe(t,r);let c,u;r.isEmpty()?(c=this.children_.remove(t),u=this.indexMap_.removeFromIndexes(l,this.children_)):(c=this.children_.insert(t,r),u=this.indexMap_.addToIndexes(l,this.children_));const h=c.isEmpty()?Sl:this.priorityNode_;return new Ie(c,h,u)}}updateChild(t,r){const l=Be(t);if(l===null)return r;{ge(Be(t)!==".priority"||Ga(t)===1,".priority must be the last token in a path");const c=this.getImmediateChild(l).updateChild(ct(t),r);return this.updateImmediateChild(l,c)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let l=0,c=0,u=!0;if(this.forEachChild(pt,(h,g)=>{r[h]=g.val(t),l++,u&&Ie.INTEGER_REGEXP_.test(h)?c=Math.max(c,Number(h)):u=!1}),!t&&u&&c<2*l){const h=[];for(const g in r)h[g]=r[g];return h}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+cx(this.getPriority().val())+":"),this.forEachChild(pt,(r,l)=>{const c=l.hash();c!==""&&(t+=":"+r+":"+c)}),this.lazyHash_=t===""?"":Ly(t)}return this.lazyHash_}getPredecessorChildName(t,r,l){const c=this.resolveIndex_(l);if(c){const u=c.getPredecessorKey(new qe(t,r));return u?u.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const l=r.minKey();return l&&l.name}else return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new qe(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const l=r.maxKey();return l&&l.name}else return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new qe(r,this.children_.get(r)):null}forEachChild(t,r){const l=this.resolveIndex_(t);return l?l.inorderTraversal(c=>r(c.name,c.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const l=this.resolveIndex_(r);if(l)return l.getIteratorFrom(t,c=>c);{const c=this.children_.getIteratorFrom(t.name,qe.Wrap);let u=c.peek();for(;u!=null&&r.compare(u,t)<0;)c.getNext(),u=c.peek();return c}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const l=this.resolveIndex_(r);if(l)return l.getReverseIteratorFrom(t,c=>c);{const c=this.children_.getReverseIteratorFrom(t.name,qe.Wrap);let u=c.peek();for(;u!=null&&r.compare(u,t)>0;)c.getNext(),u=c.peek();return c}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Kl?-1:0}withIndex(t){if(t===fs||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new Ie(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===fs||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){const l=this.getIterator(pt),c=r.getIterator(pt);let u=l.getNext(),h=c.getNext();for(;u&&h;){if(u.name!==h.name||!u.node.equals(h.node))return!1;u=l.getNext(),h=c.getNext()}return u===null&&h===null}else return!1;else return!1}}resolveIndex_(t){return t===fs?null:this.indexMap_.get(t.toString())}}Ie.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class BN extends Ie{constructor(){super(new tn(vh),Ie.EMPTY_NODE,ia.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return Ie.EMPTY_NODE}isEmpty(){return!1}}const Kl=new BN;Object.defineProperties(qe,{MIN:{value:new qe(xs,Ie.EMPTY_NODE)},MAX:{value:new qe(xr,Kl)}});ox.__EMPTY_NODE=Ie.EMPTY_NODE;Ot.__childrenNodeConstructor=Ie;IN(Kl);UN(Kl);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qN=!0;function Ut(s,t=null){if(s===null)return Ie.EMPTY_NODE;if(typeof s=="object"&&".priority"in s&&(t=s[".priority"]),ge(t===null||typeof t=="string"||typeof t=="number"||typeof t=="object"&&".sv"in t,"Invalid priority type found: "+typeof t),typeof s=="object"&&".value"in s&&s[".value"]!==null&&(s=s[".value"]),typeof s!="object"||".sv"in s){const r=s;return new Ot(r,Ut(t))}if(!(s instanceof Array)&&qN){const r=[];let l=!1;if(rn(s,(h,g)=>{if(h.substring(0,1)!=="."){const m=Ut(g);m.isEmpty()||(l=l||!m.getPriority().isEmpty(),r.push(new qe(h,m)))}}),r.length===0)return Ie.EMPTY_NODE;const u=Mo(r,MN,h=>h.name,vh);if(l){const h=Mo(r,pt.getCompare());return new Ie(u,Ut(t),new ia({".priority":h},{".priority":pt}))}else return new Ie(u,Ut(t),ia.Default)}else{let r=Ie.EMPTY_NODE;return rn(s,(l,c)=>{if(da(s,l)&&l.substring(0,1)!=="."){const u=Ut(c);(u.isLeafNode()||!u.isEmpty())&&(r=r.updateImmediateChild(l,u))}}),r.updatePriority(Ut(t))}}LN(Ut);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FN extends Xo{constructor(t){super(),this.indexPath_=t,ge(!Ye(t)&&Be(t)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,r){const l=this.extractChild(t.node),c=this.extractChild(r.node),u=l.compareTo(c);return u===0?_s(t.name,r.name):u}makePost(t,r){const l=Ut(t),c=Ie.EMPTY_NODE.updateChild(this.indexPath_,l);return new qe(r,c)}maxPost(){const t=Ie.EMPTY_NODE.updateChild(this.indexPath_,Kl);return new qe(xr,t)}toString(){return sx(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN extends Xo{compare(t,r){const l=t.node.compareTo(r.node);return l===0?_s(t.name,r.name):l}isDefinedOn(t){return!0}indexedValueChanged(t,r){return!t.equals(r)}minPost(){return qe.MIN}maxPost(){return qe.MAX}makePost(t,r){const l=Ut(t);return new qe(r,l)}toString(){return".value"}}const YN=new GN;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fx(s){return{type:"value",snapshotNode:s}}function bs(s,t){return{type:"child_added",snapshotNode:t,childName:s}}function $l(s,t){return{type:"child_removed",snapshotNode:t,childName:s}}function zl(s,t,r){return{type:"child_changed",snapshotNode:t,childName:s,oldSnap:r}}function PN(s,t){return{type:"child_moved",snapshotNode:t,childName:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wh{constructor(t){this.index_=t}updateChild(t,r,l,c,u,h){ge(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const g=t.getImmediateChild(r);return g.getChild(c).equals(l.getChild(c))&&g.isEmpty()===l.isEmpty()||(h!=null&&(l.isEmpty()?t.hasChild(r)?h.trackChildChange($l(r,g)):ge(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):g.isEmpty()?h.trackChildChange(bs(r,l)):h.trackChildChange(zl(r,l,g))),t.isLeafNode()&&l.isEmpty())?t:t.updateImmediateChild(r,l).withIndex(this.index_)}updateFullNode(t,r,l){return l!=null&&(t.isLeafNode()||t.forEachChild(pt,(c,u)=>{r.hasChild(c)||l.trackChildChange($l(c,u))}),r.isLeafNode()||r.forEachChild(pt,(c,u)=>{if(t.hasChild(c)){const h=t.getImmediateChild(c);h.equals(u)||l.trackChildChange(zl(c,u,h))}else l.trackChildChange(bs(c,u))})),r.withIndex(this.index_)}updatePriority(t,r){return t.isEmpty()?Ie.EMPTY_NODE:t.updatePriority(r)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(t){this.indexedFilter_=new wh(t.getIndex()),this.index_=t.getIndex(),this.startPost_=Bl.getStartPost_(t),this.endPost_=Bl.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const r=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,l=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return r&&l}updateChild(t,r,l,c,u,h){return this.matches(new qe(r,l))||(l=Ie.EMPTY_NODE),this.indexedFilter_.updateChild(t,r,l,c,u,h)}updateFullNode(t,r,l){r.isLeafNode()&&(r=Ie.EMPTY_NODE);let c=r.withIndex(this.index_);c=c.updatePriority(Ie.EMPTY_NODE);const u=this;return r.forEachChild(pt,(h,g)=>{u.matches(new qe(h,g))||(c=c.updateImmediateChild(h,Ie.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,c,l)}updatePriority(t,r){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const r=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),r)}else return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const r=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),r)}else return t.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VN{constructor(t){this.withinDirectionalStart=r=>this.reverse_?this.withinEndPost(r):this.withinStartPost(r),this.withinDirectionalEnd=r=>this.reverse_?this.withinStartPost(r):this.withinEndPost(r),this.withinStartPost=r=>{const l=this.index_.compare(this.rangedFilter_.getStartPost(),r);return this.startIsInclusive_?l<=0:l<0},this.withinEndPost=r=>{const l=this.index_.compare(r,this.rangedFilter_.getEndPost());return this.endIsInclusive_?l<=0:l<0},this.rangedFilter_=new Bl(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,r,l,c,u,h){return this.rangedFilter_.matches(new qe(r,l))||(l=Ie.EMPTY_NODE),t.getImmediateChild(r).equals(l)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,r,l,c,u,h):this.fullLimitUpdateChild_(t,r,l,u,h)}updateFullNode(t,r,l){let c;if(r.isLeafNode()||r.isEmpty())c=Ie.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<r.numChildren()&&r.isIndexed(this.index_)){c=Ie.EMPTY_NODE.withIndex(this.index_);let u;this.reverse_?u=r.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):u=r.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let h=0;for(;u.hasNext()&&h<this.limit_;){const g=u.getNext();if(this.withinDirectionalStart(g))if(this.withinDirectionalEnd(g))c=c.updateImmediateChild(g.name,g.node),h++;else break;else continue}}else{c=r.withIndex(this.index_),c=c.updatePriority(Ie.EMPTY_NODE);let u;this.reverse_?u=c.getReverseIterator(this.index_):u=c.getIterator(this.index_);let h=0;for(;u.hasNext();){const g=u.getNext();h<this.limit_&&this.withinDirectionalStart(g)&&this.withinDirectionalEnd(g)?h++:c=c.updateImmediateChild(g.name,Ie.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,c,l)}updatePriority(t,r){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,r,l,c,u){let h;if(this.reverse_){const b=this.index_.getCompare();h=(w,L)=>b(L,w)}else h=this.index_.getCompare();const g=t;ge(g.numChildren()===this.limit_,"");const m=new qe(r,l),p=this.reverse_?g.getFirstChild(this.index_):g.getLastChild(this.index_),x=this.rangedFilter_.matches(m);if(g.hasChild(r)){const b=g.getImmediateChild(r);let w=c.getChildAfterChild(this.index_,p,this.reverse_);for(;w!=null&&(w.name===r||g.hasChild(w.name));)w=c.getChildAfterChild(this.index_,w,this.reverse_);const L=w==null?1:h(w,m);if(x&&!l.isEmpty()&&L>=0)return u?.trackChildChange(zl(r,l,b)),g.updateImmediateChild(r,l);{u?.trackChildChange($l(r,b));const U=g.updateImmediateChild(r,Ie.EMPTY_NODE);return w!=null&&this.rangedFilter_.matches(w)?(u?.trackChildChange(bs(w.name,w.node)),U.updateImmediateChild(w.name,w.node)):U}}else return l.isEmpty()?t:x&&h(p,m)>=0?(u!=null&&(u.trackChildChange($l(p.name,p.node)),u.trackChildChange(bs(r,l))),g.updateImmediateChild(r,l).updateImmediateChild(p.name,Ie.EMPTY_NODE)):t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=pt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return ge(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return ge(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:xs}hasEnd(){return this.endSet_}getIndexEndValue(){return ge(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return ge(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:xr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return ge(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===pt}copy(){const t=new _h;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function WN(s){return s.loadsAllData()?new wh(s.getIndex()):s.hasLimit()?new VN(s):new Bl(s)}function Np(s){const t={};if(s.isDefault())return t;let r;if(s.index_===pt?r="$priority":s.index_===YN?r="$value":s.index_===fs?r="$key":(ge(s.index_ instanceof FN,"Unrecognized index type!"),r=s.index_.toString()),t.orderBy=Tt(r),s.startSet_){const l=s.startAfterSet_?"startAfter":"startAt";t[l]=Tt(s.indexStartValue_),s.startNameSet_&&(t[l]+=","+Tt(s.indexStartName_))}if(s.endSet_){const l=s.endBeforeSet_?"endBefore":"endAt";t[l]=Tt(s.indexEndValue_),s.endNameSet_&&(t[l]+=","+Tt(s.indexEndName_))}return s.limitSet_&&(s.isViewFromLeft()?t.limitToFirst=s.limit_:t.limitToLast=s.limit_),t}function Tp(s){const t={};if(s.startSet_&&(t.sp=s.indexStartValue_,s.startNameSet_&&(t.sn=s.indexStartName_),t.sin=!s.startAfterSet_),s.endSet_&&(t.ep=s.indexEndValue_,s.endNameSet_&&(t.en=s.indexEndName_),t.ein=!s.endBeforeSet_),s.limitSet_){t.l=s.limit_;let r=s.viewFrom_;r===""&&(s.isViewFromLeft()?r="l":r="r"),t.vf=r}return s.index_!==pt&&(t.i=s.index_.toString()),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io extends nx{reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,r){return r!==void 0?"tag$"+r:(ge(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}constructor(t,r,l,c){super(),this.repoInfo_=t,this.onDataUpdate_=r,this.authTokenProvider_=l,this.appCheckTokenProvider_=c,this.log_=Xl("p:rest:"),this.listens_={}}listen(t,r,l,c){const u=t._path.toString();this.log_("Listen called for "+u+" "+t._queryIdentifier);const h=Io.getListenId_(t,l),g={};this.listens_[h]=g;const m=Np(t._queryParams);this.restRequest_(u+".json",m,(p,x)=>{let b=x;if(p===404&&(b=null,p=null),p===null&&this.onDataUpdate_(u,b,!1,l),ms(this.listens_,h)===g){let w;p?p===401?w="permission_denied":w="rest_error:"+p:w="ok",c(w,null)}})}unlisten(t,r){const l=Io.getListenId_(t,r);delete this.listens_[l]}get(t){const r=Np(t._queryParams),l=t._path.toString(),c=new ch;return this.restRequest_(l+".json",r,(u,h)=>{let g=h;u===404&&(g=null,u=null),u===null?(this.onDataUpdate_(l,g,!1,null),c.resolve(g)):c.reject(new Error(g))}),c.promise}refreshAuthToken(t){}restRequest_(t,r={},l){return r.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([c,u])=>{c&&c.accessToken&&(r.auth=c.accessToken),u&&u.token&&(r.ac=u.token);const h=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+o_(r);this.log_("Sending REST request for "+h);const g=new XMLHttpRequest;g.onreadystatechange=()=>{if(l&&g.readyState===4){this.log_("REST Response for "+h+" received. status:",g.status,"response:",g.responseText);let m=null;if(g.status>=200&&g.status<300){try{m=ih(g.responseText)}catch{nn("Failed to parse JSON response for "+h+": "+g.responseText)}l(null,m)}else g.status!==401&&g.status!==404&&nn("Got unsuccessful REST response for "+h+" Status: "+g.status),l(g.status);l=null}},g.open("GET",h,!0),g.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(){this.rootNode_=Ie.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,r){this.rootNode_=this.rootNode_.updateChild(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lo(){return{value:null,children:new Map}}function gx(s,t,r){if(Ye(t))s.value=r,s.children.clear();else if(s.value!==null)s.value=s.value.updateChild(t,r);else{const l=Be(t);s.children.has(l)||s.children.set(l,Lo());const c=s.children.get(l);t=ct(t),gx(c,t,r)}}function Vu(s,t,r){s.value!==null?r(t,s.value):XN(s,(l,c)=>{const u=new it(t.toString()+"/"+l);Vu(c,u,r)})}function XN(s,t){s.children.forEach((r,l)=>{t(l,r)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KN{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),r={...t};return this.last_&&rn(this.last_,(l,c)=>{r[l]=r[l]-c}),this.last_=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sp=10*1e3,ZN=30*1e3,JN=300*1e3;class eT{constructor(t,r){this.server_=r,this.statsToReport_={},this.statsListener_=new KN(t);const l=Sp+(ZN-Sp)*Math.random();Rl(this.reportStats_.bind(this),Math.floor(l))}reportStats_(){const t=this.statsListener_.get(),r={};let l=!1;rn(t,(c,u)=>{u>0&&da(this.statsToReport_,c)&&(r[c]=u,l=!0)}),l&&this.server_.reportStats(r),Rl(this.reportStats_.bind(this),Math.floor(Math.random()*2*JN))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rn;(function(s){s[s.OVERWRITE=0]="OVERWRITE",s[s.MERGE=1]="MERGE",s[s.ACK_USER_WRITE=2]="ACK_USER_WRITE",s[s.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Rn||(Rn={}));function mx(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function kh(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Nh(s){return{fromUser:!1,fromServer:!0,queryId:s,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(t,r,l){this.path=t,this.affectedTree=r,this.revert=l,this.type=Rn.ACK_USER_WRITE,this.source=mx()}operationForChild(t){if(Ye(this.path)){if(this.affectedTree.value!=null)return ge(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const r=this.affectedTree.subtree(new it(t));return new Uo(We(),r,this.revert)}}else return ge(Be(this.path)===t,"operationForChild called for unrelated child."),new Uo(ct(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(t,r){this.source=t,this.path=r,this.type=Rn.LISTEN_COMPLETE}operationForChild(t){return Ye(this.path)?new ql(this.source,We()):new ql(this.source,ct(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(t,r,l){this.source=t,this.path=r,this.snap=l,this.type=Rn.OVERWRITE}operationForChild(t){return Ye(this.path)?new br(this.source,We(),this.snap.getImmediateChild(t)):new br(this.source,ct(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{constructor(t,r,l){this.source=t,this.path=r,this.children=l,this.type=Rn.MERGE}operationForChild(t){if(Ye(this.path)){const r=this.children.subtree(new it(t));return r.isEmpty()?null:r.value?new br(this.source,We(),r.value):new Fl(this.source,We(),r)}else return ge(Be(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new Fl(this.source,ct(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(t,r,l){this.node_=t,this.fullyInitialized_=r,this.filtered_=l}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(Ye(t))return this.isFullyInitialized()&&!this.filtered_;const r=Be(t);return this.isCompleteForChild(r)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function nT(s,t,r,l){const c=[],u=[];return t.forEach(h=>{h.type==="child_changed"&&s.index_.indexedValueChanged(h.oldSnap,h.snapshotNode)&&u.push(PN(h.childName,h.snapshotNode))}),jl(s,c,"child_removed",t,l,r),jl(s,c,"child_added",t,l,r),jl(s,c,"child_moved",u,l,r),jl(s,c,"child_changed",t,l,r),jl(s,c,"value",t,l,r),c}function jl(s,t,r,l,c,u){const h=l.filter(g=>g.type===r);h.sort((g,m)=>rT(s,g,m)),h.forEach(g=>{const m=aT(s,g,u);c.forEach(p=>{p.respondsTo(g.type)&&t.push(p.createEvent(m,s.query_))})})}function aT(s,t,r){return t.type==="value"||t.type==="child_removed"||(t.prevName=r.getPredecessorChildName(t.childName,t.snapshotNode,s.index_)),t}function rT(s,t,r){if(t.childName==null||r.childName==null)throw Wl("Should only compare child_ events.");const l=new qe(t.childName,t.snapshotNode),c=new qe(r.childName,r.snapshotNode);return s.index_.compare(l,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ko(s,t){return{eventCache:s,serverCache:t}}function Ol(s,t,r,l){return Ko(new Ya(t,r,l),s.serverCache)}function px(s,t,r,l){return Ko(s.eventCache,new Ya(t,r,l))}function Ho(s){return s.eventCache.isFullyInitialized()?s.eventCache.getNode():null}function vr(s){return s.serverCache.isFullyInitialized()?s.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lu;const sT=()=>(Lu||(Lu=new tn(Gk)),Lu);class dt{static fromObject(t){let r=new dt(null);return rn(t,(l,c)=>{r=r.set(new it(l),c)}),r}constructor(t,r=sT()){this.value=t,this.children=r}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,r){if(this.value!=null&&r(this.value))return{path:We(),value:this.value};if(Ye(t))return null;{const l=Be(t),c=this.children.get(l);if(c!==null){const u=c.findRootMostMatchingPathAndValue(ct(t),r);return u!=null?{path:St(new it(l),u.path),value:u.value}:null}else return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(Ye(t))return this;{const r=Be(t),l=this.children.get(r);return l!==null?l.subtree(ct(t)):new dt(null)}}set(t,r){if(Ye(t))return new dt(r,this.children);{const l=Be(t),u=(this.children.get(l)||new dt(null)).set(ct(t),r),h=this.children.insert(l,u);return new dt(this.value,h)}}remove(t){if(Ye(t))return this.children.isEmpty()?new dt(null):new dt(null,this.children);{const r=Be(t),l=this.children.get(r);if(l){const c=l.remove(ct(t));let u;return c.isEmpty()?u=this.children.remove(r):u=this.children.insert(r,c),this.value===null&&u.isEmpty()?new dt(null):new dt(this.value,u)}else return this}}get(t){if(Ye(t))return this.value;{const r=Be(t),l=this.children.get(r);return l?l.get(ct(t)):null}}setTree(t,r){if(Ye(t))return r;{const l=Be(t),u=(this.children.get(l)||new dt(null)).setTree(ct(t),r);let h;return u.isEmpty()?h=this.children.remove(l):h=this.children.insert(l,u),new dt(this.value,h)}}fold(t){return this.fold_(We(),t)}fold_(t,r){const l={};return this.children.inorderTraversal((c,u)=>{l[c]=u.fold_(St(t,c),r)}),r(t,this.value,l)}findOnPath(t,r){return this.findOnPath_(t,We(),r)}findOnPath_(t,r,l){const c=this.value?l(r,this.value):!1;if(c)return c;if(Ye(t))return null;{const u=Be(t),h=this.children.get(u);return h?h.findOnPath_(ct(t),St(r,u),l):null}}foreachOnPath(t,r){return this.foreachOnPath_(t,We(),r)}foreachOnPath_(t,r,l){if(Ye(t))return this;{this.value&&l(r,this.value);const c=Be(t),u=this.children.get(c);return u?u.foreachOnPath_(ct(t),St(r,c),l):new dt(null)}}foreach(t){this.foreach_(We(),t)}foreach_(t,r){this.children.inorderTraversal((l,c)=>{c.foreach_(St(t,l),r)}),this.value&&r(t,this.value)}foreachChild(t){this.children.inorderTraversal((r,l)=>{l.value&&t(r,l.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(t){this.writeTree_=t}static empty(){return new On(new dt(null))}}function Ml(s,t,r){if(Ye(t))return new On(new dt(r));{const l=s.writeTree_.findRootMostValueAndPath(t);if(l!=null){const c=l.path;let u=l.value;const h=Wt(c,t);return u=u.updateChild(h,r),new On(s.writeTree_.set(c,u))}else{const c=new dt(r),u=s.writeTree_.setTree(t,c);return new On(u)}}}function jp(s,t,r){let l=s;return rn(r,(c,u)=>{l=Ml(l,St(t,c),u)}),l}function Dp(s,t){if(Ye(t))return On.empty();{const r=s.writeTree_.setTree(t,new dt(null));return new On(r)}}function Wu(s,t){return wr(s,t)!=null}function wr(s,t){const r=s.writeTree_.findRootMostValueAndPath(t);return r!=null?s.writeTree_.get(r.path).getChild(Wt(r.path,t)):null}function Ep(s){const t=[],r=s.writeTree_.value;return r!=null?r.isLeafNode()||r.forEachChild(pt,(l,c)=>{t.push(new qe(l,c))}):s.writeTree_.children.inorderTraversal((l,c)=>{c.value!=null&&t.push(new qe(l,c.value))}),t}function qa(s,t){if(Ye(t))return s;{const r=wr(s,t);return r!=null?new On(new dt(r)):new On(s.writeTree_.subtree(t))}}function Qu(s){return s.writeTree_.isEmpty()}function vs(s,t){return yx(We(),s.writeTree_,t)}function yx(s,t,r){if(t.value!=null)return r.updateChild(s,t.value);{let l=null;return t.children.inorderTraversal((c,u)=>{c===".priority"?(ge(u.value!==null,"Priority writes must always be leaf nodes"),l=u.value):r=yx(St(s,c),u,r)}),!r.getChild(s).isEmpty()&&l!==null&&(r=r.updateChild(St(s,".priority"),l)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zo(s,t){return wx(t,s)}function lT(s,t,r,l,c){ge(l>s.lastWriteId,"Stacking an older write on top of newer ones"),c===void 0&&(c=!0),s.allWrites.push({path:t,snap:r,writeId:l,visible:c}),c&&(s.visibleWrites=Ml(s.visibleWrites,t,r)),s.lastWriteId=l}function iT(s,t){for(let r=0;r<s.allWrites.length;r++){const l=s.allWrites[r];if(l.writeId===t)return l}return null}function oT(s,t){const r=s.allWrites.findIndex(g=>g.writeId===t);ge(r>=0,"removeWrite called with nonexistent writeId.");const l=s.allWrites[r];s.allWrites.splice(r,1);let c=l.visible,u=!1,h=s.allWrites.length-1;for(;c&&h>=0;){const g=s.allWrites[h];g.visible&&(h>=r&&cT(g,l.path)?c=!1:An(l.path,g.path)&&(u=!0)),h--}if(c){if(u)return dT(s),!0;if(l.snap)s.visibleWrites=Dp(s.visibleWrites,l.path);else{const g=l.children;rn(g,m=>{s.visibleWrites=Dp(s.visibleWrites,St(l.path,m))})}return!0}else return!1}function cT(s,t){if(s.snap)return An(s.path,t);for(const r in s.children)if(s.children.hasOwnProperty(r)&&An(St(s.path,r),t))return!0;return!1}function dT(s){s.visibleWrites=xx(s.allWrites,uT,We()),s.allWrites.length>0?s.lastWriteId=s.allWrites[s.allWrites.length-1].writeId:s.lastWriteId=-1}function uT(s){return s.visible}function xx(s,t,r){let l=On.empty();for(let c=0;c<s.length;++c){const u=s[c];if(t(u)){const h=u.path;let g;if(u.snap)An(r,h)?(g=Wt(r,h),l=Ml(l,g,u.snap)):An(h,r)&&(g=Wt(h,r),l=Ml(l,We(),u.snap.getChild(g)));else if(u.children){if(An(r,h))g=Wt(r,h),l=jp(l,g,u.children);else if(An(h,r))if(g=Wt(h,r),Ye(g))l=jp(l,We(),u.children);else{const m=ms(u.children,Be(g));if(m){const p=m.getChild(ct(g));l=Ml(l,We(),p)}}}else throw Wl("WriteRecord should have .snap or .children")}}return l}function bx(s,t,r,l,c){if(!l&&!c){const u=wr(s.visibleWrites,t);if(u!=null)return u;{const h=qa(s.visibleWrites,t);if(Qu(h))return r;if(r==null&&!Wu(h,We()))return null;{const g=r||Ie.EMPTY_NODE;return vs(h,g)}}}else{const u=qa(s.visibleWrites,t);if(!c&&Qu(u))return r;if(!c&&r==null&&!Wu(u,We()))return null;{const h=function(p){return(p.visible||c)&&(!l||!~l.indexOf(p.writeId))&&(An(p.path,t)||An(t,p.path))},g=xx(s.allWrites,h,t),m=r||Ie.EMPTY_NODE;return vs(g,m)}}}function hT(s,t,r){let l=Ie.EMPTY_NODE;const c=wr(s.visibleWrites,t);if(c)return c.isLeafNode()||c.forEachChild(pt,(u,h)=>{l=l.updateImmediateChild(u,h)}),l;if(r){const u=qa(s.visibleWrites,t);return r.forEachChild(pt,(h,g)=>{const m=vs(qa(u,new it(h)),g);l=l.updateImmediateChild(h,m)}),Ep(u).forEach(h=>{l=l.updateImmediateChild(h.name,h.node)}),l}else{const u=qa(s.visibleWrites,t);return Ep(u).forEach(h=>{l=l.updateImmediateChild(h.name,h.node)}),l}}function fT(s,t,r,l,c){ge(l||c,"Either existingEventSnap or existingServerSnap must exist");const u=St(t,r);if(Wu(s.visibleWrites,u))return null;{const h=qa(s.visibleWrites,u);return Qu(h)?c.getChild(r):vs(h,c.getChild(r))}}function gT(s,t,r,l){const c=St(t,r),u=wr(s.visibleWrites,c);if(u!=null)return u;if(l.isCompleteForChild(r)){const h=qa(s.visibleWrites,c);return vs(h,l.getNode().getImmediateChild(r))}else return null}function mT(s,t){return wr(s.visibleWrites,t)}function pT(s,t,r,l,c,u,h){let g;const m=qa(s.visibleWrites,t),p=wr(m,We());if(p!=null)g=p;else if(r!=null)g=vs(m,r);else return[];if(g=g.withIndex(h),!g.isEmpty()&&!g.isLeafNode()){const x=[],b=h.getCompare(),w=u?g.getReverseIteratorFrom(l,h):g.getIteratorFrom(l,h);let L=w.getNext();for(;L&&x.length<c;)b(L,l)!==0&&x.push(L),L=w.getNext();return x}else return[]}function yT(){return{visibleWrites:On.empty(),allWrites:[],lastWriteId:-1}}function $o(s,t,r,l){return bx(s.writeTree,s.treePath,t,r,l)}function Th(s,t){return hT(s.writeTree,s.treePath,t)}function Cp(s,t,r,l){return fT(s.writeTree,s.treePath,t,r,l)}function zo(s,t){return mT(s.writeTree,St(s.treePath,t))}function xT(s,t,r,l,c,u){return pT(s.writeTree,s.treePath,t,r,l,c,u)}function Sh(s,t,r){return gT(s.writeTree,s.treePath,t,r)}function vx(s,t){return wx(St(s.treePath,t),s.writeTree)}function wx(s,t){return{treePath:s,writeTree:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(){this.changeMap=new Map}trackChildChange(t){const r=t.type,l=t.childName;ge(r==="child_added"||r==="child_changed"||r==="child_removed","Only child changes supported for tracking"),ge(l!==".priority","Only non-priority child changes can be tracked.");const c=this.changeMap.get(l);if(c){const u=c.type;if(r==="child_added"&&u==="child_removed")this.changeMap.set(l,zl(l,t.snapshotNode,c.snapshotNode));else if(r==="child_removed"&&u==="child_added")this.changeMap.delete(l);else if(r==="child_removed"&&u==="child_changed")this.changeMap.set(l,$l(l,c.oldSnap));else if(r==="child_changed"&&u==="child_added")this.changeMap.set(l,bs(l,t.snapshotNode));else if(r==="child_changed"&&u==="child_changed")this.changeMap.set(l,zl(l,t.snapshotNode,c.oldSnap));else throw Wl("Illegal combination of changes: "+t+" occurred after "+c)}else this.changeMap.set(l,t)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT{getCompleteChild(t){return null}getChildAfterChild(t,r,l){return null}}const _x=new vT;class jh{constructor(t,r,l=null){this.writes_=t,this.viewCache_=r,this.optCompleteServerCache_=l}getCompleteChild(t){const r=this.viewCache_.eventCache;if(r.isCompleteForChild(t))return r.getNode().getImmediateChild(t);{const l=this.optCompleteServerCache_!=null?new Ya(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Sh(this.writes_,t,l)}}getChildAfterChild(t,r,l){const c=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:vr(this.viewCache_),u=xT(this.writes_,c,r,1,l,t);return u.length===0?null:u[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wT(s){return{filter:s}}function _T(s,t){ge(t.eventCache.getNode().isIndexed(s.filter.getIndex()),"Event snap not indexed"),ge(t.serverCache.getNode().isIndexed(s.filter.getIndex()),"Server snap not indexed")}function kT(s,t,r,l,c){const u=new bT;let h,g;if(r.type===Rn.OVERWRITE){const p=r;p.source.fromUser?h=Xu(s,t,p.path,p.snap,l,c,u):(ge(p.source.fromServer,"Unknown source."),g=p.source.tagged||t.serverCache.isFiltered()&&!Ye(p.path),h=Bo(s,t,p.path,p.snap,l,c,g,u))}else if(r.type===Rn.MERGE){const p=r;p.source.fromUser?h=TT(s,t,p.path,p.children,l,c,u):(ge(p.source.fromServer,"Unknown source."),g=p.source.tagged||t.serverCache.isFiltered(),h=Ku(s,t,p.path,p.children,l,c,g,u))}else if(r.type===Rn.ACK_USER_WRITE){const p=r;p.revert?h=DT(s,t,p.path,l,c,u):h=ST(s,t,p.path,p.affectedTree,l,c,u)}else if(r.type===Rn.LISTEN_COMPLETE)h=jT(s,t,r.path,l,u);else throw Wl("Unknown operation type: "+r.type);const m=u.getChanges();return NT(t,h,m),{viewCache:h,changes:m}}function NT(s,t,r){const l=t.eventCache;if(l.isFullyInitialized()){const c=l.getNode().isLeafNode()||l.getNode().isEmpty(),u=Ho(s);(r.length>0||!s.eventCache.isFullyInitialized()||c&&!l.getNode().equals(u)||!l.getNode().getPriority().equals(u.getPriority()))&&r.push(fx(Ho(t)))}}function kx(s,t,r,l,c,u){const h=t.eventCache;if(zo(l,r)!=null)return t;{let g,m;if(Ye(r))if(ge(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const p=vr(t),x=p instanceof Ie?p:Ie.EMPTY_NODE,b=Th(l,x);g=s.filter.updateFullNode(t.eventCache.getNode(),b,u)}else{const p=$o(l,vr(t));g=s.filter.updateFullNode(t.eventCache.getNode(),p,u)}else{const p=Be(r);if(p===".priority"){ge(Ga(r)===1,"Can't have a priority with additional path components");const x=h.getNode();m=t.serverCache.getNode();const b=Cp(l,r,x,m);b!=null?g=s.filter.updatePriority(x,b):g=h.getNode()}else{const x=ct(r);let b;if(h.isCompleteForChild(p)){m=t.serverCache.getNode();const w=Cp(l,r,h.getNode(),m);w!=null?b=h.getNode().getImmediateChild(p).updateChild(x,w):b=h.getNode().getImmediateChild(p)}else b=Sh(l,p,t.serverCache);b!=null?g=s.filter.updateChild(h.getNode(),p,b,x,c,u):g=h.getNode()}}return Ol(t,g,h.isFullyInitialized()||Ye(r),s.filter.filtersNodes())}}function Bo(s,t,r,l,c,u,h,g){const m=t.serverCache;let p;const x=h?s.filter:s.filter.getIndexedFilter();if(Ye(r))p=x.updateFullNode(m.getNode(),l,null);else if(x.filtersNodes()&&!m.isFiltered()){const L=m.getNode().updateChild(r,l);p=x.updateFullNode(m.getNode(),L,null)}else{const L=Be(r);if(!m.isCompleteForPath(r)&&Ga(r)>1)return t;const T=ct(r),Y=m.getNode().getImmediateChild(L).updateChild(T,l);L===".priority"?p=x.updatePriority(m.getNode(),Y):p=x.updateChild(m.getNode(),L,Y,T,_x,null)}const b=px(t,p,m.isFullyInitialized()||Ye(r),x.filtersNodes()),w=new jh(c,b,u);return kx(s,b,r,c,w,g)}function Xu(s,t,r,l,c,u,h){const g=t.eventCache;let m,p;const x=new jh(c,t,u);if(Ye(r))p=s.filter.updateFullNode(t.eventCache.getNode(),l,h),m=Ol(t,p,!0,s.filter.filtersNodes());else{const b=Be(r);if(b===".priority")p=s.filter.updatePriority(t.eventCache.getNode(),l),m=Ol(t,p,g.isFullyInitialized(),g.isFiltered());else{const w=ct(r),L=g.getNode().getImmediateChild(b);let T;if(Ye(w))T=l;else{const U=x.getCompleteChild(b);U!=null?rx(w)===".priority"&&U.getChild(lx(w)).isEmpty()?T=U:T=U.updateChild(w,l):T=Ie.EMPTY_NODE}if(L.equals(T))m=t;else{const U=s.filter.updateChild(g.getNode(),b,T,w,x,h);m=Ol(t,U,g.isFullyInitialized(),s.filter.filtersNodes())}}}return m}function Ap(s,t){return s.eventCache.isCompleteForChild(t)}function TT(s,t,r,l,c,u,h){let g=t;return l.foreach((m,p)=>{const x=St(r,m);Ap(t,Be(x))&&(g=Xu(s,g,x,p,c,u,h))}),l.foreach((m,p)=>{const x=St(r,m);Ap(t,Be(x))||(g=Xu(s,g,x,p,c,u,h))}),g}function Rp(s,t,r){return r.foreach((l,c)=>{t=t.updateChild(l,c)}),t}function Ku(s,t,r,l,c,u,h,g){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let m=t,p;Ye(r)?p=l:p=new dt(null).setTree(r,l);const x=t.serverCache.getNode();return p.children.inorderTraversal((b,w)=>{if(x.hasChild(b)){const L=t.serverCache.getNode().getImmediateChild(b),T=Rp(s,L,w);m=Bo(s,m,new it(b),T,c,u,h,g)}}),p.children.inorderTraversal((b,w)=>{const L=!t.serverCache.isCompleteForChild(b)&&w.value===null;if(!x.hasChild(b)&&!L){const T=t.serverCache.getNode().getImmediateChild(b),U=Rp(s,T,w);m=Bo(s,m,new it(b),U,c,u,h,g)}}),m}function ST(s,t,r,l,c,u,h){if(zo(c,r)!=null)return t;const g=t.serverCache.isFiltered(),m=t.serverCache;if(l.value!=null){if(Ye(r)&&m.isFullyInitialized()||m.isCompleteForPath(r))return Bo(s,t,r,m.getNode().getChild(r),c,u,g,h);if(Ye(r)){let p=new dt(null);return m.getNode().forEachChild(fs,(x,b)=>{p=p.set(new it(x),b)}),Ku(s,t,r,p,c,u,g,h)}else return t}else{let p=new dt(null);return l.foreach((x,b)=>{const w=St(r,x);m.isCompleteForPath(w)&&(p=p.set(x,m.getNode().getChild(w)))}),Ku(s,t,r,p,c,u,g,h)}}function jT(s,t,r,l,c){const u=t.serverCache,h=px(t,u.getNode(),u.isFullyInitialized()||Ye(r),u.isFiltered());return kx(s,h,r,l,_x,c)}function DT(s,t,r,l,c,u){let h;if(zo(l,r)!=null)return t;{const g=new jh(l,t,c),m=t.eventCache.getNode();let p;if(Ye(r)||Be(r)===".priority"){let x;if(t.serverCache.isFullyInitialized())x=$o(l,vr(t));else{const b=t.serverCache.getNode();ge(b instanceof Ie,"serverChildren would be complete if leaf node"),x=Th(l,b)}x=x,p=s.filter.updateFullNode(m,x,u)}else{const x=Be(r);let b=Sh(l,x,t.serverCache);b==null&&t.serverCache.isCompleteForChild(x)&&(b=m.getImmediateChild(x)),b!=null?p=s.filter.updateChild(m,x,b,ct(r),g,u):t.eventCache.getNode().hasChild(x)?p=s.filter.updateChild(m,x,Ie.EMPTY_NODE,ct(r),g,u):p=m,p.isEmpty()&&t.serverCache.isFullyInitialized()&&(h=$o(l,vr(t)),h.isLeafNode()&&(p=s.filter.updateFullNode(p,h,u)))}return h=t.serverCache.isFullyInitialized()||zo(l,We())!=null,Ol(t,p,h,s.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ET{constructor(t,r){this.query_=t,this.eventRegistrations_=[];const l=this.query_._queryParams,c=new wh(l.getIndex()),u=WN(l);this.processor_=wT(u);const h=r.serverCache,g=r.eventCache,m=c.updateFullNode(Ie.EMPTY_NODE,h.getNode(),null),p=u.updateFullNode(Ie.EMPTY_NODE,g.getNode(),null),x=new Ya(m,h.isFullyInitialized(),c.filtersNodes()),b=new Ya(p,g.isFullyInitialized(),u.filtersNodes());this.viewCache_=Ko(b,x),this.eventGenerator_=new tT(this.query_)}get query(){return this.query_}}function CT(s){return s.viewCache_.serverCache.getNode()}function AT(s){return Ho(s.viewCache_)}function RT(s,t){const r=vr(s.viewCache_);return r&&(s.query._queryParams.loadsAllData()||!Ye(t)&&!r.getImmediateChild(Be(t)).isEmpty())?r.getChild(t):null}function Op(s){return s.eventRegistrations_.length===0}function OT(s,t){s.eventRegistrations_.push(t)}function Mp(s,t,r){const l=[];if(r){ge(t==null,"A cancel should cancel all event registrations.");const c=s.query._path;s.eventRegistrations_.forEach(u=>{const h=u.createCancelEvent(r,c);h&&l.push(h)})}if(t){let c=[];for(let u=0;u<s.eventRegistrations_.length;++u){const h=s.eventRegistrations_[u];if(!h.matches(t))c.push(h);else if(t.hasAnyCallback()){c=c.concat(s.eventRegistrations_.slice(u+1));break}}s.eventRegistrations_=c}else s.eventRegistrations_=[];return l}function Ip(s,t,r,l){t.type===Rn.MERGE&&t.source.queryId!==null&&(ge(vr(s.viewCache_),"We should always have a full cache before handling merges"),ge(Ho(s.viewCache_),"Missing event cache, even though we have a server cache"));const c=s.viewCache_,u=kT(s.processor_,c,t,r,l);return _T(s.processor_,u.viewCache),ge(u.viewCache.serverCache.isFullyInitialized()||!c.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),s.viewCache_=u.viewCache,Nx(s,u.changes,u.viewCache.eventCache.getNode(),null)}function MT(s,t){const r=s.viewCache_.eventCache,l=[];return r.getNode().isLeafNode()||r.getNode().forEachChild(pt,(u,h)=>{l.push(bs(u,h))}),r.isFullyInitialized()&&l.push(fx(r.getNode())),Nx(s,l,r.getNode(),t)}function Nx(s,t,r,l){const c=l?[l]:s.eventRegistrations_;return nT(s.eventGenerator_,t,r,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qo;class Tx{constructor(){this.views=new Map}}function IT(s){ge(!qo,"__referenceConstructor has already been defined"),qo=s}function LT(){return ge(qo,"Reference.ts has not been loaded"),qo}function UT(s){return s.views.size===0}function Dh(s,t,r,l){const c=t.source.queryId;if(c!==null){const u=s.views.get(c);return ge(u!=null,"SyncTree gave us an op for an invalid query."),Ip(u,t,r,l)}else{let u=[];for(const h of s.views.values())u=u.concat(Ip(h,t,r,l));return u}}function Sx(s,t,r,l,c){const u=t._queryIdentifier,h=s.views.get(u);if(!h){let g=$o(r,c?l:null),m=!1;g?m=!0:l instanceof Ie?(g=Th(r,l),m=!1):(g=Ie.EMPTY_NODE,m=!1);const p=Ko(new Ya(g,m,!1),new Ya(l,c,!1));return new ET(t,p)}return h}function HT(s,t,r,l,c,u){const h=Sx(s,t,l,c,u);return s.views.has(t._queryIdentifier)||s.views.set(t._queryIdentifier,h),OT(h,r),MT(h,r)}function $T(s,t,r,l){const c=t._queryIdentifier,u=[];let h=[];const g=Pa(s);if(c==="default")for(const[m,p]of s.views.entries())h=h.concat(Mp(p,r,l)),Op(p)&&(s.views.delete(m),p.query._queryParams.loadsAllData()||u.push(p.query));else{const m=s.views.get(c);m&&(h=h.concat(Mp(m,r,l)),Op(m)&&(s.views.delete(c),m.query._queryParams.loadsAllData()||u.push(m.query)))}return g&&!Pa(s)&&u.push(new(LT())(t._repo,t._path)),{removed:u,events:h}}function jx(s){const t=[];for(const r of s.views.values())r.query._queryParams.loadsAllData()||t.push(r);return t}function Fa(s,t){let r=null;for(const l of s.views.values())r=r||RT(l,t);return r}function Dx(s,t){if(t._queryParams.loadsAllData())return Jo(s);{const l=t._queryIdentifier;return s.views.get(l)}}function Ex(s,t){return Dx(s,t)!=null}function Pa(s){return Jo(s)!=null}function Jo(s){for(const t of s.views.values())if(t.query._queryParams.loadsAllData())return t;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fo;function zT(s){ge(!Fo,"__referenceConstructor has already been defined"),Fo=s}function BT(){return ge(Fo,"Reference.ts has not been loaded"),Fo}let qT=1;class Lp{constructor(t){this.listenProvider_=t,this.syncPointTree_=new dt(null),this.pendingWriteTree_=yT(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Cx(s,t,r,l,c){return lT(s.pendingWriteTree_,t,r,l,c),c?Jl(s,new br(mx(),t,r)):[]}function pr(s,t,r=!1){const l=iT(s.pendingWriteTree_,t);if(oT(s.pendingWriteTree_,t)){let u=new dt(null);return l.snap!=null?u=u.set(We(),!0):rn(l.children,h=>{u=u.set(new it(h),!0)}),Jl(s,new Uo(l.path,u,r))}else return[]}function Zl(s,t,r){return Jl(s,new br(kh(),t,r))}function FT(s,t,r){const l=dt.fromObject(r);return Jl(s,new Fl(kh(),t,l))}function GT(s,t){return Jl(s,new ql(kh(),t))}function YT(s,t,r){const l=Ch(s,r);if(l){const c=Ah(l),u=c.path,h=c.queryId,g=Wt(u,t),m=new ql(Nh(h),g);return Rh(s,u,m)}else return[]}function Go(s,t,r,l,c=!1){const u=t._path,h=s.syncPointTree_.get(u);let g=[];if(h&&(t._queryIdentifier==="default"||Ex(h,t))){const m=$T(h,t,r,l);UT(h)&&(s.syncPointTree_=s.syncPointTree_.remove(u));const p=m.removed;if(g=m.events,!c){const x=p.findIndex(w=>w._queryParams.loadsAllData())!==-1,b=s.syncPointTree_.findOnPath(u,(w,L)=>Pa(L));if(x&&!b){const w=s.syncPointTree_.subtree(u);if(!w.isEmpty()){const L=WT(w);for(let T=0;T<L.length;++T){const U=L[T],Y=U.query,k=Mx(s,U);s.listenProvider_.startListening(Il(Y),Gl(s,Y),k.hashFn,k.onComplete)}}}!b&&p.length>0&&!l&&(x?s.listenProvider_.stopListening(Il(t),null):p.forEach(w=>{const L=s.queryToTagMap.get(ec(w));s.listenProvider_.stopListening(Il(w),L)}))}QT(s,p)}return g}function Ax(s,t,r,l){const c=Ch(s,l);if(c!=null){const u=Ah(c),h=u.path,g=u.queryId,m=Wt(h,t),p=new br(Nh(g),m,r);return Rh(s,h,p)}else return[]}function PT(s,t,r,l){const c=Ch(s,l);if(c){const u=Ah(c),h=u.path,g=u.queryId,m=Wt(h,t),p=dt.fromObject(r),x=new Fl(Nh(g),m,p);return Rh(s,h,x)}else return[]}function Zu(s,t,r,l=!1){const c=t._path;let u=null,h=!1;s.syncPointTree_.foreachOnPath(c,(w,L)=>{const T=Wt(w,c);u=u||Fa(L,T),h=h||Pa(L)});let g=s.syncPointTree_.get(c);g?(h=h||Pa(g),u=u||Fa(g,We())):(g=new Tx,s.syncPointTree_=s.syncPointTree_.set(c,g));let m;u!=null?m=!0:(m=!1,u=Ie.EMPTY_NODE,s.syncPointTree_.subtree(c).foreachChild((L,T)=>{const U=Fa(T,We());U&&(u=u.updateImmediateChild(L,U))}));const p=Ex(g,t);if(!p&&!t._queryParams.loadsAllData()){const w=ec(t);ge(!s.queryToTagMap.has(w),"View does not exist, but we have a tag");const L=XT();s.queryToTagMap.set(w,L),s.tagToQueryMap.set(L,w)}const x=Zo(s.pendingWriteTree_,c);let b=HT(g,t,r,x,u,m);if(!p&&!h&&!l){const w=Dx(g,t);b=b.concat(KT(s,t,w))}return b}function Eh(s,t,r){const c=s.pendingWriteTree_,u=s.syncPointTree_.findOnPath(t,(h,g)=>{const m=Wt(h,t),p=Fa(g,m);if(p)return p});return bx(c,t,u,r,!0)}function VT(s,t){const r=t._path;let l=null;s.syncPointTree_.foreachOnPath(r,(p,x)=>{const b=Wt(p,r);l=l||Fa(x,b)});let c=s.syncPointTree_.get(r);c?l=l||Fa(c,We()):(c=new Tx,s.syncPointTree_=s.syncPointTree_.set(r,c));const u=l!=null,h=u?new Ya(l,!0,!1):null,g=Zo(s.pendingWriteTree_,t._path),m=Sx(c,t,g,u?h.getNode():Ie.EMPTY_NODE,u);return AT(m)}function Jl(s,t){return Rx(t,s.syncPointTree_,null,Zo(s.pendingWriteTree_,We()))}function Rx(s,t,r,l){if(Ye(s.path))return Ox(s,t,r,l);{const c=t.get(We());r==null&&c!=null&&(r=Fa(c,We()));let u=[];const h=Be(s.path),g=s.operationForChild(h),m=t.children.get(h);if(m&&g){const p=r?r.getImmediateChild(h):null,x=vx(l,h);u=u.concat(Rx(g,m,p,x))}return c&&(u=u.concat(Dh(c,s,l,r))),u}}function Ox(s,t,r,l){const c=t.get(We());r==null&&c!=null&&(r=Fa(c,We()));let u=[];return t.children.inorderTraversal((h,g)=>{const m=r?r.getImmediateChild(h):null,p=vx(l,h),x=s.operationForChild(h);x&&(u=u.concat(Ox(x,g,m,p)))}),c&&(u=u.concat(Dh(c,s,l,r))),u}function Mx(s,t){const r=t.query,l=Gl(s,r);return{hashFn:()=>(CT(t)||Ie.EMPTY_NODE).hash(),onComplete:c=>{if(c==="ok")return l?YT(s,r._path,l):GT(s,r._path);{const u=Vk(c,r);return Go(s,r,null,u)}}}}function Gl(s,t){const r=ec(t);return s.queryToTagMap.get(r)}function ec(s){return s._path.toString()+"$"+s._queryIdentifier}function Ch(s,t){return s.tagToQueryMap.get(t)}function Ah(s){const t=s.indexOf("$");return ge(t!==-1&&t<s.length-1,"Bad queryKey."),{queryId:s.substr(t+1),path:new it(s.substr(0,t))}}function Rh(s,t,r){const l=s.syncPointTree_.get(t);ge(l,"Missing sync point for query tag that we're tracking");const c=Zo(s.pendingWriteTree_,t);return Dh(l,r,c,null)}function WT(s){return s.fold((t,r,l)=>{if(r&&Pa(r))return[Jo(r)];{let c=[];return r&&(c=jx(r)),rn(l,(u,h)=>{c=c.concat(h)}),c}})}function Il(s){return s._queryParams.loadsAllData()&&!s._queryParams.isDefault()?new(BT())(s._repo,s._path):s}function QT(s,t){for(let r=0;r<t.length;++r){const l=t[r];if(!l._queryParams.loadsAllData()){const c=ec(l),u=s.queryToTagMap.get(c);s.queryToTagMap.delete(c),s.tagToQueryMap.delete(u)}}}function XT(){return qT++}function KT(s,t,r){const l=t._path,c=Gl(s,t),u=Mx(s,r),h=s.listenProvider_.startListening(Il(t),c,u.hashFn,u.onComplete),g=s.syncPointTree_.subtree(l);if(c)ge(!Pa(g.value),"If we're adding a query, it shouldn't be shadowed");else{const m=g.fold((p,x,b)=>{if(!Ye(p)&&x&&Pa(x))return[Jo(x).query];{let w=[];return x&&(w=w.concat(jx(x).map(L=>L.query))),rn(b,(L,T)=>{w=w.concat(T)}),w}});for(let p=0;p<m.length;++p){const x=m[p];s.listenProvider_.stopListening(Il(x),Gl(s,x))}}return h}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(t){this.node_=t}getImmediateChild(t){const r=this.node_.getImmediateChild(t);return new Oh(r)}node(){return this.node_}}class Mh{constructor(t,r){this.syncTree_=t,this.path_=r}getImmediateChild(t){const r=St(this.path_,t);return new Mh(this.syncTree_,r)}node(){return Eh(this.syncTree_,this.path_)}}const ZT=function(s){return s=s||{},s.timestamp=s.timestamp||new Date().getTime(),s},Up=function(s,t,r){if(!s||typeof s!="object")return s;if(ge(".sv"in s,"Unexpected leaf node or priority contents"),typeof s[".sv"]=="string")return JT(s[".sv"],t,r);if(typeof s[".sv"]=="object")return e1(s[".sv"],t);ge(!1,"Unexpected server value: "+JSON.stringify(s,null,2))},JT=function(s,t,r){switch(s){case"timestamp":return r.timestamp;default:ge(!1,"Unexpected server value: "+s)}},e1=function(s,t,r){s.hasOwnProperty("increment")||ge(!1,"Unexpected server value: "+JSON.stringify(s,null,2));const l=s.increment;typeof l!="number"&&ge(!1,"Unexpected increment value: "+l);const c=t.node();if(ge(c!==null&&typeof c<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!c.isLeafNode())return l;const h=c.getValue();return typeof h!="number"?l:h+l},t1=function(s,t,r,l){return Ih(t,new Mh(r,s),l)},Ix=function(s,t,r){return Ih(s,new Oh(t),r)};function Ih(s,t,r){const l=s.getPriority().val(),c=Up(l,t.getImmediateChild(".priority"),r);let u;if(s.isLeafNode()){const h=s,g=Up(h.getValue(),t,r);return g!==h.getValue()||c!==h.getPriority().val()?new Ot(g,Ut(c)):s}else{const h=s;return u=h,c!==h.getPriority().val()&&(u=u.updatePriority(new Ot(c))),h.forEachChild(pt,(g,m)=>{const p=Ih(m,t.getImmediateChild(g),r);p!==m&&(u=u.updateImmediateChild(g,p))}),u}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{constructor(t="",r=null,l={children:{},childCount:0}){this.name=t,this.parent=r,this.node=l}}function Uh(s,t){let r=t instanceof it?t:new it(t),l=s,c=Be(r);for(;c!==null;){const u=ms(l.node.children,c)||{children:{},childCount:0};l=new Lh(c,l,u),r=ct(r),c=Be(r)}return l}function Ns(s){return s.node.value}function Lx(s,t){s.node.value=t,Ju(s)}function Ux(s){return s.node.childCount>0}function n1(s){return Ns(s)===void 0&&!Ux(s)}function tc(s,t){rn(s.node.children,(r,l)=>{t(new Lh(r,s,l))})}function Hx(s,t,r,l){r&&t(s),tc(s,c=>{Hx(c,t,!0)})}function a1(s,t,r){let l=s.parent;for(;l!==null;){if(t(l))return!0;l=l.parent}return!1}function ei(s){return new it(s.parent===null?s.name:ei(s.parent)+"/"+s.name)}function Ju(s){s.parent!==null&&r1(s.parent,s.name,s)}function r1(s,t,r){const l=n1(r),c=da(s.node.children,t);l&&c?(delete s.node.children[t],s.node.childCount--,Ju(s)):!l&&!c&&(s.node.children[t]=r.node,s.node.childCount++,Ju(s))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s1=/[\[\].#$\/\u0000-\u001F\u007F]/,l1=/[\[\].#$\u0000-\u001F\u007F]/,Uu=10*1024*1024,$x=function(s){return typeof s=="string"&&s.length!==0&&!s1.test(s)},zx=function(s){return typeof s=="string"&&s.length!==0&&!l1.test(s)},i1=function(s){return s&&(s=s.replace(/^\/*\.info(\/|$)/,"/")),zx(s)},Bx=function(s,t,r,l){l&&t===void 0||Hh(oh(s,"value"),t,r)},Hh=function(s,t,r){const l=r instanceof it?new SN(r,s):r;if(t===void 0)throw new Error(s+"contains undefined "+hr(l));if(typeof t=="function")throw new Error(s+"contains a function "+hr(l)+" with contents = "+t.toString());if(Uy(t))throw new Error(s+"contains "+t.toString()+" "+hr(l));if(typeof t=="string"&&t.length>Uu/3&&Vo(t)>Uu)throw new Error(s+"contains a string greater than "+Uu+" utf8 bytes "+hr(l)+" ('"+t.substring(0,50)+"...')");if(t&&typeof t=="object"){let c=!1,u=!1;if(rn(t,(h,g)=>{if(h===".value")c=!0;else if(h!==".priority"&&h!==".sv"&&(u=!0,!$x(h)))throw new Error(s+" contains an invalid key ("+h+") "+hr(l)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);jN(l,h),Hh(s,g,l),DN(l)}),c&&u)throw new Error(s+' contains ".value" child '+hr(l)+" in addition to actual children.")}},qx=function(s,t,r,l){if(!zx(r))throw new Error(oh(s,t)+'was an invalid path = "'+r+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},o1=function(s,t,r,l){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),qx(s,t,r)},$h=function(s,t){if(Be(t)===".info")throw new Error(s+" failed = Can't modify data under /.info/")},c1=function(s,t){const r=t.path.toString();if(typeof t.repoInfo.host!="string"||t.repoInfo.host.length===0||!$x(t.repoInfo.namespace)&&t.repoInfo.host.split(":")[0]!=="localhost"||r.length!==0&&!i1(r))throw new Error(oh(s,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function zh(s,t){let r=null;for(let l=0;l<t.length;l++){const c=t[l],u=c.getPath();r!==null&&!xh(u,r.path)&&(s.eventLists_.push(r),r=null),r===null&&(r={events:[],path:u}),r.events.push(c)}r&&s.eventLists_.push(r)}function Fx(s,t,r){zh(s,r),Gx(s,l=>xh(l,t))}function qn(s,t,r){zh(s,r),Gx(s,l=>An(l,t)||An(t,l))}function Gx(s,t){s.recursionDepth_++;let r=!0;for(let l=0;l<s.eventLists_.length;l++){const c=s.eventLists_[l];if(c){const u=c.path;t(u)?(u1(s.eventLists_[l]),s.eventLists_[l]=null):r=!1}}r&&(s.eventLists_=[]),s.recursionDepth_--}function u1(s){for(let t=0;t<s.events.length;t++){const r=s.events[t];if(r!==null){s.events[t]=null;const l=r.getEventRunner();Al&&Yt("event: "+r.toString()),ks(l)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h1="repo_interrupt",f1=25;class g1{constructor(t,r,l,c){this.repoInfo_=t,this.forceRestClient_=r,this.authTokenProvider_=l,this.appCheckProvider_=c,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new d1,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Lo(),this.transactionQueueTree_=new Lh,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function m1(s,t,r){if(s.stats_=ph(s.repoInfo_),s.forceRestClient_||Kk())s.server_=new Io(s.repoInfo_,(l,c,u,h)=>{Hp(s,l,c,u,h)},s.authTokenProvider_,s.appCheckProvider_),setTimeout(()=>$p(s,!0),0);else{if(typeof r<"u"&&r!==null){if(typeof r!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Tt(r)}catch(l){throw new Error("Invalid authOverride provided: "+l)}}s.persistentConnection_=new oa(s.repoInfo_,t,(l,c,u,h)=>{Hp(s,l,c,u,h)},l=>{$p(s,l)},l=>{p1(s,l)},s.authTokenProvider_,s.appCheckProvider_,r),s.server_=s.persistentConnection_}s.authTokenProvider_.addTokenChangeListener(l=>{s.server_.refreshAuthToken(l)}),s.appCheckProvider_.addTokenChangeListener(l=>{s.server_.refreshAppCheckToken(l.token)}),s.statsReporter_=nN(s.repoInfo_,()=>new eT(s.stats_,s.server_)),s.infoData_=new QN,s.infoSyncTree_=new Lp({startListening:(l,c,u,h)=>{let g=[];const m=s.infoData_.getNode(l._path);return m.isEmpty()||(g=Zl(s.infoSyncTree_,l._path,m),setTimeout(()=>{h("ok")},0)),g},stopListening:()=>{}}),qh(s,"connected",!1),s.serverSyncTree_=new Lp({startListening:(l,c,u,h)=>(s.server_.listen(l,u,c,(g,m)=>{const p=h(g,m);qn(s.eventQueue_,l._path,p)}),[]),stopListening:(l,c)=>{s.server_.unlisten(l,c)}})}function Yx(s){const r=s.infoData_.getNode(new it(".info/serverTimeOffset")).val()||0;return new Date().getTime()+r}function Bh(s){return ZT({timestamp:Yx(s)})}function Hp(s,t,r,l,c){s.dataUpdateCount++;const u=new it(t);r=s.interceptServerDataCallback_?s.interceptServerDataCallback_(t,r):r;let h=[];if(c)if(l){const m=jo(r,p=>Ut(p));h=PT(s.serverSyncTree_,u,m,c)}else{const m=Ut(r);h=Ax(s.serverSyncTree_,u,m,c)}else if(l){const m=jo(r,p=>Ut(p));h=FT(s.serverSyncTree_,u,m)}else{const m=Ut(r);h=Zl(s.serverSyncTree_,u,m)}let g=u;h.length>0&&(g=ac(s,u)),qn(s.eventQueue_,g,h)}function $p(s,t){qh(s,"connected",t),t===!1&&b1(s)}function p1(s,t){rn(t,(r,l)=>{qh(s,r,l)})}function qh(s,t,r){const l=new it("/.info/"+t),c=Ut(r);s.infoData_.updateSnapshot(l,c);const u=Zl(s.infoSyncTree_,l,c);qn(s.eventQueue_,l,u)}function Px(s){return s.nextWriteId_++}function y1(s,t,r){const l=VT(s.serverSyncTree_,t);return l!=null?Promise.resolve(l):s.server_.get(t).then(c=>{const u=Ut(c).withIndex(t._queryParams.getIndex());Zu(s.serverSyncTree_,t,r,!0);let h;if(t._queryParams.loadsAllData())h=Zl(s.serverSyncTree_,t._path,u);else{const g=Gl(s.serverSyncTree_,t);h=Ax(s.serverSyncTree_,t._path,u,g)}return qn(s.eventQueue_,t._path,h),Go(s.serverSyncTree_,t,r,null,!0),u},c=>(nc(s,"get for query "+Tt(t)+" failed: "+c),Promise.reject(new Error(c))))}function x1(s,t,r,l,c){nc(s,"set",{path:t.toString(),value:r,priority:l});const u=Bh(s),h=Ut(r,l),g=Eh(s.serverSyncTree_,t),m=Ix(h,g,u),p=Px(s),x=Cx(s.serverSyncTree_,t,m,p,!0);zh(s.eventQueue_,x),s.server_.put(t.toString(),h.val(!0),(w,L)=>{const T=w==="ok";T||nn("set at "+t+" failed: "+w);const U=pr(s.serverSyncTree_,p,!T);qn(s.eventQueue_,t,U),k1(s,c,w,L)});const b=Kx(s,t);ac(s,b),qn(s.eventQueue_,b,[])}function b1(s){nc(s,"onDisconnectEvents");const t=Bh(s),r=Lo();Vu(s.onDisconnect_,We(),(c,u)=>{const h=t1(c,u,s.serverSyncTree_,t);gx(r,c,h)});let l=[];Vu(r,We(),(c,u)=>{l=l.concat(Zl(s.serverSyncTree_,c,u));const h=Kx(s,c);ac(s,h)}),s.onDisconnect_=Lo(),qn(s.eventQueue_,We(),l)}function v1(s,t,r){let l;Be(t._path)===".info"?l=Zu(s.infoSyncTree_,t,r):l=Zu(s.serverSyncTree_,t,r),Fx(s.eventQueue_,t._path,l)}function w1(s,t,r){let l;Be(t._path)===".info"?l=Go(s.infoSyncTree_,t,r):l=Go(s.serverSyncTree_,t,r),Fx(s.eventQueue_,t._path,l)}function _1(s){s.persistentConnection_&&s.persistentConnection_.interrupt(h1)}function nc(s,...t){let r="";s.persistentConnection_&&(r=s.persistentConnection_.id+":"),Yt(r,...t)}function k1(s,t,r,l){t&&ks(()=>{if(r==="ok")t(null);else{const c=(r||"error").toUpperCase();let u=c;l&&(u+=": "+l);const h=new Error(u);h.code=c,t(h)}})}function Vx(s,t,r){return Eh(s.serverSyncTree_,t,r)||Ie.EMPTY_NODE}function Fh(s,t=s.transactionQueueTree_){if(t||rc(s,t),Ns(t)){const r=Qx(s,t);ge(r.length>0,"Sending zero length transaction queue"),r.every(c=>c.status===0)&&N1(s,ei(t),r)}else Ux(t)&&tc(t,r=>{Fh(s,r)})}function N1(s,t,r){const l=r.map(p=>p.currentWriteId),c=Vx(s,t,l);let u=c;const h=c.hash();for(let p=0;p<r.length;p++){const x=r[p];ge(x.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),x.status=1,x.retryCount++;const b=Wt(t,x.path);u=u.updateChild(b,x.currentOutputSnapshotRaw)}const g=u.val(!0),m=t;s.server_.put(m.toString(),g,p=>{nc(s,"transaction put response",{path:m.toString(),status:p});let x=[];if(p==="ok"){const b=[];for(let w=0;w<r.length;w++)r[w].status=2,x=x.concat(pr(s.serverSyncTree_,r[w].currentWriteId)),r[w].onComplete&&b.push(()=>r[w].onComplete(null,!0,r[w].currentOutputSnapshotResolved)),r[w].unwatcher();rc(s,Uh(s.transactionQueueTree_,t)),Fh(s,s.transactionQueueTree_),qn(s.eventQueue_,t,x);for(let w=0;w<b.length;w++)ks(b[w])}else{if(p==="datastale")for(let b=0;b<r.length;b++)r[b].status===3?r[b].status=4:r[b].status=0;else{nn("transaction at "+m.toString()+" failed: "+p);for(let b=0;b<r.length;b++)r[b].status=4,r[b].abortReason=p}ac(s,t)}},h)}function ac(s,t){const r=Wx(s,t),l=ei(r),c=Qx(s,r);return T1(s,c,l),l}function T1(s,t,r){if(t.length===0)return;const l=[];let c=[];const h=t.filter(g=>g.status===0).map(g=>g.currentWriteId);for(let g=0;g<t.length;g++){const m=t[g],p=Wt(r,m.path);let x=!1,b;if(ge(p!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),m.status===4)x=!0,b=m.abortReason,c=c.concat(pr(s.serverSyncTree_,m.currentWriteId,!0));else if(m.status===0)if(m.retryCount>=f1)x=!0,b="maxretry",c=c.concat(pr(s.serverSyncTree_,m.currentWriteId,!0));else{const w=Vx(s,m.path,h);m.currentInputSnapshot=w;const L=t[g].update(w.val());if(L!==void 0){Hh("transaction failed: Data returned ",L,m.path);let T=Ut(L);typeof L=="object"&&L!=null&&da(L,".priority")||(T=T.updatePriority(w.getPriority()));const Y=m.currentWriteId,k=Bh(s),S=Ix(T,w,k);m.currentOutputSnapshotRaw=T,m.currentOutputSnapshotResolved=S,m.currentWriteId=Px(s),h.splice(h.indexOf(Y),1),c=c.concat(Cx(s.serverSyncTree_,m.path,S,m.currentWriteId,m.applyLocally)),c=c.concat(pr(s.serverSyncTree_,Y,!0))}else x=!0,b="nodata",c=c.concat(pr(s.serverSyncTree_,m.currentWriteId,!0))}qn(s.eventQueue_,r,c),c=[],x&&(t[g].status=2,function(w){setTimeout(w,Math.floor(0))}(t[g].unwatcher),t[g].onComplete&&(b==="nodata"?l.push(()=>t[g].onComplete(null,!1,t[g].currentInputSnapshot)):l.push(()=>t[g].onComplete(new Error(b),!1,null))))}rc(s,s.transactionQueueTree_);for(let g=0;g<l.length;g++)ks(l[g]);Fh(s,s.transactionQueueTree_)}function Wx(s,t){let r,l=s.transactionQueueTree_;for(r=Be(t);r!==null&&Ns(l)===void 0;)l=Uh(l,r),t=ct(t),r=Be(t);return l}function Qx(s,t){const r=[];return Xx(s,t,r),r.sort((l,c)=>l.order-c.order),r}function Xx(s,t,r){const l=Ns(t);if(l)for(let c=0;c<l.length;c++)r.push(l[c]);tc(t,c=>{Xx(s,c,r)})}function rc(s,t){const r=Ns(t);if(r){let l=0;for(let c=0;c<r.length;c++)r[c].status!==2&&(r[l]=r[c],l++);r.length=l,Lx(t,r.length>0?r:void 0)}tc(t,l=>{rc(s,l)})}function Kx(s,t){const r=ei(Wx(s,t)),l=Uh(s.transactionQueueTree_,t);return a1(l,c=>{Hu(s,c)}),Hu(s,l),Hx(l,c=>{Hu(s,c)}),r}function Hu(s,t){const r=Ns(t);if(r){const l=[];let c=[],u=-1;for(let h=0;h<r.length;h++)r[h].status===3||(r[h].status===1?(ge(u===h-1,"All SENT items should be at beginning of queue."),u=h,r[h].status=3,r[h].abortReason="set"):(ge(r[h].status===0,"Unexpected transaction status in abort"),r[h].unwatcher(),c=c.concat(pr(s.serverSyncTree_,r[h].currentWriteId,!0)),r[h].onComplete&&l.push(r[h].onComplete.bind(null,new Error("set"),!1,null))));u===-1?Lx(t,void 0):r.length=u+1,qn(s.eventQueue_,ei(t),c);for(let h=0;h<l.length;h++)ks(l[h])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S1(s){let t="";const r=s.split("/");for(let l=0;l<r.length;l++)if(r[l].length>0){let c=r[l];try{c=decodeURIComponent(c.replace(/\+/g," "))}catch{}t+="/"+c}return t}function j1(s){const t={};s.charAt(0)==="?"&&(s=s.substring(1));for(const r of s.split("&")){if(r.length===0)continue;const l=r.split("=");l.length===2?t[decodeURIComponent(l[0])]=decodeURIComponent(l[1]):nn(`Invalid query segment '${r}' in query '${s}'`)}return t}const zp=function(s,t){const r=D1(s),l=r.namespace;r.domain==="firebase.com"&&ca(r.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!l||l==="undefined")&&r.domain!=="localhost"&&ca("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),r.secure||qk();const c=r.scheme==="ws"||r.scheme==="wss";return{repoInfo:new Qy(r.host,r.secure,l,c,t,"",l!==r.subdomain),path:new it(r.pathString)}},D1=function(s){let t="",r="",l="",c="",u="",h=!0,g="https",m=443;if(typeof s=="string"){let p=s.indexOf("//");p>=0&&(g=s.substring(0,p-1),s=s.substring(p+2));let x=s.indexOf("/");x===-1&&(x=s.length);let b=s.indexOf("?");b===-1&&(b=s.length),t=s.substring(0,Math.min(x,b)),x<b&&(c=S1(s.substring(x,b)));const w=j1(s.substring(Math.min(s.length,b)));p=t.indexOf(":"),p>=0?(h=g==="https"||g==="wss",m=parseInt(t.substring(p+1),10)):p=t.length;const L=t.slice(0,p);if(L.toLowerCase()==="localhost")r="localhost";else if(L.split(".").length<=2)r=L;else{const T=t.indexOf(".");l=t.substring(0,T).toLowerCase(),r=t.substring(T+1),u=l}"ns"in w&&(u=w.ns)}return{host:t,port:m,domain:r,subdomain:l,secure:h,scheme:g,pathString:c,namespace:u}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bp="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",E1=function(){let s=0;const t=[];return function(r){const l=r===s;s=r;let c;const u=new Array(8);for(c=7;c>=0;c--)u[c]=Bp.charAt(r%64),r=Math.floor(r/64);ge(r===0,"Cannot push at time == 0");let h=u.join("");if(l){for(c=11;c>=0&&t[c]===63;c--)t[c]=0;t[c]++}else for(c=0;c<12;c++)t[c]=Math.floor(Math.random()*64);for(c=0;c<12;c++)h+=Bp.charAt(t[c]);return ge(h.length===20,"nextPushId: Length should be 20."),h}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1{constructor(t,r,l,c){this.eventType=t,this.eventRegistration=r,this.snapshot=l,this.prevName=c}getPath(){const t=this.snapshot.ref;return this.eventType==="value"?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Tt(this.snapshot.exportVal())}}class A1{constructor(t,r,l){this.eventRegistration=t,this.error=r,this.path=l}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zx{constructor(t,r){this.snapshotCallback=t,this.cancelCallback=r}onValue(t,r){this.snapshotCallback.call(null,t,r)}onCancel(t){return ge(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(t,r,l,c){this._repo=t,this._path=r,this._queryParams=l,this._orderByCalled=c}get key(){return Ye(this._path)?null:rx(this._path)}get ref(){return new ha(this._repo,this._path)}get _queryIdentifier(){const t=Tp(this._queryParams),r=gh(t);return r==="{}"?"default":r}get _queryObject(){return Tp(this._queryParams)}isEqual(t){if(t=Va(t),!(t instanceof Gh))return!1;const r=this._repo===t._repo,l=xh(this._path,t._path),c=this._queryIdentifier===t._queryIdentifier;return r&&l&&c}toJSON(){return this.toString()}toString(){return this._repo.toString()+TN(this._path)}}class ha extends Gh{constructor(t,r){super(t,r,new _h,!1)}get parent(){const t=lx(this._path);return t===null?null:new ha(this._repo,t)}get root(){let t=this;for(;t.parent!==null;)t=t.parent;return t}}class Yl{constructor(t,r,l){this._node=t,this.ref=r,this._index=l}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const r=new it(t),l=Pl(this.ref,t);return new Yl(this._node.getChild(r),l,pt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(l,c)=>t(new Yl(c,Pl(this.ref,l),pt)))}hasChild(t){const r=new it(t);return!this._node.getChild(r).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function $n(s,t){return s=Va(s),s._checkNotDeleted("ref"),t!==void 0?Pl(s._root,t):s._root}function Pl(s,t){return s=Va(s),Be(s._path)===null?o1("child","path",t):qx("child","path",t),new ha(s._repo,St(s._path,t))}function R1(s,t){s=Va(s),$h("push",s._path),Bx("push",t,s._path,!0);const r=Yx(s._repo),l=E1(r),c=Pl(s,l),u=Pl(s,l);let h;return h=Promise.resolve(u),c.then=h.then.bind(h),c.catch=h.then.bind(h,void 0),c}function qp(s){return $h("remove",s._path),ds(s,null)}function ds(s,t){s=Va(s),$h("set",s._path),Bx("set",t,s._path,!1);const r=new ch;return x1(s._repo,s._path,t,null,r.wrapCallback(()=>{})),r.promise}function $u(s){s=Va(s);const t=new Zx(()=>{}),r=new sc(t);return y1(s._repo,s,r).then(l=>new Yl(l,new ha(s._repo,s._path),s._queryParams.getIndex()))}class sc{constructor(t){this.callbackContext=t}respondsTo(t){return t==="value"}createEvent(t,r){const l=r._queryParams.getIndex();return new C1("value",this,new Yl(t.snapshotNode,new ha(r._repo,r._path),l))}getEventRunner(t){return t.getEventType()==="cancel"?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,r){return this.callbackContext.hasCancelCallback?new A1(this,t,r):null}matches(t){return t instanceof sc?!t.callbackContext||!this.callbackContext?!0:t.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function O1(s,t,r,l,c){const u=new Zx(r,void 0),h=new sc(u);return v1(s._repo,s,h),()=>w1(s._repo,s,h)}function Fp(s,t,r,l){return O1(s,"value",t)}IT(ha);zT(ha);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M1="FIREBASE_DATABASE_EMULATOR_HOST",eh={};let I1=!1;function L1(s,t,r,l){const c=t.lastIndexOf(":"),u=t.substring(0,c),h=lh(u);s.repoInfo_=new Qy(t,h,s.repoInfo_.namespace,s.repoInfo_.webSocketOnly,s.repoInfo_.nodeAdmin,s.repoInfo_.persistenceKey,s.repoInfo_.includeNamespaceInQueryParams,!0,r),l&&(s.authTokenProvider_=l)}function U1(s,t,r,l,c){let u=l||s.options.databaseURL;u===void 0&&(s.options.projectId||ca("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Yt("Using default host for project ",s.options.projectId),u=`${s.options.projectId}-default-rtdb.firebaseio.com`);let h=zp(u,c),g=h.repoInfo,m;typeof process<"u"&&ip&&(m=ip[M1]),m?(u=`http://${m}?ns=${g.namespace}`,h=zp(u,c),g=h.repoInfo):h.repoInfo.secure;const p=new Jk(s.name,s.options,t);c1("Invalid Firebase Database URL",h),Ye(h.path)||ca("Database URL must point to the root of a Firebase Database (not including a child path).");const x=$1(g,s,p,new Zk(s,r));return new z1(x,s)}function H1(s,t){const r=eh[t];(!r||r[s.key]!==s)&&ca(`Database ${t}(${s.repoInfo_}) has already been deleted.`),_1(s),delete r[s.key]}function $1(s,t,r,l){let c=eh[t.name];c||(c={},eh[t.name]=c);let u=c[s.toURLString()];return u&&ca("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),u=new g1(s,I1,r,l),c[s.toURLString()]=u,u}class z1{constructor(t,r){this._repoInternal=t,this.app=r,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(m1(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ha(this._repo,We())),this._rootInternal}_delete(){return this._rootInternal!==null&&(H1(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){this._rootInternal===null&&ca("Cannot call "+t+" on a deleted database.")}}function B1(s=ry(),t){const r=sy(s,"database").getImmediate({identifier:t});if(!r._instanceStarted){const l=ly("database");l&&q1(r,...l)}return r}function q1(s,t,r,l={}){s=Va(s),s._checkNotDeleted("useEmulator");const c=`${t}:${r}`,u=s._repoInternal;if(s._instanceStarted){if(c===s._repoInternal.repoInfo_.host&&m_(l,u.repoInfo_.emulatorOptions))return;ca("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let h;if(u.repoInfo_.nodeAdmin)l.mockUserToken&&ca('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),h=new _o(_o.OWNER);else if(l.mockUserToken){const g=typeof l.mockUserToken=="string"?l.mockUserToken:cy(l.mockUserToken,s.app.options.projectId);h=new _o(g)}lh(t)&&(iy(t),oy("Database",!0)),L1(u,c,l,h)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F1(s){Lk(ny),ey(new ty("database",(t,{instanceIdentifier:r})=>{const l=t.getProvider("app").getImmediate(),c=t.getProvider("auth-internal"),u=t.getProvider("app-check-internal");return U1(l,c,u,r)},"PUBLIC").setMultipleInstances(!0)),So(op,cp,s),So(op,cp,"esm2020")}oa.prototype.simpleListen=function(s,t){this.sendRequest("q",{p:s},t)};oa.prototype.echo=function(s,t){this.sendRequest("echo",{d:s},t)};F1();const G1={apiKey:"AIzaSyCaQ6ndqGrR_x6fvTrZxdf5cHTNnRIj2Gg",authDomain:"busvacation-e894a.firebaseapp.com",databaseURL:"https://busvacation-e894a-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"busvacation-e894a",storageBucket:"busvacation-e894a.appspot.com",messagingSenderId:"919121046118",appId:"1:919121046118:web:033047c3f1bba2164e5ba7"},Y1=()=>{const s=dy().find(t=>t.name==="vacation-management");return s||uy(G1,"vacation-management")},P1=Y1(),zn=B1(P1);class V1{constructor(){this.listeners=new Map}listeners;sanitizeDepartmentCode(t){try{return btoa(encodeURIComponent(t)).replace(/[/+=]/g,"_")}catch{return t.replace(/[^a-zA-Z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"")}}getDepartmentPath(t,r){return`departments/${this.sanitizeDepartmentCode(t)}/${r}`}async getEmployees(t){const r=this.getDepartmentPath(t,"employees");try{const l=await $u($n(zn,r));return l.exists()?l.val():[]}catch(l){return console.error(` [${t}]    :`,l),[]}}async saveEmployees(t,r){const l=this.getDepartmentPath(t,"employees");try{return await ds($n(zn,l),r),console.log(` [${t}]    `),{success:!0}}catch(c){return console.error(` [${t}]    :`,c),{success:!1,error:c}}}async getVacations(t){const r=this.getDepartmentPath(t,"vacations");try{const l=await $u($n(zn,r));if(l.exists()){const c=l.val();return Array.isArray(c)?c:Object.keys(c||{}).map(u=>({...c[u],id:u}))}return[]}catch(l){return console.error(` [${t}]    :`,l),[]}}async saveVacations(t,r){const l=this.getDepartmentPath(t,"vacations");try{return await ds($n(zn,l),r),console.log(` [${t}]    `),{success:!0}}catch(c){return console.error(` [${t}]    :`,c),{success:!1,error:c}}}async addVacation(t,r){const l=this.getDepartmentPath(t,"vacations");try{const c=$n(zn,l),u=R1(c),h={...r,id:u.key,createdAt:Date.now(),updatedAt:Date.now()};return await ds(u,h),console.log(` [${t}]   :`,h.id),{success:!0,vacation:h}}catch(c){return console.error(` [${t}]   :`,c),{success:!1,error:c}}}async updateVacation(t,r,l){const c=`${this.getDepartmentPath(t,"vacations")}/${r}`;try{const u={...l,updatedAt:Date.now()};return await ds($n(zn,c),u),console.log(` [${t}]   :`,r),{success:!0}}catch(u){return console.error(` [${t}]   :`,u),{success:!1,error:u}}}async deleteVacation(t,r){const l=`${this.getDepartmentPath(t,"vacations")}/${r}`;try{return await qp($n(zn,l)),console.log(` [${t}]   :`,r),{success:!0}}catch(c){return console.error(` [${t}]   :`,c),{success:!1,error:c}}}subscribeToVacations(t,r){const l=this.getDepartmentPath(t,"vacations"),c=$n(zn,l),u=Fp(c,g=>{const m=g.exists()?g.val():[],p=Array.isArray(m)?m:Object.keys(m||{}).map(x=>({...m[x],id:x}));r(p)}),h=`vacations_${t}`;return this.listeners.set(h,{ref:c,unsubscribe:u}),()=>{u(),this.listeners.delete(h)}}subscribeToEmployees(t,r){const l=this.getDepartmentPath(t,"employees"),c=$n(zn,l),u=Fp(c,g=>{const m=g.exists()?g.val():[];r(m)}),h=`employees_${t}`;return this.listeners.set(h,{ref:c,unsubscribe:u}),()=>{u(),this.listeners.delete(h)}}async testConnection(){try{const t=$n(zn,"connection_test");await ds(t,{timestamp:Date.now(),test:!0});const r=await $u(t),l=r.exists()&&r.val().test===!0;return l&&await qp(t),console.log(`  Firebase   ${l?"":""}`),l}catch(t){return console.error(" Firebase   :",t),!1}}cleanup(){console.log("  Firebase   ..."),this.listeners.forEach(({unsubscribe:t},r)=>{t(),console.log(`  : ${r}`)}),this.listeners.clear()}}const gr=new V1,Jx=I.createContext(void 0),W1=({children:s})=>{const{currentUser:t}=Nn(),[r,l]=I.useState([]),[c,u]=I.useState([]),[h,g]=I.useState(!1),[m,p]=I.useState(()=>{const T=localStorage.getItem("showVacationsInTodos");return T?JSON.parse(T):!0}),x=()=>{const T=!m;p(T),localStorage.setItem("showVacationsInTodos",JSON.stringify(T))},b=async()=>{if(!(!t||!Ba(t.email))){g(!0);try{const[T,U]=await Promise.all([gr.getEmployees(""),gr.getVacations("")]);l(T),u(U)}catch(T){console.error("   :",T)}finally{g(!1)}}},w=T=>{if(!m)return[];const U=new Date(T.getTime()-T.getTimezoneOffset()*6e4),Y=U.toISOString().split("T")[0];return console.log("  :",{originalDate:T,localDate:U,dateStr:Y,availableVacations:c.map(k=>({id:k.id,date:k.date,type:k.type}))}),c.filter(k=>k.date===Y)};I.useEffect(()=>{t&&Ba(t.email)&&b()},[t]);const L={employees:r,vacations:c,loading:h,showVacationsInTodos:m,toggleVacationDisplay:x,refreshVacationData:b,getVacationsForDate:w};return i.jsx(Jx.Provider,{value:L,children:s})},Yh=()=>{const s=I.useContext(Jx);if(s===void 0)throw new Error("useVacation must be used within a VacationProvider");return s},eb=I.createContext(void 0),Q1=({children:s,onOpenAddTodo:t,onFocusSearch:r,onToggleSidebar:l,onSwitchToTodayView:c,onSwitchToWeekView:u,onSwitchToMonthView:h})=>{const g={openAddTodoModal:t,focusSearch:r,toggleSidebar:l,switchToTodayView:c,switchToWeekView:u,switchToMonthView:h};return i.jsx(eb.Provider,{value:g,children:s})},X1=()=>{const s=I.useContext(eb);if(s===void 0)throw new Error("useKeyboard must be used within a KeyboardProvider");return s},tb=I.createContext(void 0),K1=()=>{const s=I.useContext(tb);if(s===void 0)throw new Error("useFontSize must be used within a FontSizeProvider");return s},Z1=({children:s})=>{const[t,r]=I.useState(()=>{const l=localStorage.getItem("fontSizeLevel");if(l){const c=parseInt(l,10);if(c>=1&&c<=7)return c}return 4});return I.useEffect(()=>{localStorage.setItem("fontSizeLevel",t.toString());const l=document.documentElement;l.classList.remove("font-size-1","font-size-2","font-size-3","font-size-4","font-size-5","font-size-6","font-size-7"),l.classList.add(`font-size-${t}`);const c={1:.55,2:.65,3:.75,4:.85,5:.95,6:1.05,7:1.15};l.style.setProperty("--font-scale",c[t].toString())},[t]),i.jsx(tb.Provider,{value:{fontSizeLevel:t,setFontSizeLevel:r},children:s})},J1=()=>{const{openAddTodoModal:s,focusSearch:t,toggleSidebar:r,switchToTodayView:l,switchToWeekView:c,switchToMonthView:u}=X1();I.useEffect(()=>{const h=m=>{if(m.ctrlKey||m.metaKey)switch(m.key.toLowerCase()){case"1":m.preventDefault(),l();break;case"2":m.preventDefault(),c();break;case"3":m.preventDefault(),u();break;case"b":m.preventDefault(),r();break;case"n":m.preventDefault(),s();break;case"f":m.preventDefault(),t();break;case"k":m.preventDefault(),g();break}if(m.key==="Escape"){const p=document.querySelectorAll('[role="dialog"]');if(p.length>0){m.preventDefault();const x=p[p.length-1].querySelector('[aria-label=""], [data-close]');x&&x.click()}}},g=()=>{alert(`  :

`+["Ctrl+1:  ","Ctrl+2:  ","Ctrl+3:  ","Ctrl+N:   ","Ctrl+F: ","Ctrl+B:  ","Ctrl+K:  ","ESC:  "].join(`
`))};return document.addEventListener("keydown",h),()=>document.removeEventListener("keydown",h)},[s,t,r,l,c,u])};class eS{metrics=[];observers=[];constructor(){this.setupObservers(),this.measureInitialLoad()}setupObservers(){try{if("PerformanceObserver"in window){const t=new PerformanceObserver(u=>{const h=u.getEntries(),g=h[h.length-1];this.recordMetric("LCP",g.startTime,this.getRating("LCP",g.startTime))});t.observe({entryTypes:["largest-contentful-paint"]}),this.observers.push(t);const r=new PerformanceObserver(u=>{for(const h of u.getEntries()){const g=h.processingStart-h.startTime;this.recordMetric("FID",g,this.getRating("FID",g))}});r.observe({entryTypes:["first-input"]}),this.observers.push(r);let l=0;const c=new PerformanceObserver(u=>{for(const h of u.getEntries())h.hadRecentInput||(l+=h.value);this.recordMetric("CLS",l,this.getRating("CLS",l))});c.observe({entryTypes:["layout-shift"]}),this.observers.push(c)}}catch(t){Ce.error("Performance observer setup failed:",t)}}measureInitialLoad(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>this.collectNavigationMetrics()):this.collectNavigationMetrics()}collectNavigationMetrics(){if(performance.getEntriesByType){const t=performance.getEntriesByType("navigation")[0];if(t){const r=t.responseStart-t.requestStart;this.recordMetric("TTFB",r,this.getRating("TTFB",r));const l=t.domContentLoadedEventEnd-t.domContentLoadedEventStart;this.recordMetric("DOM_LOADED",l,this.getRating("DOM_LOADED",l));const c=t.loadEventEnd-t.loadEventStart;this.recordMetric("LOAD_COMPLETE",c,this.getRating("LOAD_COMPLETE",c))}}}getRating(t,r){const c={LCP:{good:2500,poor:4e3},FID:{good:100,poor:300},CLS:{good:.1,poor:.25},TTFB:{good:800,poor:1800},DOM_LOADED:{good:1e3,poor:3e3},LOAD_COMPLETE:{good:2e3,poor:5e3}}[t];return!c||r<=c.good?"good":r<=c.poor?"needs-improvement":"poor"}recordMetric(t,r,l){const c={name:t,value:r,rating:l,timestamp:Date.now()};this.metrics.push(c),Ce.log(`Performance metric: ${t} = ${r.toFixed(2)}ms (${l})`),l==="poor"&&Ce.warn(`Poor performance detected: ${t} = ${r.toFixed(2)}ms`)}measureMemoryUsage(){if("memory"in performance){const t=performance.memory;Ce.log("Memory usage:",{used:`${(t.usedJSHeapSize/1024/1024).toFixed(2)}MB`,total:`${(t.totalJSHeapSize/1024/1024).toFixed(2)}MB`,limit:`${(t.jsHeapSizeLimit/1024/1024).toFixed(2)}MB`})}}getMetrics(){return[...this.metrics]}getSummary(){const t={};return[...new Set(this.metrics.map(l=>l.name))].forEach(l=>{const c=this.metrics.filter(u=>u.name===l).sort((u,h)=>h.timestamp-u.timestamp)[0];c&&(t[l]={value:c.value,rating:c.rating})}),t}cleanup(){this.observers.forEach(t=>t.disconnect()),this.observers=[],this.metrics=[]}}const tS=new eS,nS=s=>{const t=performance.now();return()=>{const l=performance.now()-t;Ce.log(`Render time for ${s}: ${l.toFixed(2)}ms`),l>16.67&&Ce.warn(`Slow render detected: ${s} took ${l.toFixed(2)}ms`)}};class aS{errors=[];maxErrors=100;constructor(){this.setupGlobalErrorHandling()}setupGlobalErrorHandling(){window.addEventListener("error",t=>{this.trackError({message:t.message,stack:t.error?.stack,severity:"high",context:{filename:t.filename,lineno:t.lineno,colno:t.colno}})}),window.addEventListener("unhandledrejection",t=>{const r=t.reason;this.trackError({message:r?.message||"Unhandled promise rejection",stack:r?.stack,severity:"high",context:{type:"unhandled_promise_rejection",reason:r}})}),window.addEventListener("error",t=>{t.target!==window&&this.trackError({message:"Resource loading failed",severity:"medium",context:{type:"resource_error",element:t.target?.tagName,source:t.target?.src||t.target?.href}})},!0)}trackError(t){const r={id:this.generateErrorId(),message:t.message,stack:t.stack,severity:t.severity,timestamp:Date.now(),url:window.location.href,userAgent:navigator.userAgent,userId:t.userId,context:t.context,resolved:!1};return this.errors.push(r),this.errors.length>this.maxErrors&&(this.errors=this.errors.slice(-this.maxErrors)),r.severity==="critical"||r.severity==="high"?Ce.error(`[ErrorTracker] ${r.severity.toUpperCase()}: ${r.message}`,{id:r.id,stack:r.stack,context:r.context}):Ce.warn(`[ErrorTracker] ${r.severity.toUpperCase()}: ${r.message}`),r.id}trackReactError(t,r,l){return this.trackError({message:`React Error: ${t.message}`,stack:t.stack,severity:"high",context:{type:"react_error",componentStack:r.componentStack,errorBoundary:r.errorBoundary},userId:l})}trackFirebaseError(t,r,l){const c=this.getFirebaseErrorSeverity(t.code);return this.trackError({message:`Firebase Error in ${r}: ${t.message}`,stack:t.stack,severity:c,context:{type:"firebase_error",code:t.code,operation:r,customData:t.customData},userId:l})}trackUserActionError(t,r,l){return this.trackError({message:`User Action Error (${t}): ${r.message}`,stack:r.stack,severity:"medium",context:{type:"user_action_error",action:t,timestamp:Date.now()},userId:l})}getFirebaseErrorSeverity(t){const r=["internal","unavailable","data-loss"],l=["permission-denied","unauthenticated","failed-precondition"],c=["not-found","already-exists","invalid-argument"];return r.includes(t)?"critical":l.includes(t)?"high":c.includes(t)?"medium":"low"}generateErrorId(){return`err_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}resolveError(t){const r=this.errors.find(l=>l.id===t);return r?(r.resolved=!0,!0):!1}getErrorStats(){const t=this.errors.length,r=this.errors.filter(h=>h.resolved).length,l=t-r,c=this.errors.reduce((h,g)=>(h[g.severity]=(h[g.severity]||0)+1,h),{}),u=this.errors.slice(-10).sort((h,g)=>g.timestamp-h.timestamp);return{total:t,resolved:r,unresolved:l,bySeverity:c,recent:u}}getCriticalErrors(){return this.errors.filter(t=>(t.severity==="critical"||t.severity==="high")&&!t.resolved)}searchErrors(t){const r=t.toLowerCase();return this.errors.filter(l=>l.message.toLowerCase().includes(r)||l.stack?.toLowerCase().includes(r))}exportErrors(){return JSON.stringify(this.errors,null,2)}cleanup(){this.errors=[]}}const nb=new aS,mj=s=>(t,r)=>{nb.trackReactError(t,{componentStack:r.componentStack,errorBoundary:s})},rS=()=>{const s=document.querySelector('meta[http-equiv="Content-Security-Policy"]');s&&Ce.log("CSP policy found:",s.getAttribute("content"))},sS=()=>{try{const s="_security_test",t="test";localStorage.setItem(s,t);const r=localStorage.getItem(s);localStorage.removeItem(s),r!==t?Ce.error("localStorage security test failed"):Ce.log("localStorage security validation passed")}catch(s){Ce.error("localStorage access error:",s)}},lS=async()=>{try{return typeof window<"u"&&window.firebase?(Ce.log("Firebase is properly initialized"),!0):(Ce.warn("Firebase not found or not initialized"),!1)}catch(s){return Ce.error("Firebase validation error:",s),!1}},ab=()=>({https:window.location.protocol==="https:",secureContext:window.isSecureContext,cookieSecure:document.cookie.includes("Secure"),localStorage:!!window.localStorage,sessionStorage:!!window.sessionStorage}),iS=()=>{rS(),sS(),ab(),lS(),window.addEventListener("error",s=>{s.error&&s.error.name==="SecurityError"&&Ce.error("Security error detected:",s.error)})},Gp=()=>{const s=[],t=ab();return s.push({name:"HTTPS",status:t.https?"pass":"fail",details:t.https?"Site served over HTTPS":"Site not served over HTTPS"}),s.push({name:"Secure Context",status:t.secureContext?"pass":"fail",details:t.secureContext?"Running in secure context":"Not running in secure context"}),s.push({name:"Local Storage",status:t.localStorage?"pass":"fail",details:t.localStorage?"localStorage available":"localStorage not available"}),{timestamp:Date.now(),checks:s}},oS={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},cS=(s,t,r)=>{let l;const c=oS[s];return typeof c=="string"?l=c:t===1?l=c.one:l=c.other.replace("{{count}}",t.toString()),r?.addSuffix?r.comparison&&r.comparison>0?l+" ":l+" ":l},dS={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},uS={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},hS={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},fS={date:_u({formats:dS,defaultWidth:"full"}),time:_u({formats:uS,defaultWidth:"full"}),dateTime:_u({formats:hS,defaultWidth:"full"})},gS={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},mS=(s,t,r,l)=>gS[s],pS={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},yS={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},xS={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},bS={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},vS={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},wS={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},_S=(s,t)=>{const r=Number(s);switch(String(t?.unit)){case"minute":case"second":return String(r);case"date":return r+"";default:return r+""}},kS={ordinalNumber:_S,era:vl({values:pS,defaultWidth:"wide"}),quarter:vl({values:yS,defaultWidth:"wide",argumentCallback:s=>s-1}),month:vl({values:xS,defaultWidth:"wide"}),day:vl({values:bS,defaultWidth:"wide"}),dayPeriod:vl({values:vS,defaultWidth:"wide",formattingValues:wS,defaultFormattingWidth:"wide"})},NS=/^(\d+)(|)?/i,TS=/\d+/i,SS={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},jS={any:[/^(bc|)/i,/^(ad|)/i]},DS={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},ES={any:[/1/i,/2/i,/3/i,/4/i]},CS={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},AS={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},RS={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},OS={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},MS={any:/^(am|pm|||||||)/i},IS={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},LS={ordinalNumber:p_({matchPattern:NS,parsePattern:TS,valueCallback:s=>parseInt(s,10)}),era:wl({matchPatterns:SS,defaultMatchWidth:"wide",parsePatterns:jS,defaultParseWidth:"any"}),quarter:wl({matchPatterns:DS,defaultMatchWidth:"wide",parsePatterns:ES,defaultParseWidth:"any",valueCallback:s=>s+1}),month:wl({matchPatterns:CS,defaultMatchWidth:"wide",parsePatterns:AS,defaultParseWidth:"any"}),day:wl({matchPatterns:RS,defaultMatchWidth:"wide",parsePatterns:OS,defaultParseWidth:"any"}),dayPeriod:wl({matchPatterns:MS,defaultMatchWidth:"any",parsePatterns:IS,defaultParseWidth:"any"})},gn={code:"ko",formatDistance:cS,formatLong:fS,formatRelative:mS,localize:kS,match:LS,options:{weekStartsOn:0,firstWeekContainsDate:1}},lc=(s,t={})=>{const{minSwipeDistance:r=50,preventDefaultTouchmoveEvent:l=!1}=t,c=I.useRef(null),u=I.useRef(null),h=I.useRef(null),g=I.useRef(null);return{onTouchStart:b=>{c.current=b.touches[0].clientX,u.current=b.touches[0].clientY},onTouchMove:b=>{l&&b.preventDefault()},onTouchEnd:b=>{if(!c.current||!u.current)return;h.current=b.changedTouches[0].clientX,g.current=b.changedTouches[0].clientY;const w=c.current-h.current,L=u.current-g.current;Math.abs(w)>Math.abs(L)&&Math.abs(w)>r&&(w>0?s.onSwipeLeft?.():s.onSwipeRight?.()),c.current=null,u.current=null,h.current=null,g.current=null}}},rb=({todoId:s,subTasks:t})=>{const{addSubTask:r,updateSubTask:l,deleteSubTask:c,toggleSubTask:u}=Qt(),[h,g]=I.useState(""),[m,p]=I.useState(!1),[x,b]=I.useState(null),w=S=>{S.preventDefault(),h.trim()&&(r(s,h.trim()),g(""),p(!1))},L=S=>{b({id:S.id,title:S.title})},T=()=>{!x||!x.title.trim()||(l(s,x.id,{title:x.title.trim()}),b(null))},U=()=>{b(null)},Y=S=>{confirm("   ?")&&c(s,S)},k=(S,R)=>{S.key==="Enter"?(S.preventDefault(),R==="add"?w(S):T()):S.key==="Escape"&&(R==="add"?(p(!1),g("")):U())};return i.jsxs("div",{className:"mt-4 space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["  (",t.length,")"]}),!m&&i.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-1 px-2 py-1 text-xs text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",children:[i.jsx(Bt,{className:"w-3 h-3"}),""]})]}),i.jsxs("div",{className:"space-y-2",children:[t.map(S=>i.jsx("div",{className:"flex items-center gap-2 p-2 bg-gray-50 dark:bg-gray-700/50 rounded-lg group",children:x?.id===S.id?i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"checkbox",checked:S.completed,onChange:()=>u(s,S.id),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),i.jsx("input",{type:"text",value:x.title,onChange:R=>b({...x,title:R.target.value}),onKeyDown:R=>k(R,"edit"),className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-600 dark:text-white",placeholder:"  ",autoFocus:!0}),i.jsx("button",{onClick:T,className:"p-1 text-green-600 hover:bg-green-100 dark:hover:bg-green-900/20 rounded",title:"",children:i.jsx(gs,{className:"w-3 h-3"})}),i.jsx("button",{onClick:U,className:"p-1 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-600 rounded",title:"",children:i.jsx(jt,{className:"w-3 h-3"})})]}):i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"checkbox",checked:S.completed,onChange:()=>u(s,S.id),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("span",{className:`text-sm ${S.completed?"line-through text-gray-500":"text-gray-700 dark:text-gray-300"}`,children:S.title}),S.completed&&S.completedAt&&S.completedAt!==null&&i.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:[": ",(()=>{try{const R=new Date(S.completedAt);return isNaN(R.getTime())?(console.warn("Invalid Date detected for subtask:",S.id,S.completedAt)," "):R.toLocaleString("ko-KR")}catch(R){return console.error("Date parsing error:",R,S.completedAt)," "}})()]})]}),i.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[i.jsx("button",{onClick:()=>L(S),className:"p-1 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-900/20 rounded",title:"",children:i.jsx(Vp,{className:"w-3 h-3"})}),i.jsx("button",{onClick:()=>Y(S.id),className:"p-1 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/20 rounded",title:"",children:i.jsx(jt,{className:"w-3 h-3"})})]})]})},S.id)),m&&i.jsxs("form",{onSubmit:w,className:"flex items-center gap-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[i.jsx("input",{type:"text",value:h,onChange:S=>g(S.target.value),onKeyDown:S=>k(S,"add"),className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-600 dark:text-white",placeholder:"   ",autoFocus:!0}),i.jsx("button",{type:"submit",className:"p-1 text-green-600 hover:bg-green-100 dark:hover:bg-green-900/20 rounded",title:"",children:i.jsx(gs,{className:"w-3 h-3"})}),i.jsx("button",{type:"button",onClick:()=>{p(!1),g("")},className:"p-1 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-600 rounded",title:"",children:i.jsx(jt,{className:"w-3 h-3"})})]}),t.length===0&&!m&&i.jsx("div",{className:"text-center py-4 text-sm text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-700/30 rounded-lg border-2 border-dashed border-gray-200 dark:border-gray-600",children:"  "})]})]})},fr=({todo:s,onEdit:t,compact:r=!1})=>{const{toggleTodo:l,deleteTodo:c,updateTodo:u}=Qt(),[h,g]=I.useState(!1),m=I.useRef(null),[p,x]=I.useState(!1),b=s.subTasks?.length||0,w=s.subTasks?.filter(_=>_.completed).length||0,L=b>0,T=L?w/b*100:0,U=s.dueDate&&qm(new Date(s.dueDate),ku(new Date))&&!s.completed;s.dueDate&&y_(new Date(s.dueDate),ku(new Date))&&qm(new Date(s.dueDate),Ll(ku(new Date),1));const Y=_=>Lt(new Date(_),"yyyy.MM.dd",{locale:gn}),k=()=>{if(!s.startDate&&!s.dueDate)return null;if(s.startDate&&s.dueDate)return i.jsxs("div",{className:"flex items-center gap-1 text-[10px] font-medium text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 px-1.5 py-0.5 rounded",children:[i.jsx("span",{children:Y(s.startDate)}),i.jsx("span",{className:"text-gray-400",children:"~"}),i.jsx("span",{className:`${U?"text-red-500 font-bold":""}`,children:Y(s.dueDate)})]});if(s.startDate)return i.jsxs("div",{className:"flex items-center gap-1 text-[10px] font-medium text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 px-1.5 py-0.5 rounded",children:[i.jsx(zu,{className:"w-3 h-3 text-blue-500"}),i.jsx("span",{children:Y(s.startDate)})]});if(s.dueDate)return i.jsxs("div",{className:`flex items-center gap-1 text-[10px] font-medium bg-gray-100 dark:bg-gray-800 px-1.5 py-0.5 rounded ${U?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400"}`,children:[i.jsx(Vl,{className:`w-3 h-3 ${U?"text-red-500 fill-red-500":"text-gray-400"}`}),i.jsx("span",{children:Y(s.dueDate)})]})},S=()=>{h||l(s.id)},R=lc({onSwipeLeft:()=>{confirm(" ?")&&c(s.id)},onSwipeRight:()=>l(s.id)},{minSwipeDistance:50}),D=()=>{if(s.completed)return"border-gray-200 dark:border-gray-700";switch(s.priority){case"urgent":return"border-red-500 dark:border-red-500";case"high":return"border-orange-500 dark:border-orange-500";case"medium":return"border-blue-500 dark:border-blue-500";default:return"border-gray-200 dark:border-gray-700"}};return i.jsx("div",{ref:m,className:`
        relative group mb-3 transition-all duration-300 ease-out
        ${s.completed?"opacity-60":"opacity-100"}
      `,...R,children:i.jsxs("div",{className:`
        relative p-5 rounded-2xl border backdrop-blur-sm transition-all duration-300
        ${s.completed?"bg-gray-50/50 dark:bg-gray-800/30 border-gray-200 dark:border-gray-700":`bg-white/70 dark:bg-gray-800/70 shadow-sm hover:shadow-md hover:-translate-y-0.5 ${D()} md:border-white/50 md:dark:border-gray-700`}
      `,children:[i.jsxs("div",{className:"hidden md:flex absolute top-4 right-20 flex-col items-end gap-1.5 z-10",children:[i.jsxs("div",{className:"flex items-center gap-1.5",children:[s.recurrence&&s.recurrence!=="none"&&i.jsxs("span",{className:"px-1.5 py-0.5 text-[10px] font-bold bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300 rounded-full border border-purple-200 dark:border-purple-800 flex items-center gap-1",children:[i.jsx(bw,{className:"w-3 h-3"}),""]}),s.priority&&s.priority!=="medium"&&i.jsx("span",{className:`px-2 py-0.5 text-[10px] font-bold rounded-full border flex items-center gap-1 ${s.priority==="urgent"?"bg-red-100 text-red-700 border-red-200 dark:bg-red-900/30 dark:text-red-300 dark:border-red-800":"bg-orange-100 text-orange-700 border-orange-200 dark:bg-orange-900/30 dark:text-orange-300 dark:border-orange-800"}`,children:s.priority==="urgent"?"":""}),s.type==="project"&&i.jsxs("span",{className:"px-2 py-0.5 text-[10px] font-bold bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-300 rounded-full border border-indigo-200 dark:border-indigo-800 flex items-center gap-1",children:[s.project==="longterm"?"":"",L&&i.jsxs("span",{className:"ml-1 opacity-80",children:[w,"/",b]})]})]}),k()]}),i.jsxs("div",{className:"md:hidden absolute top-4 right-20 flex items-center gap-1.5 z-10",children:[s.recurrence&&s.recurrence!=="none"&&i.jsx(nh,{className:"w-4 h-4 text-purple-500"}),s.type==="project"&&s.project==="longterm"&&i.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-bold bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-300 rounded-full border border-indigo-200 dark:border-indigo-800",children:""})]}),i.jsxs("div",{className:"absolute top-4 right-4 z-20 flex flex-col items-end gap-1",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{onClick:_=>{_.stopPropagation(),t?.(s)},className:"p-1.5 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",title:"",children:i.jsx(No,{className:"w-4 h-4"})}),i.jsx("button",{onClick:_=>{_.stopPropagation(),window.confirm(" ?")&&c(s.id)},className:"p-1.5 text-gray-400 hover:text-red-600 dark:hover:text-red-400 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:"",children:i.jsx(an,{className:"w-4 h-4"})})]}),i.jsx("div",{className:"md:hidden mt-1",children:k()})]}),i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("button",{onClick:S,className:`
              flex-shrink-0 w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all duration-300 mt-1
              ${s.completed?"bg-blue-500 border-blue-500 text-white scale-110":"border-gray-300 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-400 bg-white dark:bg-gray-800"}
            `,children:s.completed&&i.jsx(gs,{className:"w-4 h-4",strokeWidth:3})}),i.jsxs("div",{className:"flex-1 min-w-0 pt-0.5 pr-28 sm:pr-24",children:[i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx("h3",{className:`
                text-base font-semibold leading-snug transition-all duration-300 break-words
                ${s.completed?"text-gray-400 dark:text-gray-500 line-through decoration-2 decoration-gray-300":"text-gray-900 dark:text-white"}
              `,children:s.title}),L&&i.jsx("button",{onClick:_=>{_.stopPropagation(),x(!p)},className:"p-0.5 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-400 transition-colors",children:p?i.jsx(Wp,{className:"w-4 h-4"}):i.jsx(ah,{className:"w-4 h-4"})})]}),s.description&&i.jsx("p",{className:`mt-1.5 text-sm line-clamp-2 ${s.completed?"text-gray-400":"text-gray-600 dark:text-gray-300"}`,children:s.description}),i.jsx("div",{className:"flex flex-wrap items-center gap-2 mt-3",children:s.tags&&s.tags.length>0&&i.jsx("div",{className:"flex flex-wrap gap-1",children:s.tags.map((_,$)=>i.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-md font-medium",children:["#",_]},$))})}),L&&!s.completed&&i.jsxs("div",{className:"mt-3 w-full",children:[i.jsxs("div",{className:"flex justify-between text-[10px] text-gray-500 mb-1",children:[i.jsx("span",{children:""}),i.jsxs("span",{children:[Math.round(T),"%"]})]}),i.jsx("div",{className:"h-1.5 w-full bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden",children:i.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${T===100?"bg-green-500":"bg-blue-500"}`,style:{width:`${T}%`}})})]}),p&&i.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100 dark:border-gray-700/50 animate-fade-in-down",children:i.jsx(rb,{todoId:s.id,subTasks:s.subTasks||[]})})]})]})]})})},Yp=({vacation:s,employee:t,compact:r=!1})=>{const l=c=>{switch(c){case"":return"bg-green-100 text-green-700 border-green-200 dark:bg-green-900/20 dark:text-green-300 dark:border-green-800";case"":return"bg-blue-100 text-blue-700 border-blue-200 dark:bg-blue-900/20 dark:text-blue-300 dark:border-blue-800";case"":return"bg-purple-100 text-purple-700 border-purple-200 dark:bg-purple-900/20 dark:text-purple-300 dark:border-purple-800";case"":return"bg-yellow-100 text-yellow-700 border-yellow-200 dark:bg-yellow-900/20 dark:text-yellow-300 dark:border-yellow-800";case"":return"bg-red-100 text-red-700 border-red-200 dark:bg-red-900/20 dark:text-red-300 dark:border-red-800";case"":return"bg-gray-100 text-gray-700 border-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600";default:return"bg-gray-100 text-gray-700 border-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600"}};return r?i.jsx("div",{className:`p-2 mb-1.5 rounded border ${l(s.type)}`,children:i.jsxs("div",{className:"flex items-center gap-2",children:[t&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 rounded-full flex items-center justify-center text-white text-xs font-semibold flex-shrink-0",style:{backgroundColor:t.color},children:t.name.charAt(0)}),i.jsx("span",{className:"text-xs font-medium truncate",children:t.name})]}),i.jsx("span",{className:"text-[8px] font-medium px-1 py-0.5 rounded",children:s.type})]})}):i.jsx("div",{className:`p-3 rounded-lg border ${l(s.type)}`,children:i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{className:"flex items-center gap-2",children:t?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-white text-xs font-semibold",style:{backgroundColor:t.color},children:t.name.charAt(0)}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:t.name}),i.jsx("div",{className:"text-xs opacity-75",children:t.team})]})]}):i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Yo,{className:"w-5 h-5"}),i.jsxs("span",{className:"font-medium",children:[" ID: ",s.employeeId]})]})}),i.jsx("span",{className:"text-sm font-medium px-2 py-1 rounded",children:s.type})]})})},th=I.memo(({currentView:s,searchTerm:t="",priorityFilter:r="all",typeFilter:l="all",projectFilter:c="all",tagFilter:u=[],completionDateFilter:h="all",selectedDate:g,onDateChange:m,onEdit:p})=>{const{todos:x,getTodayTodos:b,getWeekTodos:w,getMonthTodos:L,reorderTodos:T,getYesterdayIncompleteTodos:U,getTomorrowTodos:Y}=Qt(),{currentUser:k}=Nn(),{showVacationsInTodos:S,getVacationsForDate:R,employees:D}=Yh(),[_,$]=I.useState(null),[C,ee]=I.useState(null),ie=lc({onSwipeLeft:()=>{s==="today"&&m&&g&&m(Ll(g,1))},onSwipeRight:()=>{s==="today"&&m&&g&&m(gy(g))}},{minSwipeDistance:60}),xe=I.useMemo(()=>{let K=[];switch(s){case"today":K=b(g);break;case"week":K=w();break;case"month":K=L();break;default:K=x}return K},[s,g,b,w,L,x]),_e=I.useMemo(()=>(ne=>{const ce=new Set;return ne.filter(ue=>ce.has(ue.id)?!1:(ce.add(ue.id),!0)).filter(ue=>{if(t){const Ue=t.toLowerCase(),tt=ue.title.toLowerCase().includes(Ue),st=ue.description?.toLowerCase().includes(Ue)||!1;if(!tt&&!st)return!1}return!(r!=="all"&&ue.priority!==r||l!=="all"&&ue.type!==l||c!=="all"&&ue.type==="project"&&ue.project!==c||u.length>0&&(!ue.tags||ue.tags.length===0||!ue.tags.some(tt=>u.includes(tt))))})})(xe),[xe,t,r,l,c,u,h]),ve=_e.filter(K=>!K.completed),he=_e.filter(K=>K.completed),Te=[];if(s==="today"){const K=g||new Date;K.setHours(0,0,0,0),_e.forEach(ne=>{ne.subTasks&&ne.subTasks.length>0&&ne.subTasks.forEach(ce=>{if(ce.completed&&ce.completedAt&&ce.completedAt!==null)try{const Se=new Date(ce.completedAt);Se.setHours(0,0,0,0),Se.getTime()===K.getTime()&&Te.push({...ce,type:"simple",recurrence:"none",isSubTask:!0,parentTitle:ne.title,parentDescription:ne.description,createdAt:ce.createdAt,updatedAt:ce.updatedAt})}catch{}})})}const Ee=[...he,...Te],X=()=>s==="today"&&g?g:new Date,ye=Ba(k?.email)&&S?R(X()):[],M=(K,ne)=>{$(ne),K.dataTransfer.effectAllowed="move",K.dataTransfer.setData("text/plain",ne.toString())},Z=async(K,ne)=>{if(K.preventDefault(),_!==null){try{if(_!==ne){let ce=ne;ne>_&&(ce=ne-1),await T(_,ce,Q)}}catch(ce){console.error("Drop error:",ce)}$(null),ee(null)}},E=()=>{$(null),ee(null)},Q=(K=>{const ne={urgent:0,high:1,medium:2,low:3};return K.sort((Se,ue)=>{const Ue=ne[Se.priority]-ne[ue.priority];if(Ue!==0)return Ue;const tt=Se.order,st=ue.order;return tt!==void 0&&st!==void 0&&tt!==st?tt-st:tt!==void 0&&st===void 0?-1:tt===void 0&&st!==void 0?1:Se.dueDate&&ue.dueDate?new Date(Se.dueDate).getTime()-new Date(ue.dueDate).getTime():Se.dueDate?-1:ue.dueDate?1:new Date(ue.createdAt).getTime()-new Date(Se.createdAt).getTime()})})(ve),pe=Ee.sort((K,ne)=>{const ce=Se=>{if(Se.isSubTask&&Se.completedAt)try{return new Date(Se.completedAt).getTime()}catch{return 0}if(Se.completedAt)try{return new Date(Se.completedAt).getTime()}catch{return new Date(Se.updatedAt).getTime()}return new Date(Se.updatedAt).getTime()};return ce(ne)-ce(K)}),W=s==="today"?U(g):[],de=s==="today"?Y(g):[];return s==="today"?i.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-12 gap-8 items-start",onTouchStart:ie.onTouchStart,onTouchMove:ie.onTouchMove,onTouchEnd:ie.onTouchEnd,children:[i.jsx("div",{className:"xl:col-span-2 space-y-4",children:i.jsxs("div",{className:"glass-card p-3 sm:p-4 rounded-xl",children:[i.jsxs("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 mb-3 flex items-center gap-2",children:[i.jsx(nh,{className:"w-4 h-4"}),"  ",i.jsx("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 px-1.5 py-0.5 rounded-full text-gray-600 dark:text-gray-300",children:W.length})]}),i.jsx("div",{className:"space-y-2",children:W.length>0?W.map(K=>i.jsx("div",{className:"opacity-75 hover:opacity-100 transition-opacity",children:i.jsx(fr,{todo:K,compact:!0,onEdit:p})},K.id)):i.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 text-center py-4",children:"   "})})]})}),i.jsxs("div",{className:"xl:col-span-8 space-y-6",children:[ye.length>0&&i.jsxs("div",{className:"glass-card p-4 sm:p-6 relative overflow-hidden group mb-4 sm:mb-6",children:[i.jsxs("h3",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white mb-3 sm:mb-4 flex items-center gap-2 relative z-10",children:[i.jsx(mt,{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-500"}),"  ",i.jsxs("span",{className:"text-sm sm:text-base font-medium text-gray-500 dark:text-gray-300 ml-1",children:["(",ye.length,")"]})]}),i.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-3",children:ye.map(K=>{const ne=D.find(ce=>ce.id===K.employeeId);return i.jsx(Yp,{vacation:K,employee:ne,compact:!0},K.id)})})]}),i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:["   (",Q.length,")"]}),Q.length===0&&ye.length===0?i.jsx("div",{className:"glass-card p-12 text-center text-gray-500 dark:text-gray-400",children:i.jsx("p",{className:"text-lg",children:" "})}):i.jsx("div",{className:"relative",onDragOver:K=>{if(K.preventDefault(),_===null)return;const ne=K.currentTarget,ce=ne.getBoundingClientRect(),Se=K.clientY-ce.top,ue=ne.querySelectorAll("[data-todo-index]");let Ue=ue.length;for(let tt=0;tt<ue.length;tt++){const st=ue[tt].getBoundingClientRect(),Xe=st.top-ce.top,Pt=st.bottom-ce.top,Dt=Xe+(Pt-Xe)/2;if(Se<Dt){Ue=tt;break}}if(Ue===_){ee(null);return}ee(Ue)},onDrop:K=>{K.preventDefault(),C!==null&&Z(K,C)},children:Q.map((K,ne)=>i.jsxs("div",{className:"relative",children:[_!==null&&C===ne&&i.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-blue-500 z-30"}),i.jsx("div",{"data-todo-index":ne,draggable:!0,onDragStart:ce=>M(ce,ne),onDragEnd:E,className:`
                          cursor-grab active:cursor-grabbing transition-all duration-200 relative
                          ${_===ne?"scale-105 shadow-lg z-20":""}
                          mb-1
                        `,children:i.jsx(fr,{todo:K,onEdit:p})}),_!==null&&C===ne+1&&ne===Q.length-1&&i.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-blue-500 z-30"})]},K.id))})]}),pe.length>0&&i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-green-700 dark:text-green-300 mb-4 flex items-center gap-2",children:[i.jsx(mo,{className:"w-5 h-5"}),"  (",pe.length,")"]}),i.jsx("div",{className:"space-y-2",children:pe.map(K=>{if(K.isSubTask){const ne=K,ce=ne.completedAt?new Date(ne.completedAt):new Date(ne.updatedAt);return i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx(mo,{className:"w-4 h-4 text-green-600 dark:text-green-400"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("span",{className:"text-sm font-medium text-green-800 dark:text-green-200 line-through",children:K.title}),i.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-green-100 dark:bg-green-800 text-green-800 dark:text-green-200 rounded border",children:""})]}),i.jsxs("div",{className:"text-xs text-green-700 dark:text-green-300",children:[i.jsx("span",{className:"font-medium",children:" :"})," ",ne.parentTitle,ne.parentDescription&&i.jsxs("span",{className:"ml-2 opacity-75",children:[" ",ne.parentDescription]})]}),i.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:[": ",ce.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})]})]})]},`subtask-${K.id}`)}return i.jsx(fr,{todo:K,onEdit:p},K.id)})})]})]}),i.jsx("div",{className:"xl:col-span-2 space-y-4",children:i.jsxs("div",{className:"glass-card p-3 sm:p-4 rounded-xl",children:[i.jsxs("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 mb-3 flex items-center gap-2",children:[i.jsx(Ha,{className:"w-4 h-4"})," ",i.jsx("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 px-1.5 py-0.5 rounded-full text-gray-600 dark:text-gray-300",children:de.length})]}),i.jsx("div",{className:"space-y-2",children:de.length>0?de.map(K=>i.jsx("div",{className:"opacity-75 hover:opacity-100 transition-opacity",children:i.jsx(fr,{todo:K,compact:!0,onEdit:p})},K.id)):i.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 text-center py-4",children:"   "})})]})})]}):i.jsxs("div",{className:"space-y-6 relative",children:[ye.length>0&&i.jsxs("div",{className:"glass-card p-6 relative overflow-hidden group mb-6",children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2 relative z-10",children:[i.jsx(mt,{className:"w-6 h-6 text-blue-500"}),"  ",i.jsxs("span",{className:"text-base font-medium text-gray-500 dark:text-gray-300 ml-1",children:["(",ye.length,")"]})]}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:ye.map(K=>{const ne=D.find(ce=>ce.id===K.employeeId);return i.jsx(Yp,{vacation:K,employee:ne,compact:!1},K.id)})})]}),Q.length>0&&i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:["   (",Q.length,")"]}),i.jsx("div",{className:"relative",onDragOver:K=>{if(K.preventDefault(),_===null)return;const ne=K.currentTarget,ce=ne.getBoundingClientRect(),Se=K.clientY-ce.top,ue=ne.querySelectorAll("[data-todo-index]");let Ue=ue.length;for(let tt=0;tt<ue.length;tt++){const st=ue[tt].getBoundingClientRect(),Xe=st.top-ce.top,Pt=st.bottom-ce.top,Dt=Xe+(Pt-Xe)/2;if(Se<Dt){Ue=tt;break}}if(Ue===_){ee(null);return}ee(Ue)},onDrop:K=>{K.preventDefault(),C!==null&&Z(K,C)},children:Q.map((K,ne)=>i.jsxs("div",{className:"relative",children:[_!==null&&C===ne&&i.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-blue-500 z-30"}),i.jsx("div",{"data-todo-index":ne,draggable:!0,onDragStart:ce=>M(ce,ne),onDragEnd:E,className:`
                      cursor-grab active:cursor-grabbing transition-all duration-200 relative
                      ${_===ne?"scale-105 shadow-lg z-20":""}
                      mb-1
                    `,children:i.jsx(fr,{todo:K,onEdit:p})}),_!==null&&C===ne+1&&ne===Q.length-1&&i.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-blue-500 z-30"})]},K.id))})]}),pe.length>0&&(s==="today"||s==="week"||s==="month")&&i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-green-700 dark:text-green-300 mb-4 flex items-center gap-2",children:[i.jsx(mo,{className:"w-5 h-5"}),"  (",pe.length,")"]}),i.jsx("div",{className:"space-y-2",children:pe.map(K=>{if(K.isSubTask){const ne=K,ce=ne.completedAt?new Date(ne.completedAt):new Date(ne.updatedAt);return i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx(mo,{className:"w-4 h-4 text-green-600 dark:text-green-400"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("span",{className:"text-sm font-medium text-green-800 dark:text-green-200 line-through",children:K.title}),i.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-green-100 dark:bg-green-800 text-green-800 dark:text-green-200 rounded border",children:""})]}),i.jsxs("div",{className:"text-xs text-green-700 dark:text-green-300",children:[i.jsx("span",{className:"font-medium",children:" :"})," ",ne.parentTitle,ne.parentDescription&&i.jsxs("span",{className:"ml-2 opacity-75",children:[" ",ne.parentDescription]})]}),i.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:[": ",ce.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})]})]})]},`subtask-${K.id}`)}return i.jsx(fr,{todo:K,onEdit:p},K.id)})})]})]})});th.displayName="TodoList";var US=Jp();const Ph=({isOpen:s,onClose:t,todo:r,isMobile:l=!1})=>{const{updateTodo:c,updateRecurringTemplate:u}=Qt(),[h,g]=I.useState({title:"",description:"",priority:"medium",type:"simple",startDate:"",startTime:"",dueDate:"",dueTime:"",showStartTime:!1,showDueTime:!1,recurrence:"none",recurrenceDay:1,recurrenceDate:1,project:"shortterm",tags:[],exceptions:[]}),[m,p]=I.useState({}),[x,b]=I.useState(!1);I.useEffect(()=>{if(r&&s){const D=r.id.startsWith("recurring_");b(D),g({title:r.title.replace(" ",""),description:r.description||"",priority:r.priority,type:r.type,startDate:r.startDate?new Date(r.startDate).toISOString().split("T")[0]:"",startTime:r.startTime||"",dueDate:r.dueDate?new Date(r.dueDate).toISOString().split("T")[0]:"",dueTime:r.dueDate?new Date(r.dueDate).toTimeString().split(" ")[0].substring(0,5):r.dueTime||"",showStartTime:r.showStartTime||!1,showDueTime:r.showDueTime||!1,recurrence:r.recurrence||"none",recurrenceDay:r.recurrenceDay||1,recurrenceDate:r.recurrenceDate||1,project:r.project||"shortterm",tags:r.tags||[],exceptions:[]})}},[r,s]);const w=()=>{const D={};if(h.title.trim()||(D.title="  ."),h.startDate&&h.dueDate)try{const _=new Date(`${h.startDate}T${h.startTime||"00:00"}`),$=new Date(`${h.dueDate}T${h.dueTime||"23:59"}`);_>=$&&(D.startDate="   ")}catch(_){console.error("  :",_),D.general="  "}return p(D),Object.keys(D).length===0},L=async D=>{if(D.preventDefault(),!(!w()||!r))try{if(x){const _=r._templateId;_&&u(_,{title:h.title,description:h.description,priority:h.priority,type:h.type,tags:h.tags,exceptions:h.exceptions})}else{const _={title:h.title.trim(),description:h.description.trim()||"",priority:h.priority,type:h.type,tags:h.tags};if(h.startDate)try{_.startDate=new Date(h.startDate),console.log(":  :",_.startDate)}catch($){throw console.error(":   :",$),new Error("   ")}if(h.startTime&&(_.startTime=h.startTime,console.log(":   :",_.startTime)),_.showStartTime=h.showStartTime,_.showDueTime=h.showDueTime,h.dueDate)try{const $=h.dueDate,C=h.dueTime||"23:59",ee=`${$}T${C}:00`;_.dueDate=new Date(ee),console.log(`:  : ${$} ${C} `,_.dueDate),h.dueTime&&console.log(":  dueDate :",h.dueTime)}catch($){throw console.error(":   :",$),new Error(`   : ${h.dueDate} ${h.dueTime||""}`)}h.type==="project"&&(_.project=h.project),await c(r.id,_)}t()}catch(_){console.error("  :",_),p({general:"    ."})}},T=(D,_)=>{g($=>({...$,[D]:_})),m[D]&&p($=>({...$,[D]:""}))},U=()=>{g(D=>({...D,exceptions:[...D.exceptions,{type:"date",values:[]}]}))},Y=D=>{g(_=>({..._,exceptions:_.exceptions.filter(($,C)=>C!==D)}))},k=(D,_,$)=>{g(C=>({...C,exceptions:C.exceptions.map((ee,ie)=>ie===D?{...ee,[_]:$}:ee)}))},S=(D,_)=>{g($=>({...$,exceptions:$.exceptions.map((C,ee)=>ee===D?{...C,values:_}:C)}))};if(!s||!r)return null;const R=[{value:1,label:""},{value:2,label:""},{value:3,label:""},{value:4,label:""},{value:5,label:""},{value:6,label:""},{value:0,label:""}];return US.createPortal(i.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-50 z-[9999] ${l?"":"flex items-center justify-center p-4"}`,children:i.jsxs("div",{className:`bg-white dark:bg-gray-800 shadow-xl overflow-y-auto ${l?"w-full h-full fixed inset-0":"w-full max-w-2xl max-h-[90vh] rounded-lg"}`,children:[i.jsxs("div",{className:`flex items-center justify-between border-b border-gray-200 dark:border-gray-700 ${l?"px-4 py-3":"p-6"}`,children:[i.jsxs("h2",{className:`font-semibold text-gray-900 dark:text-white ${l?"text-lg":"text-xl"}`,children:["  ",x?"( )":""]}),i.jsx("button",{onClick:t,className:`hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg ${l?"p-3":"p-2"}`,children:i.jsx(jt,{className:"w-5 h-5"})})]}),i.jsxs("form",{onSubmit:L,className:`${l?"px-4 py-4":"p-6"}`,children:[i.jsxs("div",{className:`${l?"space-y-4":"space-y-6"}`,children:[m.general&&i.jsx("div",{className:"p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:m.general}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[i.jsx(Qp,{className:"w-4 h-4 inline mr-1"})," *"]}),i.jsx("input",{type:"text",value:h.title,onChange:D=>T("title",D.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white ${m.title?"border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:" "}),m.title&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.title})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),i.jsx("textarea",{value:h.description,onChange:D=>T("description",D.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"    "})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 sm:mb-2",children:[i.jsx(Xp,{className:"w-3 h-3 sm:w-4 sm:h-4 inline mr-1"}),""]}),i.jsxs("select",{value:h.type,onChange:D=>T("type",D.target.value),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[i.jsx("option",{value:"simple",children:" "}),i.jsx("option",{value:"project",children:""})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 sm:mb-2",children:[i.jsx(Vl,{className:"w-3 h-3 sm:w-4 sm:h-4 inline mr-1"}),""]}),i.jsxs("select",{value:h.priority,onChange:D=>T("priority",D.target.value),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[i.jsx("option",{value:"low",children:""}),i.jsx("option",{value:"medium",children:""}),i.jsx("option",{value:"high",children:""}),i.jsx("option",{value:"urgent",children:""})]})]})]}),h.type==="project"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),i.jsxs("div",{className:"flex space-x-4",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",value:"shortterm",checked:h.project==="shortterm",onChange:D=>T("project",D.target.value),className:"mr-2"})," "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",value:"longterm",checked:h.project==="longterm",onChange:D=>T("project",D.target.value),className:"mr-2"})," "]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 sm:mb-2",children:[i.jsx(mt,{className:"w-3 h-3 sm:w-4 sm:h-4 inline mr-1"})," "]}),i.jsx("input",{type:"date",value:h.startDate,onChange:D=>T("startDate",D.target.value),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 sm:mb-2",children:[i.jsx(Ha,{className:"w-3 h-3 sm:w-4 sm:h-4 inline mr-1"})," "]}),i.jsx("input",{type:"time",value:h.startTime,onChange:D=>T("startTime",D.target.value),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 sm:mb-2",children:[i.jsx(mt,{className:"w-3 h-3 sm:w-4 sm:h-4 inline mr-1"})," "]}),i.jsx("input",{type:"date",value:h.dueDate,onChange:D=>T("dueDate",D.target.value),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 sm:mb-2",children:[i.jsx(Ha,{className:"w-3 h-3 sm:w-4 sm:h-4 inline mr-1"})," "]}),i.jsx("input",{type:"time",value:h.dueTime,onChange:D=>T("dueTime",D.target.value),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]})]}),i.jsxs("div",{className:"flex items-center space-x-4 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:h.showStartTime,onChange:D=>T("showStartTime",D.target.checked),className:"mr-2"}),i.jsx(Ha,{className:"w-4 h-4 inline mr-1"})," "]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:h.showDueTime,onChange:D=>T("showDueTime",D.target.checked),className:"mr-2"}),i.jsx(Ha,{className:"w-4 h-4 inline mr-1"})," "]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),i.jsx("input",{type:"text",value:h.tags.join(", "),onChange:D=>T("tags",D.target.value.split(",").map(_=>_.trim()).filter(_=>_)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"    (: , , )"})]}),h.type==="project"&&r&&!x&&i.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:i.jsx(rb,{todoId:r.id,subTasks:r.subTasks||[]})}),x&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[i.jsx(rh,{className:"w-4 h-4 inline mr-1"}),"  (  )"]}),i.jsxs("button",{type:"button",onClick:U,className:"flex items-center gap-1 px-2 py-1 text-sm bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-900/30",children:[i.jsx(Bt,{className:"w-3 h-3"})," "]})]}),h.exceptions.map((D,_)=>i.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("select",{value:D.type,onChange:$=>k(_,"type",$.target.value),className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[i.jsx("option",{value:"date",children:" "}),i.jsx("option",{value:"weekday",children:" "}),i.jsx("option",{value:"week",children:" "}),i.jsx("option",{value:"month",children:" "})]}),i.jsx("button",{type:"button",onClick:()=>Y(_),className:"ml-2 p-1 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/20 rounded",children:i.jsx(jt,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-6 gap-2",children:[D.type==="date"&&Array.from({length:31},($,C)=>C+1).map($=>i.jsxs("label",{className:"flex items-center space-x-1",children:[i.jsx("input",{type:"checkbox",checked:D.values.includes($),onChange:C=>{const ee=D.values,ie=C.target.checked?[...ee,$]:ee.filter(xe=>xe!==$);S(_,ie)},className:"text-sm"}),i.jsxs("span",{className:"text-xs",children:[$,""]})]},$)),D.type==="weekday"&&R.map($=>i.jsxs("label",{className:"flex items-center space-x-1",children:[i.jsx("input",{type:"checkbox",checked:D.values.includes($.value),onChange:C=>{const ee=D.values,ie=C.target.checked?[...ee,$.value]:ee.filter(xe=>xe!==$.value);S(_,ie)},className:"text-sm"}),i.jsx("span",{className:"text-xs",children:$.label})]},$.value)),D.type==="week"&&[1,2,3,4,-1].map($=>i.jsxs("label",{className:"flex items-center space-x-1",children:[i.jsx("input",{type:"checkbox",checked:D.values.includes($),onChange:C=>{const ee=D.values,ie=C.target.checked?[...ee,$]:ee.filter(xe=>xe!==$);S(_,ie)},className:"text-sm"}),i.jsx("span",{className:"text-xs",children:Wo($)})]},$)),D.type==="month"&&Array.from({length:12},($,C)=>C+1).map($=>i.jsxs("label",{className:"flex items-center space-x-1",children:[i.jsx("input",{type:"checkbox",checked:D.values.includes($),onChange:C=>{const ee=D.values,ie=C.target.checked?[...ee,$]:ee.filter(xe=>xe!==$);S(_,ie)},className:"text-sm"}),i.jsxs("span",{className:"text-xs",children:[$,""]})]},$))]}),i.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:D.values.length>0&&i.jsxs("span",{children:[" ",D.type==="date"?"":D.type==="weekday"?"":D.type==="week"?"":"",": ",D.values.join(", ")]})})]},_))]})]}),i.jsxs("div",{className:`flex justify-end space-x-3 ${l?"mt-6":"mt-8"}`,children:[i.jsx("button",{type:"button",onClick:t,className:`text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg ${l?"px-6 py-3":"px-4 py-2"}`,children:""}),i.jsxs("button",{type:"submit",className:`flex items-center gap-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 ${l?"px-6 py-3":"px-4 py-2"}`,children:[i.jsx(Bu,{className:"w-4 h-4"}),""]})]})]})]})}),document.body)},HS=({currentDate:s,onDateChange:t,searchTerm:r,priorityFilter:l,typeFilter:c,projectFilter:u,tagFilter:h,completionDateFilter:g,onAddTodo:m,isMobile:p=!1})=>{const[x,b]=I.useState({}),[w,L]=I.useState(null),[T,U]=I.useState(!1),[Y,k]=I.useState(!1),[S,R]=I.useState([]),[D,_]=I.useState([]),{getFilteredTodos:$,toggleTodo:C,deleteTodo:ee}=Qt(),{currentUser:ie}=Nn(),{showVacationsInTodos:xe,getVacationsForDate:_e,employees:ve}=Yh(),{getCustomHoliday:he}=Qo(),Te=I.useMemo(()=>{const O=dh(s,{weekStartsOn:0}),Q=uh(s,{weekStartsOn:0});return my({start:O,end:Q})},[s]),Ee=I.useMemo(()=>x_(s,{weekStartsOn:0}),[s]);I.useEffect(()=>{(()=>{const Q={};Te.forEach(pe=>{const W=hh(pe),de=he(pe);de?Q[pe.toISOString().split("T")[0]]={date:pe.toISOString().split("T")[0],name:de.name,isHoliday:!0,type:"custom"}:W&&(Q[pe.toISOString().split("T")[0]]=W)}),b(Q)})()},[Te]);const X=I.useMemo(()=>$({searchTerm:r,priorityFilter:l,typeFilter:c,projectFilter:u,tagFilter:h,completionDateFilter:g,includeCompleted:!0}),[r,l,c,u,h,g,$]),oe=O=>{const Q=X.filter(W=>{if(W.completed&&W.completedAt)return Do(W.completedAt,O);if(!W.completed){const de=W.startDate?new Date(W.startDate):null,K=W.dueDate?new Date(W.dueDate):null;if(de&&K){const ne=new Date(O);return de.setHours(0,0,0,0),K.setHours(0,0,0,0),ne.setHours(0,0,0,0),ne.getTime()>=de.getTime()&&ne.getTime()<=K.getTime()}if(de&&!K){const ne=new Date(O);de.setHours(0,0,0,0),ne.setHours(0,0,0,0);const ce=new Date;return ce.setHours(0,0,0,0),ne.getTime()===de.getTime()?!0:ne.getTime()>de.getTime()&&ne.getTime()<=ce.getTime()?!W.completed:!1}return!de&&K?Do(K,O):!1}return!1}),pe={urgent:0,high:1,medium:2,low:3};return Q.sort((W,de)=>{const K=pe[W.priority]-pe[de.priority];if(K!==0)return K;const ne=W.order||0,ce=de.order||0;return ne!==ce?ne-ce:new Date(W.createdAt).getTime()-new Date(de.createdAt).getTime()})},ye=()=>{t(py(s))},M=()=>{t(yy(s,1))},Z=()=>{t(new Date)},E=lc({onSwipeLeft:M,onSwipeRight:ye},{minSwipeDistance:60});return i.jsxs("div",{className:"space-y-4",...p?{onTouchStart:E.onTouchStart,onTouchMove:E.onTouchMove,onTouchEnd:E.onTouchEnd}:{},children:[i.jsxs("div",{className:`flex items-center ${p?"flex-col gap-2":"justify-between"}`,children:[i.jsxs("div",{className:`flex items-center ${p?"w-full justify-between":"gap-4"}`,children:[i.jsxs("h2",{className:`${p?"text-base":"text-xl"} font-semibold text-gray-900 dark:text-white ${p?"flex-1 text-center min-w-0":""}`,children:[Lt(s,"yyyy M",{locale:gn})," ",Ee,""]}),i.jsxs("div",{className:`flex items-center ${p?"gap-1":"gap-2"}`,children:[i.jsx("button",{onClick:ye,className:`${p?"p-1":"p-2"} hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg`,title:" ",children:i.jsx(Po,{className:`${p?"w-3 h-3":"w-4 h-4"}`})}),i.jsx("button",{onClick:Z,className:`${p?"px-2 py-1 text-xs":"px-3 py-1 text-sm"} bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/40`,children:" "}),i.jsx("button",{onClick:M,className:`${p?"p-1":"p-2"} hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg`,title:" ",children:i.jsx(ws,{className:`${p?"w-3 h-3":"w-4 h-4"}`})})]})]}),!p&&i.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[Lt(Te[0],"M d",{locale:gn})," - ",Lt(Te[6],"M d",{locale:gn})]})]}),i.jsx("div",{className:"grid grid-cols-7 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:Te.map((O,Q)=>{const pe=oe(O);pe.filter(ue=>ue.completed).length,pe.length;const W=O.toISOString().split("T")[0],de=x[W],K=za(O),ne=qu(O),Se=Ba(ie?.email)&&xe?_e(O):[];return i.jsxs("div",{className:"border-r border-gray-200 dark:border-gray-700 last:border-r-0 relative flex flex-col",children:[i.jsxs("div",{className:`${p?"p-1":"p-2"} border-b border-gray-200 dark:border-gray-700 text-center cursor-pointer hover:bg-opacity-80 transition-colors ${ne?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":de||K?"bg-red-50 dark:bg-red-900/20":"bg-gray-50 dark:bg-gray-700/50"}`,onClick:()=>{(pe.length>0||Se.length>0)&&(R(pe),_(Se),k(!0))},children:[i.jsx("div",{className:`text-xs font-medium mb-1 ${de||K?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400"}`,children:Lt(O,"E",{locale:gn})}),i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx("div",{className:`text-lg font-semibold ${ne?"text-blue-700 dark:text-blue-300":de||K?"text-red-700 dark:text-red-300":"text-gray-900 dark:text-white"}`,children:Lt(O,"d")}),de&&!p&&i.jsx("div",{className:"text-xs text-red-600 dark:text-red-400 font-medium ml-1",children:de.name})]})]}),i.jsxs("div",{className:`${p?"px-0.5 py-1 min-h-[150px] space-y-0.5":"p-2 min-h-[200px] space-y-1"} flex-1`,children:[Se.slice(0,Math.max(0,8-pe.length)).map(ue=>{const Ue=ve.find(tt=>tt.id===ue.employeeId);return i.jsx("div",{className:`${p?"p-1 text-[9px]":"p-2 text-xs"} rounded border cursor-pointer hover:shadow-md transition-all ${ue.type===""?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800 hover:bg-green-100 dark:hover:bg-green-900/30":ue.type===""||ue.type===""?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 hover:bg-blue-100 dark:hover:bg-blue-900/30":ue.type===""?"bg-purple-50 dark:bg-purple-900/20 border-purple-200 dark:border-purple-800 hover:bg-purple-100 dark:hover:bg-purple-900/30":ue.type===""?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 hover:bg-red-100 dark:hover:bg-red-900/30":"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800 hover:bg-yellow-100 dark:hover:bg-yellow-900/30"}`,title:Ue?`${Ue.name} - ${ue.type}`:` ${ue.employeeId} - ${ue.type}`,children:i.jsx("div",{className:"truncate",children:p?`${ue.type}`:Ue?`${Ue.name} ${ue.type}`:`${ue.employeeId} ${ue.type}`})},`vacation-${ue.id}`)}),pe.slice(0,Math.max(0,8-Se.length)).map(ue=>i.jsxs("div",{className:`group relative ${p?"p-1":"p-2"} rounded ${p?"text-[10px]":"text-xs"} border cursor-pointer hover:shadow-md transition-all ${ue.completed?"bg-gray-50 dark:bg-gray-700 border-gray-200 dark:border-gray-600 opacity-60":ue.priority==="urgent"?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 hover:bg-red-100 dark:hover:bg-red-900/30":ue.priority==="high"?"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800 hover:bg-orange-100 dark:hover:bg-orange-900/30":"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 hover:bg-blue-100 dark:hover:bg-blue-900/30"}`,onClick:()=>{L(ue),U(!0)},children:[i.jsx("div",{className:`font-medium truncate ${p?"text-[10px]":"text-xs"} ${ue.completed?"line-through text-gray-500":"text-gray-900 dark:text-white"}`,children:ue.title}),i.jsxs("div",{className:`${p?"text-[9px]":"text-xs"} text-gray-500 dark:text-gray-400 ${p?"mt-0.5":"mt-1"}`,children:[ue.showStartTime&&ue.startTime&&i.jsxs("span",{children:[": ",ue.startTime]}),ue.showStartTime&&ue.startTime&&ue.showDueTime&&ue.dueDate&&new Date(ue.dueDate).getHours()!==23&&new Date(ue.dueDate).getMinutes()!==59&&i.jsx("span",{children:" | "}),ue.showDueTime&&ue.dueDate&&(()=>{const Ue=new Date(ue.dueDate);return Ue.getHours()===23&&Ue.getMinutes()===59?null:i.jsxs("span",{children:[": ",Ue.toTimeString().slice(0,5)]})})()]}),i.jsxs("div",{className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity flex gap-1",children:[i.jsx("button",{onClick:Ue=>{Ue.stopPropagation(),C(ue.id)},className:"p-1.5 bg-white dark:bg-gray-800 rounded shadow-sm hover:bg-gray-100 dark:hover:bg-gray-700",title:ue.completed?" ":" ",children:i.jsx("div",{className:`w-3 h-3 rounded-full ${ue.completed?"bg-green-600":"border border-gray-400"}`})}),i.jsx("button",{onClick:Ue=>{Ue.stopPropagation(),confirm(`"${ue.title}"  ?`)&&ee(ue.id)},className:"p-1.5 bg-white dark:bg-gray-800 rounded shadow-sm hover:bg-red-100 dark:hover:bg-red-900/30",title:"",children:i.jsx(an,{className:"w-3 h-3 text-red-600"})})]})]},ue.id)),pe.length+Se.length>8&&i.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center py-1 cursor-pointer hover:text-blue-600",onClick:()=>{R(pe),_(Se),k(!0)},children:["+",pe.length+Se.length-8," "]}),i.jsx("button",{onClick:m,className:`w-full ${p?"h-6":"h-8"} border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg flex items-center justify-center text-gray-400 hover:border-blue-400 hover:text-blue-400 transition-colors`,title:" ",children:i.jsx(Bt,{className:`${p?"w-2.5 h-2.5":"w-3 h-3"}`})})]}),de&&p&&i.jsx("div",{className:"absolute bottom-0 left-0 right-0",children:i.jsx("div",{className:"text-[9px] text-red-600 dark:text-red-400 font-medium text-center bg-red-50 dark:bg-red-900/20 py-0.5 leading-tight",children:de.name})})]},Q)})}),Te.some(O=>{const Q=oe(O),W=Ba(ie?.email)&&xe?_e(O):[];return Q.length>0||W.length>0})&&i.jsxs("div",{className:"mt-8",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"   "}),i.jsx("div",{className:"space-y-2",children:Te.map(O=>{const Q=oe(O),W=Ba(ie?.email)&&xe?_e(O):[];return Q.length===0&&W.length===0?null:i.jsxs("div",{children:[i.jsxs("h4",{className:"text-md font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[i.jsx(mt,{className:"w-4 h-4"}),Lt(O,"M d (E)",{locale:gn}),qu(O)&&i.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300 rounded",children:""})]}),i.jsxs("div",{className:"space-y-2",children:[W.map(de=>{const K=ve.find(ne=>ne.id===de.employeeId);return i.jsx("div",{className:`p-3 rounded-lg border cursor-pointer hover:shadow-md transition-all ${de.type===""?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":de.type===""||de.type===""?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":de.type===""?"bg-purple-50 dark:bg-purple-900/20 border-purple-200 dark:border-purple-800":de.type===""?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800":"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800"}`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[K&&i.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-white text-sm font-semibold",style:{backgroundColor:K.color},children:K.name.charAt(0)}),i.jsx("div",{className:"flex-1 truncate",children:i.jsx("div",{className:`font-medium text-gray-900 dark:text-white truncate ${p?"text-sm":"text-base"}`,children:K?K.name:` ${de.employeeId}`})}),i.jsx("div",{className:`px-2 py-1 text-xs font-medium rounded ${de.type===""?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200":de.type===""||de.type===""?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200":de.type===""?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-200":de.type===""?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-200"}`,children:de.type})]})},`vacation-${de.id}`)}),Q.map(de=>i.jsx(fr,{todo:de},de.id))]})]},O.toISOString())})})]}),w&&i.jsx(Ph,{isOpen:T,onClose:()=>{U(!1),L(null)},todo:w,isMobile:p}),Y&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>k(!1),children:i.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-lg shadow-xl ${p?"w-[90vw] max-h-[80vh]":"w-[500px] max-h-[600px]"} overflow-hidden`,onClick:O=>O.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[i.jsx(mt,{className:"w-5 h-5"}),S.length>0&&S[0].dueDate?Lt(S[0].dueDate,"M d (E)",{locale:gn}):"  "," (",S.length+D.length,")"]}),i.jsx("button",{onClick:()=>k(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:i.jsx(jt,{className:"w-4 h-4"})})]}),i.jsx("div",{className:"p-4 overflow-y-auto max-h-[500px]",children:S.length>0||D.length>0?i.jsxs("div",{className:"space-y-3",children:[D.map(O=>{const Q=ve.find(pe=>pe.id===O.employeeId);return i.jsx("div",{className:`p-2 rounded border ${O.type===""?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":O.type===""||O.type===""?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":O.type===""?"bg-purple-50 dark:bg-purple-900/20 border-purple-200 dark:border-purple-800":O.type===""?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800":"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800"}`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[Q&&i.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-semibold",style:{backgroundColor:Q.color},children:Q.name.charAt(0)}),i.jsx("div",{className:"flex-1",children:i.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:Q?Q.name:` ${O.employeeId}`})}),i.jsx("div",{className:`px-2 py-1 text-xs font-medium rounded ${O.type===""?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200":O.type===""||O.type===""?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200":O.type===""?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-200":O.type===""?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-200"}`,children:O.type})]})},`vacation-${O.id}`)}),S.map(O=>i.jsx("div",{className:`p-2 rounded border cursor-pointer hover:shadow-md transition-all ${O.completed?"bg-gray-50 dark:bg-gray-700 border-gray-200 dark:border-gray-600 opacity-60":O.priority==="urgent"?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800":O.priority==="high"?"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800":"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800"}`,onClick:()=>{L(O),U(!0),k(!1)},children:i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:`font-medium truncate ${O.completed?"line-through text-gray-500":"text-gray-900 dark:text-white"}`,children:O.title}),(O.showStartTime&&O.startTime||O.showDueTime&&O.dueDate)&&i.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[O.showStartTime&&O.startTime&&i.jsxs("span",{children:[": ",O.startTime]}),O.showStartTime&&O.startTime&&O.showDueTime&&O.dueDate&&(()=>{const Q=new Date(O.dueDate);return Q.getHours()===23&&Q.getMinutes()===59?null:i.jsx("span",{children:" | "})})(),O.showDueTime&&O.dueDate&&(()=>{const Q=new Date(O.dueDate);return Q.getHours()===23&&Q.getMinutes()===59?null:i.jsxs("span",{children:[": ",Q.toTimeString().slice(0,5)]})})()]})]}),i.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[O.type==="project"&&i.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${O.project==="longterm"?"bg-purple-100 text-purple-700 dark:bg-purple-900/20 dark:text-purple-400":"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400"}`,children:O.project==="longterm"?"":""}),O.priority&&O.priority!=="medium"&&i.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${O.priority==="urgent"?"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400":O.priority==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/20 dark:text-orange-400":"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-400"}`,children:O.priority==="urgent"?"":O.priority==="high"?"":""}),i.jsx("button",{onClick:Q=>{Q.stopPropagation(),C(O.id)},className:"p-1 bg-white dark:bg-gray-700 rounded shadow-sm hover:bg-gray-100 dark:hover:bg-gray-600 border border-gray-200 dark:border-gray-600",title:O.completed?" ":" ",children:i.jsx("div",{className:`w-3 h-3 rounded-full ${O.completed?"bg-green-600":"border border-gray-400"}`})}),i.jsx("button",{onClick:Q=>{Q.stopPropagation(),confirm(`"${O.title}"  ?`)&&(ee(O.id),S.filter(W=>W.id!==O.id).length===0&&D.length===0&&k(!1))},className:"p-1 bg-white dark:bg-gray-700 rounded shadow-sm hover:bg-red-100 dark:hover:bg-red-800 border border-gray-200 dark:border-gray-600",title:"",children:i.jsx(an,{className:"w-3 h-3 text-red-600"})})]})]})},O.id))]}):i.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"   ."})}),i.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 flex justify-end",children:i.jsx("button",{onClick:()=>k(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",children:""})})]})})]})},$S=({currentDate:s,onDateChange:t,searchTerm:r,priorityFilter:l,typeFilter:c,projectFilter:u,tagFilter:h,completionDateFilter:g,onAddTodo:m,isMobile:p=!1})=>{const[x,b]=I.useState({}),[w,L]=I.useState(null),[T,U]=I.useState(!1),[Y,k]=I.useState(!1),[S,R]=I.useState([]),[D,_]=I.useState([]),{getFilteredTodos:$,toggleTodo:C,deleteTodo:ee}=Qt(),{currentUser:ie}=Nn(),{showVacationsInTodos:xe,getVacationsForDate:_e,employees:ve}=Yh(),{getCustomHoliday:he}=Qo(),Te=b_(s),Ee=v_(Te),X=dh(Te,{weekStartsOn:0}),oe=uh(Ee,{weekStartsOn:0}),ye=I.useMemo(()=>my({start:X,end:oe}),[X,oe]);I.useEffect(()=>{(()=>{const de={};ye.forEach(K=>{const ne=hh(K),ce=he(K);ce?de[K.toISOString().split("T")[0]]={date:K.toISOString().split("T")[0],name:ce.name,isHoliday:!0,type:"custom"}:ne&&(de[K.toISOString().split("T")[0]]=ne)}),b(de)})()},[ye]);const M=I.useMemo(()=>$({searchTerm:r,priorityFilter:l,typeFilter:c,projectFilter:u,tagFilter:h,completionDateFilter:g,includeCompleted:!0}),[r,l,c,u,h,g,$]),Z=W=>{const de=M.filter(ne=>{if(ne.completed&&ne.completedAt)return Do(ne.completedAt,W);if(!ne.completed){const ce=ne.startDate?new Date(ne.startDate):null,Se=ne.dueDate?new Date(ne.dueDate):null;if(ce&&Se){const ue=new Date(W);return ce.setHours(0,0,0,0),Se.setHours(0,0,0,0),ue.setHours(0,0,0,0),ue.getTime()>=ce.getTime()&&ue.getTime()<=Se.getTime()}if(ce&&!Se){const ue=new Date(W);ce.setHours(0,0,0,0),ue.setHours(0,0,0,0);const Ue=new Date;return Ue.setHours(0,0,0,0),ue.getTime()===ce.getTime()?!0:ue.getTime()>ce.getTime()&&ue.getTime()<=Ue.getTime()?!ne.completed:!1}return!ce&&Se?Do(Se,W):!1}return!1}),K={urgent:0,high:1,medium:2,low:3};return de.sort((ne,ce)=>{const Se=K[ne.priority]-K[ce.priority];if(Se!==0)return Se;const ue=ne.order||0,Ue=ce.order||0;return ue!==Ue?ue-Ue:new Date(ne.createdAt).getTime()-new Date(ce.createdAt).getTime()})},E=()=>{t(xy(s))},O=()=>{t(by(s,1))},Q=()=>{t(new Date)},pe=lc({onSwipeLeft:O,onSwipeRight:E},{minSwipeDistance:60});return i.jsxs("div",{className:"space-y-4",...p?{onTouchStart:pe.onTouchStart,onTouchMove:pe.onTouchMove,onTouchEnd:pe.onTouchEnd}:{},children:[i.jsx("div",{className:`flex items-center ${p?"flex-col gap-2":"justify-between"}`,children:i.jsxs("div",{className:`flex items-center ${p?"w-full justify-between":"gap-4"}`,children:[i.jsx("h2",{className:`${p?"text-base":"text-xl"} font-semibold text-gray-900 dark:text-white ${p?"flex-1 text-center min-w-0":""}`,children:Lt(s,"yyyy M",{locale:gn})}),i.jsxs("div",{className:`flex items-center ${p?"gap-1":"gap-2"}`,children:[i.jsx("button",{onClick:E,className:`${p?"p-1":"p-2"} hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg`,title:" ",children:i.jsx(Po,{className:`${p?"w-3 h-3":"w-4 h-4"}`})}),i.jsx("button",{onClick:Q,className:`${p?"px-2 py-1 text-xs":"px-3 py-1 text-sm"} bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/40`,children:" "}),i.jsx("button",{onClick:O,className:`${p?"p-1":"p-2"} hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg`,title:" ",children:i.jsx(ws,{className:`${p?"w-3 h-3":"w-4 h-4"}`})})]})]})}),i.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[i.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200 dark:border-gray-700",children:["","","","","","",""].map((W,de)=>i.jsx("div",{className:`text-center py-2 text-sm font-medium ${de===0?"text-red-600 dark:text-red-400":de===6?"text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400"}`,children:W},W))}),i.jsx("div",{className:"grid grid-cols-7",children:ye.map((W,de)=>{const K=Z(W),ne=W.toISOString().split("T")[0],ce=x[ne],Se=za(W),ue=qu(W),Ue=w_(W,s),st=Ba(ie?.email)&&xe?_e(W):[];return i.jsxs("div",{className:`min-h-[100px] border-b border-r border-gray-200 dark:border-gray-700 relative ${Ue?"":"bg-gray-50/50 dark:bg-gray-900/20"} ${de%7===6?"border-r-0":""} hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors cursor-pointer`,onClick:()=>{(K.length>0||st.length>0)&&(R(K),_(st),k(!0))},children:[i.jsxs("div",{className:`p-1 text-right ${Ue?"":"opacity-30"}`,children:[i.jsx("span",{className:`inline-block w-6 h-6 text-center leading-6 rounded-full text-sm ${ue?"bg-blue-600 text-white":ce||Se&&Fm(W)===0?"text-red-600 dark:text-red-400 font-medium":Se&&Fm(W)===6?"text-blue-600 dark:text-blue-400 font-medium":"text-gray-700 dark:text-gray-300"}`,children:Lt(W,"d")}),ce&&i.jsx("div",{className:"text-[10px] text-red-600 dark:text-red-400 font-medium truncate px-1",children:ce.name})]}),i.jsxs("div",{className:"px-1 pb-1 space-y-0.5",children:[st.slice(0,3).map(Xe=>{const Pt=ve.find(Dt=>Dt.id===Xe.employeeId);return i.jsxs("div",{className:`px-1.5 py-0.5 text-[10px] rounded truncate ${Xe.type===""?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200":Xe.type===""||Xe.type===""?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200":Xe.type===""?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-200":Xe.type===""?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-200"}`,title:Pt?`${Pt.name} - ${Xe.type}`:` ${Xe.employeeId} - ${Xe.type}`,children:[Pt?Pt.name:`${Xe.employeeId}`," ",Xe.type]},`vacation-${Xe.id}`)}),K.slice(0,Math.max(0,3-st.length)).map(Xe=>i.jsx("div",{className:`px-1.5 py-0.5 text-[10px] rounded truncate cursor-pointer ${Xe.completed?"bg-gray-100 text-gray-500 line-through dark:bg-gray-700 dark:text-gray-400":Xe.priority==="urgent"?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200":Xe.priority==="high"?"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-200":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200"}`,onClick:Pt=>{Pt.stopPropagation(),L(Xe),U(!0)},children:Xe.title},Xe.id)),K.length+st.length>3&&i.jsxs("div",{className:"text-[10px] text-gray-500 dark:text-gray-400 text-center",children:["+",K.length+st.length-3,""]})]})]},W.toISOString())})})]}),w&&i.jsx(Ph,{isOpen:T,onClose:()=>{U(!1),L(null)},todo:w,isMobile:p}),Y&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>k(!1),children:i.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-lg shadow-xl ${p?"w-[90vw] max-h-[80vh]":"w-[500px] max-h-[600px]"} overflow-hidden`,onClick:W=>W.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[i.jsx(mt,{className:"w-5 h-5"}),S.length>0&&S[0].dueDate?Lt(S[0].dueDate,"M d (E)",{locale:gn}):"  "," (",S.length+D.length,")"]}),i.jsx("button",{onClick:()=>k(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:i.jsx(jt,{className:"w-4 h-4"})})]}),i.jsx("div",{className:"p-4 overflow-y-auto max-h-[500px]",children:S.length>0||D.length>0?i.jsxs("div",{className:"space-y-3",children:[D.map(W=>{const de=ve.find(K=>K.id===W.employeeId);return i.jsx("div",{className:`p-2 rounded border ${W.type===""?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":W.type===""||W.type===""?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":W.type===""?"bg-purple-50 dark:bg-purple-900/20 border-purple-200 dark:border-purple-800":W.type===""?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800":"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800"}`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[de&&i.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-semibold",style:{backgroundColor:de.color},children:de.name.charAt(0)}),i.jsx("div",{className:"flex-1",children:i.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:de?de.name:` ${W.employeeId}`})}),i.jsx("div",{className:`px-2 py-1 text-xs font-medium rounded ${W.type===""?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200":W.type===""||W.type===""?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200":W.type===""?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-200":W.type===""?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-200"}`,children:W.type})]})},`vacation-${W.id}`)}),S.map(W=>i.jsx("div",{className:`p-2 rounded border cursor-pointer hover:shadow-md transition-all ${W.completed?"bg-gray-50 dark:bg-gray-700 border-gray-200 dark:border-gray-600 opacity-60":W.priority==="urgent"?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800":W.priority==="high"?"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800":"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800"}`,onClick:()=>{L(W),U(!0),k(!1)},children:i.jsxs("div",{className:"flex items-center justify-between gap-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:`font-medium truncate ${W.completed?"line-through text-gray-500":"text-gray-900 dark:text-white"}`,children:W.title}),(W.showStartTime&&W.startTime||W.showDueTime&&W.dueDate)&&i.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[W.showStartTime&&W.startTime&&i.jsxs("span",{children:[": ",W.startTime]}),W.showStartTime&&W.startTime&&W.showDueTime&&W.dueDate&&(()=>{const de=new Date(W.dueDate);return de.getHours()===23&&de.getMinutes()===59?null:i.jsx("span",{children:" | "})})(),W.showDueTime&&W.dueDate&&(()=>{const de=new Date(W.dueDate);return de.getHours()===23&&de.getMinutes()===59?null:i.jsxs("span",{children:[": ",de.toTimeString().slice(0,5)]})})()]})]}),i.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[W.type==="project"&&i.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${W.project==="longterm"?"bg-purple-100 text-purple-700 dark:bg-purple-900/20 dark:text-purple-400":"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400"}`,children:W.project==="longterm"?"":""}),W.priority&&W.priority!=="medium"&&i.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${W.priority==="urgent"?"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400":W.priority==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/20 dark:text-orange-400":"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-400"}`,children:W.priority==="urgent"?"":W.priority==="high"?"":""}),i.jsx("button",{onClick:de=>{de.stopPropagation(),C(W.id)},className:"p-1 bg-white dark:bg-gray-700 rounded shadow-sm hover:bg-gray-100 dark:hover:bg-gray-600 border border-gray-200 dark:border-gray-600",title:W.completed?" ":" ",children:i.jsx("div",{className:`w-3 h-3 rounded-full ${W.completed?"bg-green-600":"border border-gray-400"}`})}),i.jsx("button",{onClick:de=>{de.stopPropagation(),confirm(`"${W.title}"  ?`)&&(ee(W.id),S.filter(ne=>ne.id!==W.id).length===0&&D.length===0&&k(!1))},className:"p-1 bg-white dark:bg-gray-700 rounded shadow-sm hover:bg-red-100 dark:hover:bg-red-800 border border-gray-200 dark:border-gray-600",title:"",children:i.jsx(an,{className:"w-3 h-3 text-red-600"})})]})]})},W.id))]}):i.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"   ."})}),i.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 flex justify-end",children:i.jsx("button",{onClick:()=>k(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",children:""})})]})})]})},zS=({layout:s="sidebar"})=>{const{todos:t,getTodayTodos:r,getWeekTodos:l,getOverdueTodos:c}=Qt(),u=t.length,h=t.filter(S=>S.completed).length,g=u>0?Math.round(h/u*100):0,m=r(),p=m.filter(S=>S.completed).length,x=m.length,b=l(),w=b.filter(S=>S.completed).length,L=b.length,T=L>0?Math.round(w/L*100):0,U=c().length,Y=({value:S,color:R,size:D=60})=>{const _=D/2-4,$=2*Math.PI*_,C=$-S/100*$;return i.jsxs("div",{className:"relative flex items-center justify-center",style:{width:D,height:D},children:[i.jsxs("svg",{className:"transform -rotate-90 w-full h-full",children:[i.jsx("circle",{className:"text-gray-200 dark:text-gray-700",strokeWidth:"4",stroke:"currentColor",fill:"transparent",r:_,cx:D/2,cy:D/2}),i.jsx("circle",{className:R,strokeWidth:"4",strokeDasharray:$,strokeDashoffset:C,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:_,cx:D/2,cy:D/2})]}),i.jsxs("span",{className:"absolute text-xs font-bold text-gray-700 dark:text-gray-200",children:[S,"%"]})]})},k=[{title:" ",value:`${g}%`,icon:i.jsx(vw,{className:"w-5 h-5"}),textColor:"text-green-600",bgColor:"bg-green-50 dark:bg-green-900/20",borderColor:"border-green-100 dark:border-green-800",chart:i.jsx(Y,{value:g,color:"text-green-500"})},{title:" ",value:`${p}/${x}`,icon:i.jsx(ww,{className:"w-5 h-5"}),textColor:"text-blue-600",bgColor:"bg-blue-50 dark:bg-blue-900/20",borderColor:"border-blue-100 dark:border-blue-800",chart:i.jsx("div",{className:"w-full h-2 bg-blue-100 dark:bg-blue-900/30 rounded-full overflow-hidden mt-2",children:i.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-all duration-500",style:{width:`${x>0?p/x*100:0}%`}})})},{title:" ",value:`${T}%`,icon:i.jsx(_w,{className:"w-5 h-5"}),textColor:"text-purple-600",bgColor:"bg-purple-50 dark:bg-purple-900/20",borderColor:"border-purple-100 dark:border-purple-800",chart:i.jsx(Y,{value:T,color:"text-purple-500"})},{title:" ",value:U.toString(),icon:i.jsx(kw,{className:"w-5 h-5"}),textColor:"text-red-600",bgColor:"bg-red-50 dark:bg-red-900/20",borderColor:"border-red-100 dark:border-red-800",chart:i.jsx("div",{className:"flex items-center justify-center h-[60px]",children:i.jsx("span",{className:"text-3xl font-bold text-red-500",children:U})})}];return s==="compact"?i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("div",{className:"text-center min-w-[28px]",children:[i.jsxs("p",{className:"text-green-600 text-xs font-bold leading-none",children:[g,"%"]}),i.jsx("p",{className:"text-[9px] text-gray-500 dark:text-gray-400 leading-none mt-0.5",children:""})]}),i.jsxs("div",{className:"text-center min-w-[28px]",children:[i.jsxs("p",{className:"text-blue-600 text-xs font-bold leading-none",children:[p,"/",x]}),i.jsx("p",{className:"text-[9px] text-gray-500 dark:text-gray-400 leading-none mt-0.5",children:""})]}),i.jsxs("div",{className:"text-center min-w-[28px]",children:[i.jsxs("p",{className:"text-purple-600 text-xs font-bold leading-none",children:[T,"%"]}),i.jsx("p",{className:"text-[9px] text-gray-500 dark:text-gray-400 leading-none mt-0.5",children:""})]}),i.jsxs("div",{className:"text-center min-w-[28px]",children:[i.jsx("p",{className:"text-red-600 text-xs font-bold leading-none",children:U}),i.jsx("p",{className:"text-[9px] text-gray-500 dark:text-gray-400 leading-none mt-0.5",children:""})]})]}):i.jsx("div",{className:`grid ${s==="full"?"grid-cols-2 lg:grid-cols-4":"grid-cols-2"} gap-4 lg:gap-6`,children:k.map((S,R)=>i.jsxs("div",{className:`${S.bgColor} ${S.borderColor} rounded-xl p-4 lg:p-6 border transition-all duration-300 hover:shadow-md hover:-translate-y-1 flex flex-col justify-between min-h-[140px]`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("div",{className:`p-2.5 rounded-xl bg-white dark:bg-gray-800 ${S.textColor} shadow-sm`,children:S.icon}),i.jsx("p",{className:"text-sm lg:text-base font-semibold text-gray-600 dark:text-gray-400",children:S.title})]}),i.jsxs("div",{className:"flex items-end justify-between mt-2",children:[i.jsx("div",{className:"flex flex-col",children:i.jsx("span",{className:`text-2xl lg:text-3xl font-bold ${S.textColor} dark:text-gray-200 tracking-tight`,children:S.value})}),i.jsx("div",{className:"flex items-center justify-center scale-110 lg:scale-125 origin-bottom-right",children:S.chart})]})]},R))})},Pp=({layout:s="full"})=>{const{todos:t}=Qt(),r=t.filter(p=>p.type==="project"),l=r.filter(p=>p.project==="longterm").length,c=r.filter(p=>p.project==="shortterm").length,u=t.length-r.length,h=t.length,g=({size:p=100})=>{if(h===0)return null;const x=p/2-10,b=2*Math.PI*x,w=l/h*100,L=c/h*100,T=u/h*100;return i.jsxs("div",{className:"relative flex items-center justify-center",style:{width:p,height:p},children:[i.jsxs("svg",{className:"transform -rotate-90 w-full h-full",children:[i.jsx("circle",{className:"text-gray-100 dark:text-gray-700",strokeWidth:"8",stroke:"currentColor",fill:"transparent",r:x,cx:p/2,cy:p/2}),l>0&&i.jsx("circle",{className:"text-purple-500 transition-all duration-1000 ease-out",strokeWidth:"8",strokeDasharray:b,strokeDashoffset:b-w/100*b,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:x,cx:p/2,cy:p/2}),c>0&&i.jsx("circle",{className:"text-green-500 transition-all duration-1000 ease-out",strokeWidth:"8",strokeDasharray:b,strokeDashoffset:b-L/100*b,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:x,cx:p/2,cy:p/2,style:{transform:`rotate(${w/100*360}deg)`,transformOrigin:"center"}}),u>0&&i.jsx("circle",{className:"text-orange-500 transition-all duration-1000 ease-out",strokeWidth:"8",strokeDasharray:b,strokeDashoffset:b-T/100*b,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:x,cx:p/2,cy:p/2,style:{transform:`rotate(${(w+L)/100*360}deg)`,transformOrigin:"center"}})]}),i.jsxs("div",{className:"absolute flex flex-col items-center",children:[i.jsx("span",{className:"text-xl lg:text-3xl font-bold text-gray-800 dark:text-white",children:h}),i.jsx("span",{className:"text-[10px] lg:text-xs text-gray-500",children:"Total"})]})]})},m=[{label:" ",value:r.length,icon:i.jsx(Nw,{className:"w-5 h-5"}),color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-50 dark:bg-blue-900/20",borderColor:"border-blue-100 dark:border-blue-800"},{label:" ",value:l,icon:i.jsx(Tw,{className:"w-5 h-5"}),color:"text-purple-600 dark:text-purple-400",bgColor:"bg-purple-50 dark:bg-purple-900/20",borderColor:"border-purple-100 dark:border-purple-800"},{label:" ",value:c,icon:i.jsx(Sw,{className:"w-5 h-5"}),color:"text-green-600 dark:text-green-400",bgColor:"bg-green-50 dark:bg-green-900/20",borderColor:"border-green-100 dark:border-green-800"},{label:" ",value:u,icon:i.jsx(jw,{className:"w-5 h-5"}),color:"text-orange-600 dark:text-orange-400",bgColor:"bg-orange-50 dark:bg-orange-900/20",borderColor:"border-orange-100 dark:border-orange-800"}];return s==="compact"?i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("div",{className:"text-center min-w-[28px]",children:[i.jsx("p",{className:"text-blue-600 text-xs font-bold leading-none",children:r.length}),i.jsx("p",{className:"text-[9px] text-gray-500 dark:text-gray-400 leading-none mt-0.5",children:""})]}),i.jsxs("div",{className:"text-center min-w-[28px]",children:[i.jsx("p",{className:"text-orange-600 text-xs font-bold leading-none",children:u}),i.jsx("p",{className:"text-[9px] text-gray-500 dark:text-gray-400 leading-none mt-0.5",children:""})]}),i.jsxs("div",{className:"text-center min-w-[28px]",children:[i.jsx("p",{className:"text-purple-600 text-xs font-bold leading-none",children:l}),i.jsx("p",{className:"text-[9px] text-gray-500 dark:text-gray-400 leading-none mt-0.5",children:""})]}),i.jsxs("div",{className:"text-center min-w-[28px]",children:[i.jsx("p",{className:"text-green-600 text-xs font-bold leading-none",children:c}),i.jsx("p",{className:"text-[9px] text-gray-500 dark:text-gray-400 leading-none mt-0.5",children:""})]})]}):i.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 lg:p-8 border border-gray-100 dark:border-gray-700 shadow-sm",children:[i.jsx("div",{className:"flex items-center justify-between mb-8",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:i.jsx(Kp,{className:"w-6 h-6 text-gray-600 dark:text-gray-300"})}),i.jsx("h3",{className:"text-lg lg:text-xl font-bold text-gray-900 dark:text-white",children:" "})]})}),i.jsxs("div",{className:"flex flex-col lg:flex-row items-center gap-10 lg:gap-16",children:[i.jsxs("div",{className:"flex-shrink-0 relative",children:[i.jsx(g,{size:180}),i.jsx("div",{className:"absolute -bottom-8 left-1/2 transform -translate-x-1/2 text-sm font-medium text-gray-500 whitespace-nowrap",children:"  "})]}),i.jsx("div",{className:"flex-1 w-full grid grid-cols-2 gap-4 lg:gap-6",children:m.map((p,x)=>i.jsxs("div",{className:`${p.bgColor} ${p.borderColor} rounded-xl p-4 lg:p-5 border transition-all duration-300 hover:shadow-md hover:-translate-y-1`,children:[i.jsx("div",{className:"flex items-center justify-between mb-3",children:i.jsx("div",{className:`p-2.5 rounded-xl bg-white dark:bg-gray-800 ${p.color} shadow-sm`,children:p.icon})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:p.label}),i.jsx("p",{className:`text-2xl lg:text-3xl font-bold ${p.color}`,children:p.value})]})]},x))})]})]})},BS=({isOpen:s,onClose:t})=>{const{addRecurringTemplate:r,recurringTemplates:l}=Qt(),[c,u]=I.useState({title:"",description:"",priority:"medium",type:"simple",recurrenceType:"daily",weekday:1,monthlyDate:1,monthlyPattern:"date",monthlyWeek:"first",monthlyWeekday:3,tags:[],exceptions:[],holidayHandling:"show"}),[h,g]=I.useState(!1),m=()=>{u(k=>({...k,exceptions:[...k.exceptions,{type:"date",values:[]}]}))},p=k=>{u(S=>({...S,exceptions:S.exceptions.filter((R,D)=>D!==k)}))},x=(k,S,R)=>{u(D=>({...D,exceptions:D.exceptions.map((_,$)=>$===k?{..._,[S]:R}:_)}))},b=(k,S)=>{u(R=>({...R,exceptions:R.exceptions.map((D,_)=>_===k?{...D,values:S}:D)}))},w=k=>{const R=c.exceptions[k].values||[],D={targetTemplateTitle:"",scope:"same_week"};b(k,[...R,D])},L=(k,S)=>{const D=c.exceptions[k].values||[];b(k,D.filter((_,$)=>$!==S))},T=(k,S,R,D)=>{const C=(c.exceptions[k].values||[]).map((ee,ie)=>ie===S?{...ee,[R]:D}:ee);b(k,C)},U=[{value:0,label:""},{value:1,label:""},{value:2,label:""},{value:3,label:""},{value:4,label:""},{value:5,label:""},{value:6,label:""}],Y=async k=>{if(k.preventDefault(),!!c.title.trim()){g(!0);try{const S={title:c.title.trim(),description:c.description.trim()||void 0,priority:c.priority,type:c.type,recurrenceType:c.recurrenceType,isActive:!0,tags:c.tags,exceptions:c.exceptions,holidayHandling:c.holidayHandling};c.recurrenceType==="weekly"?S.weekday=c.weekday:c.recurrenceType==="monthly"&&(c.monthlyPattern==="weekday"?(S.monthlyPattern="weekday",S.monthlyWeek=c.monthlyWeek,S.monthlyWeekday=c.monthlyWeekday):(S.monthlyPattern="date",S.monthlyDate=c.monthlyDate)),await r(S),t(),u({title:"",description:"",priority:"medium",type:"simple",recurrenceType:"daily",weekday:1,monthlyDate:1,monthlyPattern:"date",monthlyWeek:"first",monthlyWeekday:3,tags:[],exceptions:[],holidayHandling:"show"})}catch(S){console.error("   :",S),alert("   .")}finally{g(!1)}}};return s?i.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[i.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm transition-opacity",onClick:t}),i.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:i.jsxs("form",{onSubmit:Y,className:"relative w-full max-w-2xl bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 transform transition-all",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"  "}),i.jsx("button",{type:"button",onClick:t,className:"p-2 text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 transition-colors",children:i.jsx(jt,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),i.jsx("input",{type:"text",value:c.title,onChange:k=>u({...c,title:k.target.value}),placeholder:"   ",className:"w-full text-lg px-4 py-3 bg-gray-50 dark:bg-gray-700/50 border-0 rounded-xl focus:ring-2 focus:ring-blue-500 placeholder-gray-400 dark:text-white",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" ()"}),i.jsx("textarea",{value:c.description,onChange:k=>u({...c,description:k.target.value}),placeholder:" ",className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-700/50 border-0 rounded-xl focus:ring-2 focus:ring-blue-500 placeholder-gray-400 dark:text-white resize-none",rows:2})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[i.jsx(Vl,{className:"w-4 h-4 inline mr-1"}),""]}),i.jsx("div",{className:"flex gap-2",children:[{value:"urgent",label:"",color:"text-red-700 bg-red-100 dark:bg-red-900/40 border-red-200 dark:border-red-800"},{value:"high",label:"",color:"text-orange-700 bg-orange-100 dark:bg-orange-900/40 border-orange-200 dark:border-orange-800"},{value:"medium",label:"",color:"text-yellow-700 bg-yellow-100 dark:bg-yellow-900/40 border-yellow-200 dark:border-yellow-800"},{value:"low",label:"",color:"text-green-700 bg-green-100 dark:bg-green-900/40 border-green-200 dark:border-green-800"}].map(k=>i.jsxs("label",{className:`flex-1 flex items-center justify-center p-2 rounded-lg cursor-pointer transition-all border ${c.priority===k.value?`ring-2 ring-offset-1 ring-blue-500 ${k.color} font-bold`:"bg-gray-50 dark:bg-gray-700/50 text-gray-600 dark:text-gray-400 border-transparent hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[i.jsx("input",{type:"radio",name:"priority",value:k.value,checked:c.priority===k.value,onChange:S=>u({...c,priority:S.target.value}),className:"sr-only"}),i.jsx("span",{className:"text-sm",children:k.label})]},k.value))})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[i.jsx(sh,{className:"w-4 h-4 inline mr-1"})," "]}),i.jsxs("select",{value:c.recurrenceType,onChange:k=>u({...c,recurrenceType:k.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[i.jsx("option",{value:"daily",children:""}),i.jsx("option",{value:"weekly",children:""}),i.jsx("option",{value:"monthly",children:""})]})]}),c.recurrenceType==="weekly"&&i.jsxs("div",{className:"animate-fadeIn",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),i.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:U.map(k=>i.jsx("button",{type:"button",onClick:()=>u({...c,weekday:k.value}),className:`flex-1 min-w-[60px] py-2 rounded-lg text-sm font-medium transition-colors ${c.weekday===k.value?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300 ring-2 ring-blue-500":"bg-gray-50 dark:bg-gray-700/50 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:k.label},k.value))})]}),c.recurrenceType==="monthly"&&i.jsxs("div",{className:"space-y-4 animate-fadeIn",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("label",{className:"flex items-center p-3 rounded-lg border border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors flex-1",children:[i.jsx("input",{type:"radio",checked:c.monthlyPattern==="date",onChange:()=>u({...c,monthlyPattern:"date"}),className:"mr-3 w-4 h-4 text-blue-600"}),i.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"  (: 15)"})]}),i.jsxs("label",{className:"flex items-center p-3 rounded-lg border border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors flex-1",children:[i.jsx("input",{type:"radio",checked:c.monthlyPattern==="weekday",onChange:()=>u({...c,monthlyPattern:"weekday"}),className:"mr-3 w-4 h-4 text-blue-600"}),i.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"  (:  )"})]})]})]}),c.monthlyPattern==="date"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),i.jsxs("select",{value:c.monthlyDate,onChange:k=>u({...c,monthlyDate:parseInt(k.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[Array.from({length:31},(k,S)=>S+1).map(k=>i.jsxs("option",{value:k,children:[k,""]},k)),i.jsx("option",{value:-1,children:""}),i.jsx("option",{value:-2,children:"  "}),i.jsx("option",{value:-3,children:" "})]})]}),c.monthlyPattern==="weekday"&&i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),i.jsxs("select",{value:c.monthlyWeek,onChange:k=>u({...c,monthlyWeek:k.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[i.jsx("option",{value:"first",children:"  "}),i.jsx("option",{value:"second",children:"  "}),i.jsx("option",{value:"third",children:"  "}),i.jsx("option",{value:"fourth",children:"  "}),i.jsx("option",{value:"last",children:" "})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),i.jsx("select",{value:c.monthlyWeekday,onChange:k=>u({...c,monthlyWeekday:parseInt(k.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:U.map(k=>i.jsx("option",{value:k.value,children:k.label},k.value))})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),i.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{value:"before",label:" "},{value:"after",label:" "},{value:"show",label:" "}].map(k=>i.jsxs("label",{className:`flex items-center justify-center p-2 rounded-lg cursor-pointer border transition-all ${c.holidayHandling===k.value?"bg-blue-50 border-blue-200 text-blue-700 dark:bg-blue-900/30 dark:border-blue-800 dark:text-blue-300":"bg-white border-gray-200 text-gray-600 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:[i.jsx("input",{type:"radio",name:"holidayHandling",value:k.value,checked:c.holidayHandling===k.value,onChange:S=>u({...c,holidayHandling:S.target.value}),className:"sr-only"}),i.jsx("span",{className:"text-sm",children:k.label})]},k.value))})]}),i.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-100 dark:border-gray-700",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[i.jsx(rh,{className:"w-4 h-4 inline mr-1"}),"  ( )"]}),i.jsxs("button",{type:"button",onClick:m,className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium bg-blue-50 text-blue-600 dark:bg-blue-900/20 dark:text-blue-300 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors",children:[i.jsx(Bt,{className:"w-3 h-3"})," "]})]}),c.exceptions.map((k,S)=>i.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/30 rounded-xl space-y-3 border border-gray-100 dark:border-gray-700",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("select",{value:k.type,onChange:R=>x(S,"type",R.target.value),className:"flex-1 px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white mr-2",children:[i.jsx("option",{value:"date",children:"  "}),i.jsx("option",{value:"weekday",children:"  "}),i.jsx("option",{value:"week",children:"  "}),i.jsx("option",{value:"month",children:"  "}),i.jsx("option",{value:"conflict",children:"  "})]}),i.jsx("button",{type:"button",onClick:()=>p(S),className:"p-1.5 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:i.jsx(an,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-6 gap-2",children:[k.type==="date"&&Array.from({length:31},(R,D)=>D+1).map(R=>i.jsxs("label",{className:"flex items-center space-x-2 p-1 hover:bg-white dark:hover:bg-gray-600 rounded cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:k.values.includes(R),onChange:D=>{const _=k.values,$=D.target.checked?[..._,R]:_.filter(C=>C!==R);b(S,$)},className:"rounded text-blue-600 focus:ring-blue-500"}),i.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:[R,""]})]},R)),k.type==="weekday"&&U.map(R=>i.jsxs("label",{className:"flex items-center space-x-2 p-1 hover:bg-white dark:hover:bg-gray-600 rounded cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:k.values.includes(R.value),onChange:D=>{const _=k.values,$=D.target.checked?[..._,R.value]:_.filter(C=>C!==R.value);b(S,$)},className:"rounded text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:R.label})]},R.value)),k.type==="week"&&[1,2,3,4,-1].map(R=>i.jsxs("label",{className:"flex items-center space-x-2 p-1 hover:bg-white dark:hover:bg-gray-600 rounded cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:k.values.includes(R),onChange:D=>{const _=k.values,$=D.target.checked?[..._,R]:_.filter(C=>C!==R);b(S,$)},className:"rounded text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:Wo(R)})]},R)),k.type==="month"&&Array.from({length:12},(R,D)=>D+1).map(R=>i.jsxs("label",{className:"flex items-center space-x-2 p-1 hover:bg-white dark:hover:bg-gray-600 rounded cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:k.values.includes(R),onChange:D=>{const _=k.values,$=D.target.checked?[..._,R]:_.filter(C=>C!==R);b(S,$)},className:"rounded text-blue-600 focus:ring-blue-500"}),i.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:[R,""]})]},R))]}),k.type==="conflict"&&i.jsxs("div",{className:"space-y-3",children:[(k.values||[]).map((R,D)=>i.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-700",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("span",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:["   ",D+1]}),i.jsx("button",{type:"button",onClick:()=>L(S,D),className:"text-red-500 hover:text-red-700 p-1",children:i.jsx(jt,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-blue-800 dark:text-blue-200 mb-1",children:" "}),i.jsxs("select",{value:R.targetTemplateTitle,onChange:_=>T(S,D,"targetTemplateTitle",_.target.value),className:"w-full px-2 py-1 text-sm border border-blue-300 dark:border-blue-600 rounded focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 dark:text-white",children:[i.jsx("option",{value:"",children:" "}),l.map(_=>i.jsx("option",{value:_.title,children:_.title},_.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-blue-800 dark:text-blue-200 mb-1",children:" "}),i.jsxs("select",{value:R.scope,onChange:_=>T(S,D,"scope",_.target.value),className:"w-full px-2 py-1 text-sm border border-blue-300 dark:border-blue-600 rounded focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 dark:text-white",children:[i.jsx("option",{value:"same_date",children:"  "}),i.jsx("option",{value:"same_week",children:"  "}),i.jsx("option",{value:"same_month",children:"  "})]})]})]})]},D)),i.jsxs("button",{type:"button",onClick:()=>w(S),className:"w-full py-2 px-3 text-sm border-2 border-dashed border-blue-300 dark:border-blue-600 text-blue-600 dark:text-blue-400 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/30 flex items-center justify-center gap-2",children:[i.jsx(Bt,{className:"w-4 h-4"}),"  "]})]})]},S))]})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200 dark:border-gray-700",children:[i.jsx("button",{type:"button",onClick:t,className:"px-5 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors",disabled:h,children:""}),i.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:shadow-lg hover:shadow-blue-500/30 transition-all duration-300 transform hover:-translate-y-0.5 font-medium disabled:opacity-50 disabled:cursor-not-allowed",disabled:h||!c.title.trim(),children:[i.jsx(Bt,{className:"w-4 h-4"}),h?" ...":""]})]})]})})]}):null},qS=()=>{const{recurringTemplates:s,recurringInstances:t,updateRecurringTemplate:r,deleteRecurringTemplate:l,cleanupDuplicateTemplates:c}=Qt(),[u,h]=I.useState("templates"),[g,m]=I.useState(!1),[p,x]=I.useState(!1),[b,w]=I.useState(null),[L,T]=I.useState({excludeWeeks:[],excludeDates:[]});I.useEffect(()=>{try{const C=localStorage.getItem("globalRecurringExceptions");C&&T(JSON.parse(C))}catch(C){console.error("   :",C)}},[]);const U=C=>{try{localStorage.setItem("globalRecurringExceptions",JSON.stringify(C)),T(C)}catch(ee){console.error("   :",ee)}},Y=C=>{const ee={...L},ie=ee.excludeWeeks.indexOf(C);ie===-1?ee.excludeWeeks.push(C):ee.excludeWeeks.splice(ie,1),U(ee)},k=s.filter(C=>C.isActive),S=s.filter(C=>!C.isActive),R=async C=>{const ee=s.find(ie=>ie.id===C);ee&&await r(C,{isActive:!ee.isActive})},D=async C=>{confirm("   ?")&&await l(C)},_=C=>{w(C),x(!0)},$=C=>{if(C.recurrenceType==="weekly")return` ${["","","","","","",""][C.weekday||0]}`;if(C.recurrenceType==="monthly")if(C.monthlyPattern==="weekday"&&C.monthlyWeek&&C.monthlyWeekday!==void 0){const ee=["","","","","","",""];return` ${{first:" ",second:" ",third:" ",fourth:" ",last:""}[C.monthlyWeek]}  ${ee[C.monthlyWeekday]}`}else return C.monthlyDate===-1?" ":C.monthlyDate===-2?"   ":C.monthlyDate===-3?"  ":` ${C.monthlyDate}`;return""};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:" "}),i.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:shadow-lg hover:shadow-blue-500/30 transition-all duration-300 transform hover:-translate-y-0.5 font-medium",children:[i.jsx(Bt,{className:"w-4 h-4"}),"  "]})]}),i.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:i.jsxs("nav",{className:"flex justify-between",children:[i.jsx("button",{onClick:()=>h("templates"),className:`py-4 px-1 border-b-2 font-medium text-sm ${u==="templates"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400"}`,children:" "}),i.jsxs("div",{className:"flex space-x-4",children:[i.jsx("button",{onClick:()=>h("exceptions"),className:`py-4 px-1 border-b-2 font-medium text-sm ${u==="exceptions"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400"}`,children:" "}),i.jsx("button",{onClick:()=>h("holidays"),className:`py-4 px-1 border-b-2 font-medium text-sm ${u==="holidays"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400"}`,children:" "})]})]})}),u==="templates"&&i.jsxs("div",{className:"space-y-6",children:[k.length>0&&i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[i.jsx(zu,{className:"w-5 h-5 text-green-600"}),"   (",k.length,")"]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map(C=>i.jsx("div",{className:"card p-3 bg-green-50 dark:bg-green-900/10 border-green-200 dark:border-green-800",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-1 truncate",children:C.title}),i.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300 whitespace-nowrap overflow-hidden text-ellipsis",children:$(C)})]}),i.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[i.jsx("span",{className:`px-2 py-1 rounded text-xs ${C.priority==="urgent"?"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300":C.priority==="high"?"bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-300":C.priority==="medium"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300":"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}`,children:C.priority==="urgent"?"":C.priority==="high"?"":C.priority==="medium"?"":""}),i.jsx("button",{onClick:()=>_(C),className:"p-1 hover:bg-blue-100 dark:hover:bg-blue-800 rounded",title:"",children:i.jsx(No,{className:"w-4 h-4 text-blue-600"})}),i.jsx("button",{onClick:()=>R(C.id),className:"p-1 hover:bg-green-100 dark:hover:bg-green-800 rounded",title:"",children:i.jsx(Um,{className:"w-4 h-4 text-green-600"})}),i.jsx("button",{onClick:()=>D(C.id),className:"p-1 hover:bg-red-100 dark:hover:bg-red-800 rounded",title:"",children:i.jsx(an,{className:"w-4 h-4 text-red-600"})})]})]})},C.id))})]}),S.length>0&&i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[i.jsx(Um,{className:"w-5 h-5 text-gray-500"}),"   (",S.length,")"]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:S.map(C=>i.jsx("div",{className:"card p-3 bg-gray-50 dark:bg-gray-800 opacity-75",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h4",{className:"font-medium text-gray-600 dark:text-gray-300 mb-1 truncate",children:C.title}),i.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap overflow-hidden text-ellipsis",children:$(C)})]}),i.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[i.jsx("button",{onClick:()=>R(C.id),className:"p-1 hover:bg-green-100 dark:hover:bg-green-800 rounded",title:"",children:i.jsx(zu,{className:"w-4 h-4 text-green-600"})}),i.jsx("button",{onClick:()=>D(C.id),className:"p-1 hover:bg-red-100 dark:hover:bg-red-800 rounded",title:"",children:i.jsx(an,{className:"w-4 h-4 text-red-600"})})]})]})},C.id))})]}),s.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(mt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"  "}),i.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"      ."}),i.jsx("button",{onClick:()=>m(!0),className:"btn-primary",children:"   "})]})]}),u==="exceptions"&&i.jsx("div",{className:"space-y-6",children:i.jsxs("div",{className:"card p-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"    "}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-md font-medium text-gray-800 dark:text-gray-200 mb-3",children:"  "}),i.jsxs("div",{className:"flex gap-1 justify-between overflow-hidden",children:[i.jsx("div",{className:"text-center px-1 py-1 bg-blue-50 dark:bg-blue-900/30 rounded flex-1 min-w-0",children:i.jsx("div",{className:"font-medium text-blue-700 dark:text-blue-300 whitespace-nowrap overflow-hidden text-ellipsis",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""})}),i.jsx("div",{className:"text-center px-1 py-1 bg-green-50 dark:bg-green-900/30 rounded flex-1 min-w-0",children:i.jsx("div",{className:"font-medium text-green-700 dark:text-green-300 whitespace-nowrap overflow-hidden text-ellipsis",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""})}),i.jsx("div",{className:"text-center px-1 py-1 bg-yellow-50 dark:bg-yellow-900/30 rounded flex-1 min-w-0",children:i.jsx("div",{className:"font-medium text-yellow-700 dark:text-yellow-300 whitespace-nowrap overflow-hidden text-ellipsis",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""})}),i.jsx("div",{className:"text-center px-1 py-1 bg-purple-50 dark:bg-purple-900/30 rounded flex-1 min-w-0",children:i.jsx("div",{className:"font-medium text-purple-700 dark:text-purple-300 whitespace-nowrap overflow-hidden text-ellipsis",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""})}),i.jsx("div",{className:"text-center px-1 py-1 bg-red-50 dark:bg-red-900/30 rounded flex-1 min-w-0",children:i.jsx("div",{className:"font-medium text-red-700 dark:text-red-300 whitespace-nowrap overflow-hidden text-ellipsis",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""})})]}),i.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-3",children:"*      . (4   4, 5   5)"})]}),i.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[i.jsx("h4",{className:"text-md font-medium text-gray-800 dark:text-gray-200 mb-3",children:"   "}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex gap-1 justify-between overflow-hidden",children:[i.jsxs("label",{className:"flex flex-col items-center space-y-1 px-1 py-1 bg-blue-50 dark:bg-blue-900/30 rounded cursor-pointer flex-1 min-w-0",children:[i.jsx("span",{className:"text-blue-700 dark:text-blue-300 whitespace-nowrap overflow-hidden text-ellipsis font-medium",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""}),i.jsx("input",{type:"checkbox",className:"rounded w-3 h-3",checked:L.excludeWeeks.includes(1),onChange:()=>Y(1)})]}),i.jsxs("label",{className:"flex flex-col items-center space-y-1 px-1 py-1 bg-green-50 dark:bg-green-900/30 rounded cursor-pointer flex-1 min-w-0",children:[i.jsx("span",{className:"text-green-700 dark:text-green-300 whitespace-nowrap overflow-hidden text-ellipsis font-medium",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""}),i.jsx("input",{type:"checkbox",className:"rounded w-3 h-3",checked:L.excludeWeeks.includes(2),onChange:()=>Y(2)})]}),i.jsxs("label",{className:"flex flex-col items-center space-y-1 px-1 py-1 bg-yellow-50 dark:bg-yellow-900/30 rounded cursor-pointer flex-1 min-w-0",children:[i.jsx("span",{className:"text-yellow-700 dark:text-yellow-300 whitespace-nowrap overflow-hidden text-ellipsis font-medium",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""}),i.jsx("input",{type:"checkbox",className:"rounded w-3 h-3",checked:L.excludeWeeks.includes(3),onChange:()=>Y(3)})]}),i.jsxs("label",{className:"flex flex-col items-center space-y-1 px-1 py-1 bg-purple-50 dark:bg-purple-900/30 rounded cursor-pointer flex-1 min-w-0",children:[i.jsx("span",{className:"text-purple-700 dark:text-purple-300 whitespace-nowrap overflow-hidden text-ellipsis font-medium",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""}),i.jsx("input",{type:"checkbox",className:"rounded w-3 h-3",checked:L.excludeWeeks.includes(4),onChange:()=>Y(4)})]}),i.jsxs("label",{className:"flex flex-col items-center space-y-1 px-1 py-1 bg-red-50 dark:bg-red-900/30 rounded cursor-pointer flex-1 min-w-0",children:[i.jsx("span",{className:"text-red-700 dark:text-red-300 whitespace-nowrap overflow-hidden text-ellipsis font-medium",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""}),i.jsx("input",{type:"checkbox",className:"rounded w-3 h-3",checked:L.excludeWeeks.includes(5),onChange:()=>Y(5)})]})]}),i.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"     .      ."}),L.excludeWeeks.length>0&&i.jsxs("div",{className:"mt-3 p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg",children:[i.jsxs("p",{className:"text-sm text-orange-700 dark:text-orange-300 font-medium",children:["  : ",L.excludeWeeks.map(C=>Wo(C)).join(", ")]}),i.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400 mt-1",children:"      ."})]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h4",{className:"text-md font-medium text-gray-800 dark:text-gray-200",children:"   "}),i.jsx("button",{className:"btn-secondary px-2 py-1 whitespace-nowrap",style:{fontSize:"clamp(10px, 2vw, 14px)"},children:"  "})]}),i.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-2 rounded-lg",children:i.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"         ."})})]})]})]})]})}),u==="holidays"&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Dw,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"  "}),i.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"      ."}),i.jsxs("div",{className:"card p-6 max-w-md mx-auto",children:[i.jsx("h4",{className:"font-medium mb-3",children:" "}),i.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-300 text-left space-y-2",children:[i.jsx("li",{children:"   "}),i.jsx("li",{children:"    "}),i.jsx("li",{children:"   "}),i.jsx("li",{children:"  "})]})]})]}),i.jsx("div",{className:"card p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-1",children:" "}),i.jsx("p",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:s.length})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-1",children:""}),i.jsx("p",{className:"text-xl font-bold text-green-600 dark:text-green-400",children:k.length})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-1",children:" "}),i.jsx("p",{className:"text-xl font-bold text-purple-600 dark:text-purple-400",children:t.filter(C=>{const ee=new Date().toDateString();return new Date(C.date).toDateString()===ee}).length})]})]})}),i.jsx(BS,{isOpen:g,onClose:()=>m(!1)}),p&&b&&i.jsx(FS,{template:b,onClose:()=>{x(!1),w(null)},onSave:async C=>{await r(b.id,C),x(!1),w(null)}})]})},FS=({template:s,onClose:t,onSave:r})=>{const{recurringTemplates:l}=Qt(),[c,u]=I.useState({title:s.title,description:s.description||"",priority:s.priority,type:s.type,recurrenceType:s.recurrenceType,weekday:s.weekday||0,monthlyDate:s.monthlyDate||1,monthlyPattern:s.monthlyPattern||"date",monthlyWeek:s.monthlyWeek||"first",monthlyWeekday:s.monthlyWeekday||3,tags:s.tags||[],exceptions:s.exceptions||[],holidayHandling:s.holidayHandling||"show"}),[h,g]=I.useState(!1);I.useEffect(()=>{u({title:s.title,description:s.description||"",priority:s.priority,type:s.type,recurrenceType:s.recurrenceType,weekday:s.weekday||0,monthlyDate:s.monthlyDate||1,monthlyPattern:s.monthlyPattern||"date",monthlyWeek:s.monthlyWeek||"first",monthlyWeekday:s.monthlyWeekday||3,tags:s.tags||[],exceptions:s.exceptions||[],holidayHandling:s.holidayHandling||"show"})},[s]);const m=()=>{u(k=>({...k,exceptions:[...k.exceptions,{type:"date",values:[]}]}))},p=k=>{u(S=>({...S,exceptions:S.exceptions.filter((R,D)=>D!==k)}))},x=(k,S,R)=>{u(D=>({...D,exceptions:D.exceptions.map((_,$)=>$===k?{..._,[S]:R}:_)}))},b=(k,S)=>{u(R=>({...R,exceptions:R.exceptions.map((D,_)=>_===k?{...D,values:S}:D)}))},w=k=>{const R=c.exceptions[k].values||[],D={targetTemplateTitle:"",scope:"same_week"};b(k,[...R,D])},L=(k,S)=>{const D=c.exceptions[k].values||[];b(k,D.filter((_,$)=>$!==S))},T=(k,S,R,D)=>{const C=(c.exceptions[k].values||[]).map((ee,ie)=>ie===S?{...ee,[R]:D}:ee);b(k,C)},U=[{value:0,label:""},{value:1,label:""},{value:2,label:""},{value:3,label:""},{value:4,label:""},{value:5,label:""},{value:6,label:""}],Y=async k=>{k.preventDefault(),g(!0);try{const S={title:c.title.trim(),description:c.description.trim()||void 0,priority:c.priority,type:c.type,recurrenceType:c.recurrenceType,tags:c.tags,exceptions:c.exceptions,holidayHandling:c.holidayHandling,updatedAt:new Date};c.recurrenceType==="weekly"?S.weekday=c.weekday:c.recurrenceType==="monthly"&&(c.monthlyPattern==="weekday"?(S.monthlyPattern="weekday",S.monthlyWeek=c.monthlyWeek,S.monthlyWeekday=c.monthlyWeekday):(S.monthlyPattern="date",S.monthlyDate=c.monthlyDate)),await r(S),t()}catch(S){console.error("  :",S),alert("  .")}finally{g(!1)}};return i.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[i.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm transition-opacity",onClick:t}),i.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:i.jsxs("form",{onSubmit:Y,className:"relative w-full max-w-2xl bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 transform transition-all",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"  "}),i.jsx("button",{type:"button",onClick:t,className:"p-2 text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 transition-colors",children:i.jsx(jt,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),i.jsx("input",{type:"text",value:c.title,onChange:k=>u({...c,title:k.target.value}),className:"w-full text-lg px-4 py-3 bg-gray-50 dark:bg-gray-700/50 border-0 rounded-xl focus:ring-2 focus:ring-blue-500 placeholder-gray-400 dark:text-white",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),i.jsx("textarea",{value:c.description,onChange:k=>u({...c,description:k.target.value}),className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-700/50 border-0 rounded-xl focus:ring-2 focus:ring-blue-500 placeholder-gray-400 dark:text-white resize-none",rows:2})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[i.jsx(Vl,{className:"w-4 h-4 inline mr-1"}),""]}),i.jsx("div",{className:"flex gap-2",children:[{value:"urgent",label:"",color:"text-red-700 bg-red-100 dark:bg-red-900/40 border-red-200 dark:border-red-800"},{value:"high",label:"",color:"text-orange-700 bg-orange-100 dark:bg-orange-900/40 border-orange-200 dark:border-orange-800"},{value:"medium",label:"",color:"text-yellow-700 bg-yellow-100 dark:bg-yellow-900/40 border-yellow-200 dark:border-yellow-800"},{value:"low",label:"",color:"text-green-700 bg-green-100 dark:bg-green-900/40 border-green-200 dark:border-green-800"}].map(k=>i.jsxs("label",{className:`flex-1 flex items-center justify-center p-2 rounded-lg cursor-pointer transition-all border ${c.priority===k.value?`ring-2 ring-offset-1 ring-blue-500 ${k.color} font-bold`:"bg-gray-50 dark:bg-gray-700/50 text-gray-600 dark:text-gray-400 border-transparent hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[i.jsx("input",{type:"radio",name:"priority",value:k.value,checked:c.priority===k.value,onChange:S=>u({...c,priority:S.target.value}),className:"sr-only"}),i.jsx("span",{className:"text-sm",children:k.label})]},k.value))})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[i.jsx(sh,{className:"w-4 h-4 inline mr-1"})," "]}),i.jsxs("select",{value:c.recurrenceType,onChange:k=>u({...c,recurrenceType:k.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[i.jsx("option",{value:"daily",children:""}),i.jsx("option",{value:"weekly",children:""}),i.jsx("option",{value:"monthly",children:""})]})]}),c.recurrenceType==="weekly"&&i.jsxs("div",{className:"animate-fadeIn",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),i.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:U.map(k=>i.jsx("button",{type:"button",onClick:()=>u({...c,weekday:k.value}),className:`flex-1 min-w-[60px] py-2 rounded-lg text-sm font-medium transition-colors ${c.weekday===k.value?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300 ring-2 ring-blue-500":"bg-gray-50 dark:bg-gray-700/50 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:k.label},k.value))})]}),c.recurrenceType==="monthly"&&i.jsxs("div",{className:"space-y-4 animate-fadeIn",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("label",{className:"flex items-center p-3 rounded-lg border border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors flex-1",children:[i.jsx("input",{type:"radio",checked:c.monthlyPattern==="date",onChange:()=>u({...c,monthlyPattern:"date"}),className:"mr-3 w-4 h-4 text-blue-600"}),i.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"  (: 15)"})]}),i.jsxs("label",{className:"flex items-center p-3 rounded-lg border border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors flex-1",children:[i.jsx("input",{type:"radio",checked:c.monthlyPattern==="weekday",onChange:()=>u({...c,monthlyPattern:"weekday"}),className:"mr-3 w-4 h-4 text-blue-600"}),i.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"  (:  )"})]})]})]}),c.monthlyPattern==="date"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),i.jsxs("select",{value:c.monthlyDate,onChange:k=>u({...c,monthlyDate:parseInt(k.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[Array.from({length:31},(k,S)=>S+1).map(k=>i.jsxs("option",{value:k,children:[k,""]},k)),i.jsx("option",{value:-1,children:""}),i.jsx("option",{value:-2,children:"  "}),i.jsx("option",{value:-3,children:" "})]})]}),c.monthlyPattern==="weekday"&&i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),i.jsxs("select",{value:c.monthlyWeek,onChange:k=>u({...c,monthlyWeek:k.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[i.jsx("option",{value:"first",children:"  "}),i.jsx("option",{value:"second",children:"  "}),i.jsx("option",{value:"third",children:"  "}),i.jsx("option",{value:"fourth",children:"  "}),i.jsx("option",{value:"last",children:" "})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),i.jsx("select",{value:c.monthlyWeekday,onChange:k=>u({...c,monthlyWeekday:parseInt(k.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:U.map(k=>i.jsx("option",{value:k.value,children:k.label},k.value))})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),i.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{value:"before",label:" "},{value:"after",label:" "},{value:"show",label:" "}].map(k=>i.jsxs("label",{className:`flex items-center justify-center p-2 rounded-lg cursor-pointer border transition-all ${c.holidayHandling===k.value?"bg-blue-50 border-blue-200 text-blue-700 dark:bg-blue-900/30 dark:border-blue-800 dark:text-blue-300":"bg-white border-gray-200 text-gray-600 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:[i.jsx("input",{type:"radio",name:"holidayHandling",value:k.value,checked:c.holidayHandling===k.value,onChange:S=>u({...c,holidayHandling:S.target.value}),className:"sr-only"}),i.jsx("span",{className:"text-sm",children:k.label})]},k.value))})]}),i.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-100 dark:border-gray-700",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[i.jsx(rh,{className:"w-4 h-4 inline mr-1"}),"  ( )"]}),i.jsxs("button",{type:"button",onClick:m,className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium bg-blue-50 text-blue-600 dark:bg-blue-900/20 dark:text-blue-300 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors",children:[i.jsx(Bt,{className:"w-3 h-3"})," "]})]}),c.exceptions.map((k,S)=>i.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/30 rounded-xl space-y-3 border border-gray-100 dark:border-gray-700",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("select",{value:k.type,onChange:R=>x(S,"type",R.target.value),className:"flex-1 px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white mr-2",children:[i.jsx("option",{value:"date",children:"  "}),i.jsx("option",{value:"weekday",children:"  "}),i.jsx("option",{value:"week",children:"  "}),i.jsx("option",{value:"month",children:"  "}),i.jsx("option",{value:"conflict",children:"  "})]}),i.jsx("button",{type:"button",onClick:()=>p(S),className:"p-1.5 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:i.jsx(an,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-6 gap-2",children:[k.type==="date"&&Array.from({length:31},(R,D)=>D+1).map(R=>i.jsxs("label",{className:"flex items-center space-x-2 p-1 hover:bg-white dark:hover:bg-gray-600 rounded cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:k.values.includes(R),onChange:D=>{const _=k.values,$=D.target.checked?[..._,R]:_.filter(C=>C!==R);b(S,$)},className:"rounded text-blue-600 focus:ring-blue-500"}),i.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:[R,""]})]},R)),k.type==="weekday"&&U.map(R=>i.jsxs("label",{className:"flex items-center space-x-2 p-1 hover:bg-white dark:hover:bg-gray-600 rounded cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:k.values.includes(R.value),onChange:D=>{const _=k.values,$=D.target.checked?[..._,R.value]:_.filter(C=>C!==R.value);b(S,$)},className:"rounded text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:R.label})]},R.value)),k.type==="week"&&[1,2,3,4,-1].map(R=>i.jsxs("label",{className:"flex items-center space-x-2 p-1 hover:bg-white dark:hover:bg-gray-600 rounded cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:k.values.includes(R),onChange:D=>{const _=k.values,$=D.target.checked?[..._,R]:_.filter(C=>C!==R);b(S,$)},className:"rounded text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:Wo(R)})]},R)),k.type==="month"&&Array.from({length:12},(R,D)=>D+1).map(R=>i.jsxs("label",{className:"flex items-center space-x-2 p-1 hover:bg-white dark:hover:bg-gray-600 rounded cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:k.values.includes(R),onChange:D=>{const _=k.values,$=D.target.checked?[..._,R]:_.filter(C=>C!==R);b(S,$)},className:"rounded text-blue-600 focus:ring-blue-500"}),i.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:[R,""]})]},R))]}),k.type==="conflict"&&i.jsxs("div",{className:"space-y-3",children:[(k.values||[]).map((R,D)=>i.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-700",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("span",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:["   ",D+1]}),i.jsx("button",{type:"button",onClick:()=>L(S,D),className:"text-red-500 hover:text-red-700 p-1",children:i.jsx(jt,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-blue-800 dark:text-blue-200 mb-1",children:" "}),i.jsxs("select",{value:R.targetTemplateTitle,onChange:_=>T(S,D,"targetTemplateTitle",_.target.value),className:"w-full px-2 py-1 text-sm border border-blue-300 dark:border-blue-600 rounded focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 dark:text-white",children:[i.jsx("option",{value:"",children:" "}),l.map(_=>i.jsx("option",{value:_.title,children:_.title},_.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-blue-800 dark:text-blue-200 mb-1",children:" "}),i.jsxs("select",{value:R.scope,onChange:_=>T(S,D,"scope",_.target.value),className:"w-full px-2 py-1 text-sm border border-blue-300 dark:border-blue-600 rounded focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 dark:text-white",children:[i.jsx("option",{value:"same_date",children:"  "}),i.jsx("option",{value:"same_week",children:"  "}),i.jsx("option",{value:"same_month",children:"  "})]})]})]})]},D)),i.jsxs("button",{type:"button",onClick:()=>w(S),className:"w-full py-2 px-3 text-sm border-2 border-dashed border-blue-300 dark:border-blue-600 text-blue-600 dark:text-blue-400 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/30 flex items-center justify-center gap-2",children:[i.jsx(Bt,{className:"w-4 h-4"}),"  "]})]})]},S))]})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200 dark:border-gray-700",children:[i.jsx("button",{type:"button",onClick:t,className:"px-5 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors",disabled:h,children:""}),i.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:shadow-lg hover:shadow-blue-500/30 transition-all duration-300 transform hover:-translate-y-0.5 font-medium disabled:opacity-50 disabled:cursor-not-allowed",disabled:h,children:[i.jsx(gs,{className:"w-4 h-4"}),h?" ...":""]})]})]})})]})},GS=({searchTerm:s="",priorityFilter:t="all",typeFilter:r="all",projectFilter:l="all",tagFilter:c=[]})=>{const{todos:u,toggleTodo:h,getRecurringTodos:g}=Qt(),[m,p]=I.useState(new Set(["today"])),[x,b]=I.useState("period"),[w,L]=I.useState("yesterday"),T=g(),U=[...u,...T];console.log("   -  :",U.length),console.log("   -  :",u.length),console.log("   -  :",T.length);const Y=U.filter(M=>M.completed&&M.completedAt&&(s===""||M.title.toLowerCase().includes(s.toLowerCase())||M.description&&M.description.toLowerCase().includes(s.toLowerCase()))&&(t==="all"||M.priority===t)&&(r==="all"||M.type===r)&&(l==="all"||l==="longterm"&&M.project==="longterm"||l==="shortterm"&&M.project==="shortterm")&&(c.length===0||M.tags&&c.every(Z=>M.tags?.includes(Z)))),k=[];U.forEach(M=>{M.subTasks&&M.subTasks.length>0&&M.subTasks.filter(Z=>Z.completed&&Z.completedAt&&Z.completedAt!==null).forEach(Z=>{const E=s===""||Z.title.toLowerCase().includes(s.toLowerCase())||Z.description&&Z.description.toLowerCase().includes(s.toLowerCase()),O=t==="all"||Z.priority===t;E&&O&&k.push({...Z,type:"simple",recurrence:"none",isSubTask:!0,parentTitle:M.title,parentDescription:M.description,createdAt:Z.createdAt,updatedAt:Z.updatedAt})})});const S=[...Y,...k].sort((M,Z)=>{const E=pe=>{if(!pe)return 0;try{const W=new Date(pe).getTime();return isNaN(W)?0:W}catch{return 0}},O=E(M.completedAt);return E(Z.completedAt)-O});console.log("   -  :",S.length),console.log("   -   :",S.filter(M=>M._isRecurringInstance).length);const R=S.find(M=>M.title==="");R?console.log("   -  :",{title:R.title,completed:R.completed,completedAt:R.completedAt,_isRecurringInstance:R._isRecurringInstance}):(console.log("   -    "),console.log("   -   :",S.map(M=>M.title)));const D=()=>{const M=new Date,Z=new Date(M.getFullYear(),M.getMonth(),M.getDate()),E=new Date(Z);E.setDate(E.getDate()-1);const O=new Date(Z);O.setDate(Z.getDate()-Z.getDay());const Q=new Date(O);Q.setDate(O.getDate()-7),new Date(O).setDate(O.getDate()-1);const W=new Date(Z.getFullYear(),Z.getMonth(),1),de=new Date(Z.getFullYear(),Z.getMonth()-1,1);new Date(Z.getFullYear(),Z.getMonth(),0);const K={today:[],yesterday:[],thisWeek:[],lastWeek:[],thisMonth:[],lastMonth:[],older:[]};return S.forEach(ne=>{if(!ne.completedAt)return;const ce=new Date(ne.completedAt),Se=new Date(ce.getFullYear(),ce.getMonth(),ce.getDate());Se.getTime()===Z.getTime()?K.today.push(ne):Se.getTime()===E.getTime()?K.yesterday.push(ne):ce>=O&&Se<Z?K.thisWeek.push(ne):ce>=Q&&ce<O?K.lastWeek.push(ne):ce>=W&&ce<Q?K.thisMonth.push(ne):ce>=de&&ce<W?K.lastMonth.push(ne):ce<de&&K.older.push(ne)}),Object.values(K).forEach(ne=>{ne.sort((ce,Se)=>!ce.completedAt||!Se.completedAt?0:new Date(Se.completedAt).getTime()-new Date(ce.completedAt).getTime())}),K},_=()=>{const M={};S.forEach(E=>{if(!E.completedAt)return;const Q=new Date(E.completedAt).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",weekday:"short"});M[Q]||(M[Q]=[]),M[Q].push(E)}),Object.values(M).forEach(E=>{E.sort((O,Q)=>!O.completedAt||!Q.completedAt?0:new Date(Q.completedAt).getTime()-new Date(O.completedAt).getTime())});const Z=Object.keys(M).sort((E,O)=>{const Q=new Date(M[E][0].completedAt);return new Date(M[O][0].completedAt).getTime()-Q.getTime()});return{groupedByDay:M,sortedKeys:Z}},$=()=>{const M={};S.forEach(E=>{if(!E.completedAt)return;const O=new Date(E.completedAt),Q=new Date(O);Q.setDate(O.getDate()-O.getDay()),Q.setHours(0,0,0,0);const pe=new Date(Q);pe.setDate(Q.getDate()+6);const W=`${Q.toLocaleDateString("ko-KR",{month:"2-digit",day:"2-digit"})} ~ ${pe.toLocaleDateString("ko-KR",{month:"2-digit",day:"2-digit"})}`;M[W]||(M[W]=[]),M[W].push(E)}),Object.values(M).forEach(E=>{E.sort((O,Q)=>!O.completedAt||!Q.completedAt?0:new Date(Q.completedAt).getTime()-new Date(O.completedAt).getTime())});const Z=Object.keys(M).sort((E,O)=>{const Q=new Date(M[E][0].completedAt);return new Date(M[O][0].completedAt).getTime()-Q.getTime()});return{groupedByWeek:M,sortedKeys:Z}},C=()=>{const M={};S.forEach(E=>{if(!E.completedAt)return;const Q=new Date(E.completedAt).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit"});M[Q]||(M[Q]=[]),M[Q].push(E)}),Object.values(M).forEach(E=>{E.sort((O,Q)=>!O.completedAt||!Q.completedAt?0:new Date(Q.completedAt).getTime()-new Date(O.completedAt).getTime())});const Z=Object.keys(M).sort((E,O)=>{const Q=new Date(M[E][0].completedAt);return new Date(M[O][0].completedAt).getTime()-Q.getTime()});return{groupedByMonth:M,sortedKeys:Z}},ee=M=>{const Z=new Set(m);Z.has(M)?Z.delete(M):Z.add(M),p(Z)},ie=()=>{L(M=>{switch(M){case"yesterday":return"lastWeek";case"lastWeek":return"lastMonth";case"lastMonth":return"yesterday";default:return"yesterday"}})},xe=M=>{const Z={low:"text-gray-500 bg-gray-100 dark:bg-gray-800",medium:"text-blue-700 bg-blue-100 dark:bg-blue-900/30",high:"text-orange-700 bg-orange-100 dark:bg-orange-900/30",urgent:"text-red-700 bg-red-100 dark:bg-red-900/30"},E=()=>{h(M.id)};return i.jsx("div",{className:"border-l-2 border-green-500 bg-green-50 dark:bg-green-900/10 p-2 sm:p-3 rounded-r-lg",children:i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[i.jsx(vu,{className:"w-3 h-3 text-green-600 flex-shrink-0"}),i.jsx("h3",{className:"text-xs sm:text-sm font-medium text-green-800 dark:text-green-300 line-through truncate",children:M.isSubTask?` ${M.title} (${M.parentTitle})`:M.title})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-1 mb-1",children:[M.isSubTask?M.parentDescription&&i.jsx("span",{className:"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 px-1 py-0.5 rounded text-xs",children:M.parentDescription}):M.description&&i.jsx("span",{className:"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 px-1 py-0.5 rounded text-xs",children:M.description}),i.jsxs("span",{className:`px-1 py-0.5 rounded text-xs ${Z[M.priority]}`,children:[M.priority==="low"&&"",M.priority==="medium"&&"",M.priority==="high"&&"",M.priority==="urgent"&&""]}),M.isSubTask&&i.jsx("span",{className:"bg-indigo-200 dark:bg-indigo-800 text-indigo-700 dark:text-indigo-300 px-1 py-0.5 rounded text-xs",children:""}),M._isRecurringInstance&&i.jsx("span",{className:"bg-purple-200 dark:bg-purple-800 text-purple-700 dark:text-purple-300 px-1 py-0.5 rounded text-xs",children:""}),M.type==="project"&&i.jsx("span",{className:"bg-green-200 dark:bg-green-800 text-green-700 dark:text-green-300 px-1 py-0.5 rounded text-xs",children:M.project==="longterm"?"":""})]}),M.completedAt&&i.jsx("div",{className:"text-xs text-green-600 dark:text-green-400",children:i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Ha,{className:"w-3 h-3"}),A_(M.completedAt)," "]})})]}),i.jsx("div",{className:"flex items-start",children:i.jsx("button",{onClick:E,className:"p-1 hover:bg-green-100 dark:hover:bg-green-800 rounded transition-colors",title:" ",children:i.jsx(nh,{className:"w-3 h-3 text-green-600 dark:text-green-400"})})})]})},M.id)},_e=(M,Z,E,O)=>{if(Z.length===0)return null;const Q=m.has(E);return i.jsxs("div",{className:"mb-4",children:[i.jsxs("button",{onClick:()=>ee(E),className:"w-full flex items-center justify-between p-2 sm:p-3 bg-gray-100 dark:bg-gray-800 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:[i.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[i.jsx("div",{className:"w-4 h-4 flex-shrink-0",children:O}),i.jsxs("span",{className:"text-xs sm:text-sm font-medium text-gray-900 dark:text-white flex-1 leading-tight",children:[M," (",Z.length,")"]})]}),Q?i.jsx(ah,{className:"w-4 h-4 flex-shrink-0"}):i.jsx(ws,{className:"w-4 h-4 flex-shrink-0"})]}),Q&&i.jsx("div",{className:"mt-2 space-y-2",children:Z.map(xe)})]},E)},ve=D(),he=_(),Te=$(),Ee=C(),X=S.length,oe=()=>{switch(w){case"yesterday":return{count:ve.yesterday.length,label:"",color:"text-orange-600 dark:text-orange-400"};case"lastWeek":return{count:ve.lastWeek.length,label:"",color:"text-indigo-600 dark:text-indigo-400"};case"lastMonth":return{count:ve.lastMonth.length,label:"",color:"text-pink-600 dark:text-pink-400"};default:return{count:ve.yesterday.length,label:"",color:"text-orange-600 dark:text-orange-400"}}},ye=()=>{if(x==="daily"){const{groupedByDay:M,sortedKeys:Z}=he;return i.jsx("div",{className:"space-y-4",children:Z.map(E=>_e(E,M[E],`day-${E}`,i.jsx(mt,{className:"w-5 h-5 text-blue-600"})))})}else if(x==="weekly"){const{groupedByWeek:M,sortedKeys:Z}=Te;return i.jsx("div",{className:"space-y-4",children:Z.map(E=>_e(E,M[E],`week-${E}`,i.jsx(mt,{className:"w-5 h-5 text-purple-600"})))})}else if(x==="monthly"){const{groupedByMonth:M,sortedKeys:Z}=Ee;return i.jsx("div",{className:"space-y-4",children:Z.map(E=>_e(E,M[E],`month-${E}`,i.jsx(mt,{className:"w-5 h-5 text-indigo-600"})))})}return i.jsxs("div",{className:"space-y-4",children:[_e("  ",ve.today,"today",i.jsx(vu,{className:"w-5 h-5 text-green-600"})),_e("  ",ve.yesterday,"yesterday",i.jsx(mt,{className:"w-5 h-5 text-blue-600"})),_e("   ",ve.thisWeek,"thisWeek",i.jsx(mt,{className:"w-5 h-5 text-purple-600"})),_e("   ",ve.lastWeek,"lastWeek",i.jsx(mt,{className:"w-5 h-5 text-orange-600"})),_e("   ",ve.thisMonth,"thisMonth",i.jsx(mt,{className:"w-5 h-5 text-indigo-600"})),_e("   ",ve.lastMonth,"lastMonth",i.jsx(mt,{className:"w-5 h-5 text-pink-600"})),_e("   ",ve.older,"older",i.jsx(Ha,{className:"w-5 h-5 text-gray-600"}))]})};return i.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white mb-1",children:" "}),i.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[" ",X,"  "]})]}),i.jsx("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-800 p-1 rounded-lg",children:[{key:"period",label:""},{key:"daily",label:""},{key:"weekly",label:""},{key:"monthly",label:""}].map(({key:M,label:Z})=>i.jsx("button",{onClick:()=>b(M),className:`flex-1 px-2 py-1.5 text-xs sm:text-sm font-medium rounded-md transition-colors ${x===M?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:Z},M))}),x==="period"&&i.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 shadow-sm border",children:i.jsxs("div",{className:"grid grid-cols-4 gap-1",children:[i.jsxs("div",{className:"text-center px-2 py-2",children:[i.jsx("div",{className:"text-lg sm:text-xl font-bold text-green-600 dark:text-green-400",children:ve.today.length}),i.jsx("div",{className:"text-xs text-green-700 dark:text-green-300 leading-tight",children:""})]}),i.jsxs("div",{className:"text-center px-2 py-2",children:[i.jsx("div",{className:"text-lg sm:text-xl font-bold text-blue-600 dark:text-blue-400",children:ve.today.length+ve.yesterday.length+ve.thisWeek.length}),i.jsx("div",{className:"text-xs text-blue-700 dark:text-blue-300 leading-tight",children:" "})]}),i.jsxs("div",{className:"text-center px-2 py-2",children:[i.jsx("div",{className:"text-lg sm:text-xl font-bold text-purple-600 dark:text-purple-400",children:X-ve.lastMonth.length-ve.older.length}),i.jsx("div",{className:"text-xs text-purple-700 dark:text-purple-300 leading-tight",children:" "})]}),i.jsxs("button",{onClick:ie,className:"text-center px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors cursor-pointer",title:"      ",children:[i.jsx("div",{className:`text-lg sm:text-xl font-bold ${oe().color}`,children:oe().count}),i.jsx("div",{className:`text-xs leading-tight ${oe().color.replace("text-","text-").replace("600","700").replace("400","300")}`,children:oe().label})]})]})}),x==="daily"&&i.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 shadow-sm border text-center",children:[i.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:he.sortedKeys.length}),i.jsx("div",{className:"text-xs text-blue-700 dark:text-blue-300",children:" "})]}),x==="weekly"&&i.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 shadow-sm border text-center",children:[i.jsx("div",{className:"text-lg font-bold text-purple-600 dark:text-purple-400",children:Te.sortedKeys.length}),i.jsx("div",{className:"text-xs text-purple-700 dark:text-purple-300",children:" "})]}),x==="monthly"&&i.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 shadow-sm border text-center",children:[i.jsx("div",{className:"text-lg font-bold text-indigo-600 dark:text-indigo-400",children:Ee.sortedKeys.length}),i.jsx("div",{className:"text-xs text-indigo-700 dark:text-indigo-300",children:" "})]}),i.jsx("div",{className:"space-y-4",children:ye()}),X===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(vu,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"   "}),i.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"    ."})]})]})},YS=({employees:s,vacations:t,onEditVacation:r,onDeleteVacation:l})=>{const[c,u]=I.useState(new Date),[h,g]=I.useState(null),[m,p]=I.useState(!1),[x,b]=I.useState(null),[w,L]=I.useState(null),T=I.useRef(null),U=new Date(c.getFullYear(),c.getMonth(),1),Y=new Date(c.getFullYear(),c.getMonth()+1,0),k=new Date(U);k.setDate(k.getDate()-U.getDay());const S=new Date(Y);S.setDate(S.getDate()+(6-Y.getDay()));const R=[],D=new Date(k);for(;D<=S;)R.push(new Date(D)),D.setDate(D.getDate()+1);const _=he=>{const Ee=new Date(he.getTime()-he.getTimezoneOffset()*6e4).toISOString().split("T")[0];return t.filter(X=>X.date===Ee)},$=he=>s.find(Te=>Te.id===he),C=()=>{u(new Date(c.getFullYear(),c.getMonth()-1,1))},ee=()=>{u(new Date(c.getFullYear(),c.getMonth()+1,1))},ie=he=>{L(null),b(he.targetTouches[0].clientX)},xe=he=>{L(he.targetTouches[0].clientX)},_e=()=>{if(!x||!w)return;const he=x-w,Te=he>50,Ee=he<-50;Te&&ee(),Ee&&C()},ve=he=>{switch(he){case"":return"bg-blue-100 text-blue-800 border-blue-200";case"":return"bg-green-100 text-green-800 border-green-200";case"":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"":return"bg-purple-100 text-purple-800 border-purple-200";case"":return"bg-red-100 text-red-800 border-red-200";case"":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return i.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden w-full max-w-full",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[i.jsx("button",{onClick:C,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:i.jsx(Po,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})}),i.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:[c.getFullYear()," ",c.getMonth()+1,""]}),i.jsx("button",{onClick:ee,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:i.jsx(ws,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})})]}),i.jsx("div",{className:"grid w-full border-b border-gray-200 dark:border-gray-700",style:{gridTemplateColumns:"0.7fr 1fr 1fr 1fr 1fr 1fr 0.7fr",minWidth:"100%",maxWidth:"100%"},children:["","","","","","",""].map((he,Te)=>i.jsx("div",{className:`p-3 text-sm font-medium text-center ${Te===0||Te===6?"text-gray-400 dark:text-gray-500":"text-gray-500 dark:text-gray-400"}`,children:he},he))}),i.jsx("div",{ref:T,className:"grid w-full",style:{gridTemplateColumns:"0.7fr 1fr 1fr 1fr 1fr 1fr 0.7fr",minWidth:"100%",maxWidth:"100%"},onTouchStart:ie,onTouchMove:xe,onTouchEnd:_e,children:R.map(he=>{const Te=_(he),Ee=he.getMonth()===c.getMonth(),X=he.toDateString()===new Date().toDateString(),oe=he.getDay()===0||he.getDay()===6;return i.jsxs("div",{className:`min-h-[120px] border-b border-r border-gray-100 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 overflow-hidden ${oe?"p-1":"p-2"} ${Ee?"":"bg-gray-50 dark:bg-gray-900"} ${X?"bg-blue-50 dark:bg-blue-900/20":""} ${oe?"bg-gray-25 dark:bg-gray-850":""}`,style:{minWidth:0,maxWidth:"100%",width:"100%"},onClick:()=>{Te.length>0&&(g(he),p(!0))},children:[i.jsx("div",{className:`text-sm font-medium mb-1 ${Ee?X?"text-blue-600 dark:text-blue-400":"text-gray-900 dark:text-gray-100":"text-gray-400 dark:text-gray-600"}`,children:he.getDate()}),i.jsxs("div",{className:"space-y-1 w-full overflow-hidden",children:[Te.slice(0,oe?3:6).map(ye=>{const M=$(ye.employeeId);return i.jsx("div",{className:`text-xs rounded border cursor-pointer group ${ve(ye.type)} ${oe?"px-1 py-0.5":"px-2 py-1"}`,style:{minWidth:0,maxWidth:"100%",width:"100%",overflow:"hidden"},onClick:Z=>{Z.stopPropagation(),r(ye)},children:i.jsxs("div",{className:"flex items-center justify-between",style:{minWidth:0,maxWidth:"100%",width:"100%"},children:[i.jsxs("span",{className:"truncate",style:{minWidth:0,maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[M?.name," ",ye.type]}),i.jsxs("div",{className:"hidden group-hover:flex items-center space-x-1 flex-shrink-0",children:[i.jsx("button",{onClick:Z=>{Z.stopPropagation(),r(ye)},className:"p-1 hover:bg-white/50 rounded",children:i.jsx(No,{className:"h-3 w-3"})}),i.jsx("button",{onClick:Z=>{Z.stopPropagation(),l(ye.id)},className:"p-1 hover:bg-white/50 rounded",children:i.jsx(an,{className:"h-3 w-3"})})]})]})},ye.id)}),Te.length>(oe?3:6)&&i.jsxs("div",{className:`text-xs text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-700 rounded cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-600 ${oe?"px-1 py-0.5":"px-2 py-1"}`,style:{minWidth:0,maxWidth:"100%",width:"100%",overflow:"hidden"},children:["+",Te.length-(oe?3:6)," "]})]})]},he.toISOString())})}),m&&h&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>p(!1),children:i.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl overflow-hidden w-full max-w-md max-h-[80vh]",onClick:he=>he.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[h.getFullYear()," ",h.getMonth()+1," ",h.getDate()," "]}),i.jsx("button",{onClick:()=>p(!1),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:i.jsx(jt,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})})]}),i.jsx("div",{className:"p-4 max-h-96 overflow-y-auto",children:i.jsx("div",{className:"space-y-3",children:_(h).map(he=>{const Te=$(he.employeeId);return i.jsx("div",{className:`p-3 rounded-lg border cursor-pointer hover:shadow-md transition-shadow ${ve(he.type)}`,onClick:()=>{p(!1),r(he)},children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-sm",children:Te?.name||"   "}),i.jsxs("div",{className:"text-xs opacity-75",children:[Te?.team,"  ",he.type]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:Ee=>{Ee.stopPropagation(),p(!1),r(he)},className:"p-1 hover:bg-white/50 rounded",title:"",children:i.jsx(No,{className:"h-4 w-4"})}),i.jsx("button",{onClick:Ee=>{Ee.stopPropagation(),confirm("   ?")&&(l(he.id),p(!1))},className:"p-1 hover:bg-white/50 rounded text-red-600",title:"",children:i.jsx(an,{className:"h-4 w-4"})})]})]})},he.id)})})}),i.jsx("div",{className:"flex justify-end p-4 border-t border-gray-200 dark:border-gray-700",children:i.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",children:""})})]})})]})},PS=({employees:s,vacation:t,onSave:r,onCancel:l})=>{const[c,u]=I.useState({employeeId:"",date:"",type:""}),[h,g]=I.useState({}),m=["","","","","",""];I.useEffect(()=>{if(t)u({employeeId:t.employeeId.toString(),date:t.date,type:t.type});else{const T=new Date,U=new Date(T.getTime()-T.getTimezoneOffset()*6e4);u({employeeId:"",date:U.toISOString().split("T")[0],type:""})}g({})},[t]);const p=(T,U)=>{u(Y=>({...Y,[T]:U})),h[T]&&g(Y=>({...Y,[T]:""}))},x=()=>{const T={};return c.employeeId||(T.employeeId=" ."),c.date||(T.date=" ."),c.type||(T.type="  ."),g(T),Object.keys(T).length===0},b=()=>{if(!x())return;const T={employeeId:parseInt(c.employeeId),date:c.date,type:c.type};r(T)},w=T=>{T.key==="Enter"&&T.ctrlKey?b():T.key==="Escape"&&l()},L=s.find(T=>T.id===parseInt(c.employeeId));return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md mx-4",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t?" ":" "}),i.jsx("button",{onClick:l,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:i.jsx(jt,{className:"h-5 w-5"})})]}),i.jsxs("div",{className:"p-6 space-y-4",onKeyDown:w,children:[i.jsxs("div",{children:[i.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[i.jsx(Yo,{className:"h-4 w-4 mr-2"}),""]}),i.jsxs("select",{value:c.employeeId,onChange:T=>p("employeeId",T.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 ${h.employeeId?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"}`,children:[i.jsx("option",{value:"",children:" "}),s.map(T=>i.jsxs("option",{value:T.id,children:[T.name," (",T.team,")"]},T.id))]}),h.employeeId&&i.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:h.employeeId}),L&&i.jsxs("div",{className:"mt-2 flex items-center space-x-2 p-2 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[i.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-white text-xs font-semibold",style:{backgroundColor:L.color},children:L.name.charAt(0)}),i.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[L.name,"  ",L.team,"  ",L.position]})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[i.jsx(mt,{className:"h-4 w-4 mr-2"}),""]}),i.jsx("input",{type:"date",value:c.date,onChange:T=>p("date",T.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 ${h.date?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"}`}),h.date&&i.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:h.date})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[i.jsx(To,{className:"h-4 w-4 mr-2"})," "]}),i.jsx("select",{value:c.type,onChange:T=>p("type",T.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 ${h.type?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"}`,children:m.map(T=>i.jsx("option",{value:T,children:T},T))}),h.type&&i.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:h.type})]})]}),i.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700",children:[i.jsx("button",{onClick:l,className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:""}),i.jsx("button",{onClick:b,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:t?"":""})]}),i.jsx("div",{className:"px-6 pb-4",children:i.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:"Ctrl + Enter:  | Esc: "})})]})})},VS=()=>{const{currentUser:s}=Nn(),[t,r]=I.useState([]),[l,c]=I.useState([]),[u,h]=I.useState(!0),[g,m]=I.useState(!1),[p,x]=I.useState(null),[b,w]=I.useState({selectedEmployees:[],vacationTypes:{:!0,:!0,:!0,:!0,:!0},dateRange:"all",startDate:"",endDate:""}),[L,T]=I.useState(!1);if(!Ba(s?.email))return i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-6xl mb-4",children:""}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"  "}),i.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"      ."})]})});const U=async()=>{h(!0);try{const[ie,xe]=await Promise.all([gr.getEmployees(""),gr.getVacations("")]);r(ie),c(xe)}catch(ie){console.error("  :",ie)}finally{h(!1)}},Y=ie=>ie.filter(xe=>{if(b.selectedEmployees.length>0&&!b.selectedEmployees.includes(xe.employeeId)||!b.vacationTypes[xe.type])return!1;const _e=new Date(xe.date),ve=new Date;if(b.dateRange!=="all")switch(b.dateRange){case"thisMonth":if(_e.getMonth()!==ve.getMonth()||_e.getFullYear()!==ve.getFullYear())return!1;break;case"lastMonth":const he=new Date(ve.getFullYear(),ve.getMonth()-1);if(_e.getMonth()!==he.getMonth()||_e.getFullYear()!==he.getFullYear())return!1;break;case"thisYear":if(_e.getFullYear()!==ve.getFullYear())return!1;break;case"custom":if(b.startDate&&_e<new Date(b.startDate)||b.endDate&&_e>new Date(b.endDate))return!1;break}return!0}),k=()=>{w({selectedEmployees:[],vacationTypes:{:!0,:!0,:!0,:!0,:!0},dateRange:"all",startDate:"",endDate:""})},S=ie=>{w(xe=>({...xe,selectedEmployees:xe.selectedEmployees.includes(ie)?xe.selectedEmployees.filter(_e=>_e!==ie):[...xe.selectedEmployees,ie]}))},R=()=>{w(ie=>({...ie,selectedEmployees:ie.selectedEmployees.length===t.length?[]:t.map(xe=>xe.id)}))},D=ie=>{w(xe=>({...xe,vacationTypes:{...xe.vacationTypes,[ie]:!xe.vacationTypes[ie]}}))},_=()=>{x(null),m(!0)},$=ie=>{x(ie),m(!0)},C=async ie=>{if(confirm("   ?"))try{await gr.deleteVacation("",ie),await U()}catch(xe){console.error("  :",xe),alert("    .")}},ee=async ie=>{try{p?await gr.updateVacation("",p.id,ie):await gr.addVacation("",ie),m(!1),await U()}catch(xe){console.error("  :",xe),alert("    .")}};return I.useEffect(()=>{U()},[]),u?i.jsxs("div",{className:"flex items-center justify-center h-64",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),i.jsx("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:"  ..."})]}):i.jsxs("div",{className:"space-y-6 w-full overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100",children:" "}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:()=>T(!L),className:"flex items-center px-2 py-1.5 md:px-3 md:py-2 text-gray-600 dark:text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[i.jsx(Zp,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden md:inline ml-1",children:""})]}),i.jsxs("button",{onClick:_,className:"flex items-center px-2 py-1.5 md:px-4 md:py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[i.jsx(Bt,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden md:inline ml-1",children:" "})]})]})]}),L&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>T(!1),children:i.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl overflow-hidden w-full max-w-md max-h-[80vh]",onClick:ie=>ie.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:" "}),i.jsx("button",{onClick:()=>T(!1),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:i.jsx(jt,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})})]}),i.jsx("div",{className:"p-4 max-h-96 overflow-y-auto",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:" "}),i.jsx("button",{onClick:R,className:"text-sm text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300",children:b.selectedEmployees.length===t.length?" ":" "})]}),i.jsx("div",{className:"grid grid-cols-2 gap-1",children:t.map(ie=>i.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-1.5 rounded",children:[i.jsx("input",{type:"checkbox",checked:b.selectedEmployees.includes(ie.id),onChange:()=>S(ie.id),className:"w-3 h-3 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),i.jsx("div",{className:"w-4 h-4 rounded-full flex items-center justify-center text-white text-xs font-semibold flex-shrink-0",style:{backgroundColor:ie.color},children:ie.name.charAt(0)}),i.jsx("span",{className:"text-xs text-gray-900 dark:text-gray-100 truncate",children:ie.name})]},ie.id))}),i.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 block mb-2",children:" "}),i.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(b.vacationTypes).map(([ie,xe])=>i.jsxs("label",{className:"flex items-center space-x-1 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 px-2 py-1 rounded text-xs border border-gray-200 dark:border-gray-600",children:[i.jsx("input",{type:"checkbox",checked:xe,onChange:()=>D(ie),className:"w-3 h-3 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),i.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:ie})]},ie))})]})]})}),i.jsxs("div",{className:"flex justify-between p-4 border-t border-gray-200 dark:border-gray-700",children:[i.jsx("button",{onClick:k,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",children:""}),i.jsx("button",{onClick:()=>T(!1),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:""})]})]})}),i.jsx(YS,{employees:t,vacations:Y(l),onEditVacation:$,onDeleteVacation:C}),g&&i.jsx(PS,{employees:t,vacation:p,onSave:ee,onCancel:()=>m(!1)})]})};class sb{notifications=[];listeners=[];constructor(){this.loadNotifications(),this.checkScheduledNotifications(),this.checkWeeklyReport(),setInterval(()=>{this.checkScheduledNotifications(),this.checkWeeklyReport()},6e4)}loadNotifications(){const t=localStorage.getItem("notifications");if(t)try{this.notifications=JSON.parse(t).map(r=>({...r,scheduledTime:new Date(r.scheduledTime),createdAt:new Date(r.createdAt)}))}catch(r){console.error("Failed to load notifications:",r)}}saveNotifications(){localStorage.setItem("notifications",JSON.stringify(this.notifications))}checkScheduledNotifications(){const t=new Date;this.notifications.filter(l=>l.scheduledTime<=t&&!l.isRead).forEach(l=>{this.showBrowserNotification(l),this.listeners.forEach(c=>c(l))})}showBrowserNotification(t){"Notification"in window&&Notification.permission==="granted"&&new Notification(t.title,{body:t.message,icon:"/favicon.ico",badge:"/favicon.ico",tag:t.tag||t.id})}showNotification(t){this.isSupported()&&Notification.permission==="granted"&&new Notification(t.title,{body:t.body,icon:"/favicon.ico",tag:t.tag})}isSupported(){return"Notification"in window}requestPermission(){return"Notification"in window?Notification.requestPermission():Promise.resolve("denied")}scheduleReminder(t,r){if(!r.enabled||!t.dueDate)return;let l=new Date(t.dueDate);if(r.dueReminderTiming!==void 0)l=new Date(l.getTime()-r.dueReminderTiming*6e4);else{l.setDate(l.getDate()-r.advanceDays);const[u,h]=r.time.split(":").map(Number);l.setHours(u,h,0,0)}if(l<=new Date)return;const c={id:`reminder_${t.id}_${Date.now()}`,todoId:t.id,type:"reminder",title:"  ",message:`"${t.title}"   .`,scheduledTime:l,isRead:!1,createdAt:new Date,tag:`reminder-${t.id}`};this.notifications=this.notifications.filter(u=>u.tag!==`reminder-${t.id}`),this.notifications.push(c),this.saveNotifications()}scheduleStartReminder(t,r){if(!r.enabled||!r.startReminder||!t.startDate)return;const l=new Date(t.startDate);if(l<=new Date)return;const c={id:`start_${t.id}_${Date.now()}`,todoId:t.id,type:"start_reminder",title:"  ",message:`"${t.title}"  .`,scheduledTime:l,isRead:!1,createdAt:new Date,tag:`start-${t.id}`};this.notifications=this.notifications.filter(u=>u.tag!==`start-${t.id}`),this.notifications.push(c),this.saveNotifications()}scheduleOverdueNotification(t){if(!t.dueDate||t.completed)return;const r=new Date(t.dueDate);r.setDate(r.getDate()+1),r.setHours(9,0,0,0);const l={id:`overdue_${t.id}_${Date.now()}`,todoId:t.id,type:"overdue",title:" ",message:`"${t.title}"  .`,scheduledTime:r,isRead:!1,createdAt:new Date,tag:`overdue-${t.id}`};this.notifications.push(l),this.saveNotifications()}suggestRecurringTask(t){if(t.recurrence==="none")return;const r={id:`recurring_${t.id}_${Date.now()}`,todoId:t.id,type:"recurring_suggestion",title:"  ",message:`"${t.title}"    ?`,scheduledTime:new Date,isRead:!1,createdAt:new Date,tag:`recurring-${t.id}`};this.notifications.push(r),this.saveNotifications(),this.listeners.forEach(l=>l(r))}showCompletionCelebration(t){const r=localStorage.getItem("notification-settings");if(r&&!JSON.parse(r).completionCelebration)return;const l={id:`completion_${t.id}_${Date.now()}`,todoId:t.id,type:"completion_celebration",title:" ! ",message:`"${t.title}"  !`,scheduledTime:new Date,isRead:!1,createdAt:new Date,tag:`completion-${t.id}`};this.showBrowserNotification(l)}checkWeeklyReport(){const t=new Date;if(t.getDay()===1&&t.getHours()===9&&t.getMinutes()===0){const r=localStorage.getItem("lastWeeklyReport"),l=t.toDateString();r!==l&&(this.generateWeeklyReport(),localStorage.setItem("lastWeeklyReport",l))}}generateWeeklyReport(){const t={id:`weekly_report_${Date.now()}`,type:"weekly_report",title:" ",message:"   !",scheduledTime:new Date,isRead:!1,createdAt:new Date,tag:"weekly-report"};this.notifications.push(t),this.saveNotifications(),this.showBrowserNotification(t)}markAsRead(t){const r=this.notifications.find(l=>l.id===t);r&&(r.isRead=!0,this.saveNotifications())}dismissNotification(t){this.notifications=this.notifications.filter(r=>r.id!==t),this.saveNotifications()}getUnreadNotifications(){return this.notifications.filter(t=>!t.isRead)}getAllNotifications(){return[...this.notifications].sort((t,r)=>r.createdAt.getTime()-t.createdAt.getTime())}addListener(t){this.listeners.push(t)}removeListener(t){this.listeners=this.listeners.filter(r=>r!==t)}clearNotificationsForTodo(t){this.notifications=this.notifications.filter(r=>r.todoId!==t),this.saveNotifications()}}const ko=new sb,WS=Object.freeze(Object.defineProperty({__proto__:null,NotificationManager:sb,notificationManager:ko},Symbol.toStringTag,{value:"Module"})),QS=({onClose:s})=>{const[t,r]=I.useState("default"),[l,c]=I.useState(!1),[u,h]=I.useState({dueReminders:!0,dueReminderTiming:60,startReminder:!1,weeklyReport:!1,completionCelebration:!0,dailyReminder:!0,reminderTime:"09:00"});I.useEffect(()=>{r(Notification.permission),c(ko.isSupported());const x=localStorage.getItem("notification-settings");if(x){const b=JSON.parse(x);h({...u,...b,dueReminderTiming:b.dueReminderTiming??(b.advanceDays?b.advanceDays*24*60:60)})}},[]);const g=async()=>{const x=await ko.requestPermission();r(x?"granted":"denied")},m=(x,b)=>{const w={...u,[x]:b};h(w),localStorage.setItem("notification-settings",JSON.stringify(w))},p=async()=>{await ko.showNotification({title:" ",body:"  ! ",tag:"test"})};return l?i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-md w-full max-h-[90vh] overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:" "}),i.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:i.jsx("span",{className:"text-xl",children:""})})]}),i.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto flex-1",children:[i.jsxs("div",{className:"space-y-3",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:" "}),t==="default"&&i.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("span",{className:"text-yellow-600 dark:text-yellow-400",children:""}),i.jsx("span",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"  "})]}),i.jsx("p",{className:"text-xs text-yellow-700 dark:text-yellow-300 mb-3",children:"      ."}),i.jsx("button",{onClick:g,className:"w-full px-3 py-2 bg-yellow-600 text-white text-sm rounded-lg hover:bg-yellow-700 transition-colors",children:"  "})]}),t==="granted"&&i.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("span",{className:"text-green-600 dark:text-green-400",children:""}),i.jsx("span",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:"  "})]}),i.jsx("button",{onClick:p,className:"w-full px-3 py-2 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition-colors",children:"  "})]}),t==="denied"&&i.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("span",{className:"text-red-600 dark:text-red-400",children:""}),i.jsx("span",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"  "})]}),i.jsx("p",{className:"text-xs text-red-700 dark:text-red-300",children:"     ."})]})]}),t==="granted"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:" "}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:" "}),i.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"    "})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:u.dueReminders,onChange:x=>m("dueReminders",x.target.checked),className:"sr-only peer"}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),u.dueReminders&&i.jsx("div",{className:"pl-4 border-l-2 border-gray-200 dark:border-gray-600",children:i.jsxs("select",{value:u.dueReminderTiming,onChange:x=>m("dueReminderTiming",Number(x.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[i.jsx("option",{value:10,children:"10 "}),i.jsx("option",{value:30,children:"30 "}),i.jsx("option",{value:60,children:"1 "}),i.jsx("option",{value:180,children:"3 "}),i.jsx("option",{value:1440,children:"1 "}),i.jsx("option",{value:2880,children:"2 "})]})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:" "}),i.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"   "})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:u.startReminder,onChange:x=>m("startReminder",x.target.checked),className:"sr-only peer"}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:" "}),i.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"   "})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:u.completionCelebration,onChange:x=>m("completionCelebration",x.target.checked),className:"sr-only peer"}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:" "}),i.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"    "})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:u.weeklyReport,onChange:x=>m("weeklyReport",x.target.checked),className:"sr-only peer"}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:" "}),i.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"     "})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:u.dailyReminder,onChange:x=>m("dailyReminder",x.target.checked),className:"sr-only peer"}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),u.dailyReminder&&i.jsx("div",{className:"pl-4 border-l-2 border-gray-200 dark:border-gray-600",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:" "}),i.jsx("input",{type:"time",value:u.reminderTime,onChange:x=>m("reminderTime",x.target.value),className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})})]})]})]}),i.jsx("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0",children:i.jsx("button",{onClick:s,className:"w-full px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:""})})]})}):i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:i.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-md w-full p-6",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-4xl mb-4",children:""}),i.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"  "}),i.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"     ."}),i.jsx("button",{onClick:s,className:"w-full px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:""})]})})})},XS=()=>{const{currentUser:s,logout:t}=Nn(),{exportData:r,importData:l,clearCompleted:c,stats:u,syncing:h,syncWithCloud:g}=Qt(),{theme:m,setTheme:p}=Oy(),{fontSizeLevel:x,setFontSizeLevel:b}=K1(),{customHolidays:w,addCustomHoliday:L,deleteCustomHoliday:T}=Qo(),[U,Y]=I.useState(null),[k,S]=I.useState(!1),[R,D]=I.useState(!1),[_,$]=I.useState(""),[C,ee]=I.useState(""),[ie,xe]=I.useState(!1),_e=async M=>{if(M.preventDefault(),!(!_||!C))try{await L(_,C,ie),$(""),ee(""),xe(!1)}catch(Z){console.error("Failed to add holiday:",Z),alert("  .")}},ve=async M=>{if(confirm("  ?"))try{await T(M)}catch(Z){console.error("Failed to delete holiday:",Z),alert("  .")}},he=()=>{const M=r(),Z=new Blob([M],{type:"application/json"}),E=URL.createObjectURL(Z),O=document.createElement("a");O.href=E,O.download=`todos-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(O),O.click(),document.body.removeChild(O),URL.revokeObjectURL(E)},Te=M=>{const Z=M.target.files?.[0];if(!Z)return;const E=new FileReader;E.onload=async O=>{try{const Q=O.target?.result;await l(Q)?(Y(null),S(!0),setTimeout(()=>S(!1),3e3)):Y("  .")}catch{Y("   .")}},E.readAsText(Z),M.target.value=""},Ee=()=>{const M=u?.completed||0;if(M===0){alert("  .");return}confirm(`  ${M} ?`)&&c()},X=()=>{try{const M=localStorage.getItem("todolist-app-todos");if(M)return`${(new Blob([M]).size/1024).toFixed(2)} KB`}catch(M){console.error("Storage size calculation failed:",M)}return"0 KB"},oe=async()=>{if(confirm("?"))try{await t()}catch(M){console.error("Logout failed:",M)}},ye=async()=>{try{await g()}catch(M){console.error("Sync failed:",M)}};return i.jsxs("div",{className:"space-y-8 max-w-4xl mx-auto pb-10",children:[i.jsxs("div",{className:"animate-fade-in",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2 tracking-tight",children:""}),i.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"    "})]}),i.jsxs("div",{className:"glass-card rounded-3xl p-8 animate-slide-in",style:{animationDelay:"0.1s"},children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-2xl bg-blue-50 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-400",children:i.jsx(Yo,{className:"w-5 h-5",strokeWidth:2})}),""]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-4 p-4 bg-white/50 dark:bg-gray-700/30 rounded-xl border border-gray-100 dark:border-gray-700/50 backdrop-blur-sm",children:[i.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-900 dark:to-blue-800 rounded-full flex items-center justify-center shadow-inner",children:s?.photoURL?i.jsx("img",{src:s.photoURL,alt:"",className:"w-10 h-10 rounded-full object-cover"}):i.jsx("span",{className:"text-xl font-bold text-blue-600 dark:text-blue-300",children:s?.isAnonymous?"G":s?.email?.charAt(0).toUpperCase()||"U"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"text-base font-bold text-gray-900 dark:text-white truncate",children:s?.isAnonymous?" ":s?.displayName||""}),i.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:s?.isAnonymous?"   ":s?.email})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[!s?.isAnonymous&&i.jsxs("button",{onClick:ye,disabled:h,className:"flex items-center justify-center gap-2.5 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800 rounded-2xl hover:bg-blue-100 dark:hover:bg-blue-900/40 transition-all active:scale-[0.98] disabled:opacity-50 disabled:active:scale-100 group",children:[h?i.jsx(Hm,{className:"w-5 h-5 text-blue-600 animate-spin"}):i.jsx(Hm,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 group-hover:rotate-180 transition-transform duration-500"}),i.jsx("span",{className:"font-semibold text-blue-700 dark:text-blue-300",children:h?" ...":" "})]}),i.jsxs("button",{onClick:oe,className:"flex items-center justify-center gap-2.5 p-4 bg-red-50 dark:bg-red-900/10 border border-red-100 dark:border-red-900/30 rounded-2xl hover:bg-red-100 dark:hover:bg-red-900/30 transition-all active:scale-[0.98] group",children:[i.jsx(Ew,{className:"w-5 h-5 text-red-600 dark:text-red-400 group-hover:-translate-x-1 transition-transform"}),i.jsx("span",{className:"font-semibold text-red-700 dark:text-red-300",children:""})]})]})]})]}),i.jsxs("div",{className:"glass-card rounded-3xl p-8 animate-slide-in",style:{animationDelay:"0.2s"},children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-2xl bg-purple-50 dark:bg-purple-900/30 flex items-center justify-center text-purple-600 dark:text-purple-400",children:i.jsx(Cw,{className:"w-5 h-5",strokeWidth:2})}),""]}),i.jsx("div",{className:"grid grid-cols-3 gap-4",children:[{key:"light",label:"",icon:Aw},{key:"dark",label:"",icon:Rw},{key:"system",label:"",icon:Ow}].map(M=>{const Z=M.icon,E=m===M.key;return i.jsxs("button",{onClick:()=>p(M.key),className:`flex flex-col items-center justify-center gap-3 p-5 rounded-2xl border transition-all duration-300 ${E?"bg-blue-50 dark:bg-blue-900/30 border-blue-200 dark:border-blue-700 shadow-md scale-[1.02]":"bg-white/50 dark:bg-gray-700/30 border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50 hover:border-gray-200"}`,children:[i.jsx(Z,{className:`w-6 h-6 ${E?"text-blue-600 dark:text-blue-400":"text-gray-400"}`}),i.jsx("span",{className:`text-sm font-semibold ${E?"text-blue-700 dark:text-blue-300":"text-gray-600 dark:text-gray-400"}`,children:M.label})]},M.key)})})]}),i.jsxs("div",{className:"glass-card rounded-3xl p-8 animate-slide-in",style:{animationDelay:"0.3s"},children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-2xl bg-indigo-50 dark:bg-indigo-900/30 flex items-center justify-center text-indigo-600 dark:text-indigo-400",children:i.jsx(Mw,{className:"w-5 h-5",strokeWidth:2})})," "]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between bg-white/50 dark:bg-gray-700/30 p-6 rounded-xl border border-gray-100 dark:border-gray-700/50",children:[i.jsx("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:""}),i.jsx("div",{className:"flex gap-3 items-center flex-wrap justify-center",children:[1,2,3,4,5,6,7].map(M=>i.jsx("button",{onClick:()=>b(M),className:`w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300 ${x===M?"bg-blue-600 text-white shadow-lg shadow-blue-500/30 scale-110":"bg-white dark:bg-gray-600 text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-500"}`,"aria-label":`  ${M} `,children:i.jsx("span",{style:{fontSize:`${.5+M*.1}rem`,fontWeight:600},children:"A"})},M))}),i.jsx("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:""})]}),i.jsxs("div",{className:"p-5 border border-gray-200/60 dark:border-gray-700/60 rounded-xl bg-gray-50/50 dark:bg-gray-800/50 backdrop-blur-sm",children:[i.jsx("p",{className:"text-xs font-semibold text-gray-400 dark:text-gray-500 mb-2 uppercase tracking-wider",children:"Preview"}),i.jsx("p",{className:"text-base text-gray-800 dark:text-gray-200 leading-relaxed font-medium",children:"   . The quick brown fox jumps over the lazy dog."})]})]})]}),i.jsxs("div",{className:"glass-card rounded-3xl p-8 animate-slide-in",style:{animationDelay:"0.4s"},children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-2xl bg-red-50 dark:bg-red-900/30 flex items-center justify-center text-red-600 dark:text-red-400",children:i.jsx(mt,{className:"w-5 h-5",strokeWidth:2})})," "]}),i.jsxs("form",{onSubmit:_e,className:"flex flex-col sm:flex-row gap-3 mb-6",children:[i.jsxs("div",{className:"flex-1 flex gap-3",children:[i.jsx("input",{type:"date",value:_,onChange:M=>$(M.target.value),className:"px-4 py-2.5 border border-gray-200 dark:border-gray-700 rounded-xl bg-white/80 dark:bg-gray-800/80 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",required:!0}),i.jsx("input",{type:"text",value:C,onChange:M=>ee(M.target.value),placeholder:" ",className:"flex-1 px-4 py-2.5 border border-gray-200 dark:border-gray-700 rounded-xl bg-white/80 dark:bg-gray-800/80 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",required:!0})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"flex items-center h-full px-3 bg-white/50 dark:bg-gray-700/30 rounded-xl border border-gray-200 dark:border-gray-700",children:[i.jsx("input",{type:"checkbox",id:"recurringHoliday",checked:ie,onChange:M=>xe(M.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800"}),i.jsx("label",{htmlFor:"recurringHoliday",className:"ml-2 text-sm font-medium text-gray-700 dark:text-gray-300 whitespace-nowrap cursor-pointer select-none",children:" "})]}),i.jsx("button",{type:"submit",className:"px-4 py-2.5 bg-blue-600 text-white rounded-xl hover:bg-blue-700 active:scale-95 transition-all shadow-md shadow-blue-500/20 flex items-center justify-center min-w-[3rem]",title:"",children:i.jsx(Bt,{className:"w-5 h-5"})})]})]}),i.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto pr-1 custom-scrollbar",children:w.length===0?i.jsx("div",{className:"text-center py-8 bg-gray-50/50 dark:bg-gray-800/30 rounded-xl border border-dashed border-gray-200 dark:border-gray-700",children:i.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"  ."})}):w.map(M=>i.jsxs("div",{className:"group flex items-center justify-between p-3 bg-white/60 dark:bg-gray-800/40 rounded-xl border border-gray-100 dark:border-gray-700/50 hover:border-blue-200 dark:hover:border-blue-800 transition-all hover:shadow-sm",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-50 dark:bg-red-900/20 flex items-center justify-center text-red-600 dark:text-red-400 font-bold text-sm border border-red-100 dark:border-red-800/30",children:M.date.split("-")[2]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:M.name}),M.isRecurring&&i.jsx("span",{className:"text-[10px] px-2 py-0.5 bg-blue-100 text-blue-700 dark:bg-blue-900/40 dark:text-blue-300 rounded-full font-semibold border border-blue-200 dark:border-blue-800/50",children:""})]}),i.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:M.date})]})]}),i.jsx("button",{onClick:()=>ve(M.id),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors opacity-0 group-hover:opacity-100 focus:opacity-100",title:"",children:i.jsx(an,{className:"w-4 h-4"})})]},M.id))})]}),i.jsxs("div",{className:"glass-card rounded-3xl p-8 animate-slide-in",style:{animationDelay:"0.5s"},children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-2xl bg-green-50 dark:bg-green-900/30 flex items-center justify-center text-green-600 dark:text-green-400",children:i.jsx(Iw,{className:"w-5 h-5",strokeWidth:2})})," "]}),i.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[{label:" ",value:u?.total||0,color:"text-blue-600 dark:text-blue-400",bg:"bg-blue-50 dark:bg-blue-900/20"},{label:"",value:u?.completed||0,color:"text-green-600 dark:text-green-400",bg:"bg-green-50 dark:bg-green-900/20"},{label:"",value:u?.pending||0,color:"text-orange-600 dark:text-orange-400",bg:"bg-orange-50 dark:bg-orange-900/20"},{label:"",value:X(),color:"text-purple-600 dark:text-purple-400",bg:"bg-purple-50 dark:bg-purple-900/20"}].map((M,Z)=>i.jsxs("div",{className:`flex flex-col items-center justify-center p-4 rounded-xl ${M.bg} border border-transparent hover:border-current transition-all duration-300`,children:[i.jsx("div",{className:`text-2xl font-bold ${M.color} mb-1`,children:M.value}),i.jsx("div",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:M.label})]},Z))})]}),i.jsxs("div",{className:"glass-card rounded-3xl p-8 animate-slide-in",style:{animationDelay:"0.6s"},children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-2xl bg-orange-50 dark:bg-orange-900/30 flex items-center justify-center text-orange-600 dark:text-orange-400",children:i.jsx(Lw,{className:"w-5 h-5",strokeWidth:2})})," "]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[i.jsxs("button",{onClick:he,className:"flex flex-col items-center justify-center gap-3 p-6 bg-white/50 dark:bg-gray-700/30 border border-gray-200 dark:border-gray-700 rounded-2xl hover:bg-blue-50 dark:hover:bg-blue-900/20 hover:border-blue-200 dark:hover:border-blue-800 transition-all group",children:[i.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-50 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-400 group-hover:scale-110 transition-transform duration-300",children:i.jsx(Uw,{className:"w-6 h-6"})}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-base font-bold text-gray-900 dark:text-white group-hover:text-blue-700 dark:group-hover:text-blue-300",children:""}),i.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"JSON  "})]})]}),i.jsxs("div",{className:"relative group",children:[i.jsx("input",{type:"file",accept:".json",onChange:Te,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),i.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 p-6 bg-white/50 dark:bg-gray-700/30 border border-gray-200 dark:border-gray-700 rounded-2xl group-hover:bg-green-50 dark:group-hover:bg-green-900/20 group-hover:border-green-200 dark:group-hover:border-green-800 transition-all h-full",children:[i.jsx("div",{className:"w-12 h-12 rounded-full bg-green-50 dark:bg-green-900/30 flex items-center justify-center text-green-600 dark:text-green-400 group-hover:scale-110 transition-transform duration-300",children:i.jsx(Hw,{className:"w-6 h-6"})}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-base font-bold text-gray-900 dark:text-white group-hover:text-green-700 dark:group-hover:text-green-300",children:""}),i.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"JSON  "})]})]})]}),i.jsxs("button",{onClick:Ee,className:"flex flex-col items-center justify-center gap-3 p-6 bg-white/50 dark:bg-gray-700/30 border border-gray-200 dark:border-gray-700 rounded-2xl hover:bg-orange-50 dark:hover:bg-orange-900/20 hover:border-orange-200 dark:hover:border-orange-800 transition-all group",children:[i.jsx("div",{className:"w-12 h-12 rounded-full bg-orange-50 dark:bg-orange-900/30 flex items-center justify-center text-orange-600 dark:text-orange-400 group-hover:scale-110 transition-transform duration-300",children:i.jsx(an,{className:"w-6 h-6"})}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-base font-bold text-gray-900 dark:text-white group-hover:text-orange-700 dark:group-hover:text-orange-300",children:""}),i.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"  "})]})]})]}),(U||k)&&i.jsxs("div",{className:`mt-6 p-4 rounded-2xl border flex items-center gap-4 animate-fade-in ${U?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-800 dark:text-red-200":"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800 text-green-800 dark:text-green-200"}`,children:[i.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${U?"bg-red-100 dark:bg-red-900/40":"bg-green-100 dark:bg-green-900/40"}`,children:U?i.jsx($w,{className:"w-5 h-5"}):i.jsx(gs,{className:"w-5 h-5"})}),i.jsx("span",{className:"font-medium",children:U||"  ."})]})]}),i.jsxs("div",{className:"glass-card rounded-3xl p-8 animate-slide-in",style:{animationDelay:"0.7s"},children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-2xl bg-yellow-50 dark:bg-yellow-900/30 flex items-center justify-center text-yellow-600 dark:text-yellow-400",children:i.jsx($m,{className:"w-5 h-5",strokeWidth:2})}),""]}),i.jsxs("button",{onClick:()=>D(!0),className:"w-full flex items-center justify-between p-5 bg-white/50 dark:bg-gray-700/30 border border-gray-200 dark:border-gray-700 rounded-2xl hover:bg-blue-50 dark:hover:bg-blue-900/20 hover:border-blue-200 dark:hover:border-blue-800 transition-all group",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-12 h-12 rounded-full bg-yellow-50 dark:bg-yellow-900/20 flex items-center justify-center text-yellow-600 dark:text-yellow-400 group-hover:scale-110 transition-transform",children:i.jsx($m,{className:"w-6 h-6"})}),i.jsxs("div",{className:"text-left",children:[i.jsx("div",{className:"text-base font-bold text-gray-900 dark:text-white group-hover:text-blue-700 dark:group-hover:text-blue-300 transition-colors",children:" "}),i.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mt-0.5",children:" ,    "})]})]}),i.jsx(ws,{className:"w-5 h-5 text-gray-400 group-hover:text-blue-500 group-hover:translate-x-1 transition-all"})]})]}),i.jsxs("div",{className:"text-center py-6 animate-fade-in",style:{animationDelay:"0.8s"},children:[i.jsx("p",{className:"text-sm font-medium text-gray-400 dark:text-gray-500",children:"ToDo List App v1.0.0"}),i.jsx("p",{className:"text-xs text-gray-300 dark:text-gray-600 mt-1",children:"Designed for simplicity & productivity"})]}),R&&i.jsx(QS,{onClose:()=>D(!1)})]})},lb=({onClick:s})=>{const{theme:t}=Oy();return i.jsxs("button",{onClick:s,className:"fixed bottom-20 right-4 z-50 group","aria-label":" ",children:[i.jsx("div",{className:"absolute inset-0 rounded-full bg-blue-500 blur-lg opacity-40 group-hover:opacity-60 transition-opacity duration-300 animate-pulse"}),i.jsx("div",{className:`
        relative flex items-center justify-center 
        w-14 h-14 rounded-full
        bg-gradient-to-r from-blue-600 to-indigo-600
        text-white shadow-lg shadow-blue-500/40
        transform transition-all duration-300
        group-hover:scale-110 group-active:scale-95
        group-hover:shadow-blue-500/60
      `,children:i.jsx(Bt,{className:"w-7 h-7 transition-transform duration-300 group-hover:rotate-90",strokeWidth:2.5})})]})},KS=Object.freeze(Object.defineProperty({__proto__:null,default:lb},Symbol.toStringTag,{value:"Module"})),ZS=({isOpen:s,onClose:t,onSelectTemplate:r})=>{const{currentUser:l}=Nn(),[c,u]=I.useState([]),[h,g]=I.useState(!1),[m,p]=I.useState(null),[x,b]=I.useState(!1),[w,L]=I.useState({name:"",description:"",category:"shortterm",subTasks:[],defaultPriority:"medium",tags:[]});I.useEffect(()=>{if(!l?.uid)return;Ce.log("   ",{uid:l.uid});const _=Oe.subscribeProjectTemplates(l.uid,$=>{Ce.log("   ",{count:$.length}),u($)});return()=>_()},[l?.uid]),I.useEffect(()=>{s||(p(null),g(!1),L({name:"",description:"",category:"shortterm",subTasks:[],defaultPriority:"medium",tags:[]}))},[s]);const T=async()=>{if(!(!w.name.trim()||!l?.uid)){b(!0);try{Ce.log("  ",{template:w}),await Oe.addProjectTemplate(w,l.uid),L({name:"",description:"",category:"shortterm",subTasks:[],defaultPriority:"medium",tags:[]}),g(!1)}catch(_){Ce.error("  :",_),alert("    .")}finally{b(!1)}}},U=async()=>{if(!(!m||!l?.uid)){b(!0);try{Ce.log(" ",{template:m});const{id:_,createdAt:$,updatedAt:C,...ee}=m;await Oe.updateProjectTemplate(_,ee,l.uid),p(null)}catch(_){Ce.error("  :",_),alert("    .")}finally{b(!1)}}},Y=async _=>{if(!(!confirm("  ?")||!l?.uid)){b(!0);try{Ce.log(" ",{templateId:_}),await Oe.deleteProjectTemplate(_,l.uid)}catch($){Ce.error("  :",$),alert("    .")}finally{b(!1)}}},k=async _=>{if(l?.uid){b(!0);try{const{id:$,createdAt:C,updatedAt:ee,...ie}=_,xe={...ie,name:`${_.name} ()`};Ce.log(" ",{duplicated:xe}),await Oe.addProjectTemplate(xe,l.uid)}catch($){Ce.error("  :",$),alert("    .")}finally{b(!1)}}},S=(_,$)=>{const C={title:"",completed:!1,priority:"medium"};$({..._,subTasks:[..._.subTasks,C]})},R=(_,$,C,ee)=>{const ie=_.subTasks.map((xe,_e)=>_e===$?{...xe,...C}:xe);ee({..._,subTasks:ie})},D=(_,$,C)=>{C({..._,subTasks:_.subTasks.filter((ee,ie)=>ie!==$)})};return s?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:i.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"  "}),i.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:i.jsx(jt,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:[i.jsx("div",{className:"mb-6",children:i.jsxs("button",{onClick:()=>g(!0),className:"btn-primary flex items-center gap-2",children:[i.jsx(Bt,{className:"w-4 h-4"}),"  "]})}),h&&i.jsxs("div",{className:"mb-6 p-4 border border-gray-200 dark:border-gray-700 rounded-lg",children:[i.jsx("h3",{className:"text-lg font-medium mb-4",children:" "}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:" "}),i.jsx("input",{type:"text",value:w.name,onChange:_=>L({...w,name:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:": 7   "})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:""}),i.jsxs("select",{value:w.category,onChange:_=>L({...w,category:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[i.jsx("option",{value:"shortterm",children:" "}),i.jsx("option",{value:"longterm",children:" "})]})]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:""}),i.jsx("textarea",{value:w.description,onChange:_=>L({...w,description:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",rows:3,placeholder:" "})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("label",{className:"block text-sm font-medium",children:" "}),i.jsxs("button",{onClick:()=>S(w,L),className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[i.jsx(Bt,{className:"w-3 h-3"})," "]})]}),i.jsx("div",{className:"space-y-2",children:w.subTasks.map((_,$)=>i.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 dark:bg-gray-700 rounded",children:[i.jsx("input",{type:"checkbox",checked:_.completed,onChange:C=>{const ee=new Date;R(w,$,{completed:C.target.checked,completedAt:C.target.checked?ee:null},L)},className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),i.jsx("input",{type:"text",value:_.title,onChange:C=>R(w,$,{title:C.target.value},L),className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:ring-1 focus:ring-blue-500 dark:bg-gray-600 dark:text-white",placeholder:""}),i.jsxs("select",{value:_.priority,onChange:C=>R(w,$,{priority:C.target.value},L),className:"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded dark:bg-gray-600 dark:text-white",children:[i.jsx("option",{value:"low",children:""}),i.jsx("option",{value:"medium",children:""}),i.jsx("option",{value:"high",children:""}),i.jsx("option",{value:"urgent",children:""})]}),_.completed&&_.completedAt&&i.jsxs("span",{className:"text-xs text-green-600 dark:text-green-400",children:[": ",new Date(_.completedAt).toLocaleString()]}),i.jsx("button",{onClick:()=>D(w,$,L),className:"p-1 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/20 rounded",children:i.jsx(jt,{className:"w-3 h-3"})})]},$))})]}),i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:""}),i.jsxs("button",{onClick:T,disabled:x,className:"btn-primary flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[x?i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):i.jsx(Bu,{className:"w-4 h-4"}),x?" ...":""]})]})]}),m&&i.jsxs("div",{className:"mb-6 p-4 border border-blue-200 dark:border-blue-700 rounded-lg bg-blue-50 dark:bg-blue-900/20",children:[i.jsx("h3",{className:"text-lg font-medium mb-4 text-blue-800 dark:text-blue-200",children:" "}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:" "}),i.jsx("input",{type:"text",value:m.name,onChange:_=>p({...m,name:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:": 7   "})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:""}),i.jsxs("select",{value:m.category,onChange:_=>p({...m,category:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[i.jsx("option",{value:"shortterm",children:" "}),i.jsx("option",{value:"longterm",children:" "})]})]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium mb-2",children:""}),i.jsx("textarea",{value:m.description,onChange:_=>p({...m,description:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",rows:3,placeholder:" "})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("label",{className:"block text-sm font-medium",children:" "}),i.jsxs("button",{onClick:()=>S(m,p),className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[i.jsx(Bt,{className:"w-3 h-3"})," "]})]}),i.jsx("div",{className:"space-y-2",children:m.subTasks.map((_,$)=>i.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 dark:bg-gray-700 rounded",children:[i.jsx("input",{type:"checkbox",checked:_.completed,onChange:C=>{const ee=new Date;R(m,$,{completed:C.target.checked,completedAt:C.target.checked?ee:null},p)},className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),i.jsx("input",{type:"text",value:_.title,onChange:C=>R(m,$,{title:C.target.value},p),className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:ring-1 focus:ring-blue-500 dark:bg-gray-600 dark:text-white",placeholder:""}),i.jsxs("select",{value:_.priority,onChange:C=>R(m,$,{priority:C.target.value},p),className:"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded dark:bg-gray-600 dark:text-white",children:[i.jsx("option",{value:"low",children:""}),i.jsx("option",{value:"medium",children:""}),i.jsx("option",{value:"high",children:""}),i.jsx("option",{value:"urgent",children:""})]}),_.completed&&_.completedAt&&i.jsxs("span",{className:"text-xs text-green-600 dark:text-green-400",children:[": ",new Date(_.completedAt).toLocaleString()]}),i.jsx("button",{onClick:()=>D(m,$,p),className:"p-1 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/20 rounded",children:i.jsx(jt,{className:"w-3 h-3"})})]},$))})]}),i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx("button",{onClick:()=>p(null),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:""}),i.jsxs("button",{onClick:U,disabled:x,className:"btn-primary flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[x?i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):i.jsx(Bu,{className:"w-4 h-4"}),x?" ...":" "]})]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:c.map(_=>i.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-start justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:_.name}),i.jsx("span",{className:`text-xs px-2 py-1 rounded ${_.category==="longterm"?"bg-purple-100 text-purple-700 dark:bg-purple-900/20 dark:text-purple-300":"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-300"}`,children:_.category==="longterm"?"":""})]}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>{p(_)},disabled:x,className:"p-1 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-900/20 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:"",children:i.jsx(Vp,{className:"w-3 h-3"})}),i.jsx("button",{onClick:()=>k(_),disabled:x,className:"p-1 text-green-600 hover:bg-green-100 dark:hover:bg-green-900/20 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:"",children:i.jsx(zw,{className:"w-3 h-3"})}),i.jsx("button",{onClick:()=>Y(_.id),disabled:x,className:"p-1 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/20 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:"",children:i.jsx(an,{className:"w-3 h-3"})})]})]}),_.description&&i.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:_.description}),i.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-3",children:[" : ",_.subTasks.length,""]}),r&&i.jsx("button",{onClick:()=>{r(_),t()},className:"w-full btn-secondary text-sm",children:"  "})]},_.id))}),c.length===0&&!h&&i.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[i.jsx("p",{children:"  ."}),i.jsx("p",{className:"text-sm",children:"    ."})]})]})]})}):null},JS=({isOpen:s,onClose:t,initialDate:r})=>{const{addTodo:l,allTags:c}=Qt(),{currentUser:u}=Nn(),[h,g]=I.useState(""),[m,p]=I.useState(!1),[x,b]=I.useState(""),[w,L]=I.useState(!0),[T,U]=I.useState([]),[Y,k]=I.useState(""),[S,R]=I.useState(!1),D={startDate:Lt(r||new Date,"yyyy-MM-dd"),startTime:"",dueDate:"",dueTime:"",priority:"medium",tags:[],recurrence:"none",recurrenceDay:new Date().getDay(),recurrenceDate:new Date().getDate(),weekOfMonth:1,monthlyRecurrenceType:"by_date",holidayHandling:"show",showStartTime:!1,showDueDate:!1,type:"simple",projectCategory:"shortterm",subTasks:[],description:""},[_,$]=I.useState(D),[C,ee]=I.useState({}),[ie,xe]=I.useState(""),_e=I.useRef(null);I.useEffect(()=>{s&&_e.current&&_e.current.focus(),s&&$(E=>({...E,startDate:Lt(r||new Date,"yyyy-MM-dd")}))},[s,r]),I.useEffect(()=>{if(!u?.uid||!s)return;const E=Oe.subscribeProjectTemplates(u.uid,O=>{U(O)});return()=>E()},[u?.uid,s]);const ve=E=>{let O;if(typeof E=="string"){if(!E){k("");return}O=T.find(Q=>Q.id===E)}else O=E;O&&(k(O.id),g(O.name),$(Q=>({...Q,type:"project",projectCategory:O.category,priority:O.defaultPriority,tags:[...Q.tags,...O.tags||[]],subTasks:O.subTasks.map(pe=>({id:crypto.randomUUID(),title:pe.title})),description:O.description||""})))},he=(E,O)=>{$(Q=>({...Q,[E]:O})),C[E]&&ee(Q=>{const pe={...Q};return delete pe[E],pe})},Te=()=>{x.trim()&&!_.tags.includes(x.trim())&&(he("tags",[..._.tags,x.trim()]),b(""),p(!1))},Ee=E=>{_.tags.includes(E)?he("tags",_.tags.filter(O=>O!==E)):he("tags",[..._.tags,E])},X=()=>{if(!ie.trim())return;const E={id:crypto.randomUUID(),title:ie.trim()};he("subTasks",[..._.subTasks,E]),xe("")},oe=E=>{he("subTasks",_.subTasks.filter(O=>O.id!==E))},ye=E=>{const O=new Date;let Q=O,pe="",W="medium",de=[];E.includes("")?Q=O:E.includes("")?Q=Ll(O,1):E.includes("")&&(Q=Ll(O,2)),E.includes("!")?W="urgent":E.includes("!")?W="high":E.includes("!")&&(W="low");const K=E.match(/#(\S+)/g);return K&&(de=K.map(ne=>ne.slice(1))),{startDate:Lt(Q,"yyyy-MM-dd"),startTime:pe,priority:W,tags:de}},M=E=>{if(E.preventDefault(),!h.trim()){ee(Q=>({...Q,text:"  "}));return}const O={title:h,completed:!1,..._,startDate:new Date(`${_.startDate}T${_.startTime||"00:00"}`),dueDate:_.showDueDate&&_.dueDate?new Date(`${_.dueDate}T${_.dueTime||"23:59"}`):void 0,project:_.type==="project"?_.projectCategory:void 0,subTasks:_.type==="project"?_.subTasks.map(Q=>({...Q,completed:!1,priority:"medium",createdAt:new Date,updatedAt:new Date})):void 0,recurrence:_.recurrence==="none"?void 0:{type:_.recurrence,interval:1,days:_.recurrence==="weekly"?[_.recurrenceDay]:void 0,monthDay:_.recurrence==="monthly"&&_.monthlyRecurrenceType==="by_date"?_.recurrenceDate:void 0,weekOfMonth:_.recurrence==="monthly"&&_.monthlyRecurrenceType==="by_weekday"?_.weekOfMonth:void 0,dayOfWeek:_.recurrence==="monthly"&&_.monthlyRecurrenceType==="by_weekday"?_.recurrenceDay:void 0,holidayHandling:_.holidayHandling}};l(O),t(),g(""),$(D)},Z=[{value:0,label:""},{value:1,label:""},{value:2,label:""},{value:3,label:""},{value:4,label:""},{value:5,label:""},{value:6,label:""}];return s?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[i.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:t}),i.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:i.jsxs("div",{className:"relative w-full max-w-2xl bg-white dark:bg-gray-800 rounded-2xl shadow-2xl overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:" "}),i.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700",children:i.jsx(jt,{className:"w-5 h-5"})})]}),i.jsxs("form",{onSubmit:M,className:"p-6 max-h-[80vh] overflow-y-auto",children:[i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[i.jsx(Qp,{className:"w-4 h-4 inline mr-1"})," *"]}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{ref:_e,type:"text",value:h,onChange:E=>{if(g(E.target.value),w&&_.type==="simple"){const O=ye(E.target.value);$(Q=>({...Q,...O}))}},placeholder:w&&_.type==="simple"?":   2  ! #":" ",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white ${C.text?"border-red-500":"border-gray-300 dark:border-gray-600"}`}),_.type==="simple"&&i.jsx("button",{type:"button",onClick:()=>L(!w),className:`absolute right-2 top-1/2 -translate-y-1/2 text-xs px-2 py-1 rounded-md transition-colors ${w?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-500 dark:bg-gray-600 dark:text-gray-400"}`,children:w?" ON":"OFF"})]}),C.text&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:C.text})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),i.jsx("textarea",{value:_.description,onChange:E=>he("description",E.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white resize-none",placeholder:"    "})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[i.jsx(Xp,{className:"w-4 h-4 inline mr-1"}),""]}),i.jsxs("select",{value:_.type,onChange:E=>he("type",E.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[i.jsx("option",{value:"simple",children:" "}),i.jsx("option",{value:"project",children:""})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[i.jsx(Vl,{className:"w-4 h-4 inline mr-1"}),""]}),i.jsxs("select",{value:_.priority,onChange:E=>he("priority",E.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[i.jsx("option",{value:"low",children:""}),i.jsx("option",{value:"medium",children:""}),i.jsx("option",{value:"high",children:""}),i.jsx("option",{value:"urgent",children:""})]})]})]}),_.type==="project"&&i.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 dark:bg-gray-700/30 rounded-xl border border-gray-200 dark:border-gray-700",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:" "}),i.jsxs("button",{type:"button",onClick:()=>R(!0),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 font-medium flex items-center gap-1",children:[i.jsx(Bw,{className:"w-3 h-3"})," "]})]}),T.length>0&&i.jsxs("select",{value:Y,onChange:E=>ve(E.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm dark:bg-gray-700 dark:text-white",children:[i.jsx("option",{value:"",children:"  "}),T.map(E=>i.jsxs("option",{value:E.id,children:[E.name," (",E.subTasks.length," )"]},E.id))]}),i.jsxs("div",{className:"flex space-x-4",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",value:"shortterm",checked:_.projectCategory==="shortterm",onChange:E=>he("projectCategory",E.target.value),className:"mr-2"}),i.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:" "})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",value:"longterm",checked:_.projectCategory==="longterm",onChange:E=>he("projectCategory",E.target.value),className:"mr-2"}),i.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:" "})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[i.jsx(Kp,{className:"w-4 h-4 inline mr-1"}),"  (",_.subTasks.length,")"]}),i.jsx("div",{className:"space-y-2 mb-2",children:_.subTasks.map((E,O)=>i.jsxs("div",{className:"flex items-center gap-2 bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700",children:[i.jsx("span",{className:"text-xs text-gray-500 font-mono",children:O+1}),i.jsx("span",{className:"flex-1 text-sm text-gray-700 dark:text-gray-300",children:E.title}),i.jsx("button",{type:"button",onClick:()=>oe(E.id),className:"text-red-400 hover:text-red-600",children:i.jsx(an,{className:"w-4 h-4"})})]},E.id))}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",value:ie,onChange:E=>xe(E.target.value),onKeyPress:E=>E.key==="Enter"&&(E.preventDefault(),X()),placeholder:"  ...",className:"flex-1 px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"}),i.jsx("button",{type:"button",onClick:X,className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:""})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[i.jsx(mt,{className:"w-4 h-4 inline mr-1"})," "]}),i.jsx("input",{type:"date",value:_.startDate,onChange:E=>he("startDate",E.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[i.jsx(Ha,{className:"w-4 h-4 inline mr-1"})," "]}),i.jsx("input",{type:"time",value:_.startTime,onChange:E=>he("startTime",E.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]})]}),i.jsxs("div",{className:"border-t border-gray-100 dark:border-gray-700 pt-4",children:[i.jsxs("button",{type:"button",onClick:()=>he("showDueDate",!_.showDueDate),className:"flex items-center text-sm text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors mb-2",children:[_.showDueDate?i.jsx(Wp,{className:"w-4 h-4 mr-1"}):i.jsx(ah,{className:"w-4 h-4 mr-1"}),_.showDueDate?"  ":"   ()"]}),_.showDueDate&&i.jsxs("div",{className:"grid grid-cols-2 gap-4 animate-fadeIn",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),i.jsx("input",{type:"date",value:_.dueDate,onChange:E=>he("dueDate",E.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),i.jsx("input",{type:"time",value:_.dueTime,onChange:E=>he("dueTime",E.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[i.jsx(To,{className:"w-4 h-4 inline mr-1"}),""]}),i.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[c.map(E=>i.jsxs("button",{type:"button",onClick:()=>Ee(E),className:`px-3 py-1 rounded-full text-sm transition-colors ${_.tags.includes(E)?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:["#",E]},E)),i.jsx("button",{type:"button",onClick:()=>p(!0),className:"px-3 py-1 rounded-full text-sm border border-dashed border-gray-300 text-gray-500 hover:border-gray-400 hover:text-gray-600 transition-colors",children:"+  "})]}),m&&i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",value:x,onChange:E=>b(E.target.value),placeholder:"  ",className:"flex-1 px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",onKeyPress:E=>E.key==="Enter"&&(E.preventDefault(),Te())}),i.jsx("button",{type:"button",onClick:Te,className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:""})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[i.jsx(sh,{className:"w-4 h-4 inline mr-1"})," "]}),i.jsxs("select",{value:_.recurrence,onChange:E=>he("recurrence",E.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[i.jsx("option",{value:"none",children:" "}),i.jsx("option",{value:"daily",children:""}),i.jsx("option",{value:"weekly",children:""}),i.jsx("option",{value:"monthly",children:""}),i.jsx("option",{value:"yearly",children:""})]})]}),_.recurrence==="weekly"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),i.jsx("select",{value:_.recurrenceDay,onChange:E=>he("recurrenceDay",parseInt(E.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:Z.map(E=>i.jsx("option",{value:E.value,children:E.label},E.value))})]}),_.recurrence==="monthly"&&i.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 dark:bg-gray-700/30 rounded-xl",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),i.jsxs("div",{className:"flex space-x-4",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",checked:_.monthlyRecurrenceType==="by_date",onChange:()=>$(E=>({...E,monthlyRecurrenceType:"by_date"})),className:"mr-2"}),i.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"  (:  15)"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"radio",checked:_.monthlyRecurrenceType==="by_weekday",onChange:()=>$(E=>({...E,monthlyRecurrenceType:"by_weekday"})),className:"mr-2"}),i.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"  (:   )"})]})]})]}),_.monthlyRecurrenceType==="by_date"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),i.jsxs("select",{value:_.recurrenceDate,onChange:E=>he("recurrenceDate",parseInt(E.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[Array.from({length:31},(E,O)=>O+1).map(E=>i.jsxs("option",{value:E,children:[E,""]},E)),i.jsx("option",{value:-1,children:""})]})]}),_.monthlyRecurrenceType==="by_weekday"&&i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),i.jsxs("select",{value:_.weekOfMonth,onChange:E=>he("weekOfMonth",parseInt(E.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[i.jsx("option",{value:1,children:""}),i.jsx("option",{value:2,children:""}),i.jsx("option",{value:3,children:""}),i.jsx("option",{value:4,children:""}),i.jsx("option",{value:-1,children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),i.jsx("select",{value:_.recurrenceDay,onChange:E=>he("recurrenceDay",parseInt(E.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:Z.map(E=>i.jsx("option",{value:E.value,children:E.label},E.value))})]})]})]}),_.recurrence!=="none"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),i.jsxs("select",{value:_.holidayHandling,onChange:E=>he("holidayHandling",E.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[i.jsx("option",{value:"show",children:"  ()"}),i.jsx("option",{value:"skip",children:" (  )"}),i.jsx("option",{value:"next_day",children:"  "}),i.jsx("option",{value:"prev_day",children:"  "})]}),i.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"*       ."})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:[i.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:""}),i.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[i.jsx(Bt,{className:"w-4 h-4"}),""]})]})]})]})})]}),i.jsx(ZS,{isOpen:S,onClose:()=>R(!1),onSelectTemplate:ve})]}):null},ej=({searchTerm:s,onSearchChange:t,priorityFilter:r,onPriorityFilterChange:l,typeFilter:c,onTypeFilterChange:u,projectFilter:h,onProjectFilterChange:g,tagFilter:m,onTagFilterChange:p,completionDateFilter:x,onCompletionDateFilterChange:b,onClearFilters:w,searchInputRef:L,availableTags:T})=>{const[U,Y]=I.useState(!1),k=r!=="all"||c!=="all"||h!=="all"||s.length>0||m.length>0||x!=="all",S=R=>{m.includes(R)?p(m.filter(D=>D!==R)):p([...m,R])};return i.jsxs("div",{className:"mb-6 relative z-30",children:[i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("div",{className:"relative flex-1 group",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(qw,{className:"h-4 w-4 text-gray-400 group-focus-within:text-blue-500 transition-colors"})}),i.jsx("input",{ref:L,type:"text",value:s,onChange:R=>t(R.target.value),className:"block w-full pl-10 pr-3 py-2.5 bg-white/50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 backdrop-blur-sm transition-all duration-200 text-sm placeholder-gray-400 dark:text-white shadow-sm hover:bg-white/80 dark:hover:bg-gray-800/80",placeholder:" ..."})]}),i.jsxs("button",{onClick:()=>Y(!U),className:`flex items-center gap-2 px-4 py-2.5 rounded-xl border transition-all duration-200 ${k||U?"bg-blue-500 text-white border-blue-600 shadow-md shadow-blue-500/20":"bg-white/50 dark:bg-gray-800/50 border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-300 hover:bg-white dark:hover:bg-gray-800 backdrop-blur-sm shadow-sm"}`,children:[i.jsx(Zp,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm font-medium hidden sm:inline",children:""}),k&&i.jsx("span",{className:"bg-white/20 text-white text-[10px] px-1.5 py-0.5 rounded-full font-bold",children:"ON"})]}),k&&i.jsx("button",{onClick:w,className:"flex items-center justify-center w-10 h-10 rounded-xl bg-gray-100 text-gray-500 hover:bg-red-50 hover:text-red-500 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-red-900/30 dark:hover:text-red-400 transition-colors border border-transparent hover:border-red-200 dark:hover:border-red-800",title:" ",children:i.jsx(jt,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:`
        absolute top-full left-0 right-0 mt-2 p-5 
        glass-panel shadow-xl transform origin-top transition-all duration-300 ease-out
        ${U?"opacity-100 scale-100 translate-y-0":"opacity-0 scale-95 -translate-y-2 pointer-events-none"}
      `,children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-6",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:""}),i.jsxs("select",{value:r,onChange:R=>l(R.target.value),className:"w-full px-3 py-2 bg-white/50 dark:bg-gray-900/50 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 text-sm transition-colors",children:[i.jsx("option",{value:"all",children:""}),i.jsx("option",{value:"urgent",children:" "}),i.jsx("option",{value:"high",children:" "}),i.jsx("option",{value:"medium",children:" "}),i.jsx("option",{value:"low",children:" "})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:""}),i.jsxs("select",{value:c,onChange:R=>u(R.target.value),className:"w-full px-3 py-2 bg-white/50 dark:bg-gray-900/50 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 text-sm transition-colors",children:[i.jsx("option",{value:"all",children:""}),i.jsx("option",{value:"simple",children:"  "}),i.jsx("option",{value:"project",children:" "})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:" "}),i.jsxs("select",{value:h,onChange:R=>g(R.target.value),className:"w-full px-3 py-2 bg-white/50 dark:bg-gray-900/50 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 text-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:c!=="project"&&c!=="all",children:[i.jsx("option",{value:"all",children:""}),i.jsx("option",{value:"longterm",children:"  "}),i.jsx("option",{value:"shortterm",children:"  "})]})]}),i.jsxs("div",{className:"space-y-2 sm:col-span-2 lg:col-span-1",children:[i.jsxs("label",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider flex items-center gap-1",children:[i.jsx(To,{className:"w-3 h-3"}),""]}),i.jsx("div",{className:"p-2 bg-white/50 dark:bg-gray-900/50 border border-gray-200 dark:border-gray-700 rounded-lg max-h-32 overflow-y-auto custom-scrollbar",children:T.length>0?i.jsx("div",{className:"space-y-1",children:T.map(R=>i.jsxs("label",{className:"flex items-center gap-2 px-2 py-1.5 hover:bg-gray-100 dark:hover:bg-gray-800 rounded cursor-pointer transition-colors",children:[i.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${m.includes(R)?"bg-blue-500 border-blue-500 text-white":"border-gray-300 dark:border-gray-600"}`,children:m.includes(R)&&i.jsx(gs,{className:"w-3 h-3"})}),i.jsx("input",{type:"checkbox",checked:m.includes(R),onChange:()=>S(R),className:"hidden"}),i.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 truncate",children:R})]},R))}):i.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center py-2",children:" "})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("label",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider flex items-center gap-1",children:[i.jsx(mt,{className:"w-3 h-3"}),""]}),i.jsxs("select",{value:x,onChange:R=>b(R.target.value),className:"w-full px-3 py-2 bg-white/50 dark:bg-gray-900/50 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 text-sm transition-colors",children:[i.jsx("option",{value:"all",children:""}),i.jsx("option",{value:"today",children:" "}),i.jsx("option",{value:"yesterday",children:" "}),i.jsx("option",{value:"thisWeek",children:"  "}),i.jsx("option",{value:"lastWeek",children:"  "}),i.jsx("option",{value:"thisMonth",children:"  "})]})]})]}),k&&i.jsx("div",{className:"mt-5 pt-4 border-t border-gray-200/50 dark:border-gray-700/50",children:i.jsxs("div",{className:"flex flex-wrap gap-2",children:[m.length>0&&i.jsxs("div",{className:"flex items-center gap-1 px-2.5 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-full text-xs font-medium border border-blue-200 dark:border-blue-800",children:[i.jsx(To,{className:"w-3 h-3"}),m.length," "]}),x!=="all"&&i.jsxs("div",{className:"flex items-center gap-1 px-2.5 py-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded-full text-xs font-medium border border-green-200 dark:border-green-800",children:[i.jsx(mt,{className:"w-3 h-3"}),x==="today"&&" ",x==="yesterday"&&" ",x==="thisWeek"&&"  ",x==="lastWeek"&&"  ",x==="thisMonth"&&"  "]})]})})]})]})},tj=({currentView:s,isSidebarOpen:t,onToggleSidebar:r,searchInputRef:l,isMobile:c})=>{const{currentUser:u}=Nn(),{allTags:h}=Qt(),[g,m]=I.useState(!1),[p,x]=I.useState(null),[b,w]=I.useState(new Date),[L,T]=I.useState(""),[U,Y]=I.useState("all"),[k,S]=I.useState("all"),[R,D]=I.useState("all"),[_,$]=I.useState([]),[C,ee]=I.useState("all"),ie=Ee=>{w(Ee)},xe=()=>{w(s==="week"?Ee=>py(Ee):s==="month"?Ee=>xy(Ee):Ee=>gy(Ee))},_e=()=>{w(s==="week"?Ee=>yy(Ee,1):s==="month"?Ee=>by(Ee,1):Ee=>Ll(Ee,1))},ve=()=>{w(new Date)},he=()=>{T(""),Y("all"),S("all"),D("all"),$([]),ee("all")},Te=Ee=>{x(Ee)};return i.jsxs("main",{className:`flex-1 min-w-0 transition-all duration-300 ease-in-out ${t?"lg:ml-64":"lg:ml-20"}`,children:[i.jsx("header",{className:"bg-white/70 dark:bg-gray-900/70 backdrop-blur-md border-b border-white/20 dark:border-white/10 sticky top-0 z-20",children:i.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 py-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-lg lg:hidden",children:i.jsx(Fw,{className:"w-6 h-6 text-gray-600"})}),i.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[s==="today"&&"Today",s==="week"&&"Weekly Calendar",s==="month"&&"Monthly Calendar",s==="settings"&&"Settings",s==="analytics"&&"Analytics",s==="recurring"&&"Recurring Tasks",s==="history"&&"History",s==="vacation"&&"Vacation Management"]})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("button",{onClick:()=>m(!0),className:"hidden sm:flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors shadow-sm hover:shadow-md",children:[i.jsx(Bt,{className:"w-5 h-5"}),i.jsx("span",{className:"font-medium",children:" "})]}),i.jsx("div",{className:"h-8 w-px bg-gray-200 hidden sm:block"}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"text-right hidden sm:block",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:u?.displayName||"User"}),i.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:u?.email||"user@example.com"})]}),i.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-100 flex items-center justify-center overflow-hidden border border-indigo-200",children:u?.photoURL?i.jsx("img",{src:u.photoURL,alt:"Profile",className:"w-full h-full object-cover"}):i.jsx(Yo,{className:"w-6 h-6 text-indigo-600"})})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"w-full",children:i.jsx(ej,{searchTerm:L,onSearchChange:T,priorityFilter:U,onPriorityFilterChange:Y,typeFilter:k,onTypeFilterChange:S,projectFilter:R,onProjectFilterChange:D,tagFilter:_,onTagFilterChange:$,completionDateFilter:C,onCompletionDateFilterChange:ee,onClearFilters:he,availableTags:h,searchInputRef:l})}),(s==="today"||s==="week"||s==="month")&&i.jsxs("div",{className:"flex items-center justify-center gap-4 glass-panel p-2",children:[i.jsx("button",{onClick:xe,className:"p-1 hover:bg-gray-200 rounded-full",children:i.jsx(Po,{className:"w-5 h-5 text-gray-600"})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(mt,{className:"w-5 h-5 text-indigo-600"}),i.jsx("span",{className:"text-lg font-medium text-gray-900 dark:text-white",children:s==="week"?`${Lt(dh(b,{weekStartsOn:0}),"M d",{locale:gn})} - ${Lt(uh(b,{weekStartsOn:0}),"M d",{locale:gn})}`:s==="month"?Lt(b,"yyyy M",{locale:gn}):Lt(b,"yyyy M d (EEE)",{locale:gn})})]}),i.jsx("button",{onClick:_e,className:"p-1 hover:bg-gray-200 rounded-full",children:i.jsx(ws,{className:"w-5 h-5 text-gray-600"})}),i.jsx("button",{onClick:ve,className:"px-3 py-1 text-sm font-medium text-indigo-600 dark:text-indigo-400 hover:bg-indigo-50 dark:hover:bg-indigo-900/30 rounded-md border border-indigo-200 dark:border-indigo-500/30 ml-2",children:"Today"})]})]})]})}),i.jsx("div",{className:"p-4 sm:p-6 lg:p-8 max-w-[1920px] mx-auto",children:s==="today"?i.jsx(th,{currentView:"today",searchTerm:L,priorityFilter:U,typeFilter:k,projectFilter:R,tagFilter:_,completionDateFilter:C,selectedDate:b,onDateChange:ie,onEdit:Te}):s==="week"?i.jsx(HS,{currentDate:b,onDateChange:ie,searchTerm:L,priorityFilter:U,typeFilter:k,projectFilter:R,tagFilter:_,completionDateFilter:C,onAddTodo:()=>m(!0),isMobile:c}):s==="month"?i.jsxs("div",{className:"space-y-8",children:[i.jsx($S,{currentDate:b,onDateChange:ie,searchTerm:L,priorityFilter:U,typeFilter:k,projectFilter:R,tagFilter:_,completionDateFilter:C,onAddTodo:()=>m(!0),isMobile:c}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[i.jsx(th,{currentView:"month",onEdit:Te}),i.jsx("div",{className:"hidden lg:block",children:i.jsx(Pp,{})})]})]}):s==="analytics"?i.jsxs("div",{className:"w-full space-y-8",children:[i.jsx(zS,{}),i.jsx(Pp,{})]}):s==="recurring"?i.jsx(qS,{}):s==="history"?i.jsx(GS,{searchTerm:L,priorityFilter:U,typeFilter:k,projectFilter:R,tagFilter:_}):s==="vacation"?i.jsx(VS,{}):s==="settings"?i.jsx(XS,{}):null}),i.jsx("div",{className:"md:hidden",children:i.jsx(lb,{onClick:()=>m(!0)})}),i.jsx(JS,{isOpen:g,onClose:()=>m(!1)}),p&&i.jsx(Ph,{isOpen:!!p,onClose:()=>x(null),todo:p})]})},nj=I.lazy(()=>ua(()=>import("./LoginScreen-BISThNY4.js"),__vite__mapDeps([5,2,3,1,4]),import.meta.url)),aj=I.lazy(()=>ua(()=>import("./Sidebar-EULcEUey.js"),__vite__mapDeps([6,2,3,1,4]),import.meta.url)),rj=I.lazy(()=>ua(()=>import("./PWAInstallPrompt-P4vCKElr.js"),__vite__mapDeps([7,2,3,1,4]),import.meta.url));I.lazy(()=>ua(()=>Promise.resolve().then(()=>KS),void 0,import.meta.url));const sj=I.lazy(()=>ua(()=>import("./ErrorBoundary-D0pCXtt5.js"),__vite__mapDeps([8,2,3,1,4]),import.meta.url)),lj=I.lazy(()=>ua(()=>import("./OfflineNotification-bx3vzkQ9.js"),__vite__mapDeps([9,2,3,1,4]),import.meta.url)),ij=I.lazy(()=>ua(()=>import("./BottomNavigation-Mz7_Nk7V.js"),__vite__mapDeps([10,2,3,1,4]),import.meta.url)),Vh=()=>i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50 dark:bg-gray-900",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});function oj({currentView:s,setCurrentView:t,isSidebarOpen:r,setIsSidebarOpen:l,searchInputRef:c,addTodoModalRef:u,isMobile:h,forceMobile:g,setForceMobile:m}){const p=nS("AppInner");return J1(),I.useEffect(()=>p,[]),i.jsx(I.Suspense,{fallback:i.jsx(Vh,{}),children:i.jsxs("div",{className:`h-screen flex bg-gray-50 dark:bg-gray-900 ${h?"flex-col":""}`,children:[h&&r&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40",onClick:()=>l(!1)}),i.jsx(aj,{currentView:s,onViewChange:t,isOpen:r,onToggle:()=>l(!r),isMobile:h,forceMobile:g,onToggleForceMobile:m}),i.jsx("div",{className:`flex-1 flex flex-col min-w-0 overflow-y-auto overflow-x-hidden ${h?"pb-20":""}`,children:i.jsx(tj,{currentView:s,isSidebarOpen:r,onToggleSidebar:()=>l(!r),searchInputRef:c,addTodoModalRef:u,isMobile:h})}),h&&i.jsx(ij,{currentView:s,onViewChange:t,onToggleSidebar:()=>l(!0)}),i.jsx(lj,{}),i.jsx(rj,{})]})})}function cj(){const{currentUser:s,loading:t}=Nn(),[r,l]=I.useState("today"),[c,u]=I.useState(!0),[h,g]=I.useState(!1),[m,p]=I.useState(null),x=I.useRef(null),b=I.useRef(null);I.useEffect(()=>{iS(),Gp();const S=setInterval(()=>{tS.measureMemoryUsage()},5e3),R=setInterval(()=>{nb.getErrorStats().total>0},1e4),D=setInterval(()=>{const $=Gp().checks.filter(C=>C.status==="fail");$.length>0&&Ce.error("Critical security issues detected:",$)},3e4);return()=>{clearInterval(S),clearInterval(R),clearInterval(D)}},[]),I.useEffect(()=>{const S=()=>{const $=window.innerWidth;if(m!==null){g(m),u(!m);return}const C=$<=768,ee="ontouchstart"in window||navigator.maxTouchPoints>0,ie=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),xe=$>768&&$<=1024&&ee,_e=window.matchMedia("(max-width: 768px)").matches,ve=window.matchMedia("(pointer: coarse)").matches,he=$<=500&&ee&&ie||ee&&ie&&window.devicePixelRatio>=2||navigator.userAgent.includes("iPhone")||navigator.userAgent.includes("Android")||_e&&ee||ve&&ie;let Te=!1;he||_e||C||xe?Te=!0:Te=!1,g(Te),u(!Te)};S();let R;const D=()=>{clearTimeout(R),R=setTimeout(S,100)};window.addEventListener("resize",D),window.addEventListener("orientationchange",()=>{setTimeout(S,200)});const _=setTimeout(S,300);return()=>{window.removeEventListener("resize",D),window.removeEventListener("orientationchange",S),clearTimeout(R),clearTimeout(_)}},[m]);const w=()=>{b.current?.open()},L=()=>{x.current?.focus()},T=()=>{u(!c)},U=()=>{l("today")},Y=()=>{l("week")},k=()=>{l("month")};return t?i.jsx(Vh,{}):s?i.jsx("div",{children:i.jsx(Q1,{onOpenAddTodo:w,onFocusSearch:L,onToggleSidebar:T,onSwitchToTodayView:U,onSwitchToWeekView:Y,onSwitchToMonthView:k,children:i.jsx(oj,{currentView:r,setCurrentView:l,isSidebarOpen:c,setIsSidebarOpen:u,searchInputRef:x,addTodoModalRef:b,isMobile:h,forceMobile:m,setForceMobile:p})})}):i.jsx(nj,{})}function dj(){return i.jsx(I.Suspense,{fallback:i.jsx(Vh,{}),children:i.jsx(sj,{children:i.jsx(Mk,{children:i.jsx(kk,{children:i.jsx(Z1,{children:i.jsx(W1,{children:i.jsx(Ck,{children:i.jsx(Ok,{children:i.jsx(cj,{})})})})})})})})})}D_.createRoot(document.getElementById("root")).render(i.jsx(I.StrictMode,{children:i.jsx(dj,{})}));export{ep as P,Ty as W,Oy as a,Qt as b,Yh as c,mj as d,nb as e,Ce as f,Jm as g,Ba as i,i as j,Nn as u};
