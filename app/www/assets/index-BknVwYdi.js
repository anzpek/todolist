const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./LoginScreen-CbIkiRta.js","./icons-CpcCsFSF.js","./react-DJG_os-6.js","./firebase-BUAVoIHS.js","./date-CFbvH-ln.js","./Sidebar-D1PGWEuW.js","./PWAInstallPrompt-DJFxaMQ9.js","./ErrorBoundary-n7WkWmgO.js","./OfflineNotification-D02yQjhr.js","./BottomNavigation-BxSfy3al.js"])))=>i.map(i=>d[i]);
import{r as O,P as Bt,C as gs,X as St,a as zp,A as iw,R as Ju,S as _o,T as an,b as Hp,c as eh,d as Lu,F as Gl,U as Yo,e as mt,f as fo,g as La,h as $p,i as Bp,M as th,j as zu,k as Fo,l as bs,m as ow,n as cw,o as dw,p as uw,q as hw,s as fw,Z as gw,t as mw,L as qp,u as nh,v as Om,w as pw,x as xu,y as ko,z as Yp,B as Mm,D as yw,E as xw,G as bw,H as vw,I as ww,J as _w,K as kw,N as Nw,O as Tw,Q as jw,V as Sw,W as Im,Y as Dw,_ as Ew,$ as Cw,a0 as Aw}from"./icons-CpcCsFSF.js";import{r as Rw,a as Fp}from"./react-DJG_os-6.js";import{_ as Gp,C as Vp,r as No,S as Wp,a as Pp,F as Ow,g as Qp,b as Va,c as Xp,d as Kp,i as ah,p as Zp,u as Jp,e as ey,f as ty,h as ny,j as Mw,k as Iw,G as Uw,o as Lw,s as zw,l as Hw,m as $w,n as Bw,q as qw,t as Yw,v as et,w as Mt,x as za,y as Nt,z as bt,A as Dn,B as bu,D as Ua,E as jl,H as bo,I as ur,J as Sl,K as go,L as Fw,M as Um,N as Gw,O as fe,P as Tt,Q as rh,R as da,T as ms,U as To,V as Vw,W as Ww,X as Pw,Y as Vl,Z as sh,$ as Qw,a0 as lh,a1 as Xw,a2 as Kw,a3 as Zw,a4 as Lm,a5 as ay,a6 as Jw,a7 as e_,a8 as Go,a9 as t_,aa as n_,ab as a_}from"./firebase-BUAVoIHS.js";import{b as vu,a as xl,c as bl,d as r_,i as zm,s as wu,e as s_,f as Ml,g as Ut,h as ry,j as ih,k as oh,l as sy,m as l_,n as Hu,o as ly,p as iy,q as jo,r as i_,t as o_,u as c_,v as Hm,w as oy,x as cy}from"./date-CFbvH-ln.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))i(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function r(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(c){if(c.ep)return;c.ep=!0;const u=r(c);fetch(c.href,u)}})();var _u={exports:{}},vl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $m;function d_(){if($m)return vl;$m=1;var s=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function r(i,c,u){var f=null;if(u!==void 0&&(f=""+u),c.key!==void 0&&(f=""+c.key),"key"in c){u={};for(var g in c)g!=="key"&&(u[g]=c[g])}else u=c;return c=u.ref,{$$typeof:s,type:i,key:f,ref:c!==void 0?c:null,props:u}}return vl.Fragment=n,vl.jsx=r,vl.jsxs=r,vl}var Bm;function u_(){return Bm||(Bm=1,_u.exports=d_()),_u.exports}var l=u_(),ku={exports:{}},wl={},Nu={exports:{}},Tu={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qm;function h_(){return qm||(qm=1,function(s){function n(P,ce){var pe=P.length;P.push(ce);e:for(;0<pe;){var R=pe-1>>>1,re=P[R];if(0<c(re,ce))P[R]=ce,P[pe]=re,pe=R;else break e}}function r(P){return P.length===0?null:P[0]}function i(P){if(P.length===0)return null;var ce=P[0],pe=P.pop();if(pe!==ce){P[0]=pe;e:for(var R=0,re=P.length,C=re>>>1;R<C;){var M=2*(R+1)-1,Q=P[M],xe=M+1,X=P[xe];if(0>c(Q,pe))xe<re&&0>c(X,Q)?(P[R]=X,P[xe]=pe,R=xe):(P[R]=Q,P[M]=pe,R=M);else if(xe<re&&0>c(X,pe))P[R]=X,P[xe]=pe,R=xe;else break e}}return ce}function c(P,ce){var pe=P.sortIndex-ce.sortIndex;return pe!==0?pe:P.id-ce.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var f=Date,g=f.now();s.unstable_now=function(){return f.now()-g}}var m=[],p=[],x=1,b=null,w=3,L=!1,T=!1,z=!1,W=!1,k=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;function D(P){for(var ce=r(p);ce!==null;){if(ce.callback===null)i(p);else if(ce.startTime<=P)i(p),ce.sortIndex=ce.expirationTime,n(m,ce);else break;ce=r(p)}}function _(P){if(z=!1,D(P),!T)if(r(m)!==null)T=!0,H||(H=!0,_e());else{var ce=r(p);ce!==null&&Ae(_,ce.startTime-P)}}var H=!1,I=-1,le=5,ie=-1;function be(){return W?!0:!(s.unstable_now()-ie<le)}function Ee(){if(W=!1,H){var P=s.unstable_now();ie=P;var ce=!0;try{e:{T=!1,z&&(z=!1,S(I),I=-1),L=!0;var pe=w;try{t:{for(D(P),b=r(m);b!==null&&!(b.expirationTime>P&&be());){var R=b.callback;if(typeof R=="function"){b.callback=null,w=b.priorityLevel;var re=R(b.expirationTime<=P);if(P=s.unstable_now(),typeof re=="function"){b.callback=re,D(P),ce=!0;break t}b===r(m)&&i(m),D(P)}else i(m);b=r(m)}if(b!==null)ce=!0;else{var C=r(p);C!==null&&Ae(_,C.startTime-P),ce=!1}}break e}finally{b=null,w=pe,L=!1}ce=void 0}}finally{ce?_e():H=!1}}}var _e;if(typeof A=="function")_e=function(){A(Ee)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,je=ge.port2;ge.port1.onmessage=Ee,_e=function(){je.postMessage(null)}}else _e=function(){k(Ee,0)};function Ae(P,ce){I=k(function(){P(s.unstable_now())},ce)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(P){P.callback=null},s.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):le=0<P?Math.floor(1e3/P):5},s.unstable_getCurrentPriorityLevel=function(){return w},s.unstable_next=function(P){switch(w){case 1:case 2:case 3:var ce=3;break;default:ce=w}var pe=w;w=ce;try{return P()}finally{w=pe}},s.unstable_requestPaint=function(){W=!0},s.unstable_runWithPriority=function(P,ce){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var pe=w;w=P;try{return ce()}finally{w=pe}},s.unstable_scheduleCallback=function(P,ce,pe){var R=s.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?R+pe:R):pe=R,P){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=pe+re,P={id:x++,callback:ce,priorityLevel:P,startTime:pe,expirationTime:re,sortIndex:-1},pe>R?(P.sortIndex=pe,n(p,P),r(m)===null&&P===r(p)&&(z?(S(I),I=-1):z=!0,Ae(_,pe-R))):(P.sortIndex=re,n(m,P),T||L||(T=!0,H||(H=!0,_e()))),P},s.unstable_shouldYield=be,s.unstable_wrapCallback=function(P){var ce=w;return function(){var pe=w;w=ce;try{return P.apply(this,arguments)}finally{w=pe}}}}(Tu)),Tu}var Ym;function f_(){return Ym||(Ym=1,Nu.exports=h_()),Nu.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fm;function g_(){if(Fm)return wl;Fm=1;var s=f_(),n=Rw(),r=Fp();function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function u(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(a=t.return),e=t.return;while(e)}return t.tag===3?a:null}function f(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(u(e)!==e)throw Error(i(188))}function m(e){var t=e.alternate;if(!t){if(t=u(e),t===null)throw Error(i(188));return t!==e?null:e}for(var a=e,o=t;;){var d=a.return;if(d===null)break;var h=d.alternate;if(h===null){if(o=d.return,o!==null){a=o;continue}break}if(d.child===h.child){for(h=d.child;h;){if(h===a)return g(d),e;if(h===o)return g(d),t;h=h.sibling}throw Error(i(188))}if(a.return!==o.return)a=d,o=h;else{for(var y=!1,v=d.child;v;){if(v===a){y=!0,a=d,o=h;break}if(v===o){y=!0,o=d,a=h;break}v=v.sibling}if(!y){for(v=h.child;v;){if(v===a){y=!0,a=h,o=d;break}if(v===o){y=!0,o=h,a=d;break}v=v.sibling}if(!y)throw Error(i(189))}}if(a.alternate!==o)throw Error(i(190))}if(a.tag!==3)throw Error(i(188));return a.stateNode.current===a?e:t}function p(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=p(e),t!==null)return t;e=e.sibling}return null}var x=Object.assign,b=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),L=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),W=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),S=Symbol.for("react.consumer"),A=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),le=Symbol.for("react.lazy"),ie=Symbol.for("react.activity"),be=Symbol.for("react.memo_cache_sentinel"),Ee=Symbol.iterator;function _e(e){return e===null||typeof e!="object"?null:(e=Ee&&e[Ee]||e["@@iterator"],typeof e=="function"?e:null)}var ge=Symbol.for("react.client.reference");function je(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===ge?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case T:return"Fragment";case W:return"Profiler";case z:return"StrictMode";case _:return"Suspense";case H:return"SuspenseList";case ie:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case L:return"Portal";case A:return(e.displayName||"Context")+".Provider";case S:return(e._context.displayName||"Context")+".Consumer";case D:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case I:return t=e.displayName||null,t!==null?t:je(e.type)||"Memo";case le:t=e._payload,e=e._init;try{return je(e(t))}catch{}}return null}var Ae=Array.isArray,P=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe={pending:!1,data:null,method:null,action:null},R=[],re=-1;function C(e){return{current:e}}function M(e){0>re||(e.current=R[re],R[re]=null,re--)}function Q(e,t){re++,R[re]=e.current,e.current=t}var xe=C(null),X=C(null),ue=C(null),K=C(null);function ee(e,t){switch(Q(ue,t),Q(X,e),Q(xe,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?im(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=im(t),e=om(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}M(xe),Q(xe,e)}function oe(){M(xe),M(X),M(ue)}function Ne(e){e.memoizedState!==null&&Q(K,e);var t=xe.current,a=om(t,e.type);t!==a&&(Q(X,e),Q(xe,a))}function de(e){X.current===e&&(M(xe),M(X)),K.current===e&&(M(K),fl._currentValue=pe)}var Le=Object.prototype.hasOwnProperty,tt=s.unstable_scheduleCallback,st=s.unstable_cancelCallback,Xe=s.unstable_shouldYield,Vt=s.unstable_requestPaint,Dt=s.unstable_now,sc=s.unstable_getCurrentPriorityLevel,Jl=s.unstable_ImmediatePriority,ei=s.unstable_UserBlockingPriority,_r=s.unstable_NormalPriority,lc=s.unstable_LowPriority,ti=s.unstable_IdlePriority,j=s.log,G=s.unstable_setDisableYieldValue,q=null,Y=null;function se(e){if(typeof j=="function"&&G(e),Y&&typeof Y.setStrictMode=="function")try{Y.setStrictMode(q,e)}catch{}}var ne=Math.clz32?Math.clz32:ye,J=Math.log,Se=Math.LN2;function ye(e){return e>>>=0,e===0?32:31-(J(e)/Se|0)|0}var me=256,ke=4194304;function he(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function we(e,t,a){var o=e.pendingLanes;if(o===0)return 0;var d=0,h=e.suspendedLanes,y=e.pingedLanes;e=e.warmLanes;var v=o&134217727;return v!==0?(o=v&~h,o!==0?d=he(o):(y&=v,y!==0?d=he(y):a||(a=v&~e,a!==0&&(d=he(a))))):(v=o&~h,v!==0?d=he(v):y!==0?d=he(y):a||(a=o&~e,a!==0&&(d=he(a)))),d===0?0:t!==0&&t!==d&&(t&h)===0&&(h=d&-d,a=t&-t,h>=a||h===32&&(a&4194048)!==0)?t:d}function ze(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function qt(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ha(){var e=me;return me<<=1,(me&4194048)===0&&(me=256),e}function Fh(){var e=ke;return ke<<=1,(ke&62914560)===0&&(ke=4194304),e}function ic(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function ks(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Qx(e,t,a,o,d,h){var y=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var v=e.entanglements,N=e.expirationTimes,B=e.hiddenUpdates;for(a=y&~a;0<a;){var Z=31-ne(a),ae=1<<Z;v[Z]=0,N[Z]=-1;var F=B[Z];if(F!==null)for(B[Z]=null,Z=0;Z<F.length;Z++){var V=F[Z];V!==null&&(V.lane&=-536870913)}a&=~ae}o!==0&&Gh(e,o,0),h!==0&&d===0&&e.tag!==0&&(e.suspendedLanes|=h&~(y&~t))}function Gh(e,t,a){e.pendingLanes|=t,e.suspendedLanes&=~t;var o=31-ne(t);e.entangledLanes|=t,e.entanglements[o]=e.entanglements[o]|1073741824|a&4194090}function Vh(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var o=31-ne(a),d=1<<o;d&t|e[o]&t&&(e[o]|=t),a&=~d}}function oc(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function cc(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Wh(){var e=ce.p;return e!==0?e:(e=window.event,e===void 0?32:Sm(e.type))}function Xx(e,t){var a=ce.p;try{return ce.p=e,t()}finally{ce.p=a}}var fa=Math.random().toString(36).slice(2),Yt="__reactFiber$"+fa,Xt="__reactProps$"+fa,kr="__reactContainer$"+fa,dc="__reactEvents$"+fa,Kx="__reactListeners$"+fa,Zx="__reactHandles$"+fa,Ph="__reactResources$"+fa,Ns="__reactMarker$"+fa;function uc(e){delete e[Yt],delete e[Xt],delete e[dc],delete e[Kx],delete e[Zx]}function Nr(e){var t=e[Yt];if(t)return t;for(var a=e.parentNode;a;){if(t=a[kr]||a[Yt]){if(a=t.alternate,t.child!==null||a!==null&&a.child!==null)for(e=hm(e);e!==null;){if(a=e[Yt])return a;e=hm(e)}return t}e=a,a=e.parentNode}return null}function Tr(e){if(e=e[Yt]||e[kr]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function Ts(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(i(33))}function jr(e){var t=e[Ph];return t||(t=e[Ph]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Et(e){e[Ns]=!0}var Qh=new Set,Xh={};function Pa(e,t){Sr(e,t),Sr(e+"Capture",t)}function Sr(e,t){for(Xh[e]=t,e=0;e<t.length;e++)Qh.add(t[e])}var Jx=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Kh={},Zh={};function eb(e){return Le.call(Zh,e)?!0:Le.call(Kh,e)?!1:Jx.test(e)?Zh[e]=!0:(Kh[e]=!0,!1)}function ni(e,t,a){if(eb(t))if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var o=t.toLowerCase().slice(0,5);if(o!=="data-"&&o!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+a)}}function ai(e,t,a){if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+a)}}function Fn(e,t,a,o){if(o===null)e.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttributeNS(t,a,""+o)}}var hc,Jh;function Dr(e){if(hc===void 0)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);hc=t&&t[1]||"",Jh=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+hc+e+Jh}var fc=!1;function gc(e,t){if(!e||fc)return"";fc=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var o={DetermineComponentFrameRoot:function(){try{if(t){var ae=function(){throw Error()};if(Object.defineProperty(ae.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ae,[])}catch(V){var F=V}Reflect.construct(e,[],ae)}else{try{ae.call()}catch(V){F=V}e.call(ae.prototype)}}else{try{throw Error()}catch(V){F=V}(ae=e())&&typeof ae.catch=="function"&&ae.catch(function(){})}}catch(V){if(V&&F&&typeof V.stack=="string")return[V.stack,F.stack]}return[null,null]}};o.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(o.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(o.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var h=o.DetermineComponentFrameRoot(),y=h[0],v=h[1];if(y&&v){var N=y.split(`
`),B=v.split(`
`);for(d=o=0;o<N.length&&!N[o].includes("DetermineComponentFrameRoot");)o++;for(;d<B.length&&!B[d].includes("DetermineComponentFrameRoot");)d++;if(o===N.length||d===B.length)for(o=N.length-1,d=B.length-1;1<=o&&0<=d&&N[o]!==B[d];)d--;for(;1<=o&&0<=d;o--,d--)if(N[o]!==B[d]){if(o!==1||d!==1)do if(o--,d--,0>d||N[o]!==B[d]){var Z=`
`+N[o].replace(" at new "," at ");return e.displayName&&Z.includes("<anonymous>")&&(Z=Z.replace("<anonymous>",e.displayName)),Z}while(1<=o&&0<=d);break}}}finally{fc=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?Dr(a):""}function tb(e){switch(e.tag){case 26:case 27:case 5:return Dr(e.type);case 16:return Dr("Lazy");case 13:return Dr("Suspense");case 19:return Dr("SuspenseList");case 0:case 15:return gc(e.type,!1);case 11:return gc(e.type.render,!1);case 1:return gc(e.type,!0);case 31:return Dr("Activity");default:return""}}function ef(e){try{var t="";do t+=tb(e),e=e.return;while(e);return t}catch(a){return`
Error generating stack: `+a.message+`
`+a.stack}}function gn(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function tf(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function nb(e){var t=tf(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),o=""+e[t];if(!e.hasOwnProperty(t)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var d=a.get,h=a.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return d.call(this)},set:function(y){o=""+y,h.call(this,y)}}),Object.defineProperty(e,t,{enumerable:a.enumerable}),{getValue:function(){return o},setValue:function(y){o=""+y},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ri(e){e._valueTracker||(e._valueTracker=nb(e))}function nf(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),o="";return e&&(o=tf(e)?e.checked?"true":"false":e.value),e=o,e!==a?(t.setValue(e),!0):!1}function si(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var ab=/[\n"\\]/g;function mn(e){return e.replace(ab,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function mc(e,t,a,o,d,h,y,v){e.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?e.type=y:e.removeAttribute("type"),t!=null?y==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+gn(t)):e.value!==""+gn(t)&&(e.value=""+gn(t)):y!=="submit"&&y!=="reset"||e.removeAttribute("value"),t!=null?pc(e,y,gn(t)):a!=null?pc(e,y,gn(a)):o!=null&&e.removeAttribute("value"),d==null&&h!=null&&(e.defaultChecked=!!h),d!=null&&(e.checked=d&&typeof d!="function"&&typeof d!="symbol"),v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?e.name=""+gn(v):e.removeAttribute("name")}function af(e,t,a,o,d,h,y,v){if(h!=null&&typeof h!="function"&&typeof h!="symbol"&&typeof h!="boolean"&&(e.type=h),t!=null||a!=null){if(!(h!=="submit"&&h!=="reset"||t!=null))return;a=a!=null?""+gn(a):"",t=t!=null?""+gn(t):a,v||t===e.value||(e.value=t),e.defaultValue=t}o=o??d,o=typeof o!="function"&&typeof o!="symbol"&&!!o,e.checked=v?e.checked:!!o,e.defaultChecked=!!o,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(e.name=y)}function pc(e,t,a){t==="number"&&si(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function Er(e,t,a,o){if(e=e.options,t){t={};for(var d=0;d<a.length;d++)t["$"+a[d]]=!0;for(a=0;a<e.length;a++)d=t.hasOwnProperty("$"+e[a].value),e[a].selected!==d&&(e[a].selected=d),d&&o&&(e[a].defaultSelected=!0)}else{for(a=""+gn(a),t=null,d=0;d<e.length;d++){if(e[d].value===a){e[d].selected=!0,o&&(e[d].defaultSelected=!0);return}t!==null||e[d].disabled||(t=e[d])}t!==null&&(t.selected=!0)}}function rf(e,t,a){if(t!=null&&(t=""+gn(t),t!==e.value&&(e.value=t),a==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=a!=null?""+gn(a):""}function sf(e,t,a,o){if(t==null){if(o!=null){if(a!=null)throw Error(i(92));if(Ae(o)){if(1<o.length)throw Error(i(93));o=o[0]}a=o}a==null&&(a=""),t=a}a=gn(t),e.defaultValue=a,o=e.textContent,o===a&&o!==""&&o!==null&&(e.value=o)}function Cr(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=t;return}}e.textContent=t}var rb=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function lf(e,t,a){var o=t.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?o?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":o?e.setProperty(t,a):typeof a!="number"||a===0||rb.has(t)?t==="float"?e.cssFloat=a:e[t]=(""+a).trim():e[t]=a+"px"}function of(e,t,a){if(t!=null&&typeof t!="object")throw Error(i(62));if(e=e.style,a!=null){for(var o in a)!a.hasOwnProperty(o)||t!=null&&t.hasOwnProperty(o)||(o.indexOf("--")===0?e.setProperty(o,""):o==="float"?e.cssFloat="":e[o]="");for(var d in t)o=t[d],t.hasOwnProperty(d)&&a[d]!==o&&lf(e,d,o)}else for(var h in t)t.hasOwnProperty(h)&&lf(e,h,t[h])}function yc(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sb=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),lb=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function li(e){return lb.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var xc=null;function bc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ar=null,Rr=null;function cf(e){var t=Tr(e);if(t&&(e=t.stateNode)){var a=e[Xt]||null;e:switch(e=t.stateNode,t.type){case"input":if(mc(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),t=a.name,a.type==="radio"&&t!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+mn(""+t)+'"][type="radio"]'),t=0;t<a.length;t++){var o=a[t];if(o!==e&&o.form===e.form){var d=o[Xt]||null;if(!d)throw Error(i(90));mc(o,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(t=0;t<a.length;t++)o=a[t],o.form===e.form&&nf(o)}break e;case"textarea":rf(e,a.value,a.defaultValue);break e;case"select":t=a.value,t!=null&&Er(e,!!a.multiple,t,!1)}}}var vc=!1;function df(e,t,a){if(vc)return e(t,a);vc=!0;try{var o=e(t);return o}finally{if(vc=!1,(Ar!==null||Rr!==null)&&(Gi(),Ar&&(t=Ar,e=Rr,Rr=Ar=null,cf(t),e)))for(t=0;t<e.length;t++)cf(e[t])}}function js(e,t){var a=e.stateNode;if(a===null)return null;var o=a[Xt]||null;if(o===null)return null;a=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(i(231,t,typeof a));return a}var Gn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wc=!1;if(Gn)try{var Ss={};Object.defineProperty(Ss,"passive",{get:function(){wc=!0}}),window.addEventListener("test",Ss,Ss),window.removeEventListener("test",Ss,Ss)}catch{wc=!1}var ga=null,_c=null,ii=null;function uf(){if(ii)return ii;var e,t=_c,a=t.length,o,d="value"in ga?ga.value:ga.textContent,h=d.length;for(e=0;e<a&&t[e]===d[e];e++);var y=a-e;for(o=1;o<=y&&t[a-o]===d[h-o];o++);return ii=d.slice(e,1<o?1-o:void 0)}function oi(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ci(){return!0}function hf(){return!1}function Kt(e){function t(a,o,d,h,y){this._reactName=a,this._targetInst=d,this.type=o,this.nativeEvent=h,this.target=y,this.currentTarget=null;for(var v in e)e.hasOwnProperty(v)&&(a=e[v],this[v]=a?a(h):h[v]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?ci:hf,this.isPropagationStopped=hf,this}return x(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=ci)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=ci)},persist:function(){},isPersistent:ci}),t}var Qa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},di=Kt(Qa),Ds=x({},Qa,{view:0,detail:0}),ib=Kt(Ds),kc,Nc,Es,ui=x({},Ds,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Es&&(Es&&e.type==="mousemove"?(kc=e.screenX-Es.screenX,Nc=e.screenY-Es.screenY):Nc=kc=0,Es=e),kc)},movementY:function(e){return"movementY"in e?e.movementY:Nc}}),ff=Kt(ui),ob=x({},ui,{dataTransfer:0}),cb=Kt(ob),db=x({},Ds,{relatedTarget:0}),Tc=Kt(db),ub=x({},Qa,{animationName:0,elapsedTime:0,pseudoElement:0}),hb=Kt(ub),fb=x({},Qa,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),gb=Kt(fb),mb=x({},Qa,{data:0}),gf=Kt(mb),pb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bb(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=xb[e])?!!t[e]:!1}function jc(){return bb}var vb=x({},Ds,{key:function(e){if(e.key){var t=pb[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=oi(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?yb[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jc,charCode:function(e){return e.type==="keypress"?oi(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?oi(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),wb=Kt(vb),_b=x({},ui,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mf=Kt(_b),kb=x({},Ds,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jc}),Nb=Kt(kb),Tb=x({},Qa,{propertyName:0,elapsedTime:0,pseudoElement:0}),jb=Kt(Tb),Sb=x({},ui,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Db=Kt(Sb),Eb=x({},Qa,{newState:0,oldState:0}),Cb=Kt(Eb),Ab=[9,13,27,32],Sc=Gn&&"CompositionEvent"in window,Cs=null;Gn&&"documentMode"in document&&(Cs=document.documentMode);var Rb=Gn&&"TextEvent"in window&&!Cs,pf=Gn&&(!Sc||Cs&&8<Cs&&11>=Cs),yf=" ",xf=!1;function bf(e,t){switch(e){case"keyup":return Ab.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vf(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Or=!1;function Ob(e,t){switch(e){case"compositionend":return vf(t);case"keypress":return t.which!==32?null:(xf=!0,yf);case"textInput":return e=t.data,e===yf&&xf?null:e;default:return null}}function Mb(e,t){if(Or)return e==="compositionend"||!Sc&&bf(e,t)?(e=uf(),ii=_c=ga=null,Or=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return pf&&t.locale!=="ko"?null:t.data;default:return null}}var Ib={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Ib[e.type]:t==="textarea"}function _f(e,t,a,o){Ar?Rr?Rr.push(o):Rr=[o]:Ar=o,t=Ki(t,"onChange"),0<t.length&&(a=new di("onChange","change",null,a,o),e.push({event:a,listeners:t}))}var As=null,Rs=null;function Ub(e){nm(e,0)}function hi(e){var t=Ts(e);if(nf(t))return e}function kf(e,t){if(e==="change")return t}var Nf=!1;if(Gn){var Dc;if(Gn){var Ec="oninput"in document;if(!Ec){var Tf=document.createElement("div");Tf.setAttribute("oninput","return;"),Ec=typeof Tf.oninput=="function"}Dc=Ec}else Dc=!1;Nf=Dc&&(!document.documentMode||9<document.documentMode)}function jf(){As&&(As.detachEvent("onpropertychange",Sf),Rs=As=null)}function Sf(e){if(e.propertyName==="value"&&hi(Rs)){var t=[];_f(t,Rs,e,bc(e)),df(Ub,t)}}function Lb(e,t,a){e==="focusin"?(jf(),As=t,Rs=a,As.attachEvent("onpropertychange",Sf)):e==="focusout"&&jf()}function zb(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return hi(Rs)}function Hb(e,t){if(e==="click")return hi(t)}function $b(e,t){if(e==="input"||e==="change")return hi(t)}function Bb(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var sn=typeof Object.is=="function"?Object.is:Bb;function Os(e,t){if(sn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var a=Object.keys(e),o=Object.keys(t);if(a.length!==o.length)return!1;for(o=0;o<a.length;o++){var d=a[o];if(!Le.call(t,d)||!sn(e[d],t[d]))return!1}return!0}function Df(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ef(e,t){var a=Df(e);e=0;for(var o;a;){if(a.nodeType===3){if(o=e+a.textContent.length,e<=t&&o>=t)return{node:a,offset:t-e};e=o}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Df(a)}}function Cf(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Cf(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Af(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=si(e.document);t instanceof e.HTMLIFrameElement;){try{var a=typeof t.contentWindow.location.href=="string"}catch{a=!1}if(a)e=t.contentWindow;else break;t=si(e.document)}return t}function Cc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var qb=Gn&&"documentMode"in document&&11>=document.documentMode,Mr=null,Ac=null,Ms=null,Rc=!1;function Rf(e,t,a){var o=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Rc||Mr==null||Mr!==si(o)||(o=Mr,"selectionStart"in o&&Cc(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Ms&&Os(Ms,o)||(Ms=o,o=Ki(Ac,"onSelect"),0<o.length&&(t=new di("onSelect","select",null,t,a),e.push({event:t,listeners:o}),t.target=Mr)))}function Xa(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var Ir={animationend:Xa("Animation","AnimationEnd"),animationiteration:Xa("Animation","AnimationIteration"),animationstart:Xa("Animation","AnimationStart"),transitionrun:Xa("Transition","TransitionRun"),transitionstart:Xa("Transition","TransitionStart"),transitioncancel:Xa("Transition","TransitionCancel"),transitionend:Xa("Transition","TransitionEnd")},Oc={},Of={};Gn&&(Of=document.createElement("div").style,"AnimationEvent"in window||(delete Ir.animationend.animation,delete Ir.animationiteration.animation,delete Ir.animationstart.animation),"TransitionEvent"in window||delete Ir.transitionend.transition);function Ka(e){if(Oc[e])return Oc[e];if(!Ir[e])return e;var t=Ir[e],a;for(a in t)if(t.hasOwnProperty(a)&&a in Of)return Oc[e]=t[a];return e}var Mf=Ka("animationend"),If=Ka("animationiteration"),Uf=Ka("animationstart"),Yb=Ka("transitionrun"),Fb=Ka("transitionstart"),Gb=Ka("transitioncancel"),Lf=Ka("transitionend"),zf=new Map,Mc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Mc.push("scrollEnd");function Tn(e,t){zf.set(e,t),Pa(t,[e])}var Hf=new WeakMap;function pn(e,t){if(typeof e=="object"&&e!==null){var a=Hf.get(e);return a!==void 0?a:(t={value:e,source:t,stack:ef(t)},Hf.set(e,t),t)}return{value:e,source:t,stack:ef(t)}}var yn=[],Ur=0,Ic=0;function fi(){for(var e=Ur,t=Ic=Ur=0;t<e;){var a=yn[t];yn[t++]=null;var o=yn[t];yn[t++]=null;var d=yn[t];yn[t++]=null;var h=yn[t];if(yn[t++]=null,o!==null&&d!==null){var y=o.pending;y===null?d.next=d:(d.next=y.next,y.next=d),o.pending=d}h!==0&&$f(a,d,h)}}function gi(e,t,a,o){yn[Ur++]=e,yn[Ur++]=t,yn[Ur++]=a,yn[Ur++]=o,Ic|=o,e.lanes|=o,e=e.alternate,e!==null&&(e.lanes|=o)}function Uc(e,t,a,o){return gi(e,t,a,o),mi(e)}function Lr(e,t){return gi(e,null,null,t),mi(e)}function $f(e,t,a){e.lanes|=a;var o=e.alternate;o!==null&&(o.lanes|=a);for(var d=!1,h=e.return;h!==null;)h.childLanes|=a,o=h.alternate,o!==null&&(o.childLanes|=a),h.tag===22&&(e=h.stateNode,e===null||e._visibility&1||(d=!0)),e=h,h=h.return;return e.tag===3?(h=e.stateNode,d&&t!==null&&(d=31-ne(a),e=h.hiddenUpdates,o=e[d],o===null?e[d]=[t]:o.push(t),t.lane=a|536870912),h):null}function mi(e){if(50<sl)throw sl=0,qd=null,Error(i(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var zr={};function Vb(e,t,a,o){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ln(e,t,a,o){return new Vb(e,t,a,o)}function Lc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Vn(e,t){var a=e.alternate;return a===null?(a=ln(e.tag,t,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&65011712,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function Bf(e,t){e.flags&=65011714;var a=e.alternate;return a===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,t=a.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function pi(e,t,a,o,d,h){var y=0;if(o=e,typeof e=="function")Lc(e)&&(y=1);else if(typeof e=="string")y=Pv(e,a,xe.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case ie:return e=ln(31,a,t,d),e.elementType=ie,e.lanes=h,e;case T:return Za(a.children,d,h,t);case z:y=8,d|=24;break;case W:return e=ln(12,a,t,d|2),e.elementType=W,e.lanes=h,e;case _:return e=ln(13,a,t,d),e.elementType=_,e.lanes=h,e;case H:return e=ln(19,a,t,d),e.elementType=H,e.lanes=h,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case k:case A:y=10;break e;case S:y=9;break e;case D:y=11;break e;case I:y=14;break e;case le:y=16,o=null;break e}y=29,a=Error(i(130,e===null?"null":typeof e,"")),o=null}return t=ln(y,a,t,d),t.elementType=e,t.type=o,t.lanes=h,t}function Za(e,t,a,o){return e=ln(7,e,o,t),e.lanes=a,e}function zc(e,t,a){return e=ln(6,e,null,t),e.lanes=a,e}function Hc(e,t,a){return t=ln(4,e.children!==null?e.children:[],e.key,t),t.lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Hr=[],$r=0,yi=null,xi=0,xn=[],bn=0,Ja=null,Wn=1,Pn="";function er(e,t){Hr[$r++]=xi,Hr[$r++]=yi,yi=e,xi=t}function qf(e,t,a){xn[bn++]=Wn,xn[bn++]=Pn,xn[bn++]=Ja,Ja=e;var o=Wn;e=Pn;var d=32-ne(o)-1;o&=~(1<<d),a+=1;var h=32-ne(t)+d;if(30<h){var y=d-d%5;h=(o&(1<<y)-1).toString(32),o>>=y,d-=y,Wn=1<<32-ne(t)+d|a<<d|o,Pn=h+e}else Wn=1<<h|a<<d|o,Pn=e}function $c(e){e.return!==null&&(er(e,1),qf(e,1,0))}function Bc(e){for(;e===yi;)yi=Hr[--$r],Hr[$r]=null,xi=Hr[--$r],Hr[$r]=null;for(;e===Ja;)Ja=xn[--bn],xn[bn]=null,Pn=xn[--bn],xn[bn]=null,Wn=xn[--bn],xn[bn]=null}var Wt=null,ft=null,Qe=!1,tr=null,Mn=!1,qc=Error(i(519));function nr(e){var t=Error(i(418,""));throw Ls(pn(t,e)),qc}function Yf(e){var t=e.stateNode,a=e.type,o=e.memoizedProps;switch(t[Yt]=e,t[Xt]=o,a){case"dialog":Fe("cancel",t),Fe("close",t);break;case"iframe":case"object":case"embed":Fe("load",t);break;case"video":case"audio":for(a=0;a<il.length;a++)Fe(il[a],t);break;case"source":Fe("error",t);break;case"img":case"image":case"link":Fe("error",t),Fe("load",t);break;case"details":Fe("toggle",t);break;case"input":Fe("invalid",t),af(t,o.value,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name,!0),ri(t);break;case"select":Fe("invalid",t);break;case"textarea":Fe("invalid",t),sf(t,o.value,o.defaultValue,o.children),ri(t)}a=o.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||t.textContent===""+a||o.suppressHydrationWarning===!0||lm(t.textContent,a)?(o.popover!=null&&(Fe("beforetoggle",t),Fe("toggle",t)),o.onScroll!=null&&Fe("scroll",t),o.onScrollEnd!=null&&Fe("scrollend",t),o.onClick!=null&&(t.onclick=Zi),t=!0):t=!1,t||nr(e)}function Ff(e){for(Wt=e.return;Wt;)switch(Wt.tag){case 5:case 13:Mn=!1;return;case 27:case 3:Mn=!0;return;default:Wt=Wt.return}}function Is(e){if(e!==Wt)return!1;if(!Qe)return Ff(e),Qe=!0,!1;var t=e.tag,a;if((a=t!==3&&t!==27)&&((a=t===5)&&(a=e.type,a=!(a!=="form"&&a!=="button")||ru(e.type,e.memoizedProps)),a=!a),a&&ft&&nr(e),Ff(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(a=e.data,a==="/$"){if(t===0){ft=Sn(e.nextSibling);break e}t--}else a!=="$"&&a!=="$!"&&a!=="$?"||t++;e=e.nextSibling}ft=null}}else t===27?(t=ft,Ca(e.type)?(e=ou,ou=null,ft=e):ft=t):ft=Wt?Sn(e.stateNode.nextSibling):null;return!0}function Us(){ft=Wt=null,Qe=!1}function Gf(){var e=tr;return e!==null&&(en===null?en=e:en.push.apply(en,e),tr=null),e}function Ls(e){tr===null?tr=[e]:tr.push(e)}var Yc=C(null),ar=null,Qn=null;function ma(e,t,a){Q(Yc,t._currentValue),t._currentValue=a}function Xn(e){e._currentValue=Yc.current,M(Yc)}function Fc(e,t,a){for(;e!==null;){var o=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,o!==null&&(o.childLanes|=t)):o!==null&&(o.childLanes&t)!==t&&(o.childLanes|=t),e===a)break;e=e.return}}function Gc(e,t,a,o){var d=e.child;for(d!==null&&(d.return=e);d!==null;){var h=d.dependencies;if(h!==null){var y=d.child;h=h.firstContext;e:for(;h!==null;){var v=h;h=d;for(var N=0;N<t.length;N++)if(v.context===t[N]){h.lanes|=a,v=h.alternate,v!==null&&(v.lanes|=a),Fc(h.return,a,e),o||(y=null);break e}h=v.next}}else if(d.tag===18){if(y=d.return,y===null)throw Error(i(341));y.lanes|=a,h=y.alternate,h!==null&&(h.lanes|=a),Fc(y,a,e),y=null}else y=d.child;if(y!==null)y.return=d;else for(y=d;y!==null;){if(y===e){y=null;break}if(d=y.sibling,d!==null){d.return=y.return,y=d;break}y=y.return}d=y}}function zs(e,t,a,o){e=null;for(var d=t,h=!1;d!==null;){if(!h){if((d.flags&524288)!==0)h=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var y=d.alternate;if(y===null)throw Error(i(387));if(y=y.memoizedProps,y!==null){var v=d.type;sn(d.pendingProps.value,y.value)||(e!==null?e.push(v):e=[v])}}else if(d===K.current){if(y=d.alternate,y===null)throw Error(i(387));y.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(e!==null?e.push(fl):e=[fl])}d=d.return}e!==null&&Gc(t,e,a,o),t.flags|=262144}function bi(e){for(e=e.firstContext;e!==null;){if(!sn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function rr(e){ar=e,Qn=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Ft(e){return Vf(ar,e)}function vi(e,t){return ar===null&&rr(e),Vf(e,t)}function Vf(e,t){var a=t._currentValue;if(t={context:t,memoizedValue:a,next:null},Qn===null){if(e===null)throw Error(i(308));Qn=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Qn=Qn.next=t;return a}var Wb=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(a,o){e.push(o)}};this.abort=function(){t.aborted=!0,e.forEach(function(a){return a()})}},Pb=s.unstable_scheduleCallback,Qb=s.unstable_NormalPriority,_t={$$typeof:A,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Vc(){return{controller:new Wb,data:new Map,refCount:0}}function Hs(e){e.refCount--,e.refCount===0&&Pb(Qb,function(){e.controller.abort()})}var $s=null,Wc=0,Br=0,qr=null;function Xb(e,t){if($s===null){var a=$s=[];Wc=0,Br=Qd(),qr={status:"pending",value:void 0,then:function(o){a.push(o)}}}return Wc++,t.then(Wf,Wf),t}function Wf(){if(--Wc===0&&$s!==null){qr!==null&&(qr.status="fulfilled");var e=$s;$s=null,Br=0,qr=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Kb(e,t){var a=[],o={status:"pending",value:null,reason:null,then:function(d){a.push(d)}};return e.then(function(){o.status="fulfilled",o.value=t;for(var d=0;d<a.length;d++)(0,a[d])(t)},function(d){for(o.status="rejected",o.reason=d,d=0;d<a.length;d++)(0,a[d])(void 0)}),o}var Pf=P.S;P.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&Xb(e,t),Pf!==null&&Pf(e,t)};var sr=C(null);function Pc(){var e=sr.current;return e!==null?e:ot.pooledCache}function wi(e,t){t===null?Q(sr,sr.current):Q(sr,t.pool)}function Qf(){var e=Pc();return e===null?null:{parent:_t._currentValue,pool:e}}var Bs=Error(i(460)),Xf=Error(i(474)),_i=Error(i(542)),Qc={then:function(){}};function Kf(e){return e=e.status,e==="fulfilled"||e==="rejected"}function ki(){}function Zf(e,t,a){switch(a=e[a],a===void 0?e.push(t):a!==t&&(t.then(ki,ki),t=a),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,e0(e),e;default:if(typeof t.status=="string")t.then(ki,ki);else{if(e=ot,e!==null&&100<e.shellSuspendCounter)throw Error(i(482));e=t,e.status="pending",e.then(function(o){if(t.status==="pending"){var d=t;d.status="fulfilled",d.value=o}},function(o){if(t.status==="pending"){var d=t;d.status="rejected",d.reason=o}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,e0(e),e}throw qs=t,Bs}}var qs=null;function Jf(){if(qs===null)throw Error(i(459));var e=qs;return qs=null,e}function e0(e){if(e===Bs||e===_i)throw Error(i(483))}var pa=!1;function Xc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Kc(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ya(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function xa(e,t,a){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,(Ke&2)!==0){var d=o.pending;return d===null?t.next=t:(t.next=d.next,d.next=t),o.pending=t,t=mi(e),$f(e,null,a),t}return gi(e,o,t,a),mi(e)}function Ys(e,t,a){if(t=t.updateQueue,t!==null&&(t=t.shared,(a&4194048)!==0)){var o=t.lanes;o&=e.pendingLanes,a|=o,t.lanes=a,Vh(e,a)}}function Zc(e,t){var a=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,a===o)){var d=null,h=null;if(a=a.firstBaseUpdate,a!==null){do{var y={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};h===null?d=h=y:h=h.next=y,a=a.next}while(a!==null);h===null?d=h=t:h=h.next=t}else d=h=t;a={baseState:o.baseState,firstBaseUpdate:d,lastBaseUpdate:h,shared:o.shared,callbacks:o.callbacks},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}var Jc=!1;function Fs(){if(Jc){var e=qr;if(e!==null)throw e}}function Gs(e,t,a,o){Jc=!1;var d=e.updateQueue;pa=!1;var h=d.firstBaseUpdate,y=d.lastBaseUpdate,v=d.shared.pending;if(v!==null){d.shared.pending=null;var N=v,B=N.next;N.next=null,y===null?h=B:y.next=B,y=N;var Z=e.alternate;Z!==null&&(Z=Z.updateQueue,v=Z.lastBaseUpdate,v!==y&&(v===null?Z.firstBaseUpdate=B:v.next=B,Z.lastBaseUpdate=N))}if(h!==null){var ae=d.baseState;y=0,Z=B=N=null,v=h;do{var F=v.lane&-536870913,V=F!==v.lane;if(V?(Ve&F)===F:(o&F)===F){F!==0&&F===Br&&(Jc=!0),Z!==null&&(Z=Z.next={lane:0,tag:v.tag,payload:v.payload,callback:null,next:null});e:{var Ue=e,Re=v;F=t;var rt=a;switch(Re.tag){case 1:if(Ue=Re.payload,typeof Ue=="function"){ae=Ue.call(rt,ae,F);break e}ae=Ue;break e;case 3:Ue.flags=Ue.flags&-65537|128;case 0:if(Ue=Re.payload,F=typeof Ue=="function"?Ue.call(rt,ae,F):Ue,F==null)break e;ae=x({},ae,F);break e;case 2:pa=!0}}F=v.callback,F!==null&&(e.flags|=64,V&&(e.flags|=8192),V=d.callbacks,V===null?d.callbacks=[F]:V.push(F))}else V={lane:F,tag:v.tag,payload:v.payload,callback:v.callback,next:null},Z===null?(B=Z=V,N=ae):Z=Z.next=V,y|=F;if(v=v.next,v===null){if(v=d.shared.pending,v===null)break;V=v,v=V.next,V.next=null,d.lastBaseUpdate=V,d.shared.pending=null}}while(!0);Z===null&&(N=ae),d.baseState=N,d.firstBaseUpdate=B,d.lastBaseUpdate=Z,h===null&&(d.shared.lanes=0),ja|=y,e.lanes=y,e.memoizedState=ae}}function t0(e,t){if(typeof e!="function")throw Error(i(191,e));e.call(t)}function n0(e,t){var a=e.callbacks;if(a!==null)for(e.callbacks=null,e=0;e<a.length;e++)t0(a[e],t)}var Yr=C(null),Ni=C(0);function a0(e,t){e=aa,Q(Ni,e),Q(Yr,t),aa=e|t.baseLanes}function ed(){Q(Ni,aa),Q(Yr,Yr.current)}function td(){aa=Ni.current,M(Yr),M(Ni)}var ba=0,He=null,nt=null,vt=null,Ti=!1,Fr=!1,lr=!1,ji=0,Vs=0,Gr=null,Zb=0;function yt(){throw Error(i(321))}function nd(e,t){if(t===null)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!sn(e[a],t[a]))return!1;return!0}function ad(e,t,a,o,d,h){return ba=h,He=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,P.H=e===null||e.memoizedState===null?$0:B0,lr=!1,h=a(o,d),lr=!1,Fr&&(h=s0(t,a,o,d)),r0(e),h}function r0(e){P.H=Ri;var t=nt!==null&&nt.next!==null;if(ba=0,vt=nt=He=null,Ti=!1,Vs=0,Gr=null,t)throw Error(i(300));e===null||Ct||(e=e.dependencies,e!==null&&bi(e)&&(Ct=!0))}function s0(e,t,a,o){He=e;var d=0;do{if(Fr&&(Gr=null),Vs=0,Fr=!1,25<=d)throw Error(i(301));if(d+=1,vt=nt=null,e.updateQueue!=null){var h=e.updateQueue;h.lastEffect=null,h.events=null,h.stores=null,h.memoCache!=null&&(h.memoCache.index=0)}P.H=sv,h=t(a,o)}while(Fr);return h}function Jb(){var e=P.H,t=e.useState()[0];return t=typeof t.then=="function"?Ws(t):t,e=e.useState()[0],(nt!==null?nt.memoizedState:null)!==e&&(He.flags|=1024),t}function rd(){var e=ji!==0;return ji=0,e}function sd(e,t,a){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a}function ld(e){if(Ti){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Ti=!1}ba=0,vt=nt=He=null,Fr=!1,Vs=ji=0,Gr=null}function Zt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vt===null?He.memoizedState=vt=e:vt=vt.next=e,vt}function wt(){if(nt===null){var e=He.alternate;e=e!==null?e.memoizedState:null}else e=nt.next;var t=vt===null?He.memoizedState:vt.next;if(t!==null)vt=t,nt=e;else{if(e===null)throw He.alternate===null?Error(i(467)):Error(i(310));nt=e,e={memoizedState:nt.memoizedState,baseState:nt.baseState,baseQueue:nt.baseQueue,queue:nt.queue,next:null},vt===null?He.memoizedState=vt=e:vt=vt.next=e}return vt}function id(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ws(e){var t=Vs;return Vs+=1,Gr===null&&(Gr=[]),e=Zf(Gr,e,t),t=He,(vt===null?t.memoizedState:vt.next)===null&&(t=t.alternate,P.H=t===null||t.memoizedState===null?$0:B0),e}function Si(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Ws(e);if(e.$$typeof===A)return Ft(e)}throw Error(i(438,String(e)))}function od(e){var t=null,a=He.updateQueue;if(a!==null&&(t=a.memoCache),t==null){var o=He.alternate;o!==null&&(o=o.updateQueue,o!==null&&(o=o.memoCache,o!=null&&(t={data:o.data.map(function(d){return d.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),a===null&&(a=id(),He.updateQueue=a),a.memoCache=t,a=t.data[t.index],a===void 0)for(a=t.data[t.index]=Array(e),o=0;o<e;o++)a[o]=be;return t.index++,a}function Kn(e,t){return typeof t=="function"?t(e):t}function Di(e){var t=wt();return cd(t,nt,e)}function cd(e,t,a){var o=e.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=a;var d=e.baseQueue,h=o.pending;if(h!==null){if(d!==null){var y=d.next;d.next=h.next,h.next=y}t.baseQueue=d=h,o.pending=null}if(h=e.baseState,d===null)e.memoizedState=h;else{t=d.next;var v=y=null,N=null,B=t,Z=!1;do{var ae=B.lane&-536870913;if(ae!==B.lane?(Ve&ae)===ae:(ba&ae)===ae){var F=B.revertLane;if(F===0)N!==null&&(N=N.next={lane:0,revertLane:0,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null}),ae===Br&&(Z=!0);else if((ba&F)===F){B=B.next,F===Br&&(Z=!0);continue}else ae={lane:0,revertLane:B.revertLane,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null},N===null?(v=N=ae,y=h):N=N.next=ae,He.lanes|=F,ja|=F;ae=B.action,lr&&a(h,ae),h=B.hasEagerState?B.eagerState:a(h,ae)}else F={lane:ae,revertLane:B.revertLane,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null},N===null?(v=N=F,y=h):N=N.next=F,He.lanes|=ae,ja|=ae;B=B.next}while(B!==null&&B!==t);if(N===null?y=h:N.next=v,!sn(h,e.memoizedState)&&(Ct=!0,Z&&(a=qr,a!==null)))throw a;e.memoizedState=h,e.baseState=y,e.baseQueue=N,o.lastRenderedState=h}return d===null&&(o.lanes=0),[e.memoizedState,o.dispatch]}function dd(e){var t=wt(),a=t.queue;if(a===null)throw Error(i(311));a.lastRenderedReducer=e;var o=a.dispatch,d=a.pending,h=t.memoizedState;if(d!==null){a.pending=null;var y=d=d.next;do h=e(h,y.action),y=y.next;while(y!==d);sn(h,t.memoizedState)||(Ct=!0),t.memoizedState=h,t.baseQueue===null&&(t.baseState=h),a.lastRenderedState=h}return[h,o]}function l0(e,t,a){var o=He,d=wt(),h=Qe;if(h){if(a===void 0)throw Error(i(407));a=a()}else a=t();var y=!sn((nt||d).memoizedState,a);y&&(d.memoizedState=a,Ct=!0),d=d.queue;var v=c0.bind(null,o,d,e);if(Ps(2048,8,v,[e]),d.getSnapshot!==t||y||vt!==null&&vt.memoizedState.tag&1){if(o.flags|=2048,Vr(9,Ei(),o0.bind(null,o,d,a,t),null),ot===null)throw Error(i(349));h||(ba&124)!==0||i0(o,t,a)}return a}function i0(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},t=He.updateQueue,t===null?(t=id(),He.updateQueue=t,t.stores=[e]):(a=t.stores,a===null?t.stores=[e]:a.push(e))}function o0(e,t,a,o){t.value=a,t.getSnapshot=o,d0(t)&&u0(e)}function c0(e,t,a){return a(function(){d0(t)&&u0(e)})}function d0(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!sn(e,a)}catch{return!0}}function u0(e){var t=Lr(e,2);t!==null&&hn(t,e,2)}function ud(e){var t=Zt();if(typeof e=="function"){var a=e;if(e=a(),lr){se(!0);try{a()}finally{se(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Kn,lastRenderedState:e},t}function h0(e,t,a,o){return e.baseState=a,cd(e,nt,typeof o=="function"?o:Kn)}function ev(e,t,a,o,d){if(Ai(e))throw Error(i(485));if(e=t.action,e!==null){var h={payload:d,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){h.listeners.push(y)}};P.T!==null?a(!0):h.isTransition=!1,o(h),a=t.pending,a===null?(h.next=t.pending=h,f0(t,h)):(h.next=a.next,t.pending=a.next=h)}}function f0(e,t){var a=t.action,o=t.payload,d=e.state;if(t.isTransition){var h=P.T,y={};P.T=y;try{var v=a(d,o),N=P.S;N!==null&&N(y,v),g0(e,t,v)}catch(B){hd(e,t,B)}finally{P.T=h}}else try{h=a(d,o),g0(e,t,h)}catch(B){hd(e,t,B)}}function g0(e,t,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(o){m0(e,t,o)},function(o){return hd(e,t,o)}):m0(e,t,a)}function m0(e,t,a){t.status="fulfilled",t.value=a,p0(t),e.state=a,t=e.pending,t!==null&&(a=t.next,a===t?e.pending=null:(a=a.next,t.next=a,f0(e,a)))}function hd(e,t,a){var o=e.pending;if(e.pending=null,o!==null){o=o.next;do t.status="rejected",t.reason=a,p0(t),t=t.next;while(t!==o)}e.action=null}function p0(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function y0(e,t){return t}function x0(e,t){if(Qe){var a=ot.formState;if(a!==null){e:{var o=He;if(Qe){if(ft){t:{for(var d=ft,h=Mn;d.nodeType!==8;){if(!h){d=null;break t}if(d=Sn(d.nextSibling),d===null){d=null;break t}}h=d.data,d=h==="F!"||h==="F"?d:null}if(d){ft=Sn(d.nextSibling),o=d.data==="F!";break e}}nr(o)}o=!1}o&&(t=a[0])}}return a=Zt(),a.memoizedState=a.baseState=t,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:y0,lastRenderedState:t},a.queue=o,a=L0.bind(null,He,o),o.dispatch=a,o=ud(!1),h=yd.bind(null,He,!1,o.queue),o=Zt(),d={state:t,dispatch:null,action:e,pending:null},o.queue=d,a=ev.bind(null,He,d,h,a),d.dispatch=a,o.memoizedState=e,[t,a,!1]}function b0(e){var t=wt();return v0(t,nt,e)}function v0(e,t,a){if(t=cd(e,t,y0)[0],e=Di(Kn)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var o=Ws(t)}catch(y){throw y===Bs?_i:y}else o=t;t=wt();var d=t.queue,h=d.dispatch;return a!==t.memoizedState&&(He.flags|=2048,Vr(9,Ei(),tv.bind(null,d,a),null)),[o,h,e]}function tv(e,t){e.action=t}function w0(e){var t=wt(),a=nt;if(a!==null)return v0(t,a,e);wt(),t=t.memoizedState,a=wt();var o=a.queue.dispatch;return a.memoizedState=e,[t,o,!1]}function Vr(e,t,a,o){return e={tag:e,create:a,deps:o,inst:t,next:null},t=He.updateQueue,t===null&&(t=id(),He.updateQueue=t),a=t.lastEffect,a===null?t.lastEffect=e.next=e:(o=a.next,a.next=e,e.next=o,t.lastEffect=e),e}function Ei(){return{destroy:void 0,resource:void 0}}function _0(){return wt().memoizedState}function Ci(e,t,a,o){var d=Zt();o=o===void 0?null:o,He.flags|=e,d.memoizedState=Vr(1|t,Ei(),a,o)}function Ps(e,t,a,o){var d=wt();o=o===void 0?null:o;var h=d.memoizedState.inst;nt!==null&&o!==null&&nd(o,nt.memoizedState.deps)?d.memoizedState=Vr(t,h,a,o):(He.flags|=e,d.memoizedState=Vr(1|t,h,a,o))}function k0(e,t){Ci(8390656,8,e,t)}function N0(e,t){Ps(2048,8,e,t)}function T0(e,t){return Ps(4,2,e,t)}function j0(e,t){return Ps(4,4,e,t)}function S0(e,t){if(typeof t=="function"){e=e();var a=t(e);return function(){typeof a=="function"?a():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function D0(e,t,a){a=a!=null?a.concat([e]):null,Ps(4,4,S0.bind(null,t,e),a)}function fd(){}function E0(e,t){var a=wt();t=t===void 0?null:t;var o=a.memoizedState;return t!==null&&nd(t,o[1])?o[0]:(a.memoizedState=[e,t],e)}function C0(e,t){var a=wt();t=t===void 0?null:t;var o=a.memoizedState;if(t!==null&&nd(t,o[1]))return o[0];if(o=e(),lr){se(!0);try{e()}finally{se(!1)}}return a.memoizedState=[o,t],o}function gd(e,t,a){return a===void 0||(ba&1073741824)!==0?e.memoizedState=t:(e.memoizedState=a,e=Og(),He.lanes|=e,ja|=e,a)}function A0(e,t,a,o){return sn(a,t)?a:Yr.current!==null?(e=gd(e,a,o),sn(e,t)||(Ct=!0),e):(ba&42)===0?(Ct=!0,e.memoizedState=a):(e=Og(),He.lanes|=e,ja|=e,t)}function R0(e,t,a,o,d){var h=ce.p;ce.p=h!==0&&8>h?h:8;var y=P.T,v={};P.T=v,yd(e,!1,t,a);try{var N=d(),B=P.S;if(B!==null&&B(v,N),N!==null&&typeof N=="object"&&typeof N.then=="function"){var Z=Kb(N,o);Qs(e,t,Z,un(e))}else Qs(e,t,o,un(e))}catch(ae){Qs(e,t,{then:function(){},status:"rejected",reason:ae},un())}finally{ce.p=h,P.T=y}}function nv(){}function md(e,t,a,o){if(e.tag!==5)throw Error(i(476));var d=O0(e).queue;R0(e,d,t,pe,a===null?nv:function(){return M0(e),a(o)})}function O0(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:pe,baseState:pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Kn,lastRenderedState:pe},next:null};var a={};return t.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Kn,lastRenderedState:a},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function M0(e){var t=O0(e).next.queue;Qs(e,t,{},un())}function pd(){return Ft(fl)}function I0(){return wt().memoizedState}function U0(){return wt().memoizedState}function av(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var a=un();e=ya(a);var o=xa(t,e,a);o!==null&&(hn(o,t,a),Ys(o,t,a)),t={cache:Vc()},e.payload=t;return}t=t.return}}function rv(e,t,a){var o=un();a={lane:o,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null},Ai(e)?z0(t,a):(a=Uc(e,t,a,o),a!==null&&(hn(a,e,o),H0(a,t,o)))}function L0(e,t,a){var o=un();Qs(e,t,a,o)}function Qs(e,t,a,o){var d={lane:o,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null};if(Ai(e))z0(t,d);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=t.lastRenderedReducer,h!==null))try{var y=t.lastRenderedState,v=h(y,a);if(d.hasEagerState=!0,d.eagerState=v,sn(v,y))return gi(e,t,d,0),ot===null&&fi(),!1}catch{}finally{}if(a=Uc(e,t,d,o),a!==null)return hn(a,e,o),H0(a,t,o),!0}return!1}function yd(e,t,a,o){if(o={lane:2,revertLane:Qd(),action:o,hasEagerState:!1,eagerState:null,next:null},Ai(e)){if(t)throw Error(i(479))}else t=Uc(e,a,o,2),t!==null&&hn(t,e,2)}function Ai(e){var t=e.alternate;return e===He||t!==null&&t===He}function z0(e,t){Fr=Ti=!0;var a=e.pending;a===null?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function H0(e,t,a){if((a&4194048)!==0){var o=t.lanes;o&=e.pendingLanes,a|=o,t.lanes=a,Vh(e,a)}}var Ri={readContext:Ft,use:Si,useCallback:yt,useContext:yt,useEffect:yt,useImperativeHandle:yt,useLayoutEffect:yt,useInsertionEffect:yt,useMemo:yt,useReducer:yt,useRef:yt,useState:yt,useDebugValue:yt,useDeferredValue:yt,useTransition:yt,useSyncExternalStore:yt,useId:yt,useHostTransitionStatus:yt,useFormState:yt,useActionState:yt,useOptimistic:yt,useMemoCache:yt,useCacheRefresh:yt},$0={readContext:Ft,use:Si,useCallback:function(e,t){return Zt().memoizedState=[e,t===void 0?null:t],e},useContext:Ft,useEffect:k0,useImperativeHandle:function(e,t,a){a=a!=null?a.concat([e]):null,Ci(4194308,4,S0.bind(null,t,e),a)},useLayoutEffect:function(e,t){return Ci(4194308,4,e,t)},useInsertionEffect:function(e,t){Ci(4,2,e,t)},useMemo:function(e,t){var a=Zt();t=t===void 0?null:t;var o=e();if(lr){se(!0);try{e()}finally{se(!1)}}return a.memoizedState=[o,t],o},useReducer:function(e,t,a){var o=Zt();if(a!==void 0){var d=a(t);if(lr){se(!0);try{a(t)}finally{se(!1)}}}else d=t;return o.memoizedState=o.baseState=d,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:d},o.queue=e,e=e.dispatch=rv.bind(null,He,e),[o.memoizedState,e]},useRef:function(e){var t=Zt();return e={current:e},t.memoizedState=e},useState:function(e){e=ud(e);var t=e.queue,a=L0.bind(null,He,t);return t.dispatch=a,[e.memoizedState,a]},useDebugValue:fd,useDeferredValue:function(e,t){var a=Zt();return gd(a,e,t)},useTransition:function(){var e=ud(!1);return e=R0.bind(null,He,e.queue,!0,!1),Zt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,a){var o=He,d=Zt();if(Qe){if(a===void 0)throw Error(i(407));a=a()}else{if(a=t(),ot===null)throw Error(i(349));(Ve&124)!==0||i0(o,t,a)}d.memoizedState=a;var h={value:a,getSnapshot:t};return d.queue=h,k0(c0.bind(null,o,h,e),[e]),o.flags|=2048,Vr(9,Ei(),o0.bind(null,o,h,a,t),null),a},useId:function(){var e=Zt(),t=ot.identifierPrefix;if(Qe){var a=Pn,o=Wn;a=(o&~(1<<32-ne(o)-1)).toString(32)+a,t=""+t+"R"+a,a=ji++,0<a&&(t+="H"+a.toString(32)),t+=""}else a=Zb++,t=""+t+"r"+a.toString(32)+"";return e.memoizedState=t},useHostTransitionStatus:pd,useFormState:x0,useActionState:x0,useOptimistic:function(e){var t=Zt();t.memoizedState=t.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=a,t=yd.bind(null,He,!0,a),a.dispatch=t,[e,t]},useMemoCache:od,useCacheRefresh:function(){return Zt().memoizedState=av.bind(null,He)}},B0={readContext:Ft,use:Si,useCallback:E0,useContext:Ft,useEffect:N0,useImperativeHandle:D0,useInsertionEffect:T0,useLayoutEffect:j0,useMemo:C0,useReducer:Di,useRef:_0,useState:function(){return Di(Kn)},useDebugValue:fd,useDeferredValue:function(e,t){var a=wt();return A0(a,nt.memoizedState,e,t)},useTransition:function(){var e=Di(Kn)[0],t=wt().memoizedState;return[typeof e=="boolean"?e:Ws(e),t]},useSyncExternalStore:l0,useId:I0,useHostTransitionStatus:pd,useFormState:b0,useActionState:b0,useOptimistic:function(e,t){var a=wt();return h0(a,nt,e,t)},useMemoCache:od,useCacheRefresh:U0},sv={readContext:Ft,use:Si,useCallback:E0,useContext:Ft,useEffect:N0,useImperativeHandle:D0,useInsertionEffect:T0,useLayoutEffect:j0,useMemo:C0,useReducer:dd,useRef:_0,useState:function(){return dd(Kn)},useDebugValue:fd,useDeferredValue:function(e,t){var a=wt();return nt===null?gd(a,e,t):A0(a,nt.memoizedState,e,t)},useTransition:function(){var e=dd(Kn)[0],t=wt().memoizedState;return[typeof e=="boolean"?e:Ws(e),t]},useSyncExternalStore:l0,useId:I0,useHostTransitionStatus:pd,useFormState:w0,useActionState:w0,useOptimistic:function(e,t){var a=wt();return nt!==null?h0(a,nt,e,t):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:od,useCacheRefresh:U0},Wr=null,Xs=0;function Oi(e){var t=Xs;return Xs+=1,Wr===null&&(Wr=[]),Zf(Wr,e,t)}function Ks(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Mi(e,t){throw t.$$typeof===b?Error(i(525)):(e=Object.prototype.toString.call(t),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function q0(e){var t=e._init;return t(e._payload)}function Y0(e){function t(U,E){if(e){var $=U.deletions;$===null?(U.deletions=[E],U.flags|=16):$.push(E)}}function a(U,E){if(!e)return null;for(;E!==null;)t(U,E),E=E.sibling;return null}function o(U){for(var E=new Map;U!==null;)U.key!==null?E.set(U.key,U):E.set(U.index,U),U=U.sibling;return E}function d(U,E){return U=Vn(U,E),U.index=0,U.sibling=null,U}function h(U,E,$){return U.index=$,e?($=U.alternate,$!==null?($=$.index,$<E?(U.flags|=67108866,E):$):(U.flags|=67108866,E)):(U.flags|=1048576,E)}function y(U){return e&&U.alternate===null&&(U.flags|=67108866),U}function v(U,E,$,te){return E===null||E.tag!==6?(E=zc($,U.mode,te),E.return=U,E):(E=d(E,$),E.return=U,E)}function N(U,E,$,te){var ve=$.type;return ve===T?Z(U,E,$.props.children,te,$.key):E!==null&&(E.elementType===ve||typeof ve=="object"&&ve!==null&&ve.$$typeof===le&&q0(ve)===E.type)?(E=d(E,$.props),Ks(E,$),E.return=U,E):(E=pi($.type,$.key,$.props,null,U.mode,te),Ks(E,$),E.return=U,E)}function B(U,E,$,te){return E===null||E.tag!==4||E.stateNode.containerInfo!==$.containerInfo||E.stateNode.implementation!==$.implementation?(E=Hc($,U.mode,te),E.return=U,E):(E=d(E,$.children||[]),E.return=U,E)}function Z(U,E,$,te,ve){return E===null||E.tag!==7?(E=Za($,U.mode,te,ve),E.return=U,E):(E=d(E,$),E.return=U,E)}function ae(U,E,$){if(typeof E=="string"&&E!==""||typeof E=="number"||typeof E=="bigint")return E=zc(""+E,U.mode,$),E.return=U,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case w:return $=pi(E.type,E.key,E.props,null,U.mode,$),Ks($,E),$.return=U,$;case L:return E=Hc(E,U.mode,$),E.return=U,E;case le:var te=E._init;return E=te(E._payload),ae(U,E,$)}if(Ae(E)||_e(E))return E=Za(E,U.mode,$,null),E.return=U,E;if(typeof E.then=="function")return ae(U,Oi(E),$);if(E.$$typeof===A)return ae(U,vi(U,E),$);Mi(U,E)}return null}function F(U,E,$,te){var ve=E!==null?E.key:null;if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return ve!==null?null:v(U,E,""+$,te);if(typeof $=="object"&&$!==null){switch($.$$typeof){case w:return $.key===ve?N(U,E,$,te):null;case L:return $.key===ve?B(U,E,$,te):null;case le:return ve=$._init,$=ve($._payload),F(U,E,$,te)}if(Ae($)||_e($))return ve!==null?null:Z(U,E,$,te,null);if(typeof $.then=="function")return F(U,E,Oi($),te);if($.$$typeof===A)return F(U,E,vi(U,$),te);Mi(U,$)}return null}function V(U,E,$,te,ve){if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return U=U.get($)||null,v(E,U,""+te,ve);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case w:return U=U.get(te.key===null?$:te.key)||null,N(E,U,te,ve);case L:return U=U.get(te.key===null?$:te.key)||null,B(E,U,te,ve);case le:var $e=te._init;return te=$e(te._payload),V(U,E,$,te,ve)}if(Ae(te)||_e(te))return U=U.get($)||null,Z(E,U,te,ve,null);if(typeof te.then=="function")return V(U,E,$,Oi(te),ve);if(te.$$typeof===A)return V(U,E,$,vi(E,te),ve);Mi(E,te)}return null}function Ue(U,E,$,te){for(var ve=null,$e=null,Te=E,Me=E=0,Rt=null;Te!==null&&Me<$.length;Me++){Te.index>Me?(Rt=Te,Te=null):Rt=Te.sibling;var We=F(U,Te,$[Me],te);if(We===null){Te===null&&(Te=Rt);break}e&&Te&&We.alternate===null&&t(U,Te),E=h(We,E,Me),$e===null?ve=We:$e.sibling=We,$e=We,Te=Rt}if(Me===$.length)return a(U,Te),Qe&&er(U,Me),ve;if(Te===null){for(;Me<$.length;Me++)Te=ae(U,$[Me],te),Te!==null&&(E=h(Te,E,Me),$e===null?ve=Te:$e.sibling=Te,$e=Te);return Qe&&er(U,Me),ve}for(Te=o(Te);Me<$.length;Me++)Rt=V(Te,U,Me,$[Me],te),Rt!==null&&(e&&Rt.alternate!==null&&Te.delete(Rt.key===null?Me:Rt.key),E=h(Rt,E,Me),$e===null?ve=Rt:$e.sibling=Rt,$e=Rt);return e&&Te.forEach(function(Ia){return t(U,Ia)}),Qe&&er(U,Me),ve}function Re(U,E,$,te){if($==null)throw Error(i(151));for(var ve=null,$e=null,Te=E,Me=E=0,Rt=null,We=$.next();Te!==null&&!We.done;Me++,We=$.next()){Te.index>Me?(Rt=Te,Te=null):Rt=Te.sibling;var Ia=F(U,Te,We.value,te);if(Ia===null){Te===null&&(Te=Rt);break}e&&Te&&Ia.alternate===null&&t(U,Te),E=h(Ia,E,Me),$e===null?ve=Ia:$e.sibling=Ia,$e=Ia,Te=Rt}if(We.done)return a(U,Te),Qe&&er(U,Me),ve;if(Te===null){for(;!We.done;Me++,We=$.next())We=ae(U,We.value,te),We!==null&&(E=h(We,E,Me),$e===null?ve=We:$e.sibling=We,$e=We);return Qe&&er(U,Me),ve}for(Te=o(Te);!We.done;Me++,We=$.next())We=V(Te,U,Me,We.value,te),We!==null&&(e&&We.alternate!==null&&Te.delete(We.key===null?Me:We.key),E=h(We,E,Me),$e===null?ve=We:$e.sibling=We,$e=We);return e&&Te.forEach(function(lw){return t(U,lw)}),Qe&&er(U,Me),ve}function rt(U,E,$,te){if(typeof $=="object"&&$!==null&&$.type===T&&$.key===null&&($=$.props.children),typeof $=="object"&&$!==null){switch($.$$typeof){case w:e:{for(var ve=$.key;E!==null;){if(E.key===ve){if(ve=$.type,ve===T){if(E.tag===7){a(U,E.sibling),te=d(E,$.props.children),te.return=U,U=te;break e}}else if(E.elementType===ve||typeof ve=="object"&&ve!==null&&ve.$$typeof===le&&q0(ve)===E.type){a(U,E.sibling),te=d(E,$.props),Ks(te,$),te.return=U,U=te;break e}a(U,E);break}else t(U,E);E=E.sibling}$.type===T?(te=Za($.props.children,U.mode,te,$.key),te.return=U,U=te):(te=pi($.type,$.key,$.props,null,U.mode,te),Ks(te,$),te.return=U,U=te)}return y(U);case L:e:{for(ve=$.key;E!==null;){if(E.key===ve)if(E.tag===4&&E.stateNode.containerInfo===$.containerInfo&&E.stateNode.implementation===$.implementation){a(U,E.sibling),te=d(E,$.children||[]),te.return=U,U=te;break e}else{a(U,E);break}else t(U,E);E=E.sibling}te=Hc($,U.mode,te),te.return=U,U=te}return y(U);case le:return ve=$._init,$=ve($._payload),rt(U,E,$,te)}if(Ae($))return Ue(U,E,$,te);if(_e($)){if(ve=_e($),typeof ve!="function")throw Error(i(150));return $=ve.call($),Re(U,E,$,te)}if(typeof $.then=="function")return rt(U,E,Oi($),te);if($.$$typeof===A)return rt(U,E,vi(U,$),te);Mi(U,$)}return typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint"?($=""+$,E!==null&&E.tag===6?(a(U,E.sibling),te=d(E,$),te.return=U,U=te):(a(U,E),te=zc($,U.mode,te),te.return=U,U=te),y(U)):a(U,E)}return function(U,E,$,te){try{Xs=0;var ve=rt(U,E,$,te);return Wr=null,ve}catch(Te){if(Te===Bs||Te===_i)throw Te;var $e=ln(29,Te,null,U.mode);return $e.lanes=te,$e.return=U,$e}finally{}}}var Pr=Y0(!0),F0=Y0(!1),vn=C(null),In=null;function va(e){var t=e.alternate;Q(kt,kt.current&1),Q(vn,e),In===null&&(t===null||Yr.current!==null||t.memoizedState!==null)&&(In=e)}function G0(e){if(e.tag===22){if(Q(kt,kt.current),Q(vn,e),In===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(In=e)}}else wa()}function wa(){Q(kt,kt.current),Q(vn,vn.current)}function Zn(e){M(vn),In===e&&(In=null),M(kt)}var kt=C(0);function Ii(e){for(var t=e;t!==null;){if(t.tag===13){var a=t.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||iu(a)))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function xd(e,t,a,o){t=e.memoizedState,a=a(o,t),a=a==null?t:x({},t,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var bd={enqueueSetState:function(e,t,a){e=e._reactInternals;var o=un(),d=ya(o);d.payload=t,a!=null&&(d.callback=a),t=xa(e,d,o),t!==null&&(hn(t,e,o),Ys(t,e,o))},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var o=un(),d=ya(o);d.tag=1,d.payload=t,a!=null&&(d.callback=a),t=xa(e,d,o),t!==null&&(hn(t,e,o),Ys(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=un(),o=ya(a);o.tag=2,t!=null&&(o.callback=t),t=xa(e,o,a),t!==null&&(hn(t,e,a),Ys(t,e,a))}};function V0(e,t,a,o,d,h,y){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,h,y):t.prototype&&t.prototype.isPureReactComponent?!Os(a,o)||!Os(d,h):!0}function W0(e,t,a,o){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(a,o),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(a,o),t.state!==e&&bd.enqueueReplaceState(t,t.state,null)}function ir(e,t){var a=t;if("ref"in t){a={};for(var o in t)o!=="ref"&&(a[o]=t[o])}if(e=e.defaultProps){a===t&&(a=x({},a));for(var d in e)a[d]===void 0&&(a[d]=e[d])}return a}var Ui=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function P0(e){Ui(e)}function Q0(e){console.error(e)}function X0(e){Ui(e)}function Li(e,t){try{var a=e.onUncaughtError;a(t.value,{componentStack:t.stack})}catch(o){setTimeout(function(){throw o})}}function K0(e,t,a){try{var o=e.onCaughtError;o(a.value,{componentStack:a.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function vd(e,t,a){return a=ya(a),a.tag=3,a.payload={element:null},a.callback=function(){Li(e,t)},a}function Z0(e){return e=ya(e),e.tag=3,e}function J0(e,t,a,o){var d=a.type.getDerivedStateFromError;if(typeof d=="function"){var h=o.value;e.payload=function(){return d(h)},e.callback=function(){K0(t,a,o)}}var y=a.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(e.callback=function(){K0(t,a,o),typeof d!="function"&&(Sa===null?Sa=new Set([this]):Sa.add(this));var v=o.stack;this.componentDidCatch(o.value,{componentStack:v!==null?v:""})})}function lv(e,t,a,o,d){if(a.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){if(t=a.alternate,t!==null&&zs(t,a,d,!0),a=vn.current,a!==null){switch(a.tag){case 13:return In===null?Fd():a.alternate===null&&gt===0&&(gt=3),a.flags&=-257,a.flags|=65536,a.lanes=d,o===Qc?a.flags|=16384:(t=a.updateQueue,t===null?a.updateQueue=new Set([o]):t.add(o),Vd(e,o,d)),!1;case 22:return a.flags|=65536,o===Qc?a.flags|=16384:(t=a.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([o])},a.updateQueue=t):(a=t.retryQueue,a===null?t.retryQueue=new Set([o]):a.add(o)),Vd(e,o,d)),!1}throw Error(i(435,a.tag))}return Vd(e,o,d),Fd(),!1}if(Qe)return t=vn.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=d,o!==qc&&(e=Error(i(422),{cause:o}),Ls(pn(e,a)))):(o!==qc&&(t=Error(i(423),{cause:o}),Ls(pn(t,a))),e=e.current.alternate,e.flags|=65536,d&=-d,e.lanes|=d,o=pn(o,a),d=vd(e.stateNode,o,d),Zc(e,d),gt!==4&&(gt=2)),!1;var h=Error(i(520),{cause:o});if(h=pn(h,a),rl===null?rl=[h]:rl.push(h),gt!==4&&(gt=2),t===null)return!0;o=pn(o,a),a=t;do{switch(a.tag){case 3:return a.flags|=65536,e=d&-d,a.lanes|=e,e=vd(a.stateNode,o,e),Zc(a,e),!1;case 1:if(t=a.type,h=a.stateNode,(a.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||h!==null&&typeof h.componentDidCatch=="function"&&(Sa===null||!Sa.has(h))))return a.flags|=65536,d&=-d,a.lanes|=d,d=Z0(d),J0(d,e,a,o),Zc(a,d),!1}a=a.return}while(a!==null);return!1}var eg=Error(i(461)),Ct=!1;function zt(e,t,a,o){t.child=e===null?F0(t,null,a,o):Pr(t,e.child,a,o)}function tg(e,t,a,o,d){a=a.render;var h=t.ref;if("ref"in o){var y={};for(var v in o)v!=="ref"&&(y[v]=o[v])}else y=o;return rr(t),o=ad(e,t,a,y,h,d),v=rd(),e!==null&&!Ct?(sd(e,t,d),Jn(e,t,d)):(Qe&&v&&$c(t),t.flags|=1,zt(e,t,o,d),t.child)}function ng(e,t,a,o,d){if(e===null){var h=a.type;return typeof h=="function"&&!Lc(h)&&h.defaultProps===void 0&&a.compare===null?(t.tag=15,t.type=h,ag(e,t,h,o,d)):(e=pi(a.type,null,o,t,t.mode,d),e.ref=t.ref,e.return=t,t.child=e)}if(h=e.child,!Dd(e,d)){var y=h.memoizedProps;if(a=a.compare,a=a!==null?a:Os,a(y,o)&&e.ref===t.ref)return Jn(e,t,d)}return t.flags|=1,e=Vn(h,o),e.ref=t.ref,e.return=t,t.child=e}function ag(e,t,a,o,d){if(e!==null){var h=e.memoizedProps;if(Os(h,o)&&e.ref===t.ref)if(Ct=!1,t.pendingProps=o=h,Dd(e,d))(e.flags&131072)!==0&&(Ct=!0);else return t.lanes=e.lanes,Jn(e,t,d)}return wd(e,t,a,o,d)}function rg(e,t,a){var o=t.pendingProps,d=o.children,h=e!==null?e.memoizedState:null;if(o.mode==="hidden"){if((t.flags&128)!==0){if(o=h!==null?h.baseLanes|a:a,e!==null){for(d=t.child=e.child,h=0;d!==null;)h=h|d.lanes|d.childLanes,d=d.sibling;t.childLanes=h&~o}else t.childLanes=0,t.child=null;return sg(e,t,o,a)}if((a&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&wi(t,h!==null?h.cachePool:null),h!==null?a0(t,h):ed(),G0(t);else return t.lanes=t.childLanes=536870912,sg(e,t,h!==null?h.baseLanes|a:a,a)}else h!==null?(wi(t,h.cachePool),a0(t,h),wa(),t.memoizedState=null):(e!==null&&wi(t,null),ed(),wa());return zt(e,t,d,a),t.child}function sg(e,t,a,o){var d=Pc();return d=d===null?null:{parent:_t._currentValue,pool:d},t.memoizedState={baseLanes:a,cachePool:d},e!==null&&wi(t,null),ed(),G0(t),e!==null&&zs(e,t,o,!0),null}function zi(e,t){var a=t.ref;if(a===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(i(284));(e===null||e.ref!==a)&&(t.flags|=4194816)}}function wd(e,t,a,o,d){return rr(t),a=ad(e,t,a,o,void 0,d),o=rd(),e!==null&&!Ct?(sd(e,t,d),Jn(e,t,d)):(Qe&&o&&$c(t),t.flags|=1,zt(e,t,a,d),t.child)}function lg(e,t,a,o,d,h){return rr(t),t.updateQueue=null,a=s0(t,o,a,d),r0(e),o=rd(),e!==null&&!Ct?(sd(e,t,h),Jn(e,t,h)):(Qe&&o&&$c(t),t.flags|=1,zt(e,t,a,h),t.child)}function ig(e,t,a,o,d){if(rr(t),t.stateNode===null){var h=zr,y=a.contextType;typeof y=="object"&&y!==null&&(h=Ft(y)),h=new a(o,h),t.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=bd,t.stateNode=h,h._reactInternals=t,h=t.stateNode,h.props=o,h.state=t.memoizedState,h.refs={},Xc(t),y=a.contextType,h.context=typeof y=="object"&&y!==null?Ft(y):zr,h.state=t.memoizedState,y=a.getDerivedStateFromProps,typeof y=="function"&&(xd(t,a,y,o),h.state=t.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(y=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),y!==h.state&&bd.enqueueReplaceState(h,h.state,null),Gs(t,o,h,d),Fs(),h.state=t.memoizedState),typeof h.componentDidMount=="function"&&(t.flags|=4194308),o=!0}else if(e===null){h=t.stateNode;var v=t.memoizedProps,N=ir(a,v);h.props=N;var B=h.context,Z=a.contextType;y=zr,typeof Z=="object"&&Z!==null&&(y=Ft(Z));var ae=a.getDerivedStateFromProps;Z=typeof ae=="function"||typeof h.getSnapshotBeforeUpdate=="function",v=t.pendingProps!==v,Z||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(v||B!==y)&&W0(t,h,o,y),pa=!1;var F=t.memoizedState;h.state=F,Gs(t,o,h,d),Fs(),B=t.memoizedState,v||F!==B||pa?(typeof ae=="function"&&(xd(t,a,ae,o),B=t.memoizedState),(N=pa||V0(t,a,N,o,F,B,y))?(Z||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(t.flags|=4194308)):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=o,t.memoizedState=B),h.props=o,h.state=B,h.context=y,o=N):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),o=!1)}else{h=t.stateNode,Kc(e,t),y=t.memoizedProps,Z=ir(a,y),h.props=Z,ae=t.pendingProps,F=h.context,B=a.contextType,N=zr,typeof B=="object"&&B!==null&&(N=Ft(B)),v=a.getDerivedStateFromProps,(B=typeof v=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(y!==ae||F!==N)&&W0(t,h,o,N),pa=!1,F=t.memoizedState,h.state=F,Gs(t,o,h,d),Fs();var V=t.memoizedState;y!==ae||F!==V||pa||e!==null&&e.dependencies!==null&&bi(e.dependencies)?(typeof v=="function"&&(xd(t,a,v,o),V=t.memoizedState),(Z=pa||V0(t,a,Z,o,F,V,N)||e!==null&&e.dependencies!==null&&bi(e.dependencies))?(B||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(o,V,N),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(o,V,N)),typeof h.componentDidUpdate=="function"&&(t.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof h.componentDidUpdate!="function"||y===e.memoizedProps&&F===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&F===e.memoizedState||(t.flags|=1024),t.memoizedProps=o,t.memoizedState=V),h.props=o,h.state=V,h.context=N,o=Z):(typeof h.componentDidUpdate!="function"||y===e.memoizedProps&&F===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&F===e.memoizedState||(t.flags|=1024),o=!1)}return h=o,zi(e,t),o=(t.flags&128)!==0,h||o?(h=t.stateNode,a=o&&typeof a.getDerivedStateFromError!="function"?null:h.render(),t.flags|=1,e!==null&&o?(t.child=Pr(t,e.child,null,d),t.child=Pr(t,null,a,d)):zt(e,t,a,d),t.memoizedState=h.state,e=t.child):e=Jn(e,t,d),e}function og(e,t,a,o){return Us(),t.flags|=256,zt(e,t,a,o),t.child}var _d={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function kd(e){return{baseLanes:e,cachePool:Qf()}}function Nd(e,t,a){return e=e!==null?e.childLanes&~a:0,t&&(e|=wn),e}function cg(e,t,a){var o=t.pendingProps,d=!1,h=(t.flags&128)!==0,y;if((y=h)||(y=e!==null&&e.memoizedState===null?!1:(kt.current&2)!==0),y&&(d=!0,t.flags&=-129),y=(t.flags&32)!==0,t.flags&=-33,e===null){if(Qe){if(d?va(t):wa(),Qe){var v=ft,N;if(N=v){e:{for(N=v,v=Mn;N.nodeType!==8;){if(!v){v=null;break e}if(N=Sn(N.nextSibling),N===null){v=null;break e}}v=N}v!==null?(t.memoizedState={dehydrated:v,treeContext:Ja!==null?{id:Wn,overflow:Pn}:null,retryLane:536870912,hydrationErrors:null},N=ln(18,null,null,0),N.stateNode=v,N.return=t,t.child=N,Wt=t,ft=null,N=!0):N=!1}N||nr(t)}if(v=t.memoizedState,v!==null&&(v=v.dehydrated,v!==null))return iu(v)?t.lanes=32:t.lanes=536870912,null;Zn(t)}return v=o.children,o=o.fallback,d?(wa(),d=t.mode,v=Hi({mode:"hidden",children:v},d),o=Za(o,d,a,null),v.return=t,o.return=t,v.sibling=o,t.child=v,d=t.child,d.memoizedState=kd(a),d.childLanes=Nd(e,y,a),t.memoizedState=_d,o):(va(t),Td(t,v))}if(N=e.memoizedState,N!==null&&(v=N.dehydrated,v!==null)){if(h)t.flags&256?(va(t),t.flags&=-257,t=jd(e,t,a)):t.memoizedState!==null?(wa(),t.child=e.child,t.flags|=128,t=null):(wa(),d=o.fallback,v=t.mode,o=Hi({mode:"visible",children:o.children},v),d=Za(d,v,a,null),d.flags|=2,o.return=t,d.return=t,o.sibling=d,t.child=o,Pr(t,e.child,null,a),o=t.child,o.memoizedState=kd(a),o.childLanes=Nd(e,y,a),t.memoizedState=_d,t=d);else if(va(t),iu(v)){if(y=v.nextSibling&&v.nextSibling.dataset,y)var B=y.dgst;y=B,o=Error(i(419)),o.stack="",o.digest=y,Ls({value:o,source:null,stack:null}),t=jd(e,t,a)}else if(Ct||zs(e,t,a,!1),y=(a&e.childLanes)!==0,Ct||y){if(y=ot,y!==null&&(o=a&-a,o=(o&42)!==0?1:oc(o),o=(o&(y.suspendedLanes|a))!==0?0:o,o!==0&&o!==N.retryLane))throw N.retryLane=o,Lr(e,o),hn(y,e,o),eg;v.data==="$?"||Fd(),t=jd(e,t,a)}else v.data==="$?"?(t.flags|=192,t.child=e.child,t=null):(e=N.treeContext,ft=Sn(v.nextSibling),Wt=t,Qe=!0,tr=null,Mn=!1,e!==null&&(xn[bn++]=Wn,xn[bn++]=Pn,xn[bn++]=Ja,Wn=e.id,Pn=e.overflow,Ja=t),t=Td(t,o.children),t.flags|=4096);return t}return d?(wa(),d=o.fallback,v=t.mode,N=e.child,B=N.sibling,o=Vn(N,{mode:"hidden",children:o.children}),o.subtreeFlags=N.subtreeFlags&65011712,B!==null?d=Vn(B,d):(d=Za(d,v,a,null),d.flags|=2),d.return=t,o.return=t,o.sibling=d,t.child=o,o=d,d=t.child,v=e.child.memoizedState,v===null?v=kd(a):(N=v.cachePool,N!==null?(B=_t._currentValue,N=N.parent!==B?{parent:B,pool:B}:N):N=Qf(),v={baseLanes:v.baseLanes|a,cachePool:N}),d.memoizedState=v,d.childLanes=Nd(e,y,a),t.memoizedState=_d,o):(va(t),a=e.child,e=a.sibling,a=Vn(a,{mode:"visible",children:o.children}),a.return=t,a.sibling=null,e!==null&&(y=t.deletions,y===null?(t.deletions=[e],t.flags|=16):y.push(e)),t.child=a,t.memoizedState=null,a)}function Td(e,t){return t=Hi({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Hi(e,t){return e=ln(22,e,null,t),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function jd(e,t,a){return Pr(t,e.child,null,a),e=Td(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function dg(e,t,a){e.lanes|=t;var o=e.alternate;o!==null&&(o.lanes|=t),Fc(e.return,t,a)}function Sd(e,t,a,o,d){var h=e.memoizedState;h===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:a,tailMode:d}:(h.isBackwards=t,h.rendering=null,h.renderingStartTime=0,h.last=o,h.tail=a,h.tailMode=d)}function ug(e,t,a){var o=t.pendingProps,d=o.revealOrder,h=o.tail;if(zt(e,t,o.children,a),o=kt.current,(o&2)!==0)o=o&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&dg(e,a,t);else if(e.tag===19)dg(e,a,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}switch(Q(kt,o),d){case"forwards":for(a=t.child,d=null;a!==null;)e=a.alternate,e!==null&&Ii(e)===null&&(d=a),a=a.sibling;a=d,a===null?(d=t.child,t.child=null):(d=a.sibling,a.sibling=null),Sd(t,!1,d,a,h);break;case"backwards":for(a=null,d=t.child,t.child=null;d!==null;){if(e=d.alternate,e!==null&&Ii(e)===null){t.child=d;break}e=d.sibling,d.sibling=a,a=d,d=e}Sd(t,!0,a,null,h);break;case"together":Sd(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Jn(e,t,a){if(e!==null&&(t.dependencies=e.dependencies),ja|=t.lanes,(a&t.childLanes)===0)if(e!==null){if(zs(e,t,a,!1),(a&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(i(153));if(t.child!==null){for(e=t.child,a=Vn(e,e.pendingProps),t.child=a,a.return=t;e.sibling!==null;)e=e.sibling,a=a.sibling=Vn(e,e.pendingProps),a.return=t;a.sibling=null}return t.child}function Dd(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&bi(e)))}function iv(e,t,a){switch(t.tag){case 3:ee(t,t.stateNode.containerInfo),ma(t,_t,e.memoizedState.cache),Us();break;case 27:case 5:Ne(t);break;case 4:ee(t,t.stateNode.containerInfo);break;case 10:ma(t,t.type,t.memoizedProps.value);break;case 13:var o=t.memoizedState;if(o!==null)return o.dehydrated!==null?(va(t),t.flags|=128,null):(a&t.child.childLanes)!==0?cg(e,t,a):(va(t),e=Jn(e,t,a),e!==null?e.sibling:null);va(t);break;case 19:var d=(e.flags&128)!==0;if(o=(a&t.childLanes)!==0,o||(zs(e,t,a,!1),o=(a&t.childLanes)!==0),d){if(o)return ug(e,t,a);t.flags|=128}if(d=t.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),Q(kt,kt.current),o)break;return null;case 22:case 23:return t.lanes=0,rg(e,t,a);case 24:ma(t,_t,e.memoizedState.cache)}return Jn(e,t,a)}function hg(e,t,a){if(e!==null)if(e.memoizedProps!==t.pendingProps)Ct=!0;else{if(!Dd(e,a)&&(t.flags&128)===0)return Ct=!1,iv(e,t,a);Ct=(e.flags&131072)!==0}else Ct=!1,Qe&&(t.flags&1048576)!==0&&qf(t,xi,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var o=t.elementType,d=o._init;if(o=d(o._payload),t.type=o,typeof o=="function")Lc(o)?(e=ir(o,e),t.tag=1,t=ig(null,t,o,e,a)):(t.tag=0,t=wd(null,t,o,e,a));else{if(o!=null){if(d=o.$$typeof,d===D){t.tag=11,t=tg(null,t,o,e,a);break e}else if(d===I){t.tag=14,t=ng(null,t,o,e,a);break e}}throw t=je(o)||o,Error(i(306,t,""))}}return t;case 0:return wd(e,t,t.type,t.pendingProps,a);case 1:return o=t.type,d=ir(o,t.pendingProps),ig(e,t,o,d,a);case 3:e:{if(ee(t,t.stateNode.containerInfo),e===null)throw Error(i(387));o=t.pendingProps;var h=t.memoizedState;d=h.element,Kc(e,t),Gs(t,o,null,a);var y=t.memoizedState;if(o=y.cache,ma(t,_t,o),o!==h.cache&&Gc(t,[_t],a,!0),Fs(),o=y.element,h.isDehydrated)if(h={element:o,isDehydrated:!1,cache:y.cache},t.updateQueue.baseState=h,t.memoizedState=h,t.flags&256){t=og(e,t,o,a);break e}else if(o!==d){d=pn(Error(i(424)),t),Ls(d),t=og(e,t,o,a);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(ft=Sn(e.firstChild),Wt=t,Qe=!0,tr=null,Mn=!0,a=F0(t,null,o,a),t.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(Us(),o===d){t=Jn(e,t,a);break e}zt(e,t,o,a)}t=t.child}return t;case 26:return zi(e,t),e===null?(a=pm(t.type,null,t.pendingProps,null))?t.memoizedState=a:Qe||(a=t.type,e=t.pendingProps,o=Ji(ue.current).createElement(a),o[Yt]=t,o[Xt]=e,$t(o,a,e),Et(o),t.stateNode=o):t.memoizedState=pm(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Ne(t),e===null&&Qe&&(o=t.stateNode=fm(t.type,t.pendingProps,ue.current),Wt=t,Mn=!0,d=ft,Ca(t.type)?(ou=d,ft=Sn(o.firstChild)):ft=d),zt(e,t,t.pendingProps.children,a),zi(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Qe&&((d=o=ft)&&(o=Iv(o,t.type,t.pendingProps,Mn),o!==null?(t.stateNode=o,Wt=t,ft=Sn(o.firstChild),Mn=!1,d=!0):d=!1),d||nr(t)),Ne(t),d=t.type,h=t.pendingProps,y=e!==null?e.memoizedProps:null,o=h.children,ru(d,h)?o=null:y!==null&&ru(d,y)&&(t.flags|=32),t.memoizedState!==null&&(d=ad(e,t,Jb,null,null,a),fl._currentValue=d),zi(e,t),zt(e,t,o,a),t.child;case 6:return e===null&&Qe&&((e=a=ft)&&(a=Uv(a,t.pendingProps,Mn),a!==null?(t.stateNode=a,Wt=t,ft=null,e=!0):e=!1),e||nr(t)),null;case 13:return cg(e,t,a);case 4:return ee(t,t.stateNode.containerInfo),o=t.pendingProps,e===null?t.child=Pr(t,null,o,a):zt(e,t,o,a),t.child;case 11:return tg(e,t,t.type,t.pendingProps,a);case 7:return zt(e,t,t.pendingProps,a),t.child;case 8:return zt(e,t,t.pendingProps.children,a),t.child;case 12:return zt(e,t,t.pendingProps.children,a),t.child;case 10:return o=t.pendingProps,ma(t,t.type,o.value),zt(e,t,o.children,a),t.child;case 9:return d=t.type._context,o=t.pendingProps.children,rr(t),d=Ft(d),o=o(d),t.flags|=1,zt(e,t,o,a),t.child;case 14:return ng(e,t,t.type,t.pendingProps,a);case 15:return ag(e,t,t.type,t.pendingProps,a);case 19:return ug(e,t,a);case 31:return o=t.pendingProps,a=t.mode,o={mode:o.mode,children:o.children},e===null?(a=Hi(o,a),a.ref=t.ref,t.child=a,a.return=t,t=a):(a=Vn(e.child,o),a.ref=t.ref,t.child=a,a.return=t,t=a),t;case 22:return rg(e,t,a);case 24:return rr(t),o=Ft(_t),e===null?(d=Pc(),d===null&&(d=ot,h=Vc(),d.pooledCache=h,h.refCount++,h!==null&&(d.pooledCacheLanes|=a),d=h),t.memoizedState={parent:o,cache:d},Xc(t),ma(t,_t,d)):((e.lanes&a)!==0&&(Kc(e,t),Gs(t,null,null,a),Fs()),d=e.memoizedState,h=t.memoizedState,d.parent!==o?(d={parent:o,cache:o},t.memoizedState=d,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=d),ma(t,_t,o)):(o=h.cache,ma(t,_t,o),o!==d.cache&&Gc(t,[_t],a,!0))),zt(e,t,t.pendingProps.children,a),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function ea(e){e.flags|=4}function fg(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!wm(t)){if(t=vn.current,t!==null&&((Ve&4194048)===Ve?In!==null:(Ve&62914560)!==Ve&&(Ve&536870912)===0||t!==In))throw qs=Qc,Xf;e.flags|=8192}}function $i(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?Fh():536870912,e.lanes|=t,Zr|=t)}function Zs(e,t){if(!Qe)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;t!==null;)t.alternate!==null&&(a=t),t=t.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function ht(e){var t=e.alternate!==null&&e.alternate.child===e.child,a=0,o=0;if(t)for(var d=e.child;d!==null;)a|=d.lanes|d.childLanes,o|=d.subtreeFlags&65011712,o|=d.flags&65011712,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)a|=d.lanes|d.childLanes,o|=d.subtreeFlags,o|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=o,e.childLanes=a,t}function ov(e,t,a){var o=t.pendingProps;switch(Bc(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ht(t),null;case 1:return ht(t),null;case 3:return a=t.stateNode,o=null,e!==null&&(o=e.memoizedState.cache),t.memoizedState.cache!==o&&(t.flags|=2048),Xn(_t),oe(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Is(t)?ea(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Gf())),ht(t),null;case 26:return a=t.memoizedState,e===null?(ea(t),a!==null?(ht(t),fg(t,a)):(ht(t),t.flags&=-16777217)):a?a!==e.memoizedState?(ea(t),ht(t),fg(t,a)):(ht(t),t.flags&=-16777217):(e.memoizedProps!==o&&ea(t),ht(t),t.flags&=-16777217),null;case 27:de(t),a=ue.current;var d=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==o&&ea(t);else{if(!o){if(t.stateNode===null)throw Error(i(166));return ht(t),null}e=xe.current,Is(t)?Yf(t):(e=fm(d,o,a),t.stateNode=e,ea(t))}return ht(t),null;case 5:if(de(t),a=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==o&&ea(t);else{if(!o){if(t.stateNode===null)throw Error(i(166));return ht(t),null}if(e=xe.current,Is(t))Yf(t);else{switch(d=Ji(ue.current),e){case 1:e=d.createElementNS("http://www.w3.org/2000/svg",a);break;case 2:e=d.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;default:switch(a){case"svg":e=d.createElementNS("http://www.w3.org/2000/svg",a);break;case"math":e=d.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;case"script":e=d.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof o.is=="string"?d.createElement("select",{is:o.is}):d.createElement("select"),o.multiple?e.multiple=!0:o.size&&(e.size=o.size);break;default:e=typeof o.is=="string"?d.createElement(a,{is:o.is}):d.createElement(a)}}e[Yt]=t,e[Xt]=o;e:for(d=t.child;d!==null;){if(d.tag===5||d.tag===6)e.appendChild(d.stateNode);else if(d.tag!==4&&d.tag!==27&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}t.stateNode=e;e:switch($t(e,a,o),a){case"button":case"input":case"select":case"textarea":e=!!o.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&ea(t)}}return ht(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==o&&ea(t);else{if(typeof o!="string"&&t.stateNode===null)throw Error(i(166));if(e=ue.current,Is(t)){if(e=t.stateNode,a=t.memoizedProps,o=null,d=Wt,d!==null)switch(d.tag){case 27:case 5:o=d.memoizedProps}e[Yt]=t,e=!!(e.nodeValue===a||o!==null&&o.suppressHydrationWarning===!0||lm(e.nodeValue,a)),e||nr(t)}else e=Ji(e).createTextNode(o),e[Yt]=t,t.stateNode=e}return ht(t),null;case 13:if(o=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(d=Is(t),o!==null&&o.dehydrated!==null){if(e===null){if(!d)throw Error(i(318));if(d=t.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(i(317));d[Yt]=t}else Us(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ht(t),d=!1}else d=Gf(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=d),d=!0;if(!d)return t.flags&256?(Zn(t),t):(Zn(t),null)}if(Zn(t),(t.flags&128)!==0)return t.lanes=a,t;if(a=o!==null,e=e!==null&&e.memoizedState!==null,a){o=t.child,d=null,o.alternate!==null&&o.alternate.memoizedState!==null&&o.alternate.memoizedState.cachePool!==null&&(d=o.alternate.memoizedState.cachePool.pool);var h=null;o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),h!==d&&(o.flags|=2048)}return a!==e&&a&&(t.child.flags|=8192),$i(t,t.updateQueue),ht(t),null;case 4:return oe(),e===null&&Jd(t.stateNode.containerInfo),ht(t),null;case 10:return Xn(t.type),ht(t),null;case 19:if(M(kt),d=t.memoizedState,d===null)return ht(t),null;if(o=(t.flags&128)!==0,h=d.rendering,h===null)if(o)Zs(d,!1);else{if(gt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(h=Ii(e),h!==null){for(t.flags|=128,Zs(d,!1),e=h.updateQueue,t.updateQueue=e,$i(t,e),t.subtreeFlags=0,e=a,a=t.child;a!==null;)Bf(a,e),a=a.sibling;return Q(kt,kt.current&1|2),t.child}e=e.sibling}d.tail!==null&&Dt()>Yi&&(t.flags|=128,o=!0,Zs(d,!1),t.lanes=4194304)}else{if(!o)if(e=Ii(h),e!==null){if(t.flags|=128,o=!0,e=e.updateQueue,t.updateQueue=e,$i(t,e),Zs(d,!0),d.tail===null&&d.tailMode==="hidden"&&!h.alternate&&!Qe)return ht(t),null}else 2*Dt()-d.renderingStartTime>Yi&&a!==536870912&&(t.flags|=128,o=!0,Zs(d,!1),t.lanes=4194304);d.isBackwards?(h.sibling=t.child,t.child=h):(e=d.last,e!==null?e.sibling=h:t.child=h,d.last=h)}return d.tail!==null?(t=d.tail,d.rendering=t,d.tail=t.sibling,d.renderingStartTime=Dt(),t.sibling=null,e=kt.current,Q(kt,o?e&1|2:e&1),t):(ht(t),null);case 22:case 23:return Zn(t),td(),o=t.memoizedState!==null,e!==null?e.memoizedState!==null!==o&&(t.flags|=8192):o&&(t.flags|=8192),o?(a&536870912)!==0&&(t.flags&128)===0&&(ht(t),t.subtreeFlags&6&&(t.flags|=8192)):ht(t),a=t.updateQueue,a!==null&&$i(t,a.retryQueue),a=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),o=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),o!==a&&(t.flags|=2048),e!==null&&M(sr),null;case 24:return a=null,e!==null&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),Xn(_t),ht(t),null;case 25:return null;case 30:return null}throw Error(i(156,t.tag))}function cv(e,t){switch(Bc(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Xn(_t),oe(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return de(t),null;case 13:if(Zn(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(i(340));Us()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return M(kt),null;case 4:return oe(),null;case 10:return Xn(t.type),null;case 22:case 23:return Zn(t),td(),e!==null&&M(sr),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Xn(_t),null;case 25:return null;default:return null}}function gg(e,t){switch(Bc(t),t.tag){case 3:Xn(_t),oe();break;case 26:case 27:case 5:de(t);break;case 4:oe();break;case 13:Zn(t);break;case 19:M(kt);break;case 10:Xn(t.type);break;case 22:case 23:Zn(t),td(),e!==null&&M(sr);break;case 24:Xn(_t)}}function Js(e,t){try{var a=t.updateQueue,o=a!==null?a.lastEffect:null;if(o!==null){var d=o.next;a=d;do{if((a.tag&e)===e){o=void 0;var h=a.create,y=a.inst;o=h(),y.destroy=o}a=a.next}while(a!==d)}}catch(v){lt(t,t.return,v)}}function _a(e,t,a){try{var o=t.updateQueue,d=o!==null?o.lastEffect:null;if(d!==null){var h=d.next;o=h;do{if((o.tag&e)===e){var y=o.inst,v=y.destroy;if(v!==void 0){y.destroy=void 0,d=t;var N=a,B=v;try{B()}catch(Z){lt(d,N,Z)}}}o=o.next}while(o!==h)}}catch(Z){lt(t,t.return,Z)}}function mg(e){var t=e.updateQueue;if(t!==null){var a=e.stateNode;try{n0(t,a)}catch(o){lt(e,e.return,o)}}}function pg(e,t,a){a.props=ir(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(o){lt(e,t,o)}}function el(e,t){try{var a=e.ref;if(a!==null){switch(e.tag){case 26:case 27:case 5:var o=e.stateNode;break;case 30:o=e.stateNode;break;default:o=e.stateNode}typeof a=="function"?e.refCleanup=a(o):a.current=o}}catch(d){lt(e,t,d)}}function Un(e,t){var a=e.ref,o=e.refCleanup;if(a!==null)if(typeof o=="function")try{o()}catch(d){lt(e,t,d)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(d){lt(e,t,d)}else a.current=null}function yg(e){var t=e.type,a=e.memoizedProps,o=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":a.autoFocus&&o.focus();break e;case"img":a.src?o.src=a.src:a.srcSet&&(o.srcset=a.srcSet)}}catch(d){lt(e,e.return,d)}}function Ed(e,t,a){try{var o=e.stateNode;Cv(o,e.type,a,t),o[Xt]=t}catch(d){lt(e,e.return,d)}}function xg(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Ca(e.type)||e.tag===4}function Cd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||xg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Ca(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ad(e,t,a){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(e,t):(t=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,t.appendChild(e),a=a._reactRootContainer,a!=null||t.onclick!==null||(t.onclick=Zi));else if(o!==4&&(o===27&&Ca(e.type)&&(a=e.stateNode,t=null),e=e.child,e!==null))for(Ad(e,t,a),e=e.sibling;e!==null;)Ad(e,t,a),e=e.sibling}function Bi(e,t,a){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(o!==4&&(o===27&&Ca(e.type)&&(a=e.stateNode),e=e.child,e!==null))for(Bi(e,t,a),e=e.sibling;e!==null;)Bi(e,t,a),e=e.sibling}function bg(e){var t=e.stateNode,a=e.memoizedProps;try{for(var o=e.type,d=t.attributes;d.length;)t.removeAttributeNode(d[0]);$t(t,o,a),t[Yt]=e,t[Xt]=a}catch(h){lt(e,e.return,h)}}var ta=!1,xt=!1,Rd=!1,vg=typeof WeakSet=="function"?WeakSet:Set,At=null;function dv(e,t){if(e=e.containerInfo,nu=so,e=Af(e),Cc(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var o=a.getSelection&&a.getSelection();if(o&&o.rangeCount!==0){a=o.anchorNode;var d=o.anchorOffset,h=o.focusNode;o=o.focusOffset;try{a.nodeType,h.nodeType}catch{a=null;break e}var y=0,v=-1,N=-1,B=0,Z=0,ae=e,F=null;t:for(;;){for(var V;ae!==a||d!==0&&ae.nodeType!==3||(v=y+d),ae!==h||o!==0&&ae.nodeType!==3||(N=y+o),ae.nodeType===3&&(y+=ae.nodeValue.length),(V=ae.firstChild)!==null;)F=ae,ae=V;for(;;){if(ae===e)break t;if(F===a&&++B===d&&(v=y),F===h&&++Z===o&&(N=y),(V=ae.nextSibling)!==null)break;ae=F,F=ae.parentNode}ae=V}a=v===-1||N===-1?null:{start:v,end:N}}else a=null}a=a||{start:0,end:0}}else a=null;for(au={focusedElem:e,selectionRange:a},so=!1,At=t;At!==null;)if(t=At,e=t.child,(t.subtreeFlags&1024)!==0&&e!==null)e.return=t,At=e;else for(;At!==null;){switch(t=At,h=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if((e&1024)!==0&&h!==null){e=void 0,a=t,d=h.memoizedProps,h=h.memoizedState,o=a.stateNode;try{var Ue=ir(a.type,d,a.elementType===a.type);e=o.getSnapshotBeforeUpdate(Ue,h),o.__reactInternalSnapshotBeforeUpdate=e}catch(Re){lt(a,a.return,Re)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,a=e.nodeType,a===9)lu(e);else if(a===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":lu(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(i(163))}if(e=t.sibling,e!==null){e.return=t.return,At=e;break}At=t.return}}function wg(e,t,a){var o=a.flags;switch(a.tag){case 0:case 11:case 15:ka(e,a),o&4&&Js(5,a);break;case 1:if(ka(e,a),o&4)if(e=a.stateNode,t===null)try{e.componentDidMount()}catch(y){lt(a,a.return,y)}else{var d=ir(a.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(d,t,e.__reactInternalSnapshotBeforeUpdate)}catch(y){lt(a,a.return,y)}}o&64&&mg(a),o&512&&el(a,a.return);break;case 3:if(ka(e,a),o&64&&(e=a.updateQueue,e!==null)){if(t=null,a.child!==null)switch(a.child.tag){case 27:case 5:t=a.child.stateNode;break;case 1:t=a.child.stateNode}try{n0(e,t)}catch(y){lt(a,a.return,y)}}break;case 27:t===null&&o&4&&bg(a);case 26:case 5:ka(e,a),t===null&&o&4&&yg(a),o&512&&el(a,a.return);break;case 12:ka(e,a);break;case 13:ka(e,a),o&4&&Ng(e,a),o&64&&(e=a.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(a=bv.bind(null,a),Lv(e,a))));break;case 22:if(o=a.memoizedState!==null||ta,!o){t=t!==null&&t.memoizedState!==null||xt,d=ta;var h=xt;ta=o,(xt=t)&&!h?Na(e,a,(a.subtreeFlags&8772)!==0):ka(e,a),ta=d,xt=h}break;case 30:break;default:ka(e,a)}}function _g(e){var t=e.alternate;t!==null&&(e.alternate=null,_g(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&uc(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var ut=null,Jt=!1;function na(e,t,a){for(a=a.child;a!==null;)kg(e,t,a),a=a.sibling}function kg(e,t,a){if(Y&&typeof Y.onCommitFiberUnmount=="function")try{Y.onCommitFiberUnmount(q,a)}catch{}switch(a.tag){case 26:xt||Un(a,t),na(e,t,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:xt||Un(a,t);var o=ut,d=Jt;Ca(a.type)&&(ut=a.stateNode,Jt=!1),na(e,t,a),cl(a.stateNode),ut=o,Jt=d;break;case 5:xt||Un(a,t);case 6:if(o=ut,d=Jt,ut=null,na(e,t,a),ut=o,Jt=d,ut!==null)if(Jt)try{(ut.nodeType===9?ut.body:ut.nodeName==="HTML"?ut.ownerDocument.body:ut).removeChild(a.stateNode)}catch(h){lt(a,t,h)}else try{ut.removeChild(a.stateNode)}catch(h){lt(a,t,h)}break;case 18:ut!==null&&(Jt?(e=ut,um(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,a.stateNode),yl(e)):um(ut,a.stateNode));break;case 4:o=ut,d=Jt,ut=a.stateNode.containerInfo,Jt=!0,na(e,t,a),ut=o,Jt=d;break;case 0:case 11:case 14:case 15:xt||_a(2,a,t),xt||_a(4,a,t),na(e,t,a);break;case 1:xt||(Un(a,t),o=a.stateNode,typeof o.componentWillUnmount=="function"&&pg(a,t,o)),na(e,t,a);break;case 21:na(e,t,a);break;case 22:xt=(o=xt)||a.memoizedState!==null,na(e,t,a),xt=o;break;default:na(e,t,a)}}function Ng(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{yl(e)}catch(a){lt(t,t.return,a)}}function uv(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new vg),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new vg),t;default:throw Error(i(435,e.tag))}}function Od(e,t){var a=uv(e);t.forEach(function(o){var d=vv.bind(null,e,o);a.has(o)||(a.add(o),o.then(d,d))})}function on(e,t){var a=t.deletions;if(a!==null)for(var o=0;o<a.length;o++){var d=a[o],h=e,y=t,v=y;e:for(;v!==null;){switch(v.tag){case 27:if(Ca(v.type)){ut=v.stateNode,Jt=!1;break e}break;case 5:ut=v.stateNode,Jt=!1;break e;case 3:case 4:ut=v.stateNode.containerInfo,Jt=!0;break e}v=v.return}if(ut===null)throw Error(i(160));kg(h,y,d),ut=null,Jt=!1,h=d.alternate,h!==null&&(h.return=null),d.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)Tg(t,e),t=t.sibling}var jn=null;function Tg(e,t){var a=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:on(t,e),cn(e),o&4&&(_a(3,e,e.return),Js(3,e),_a(5,e,e.return));break;case 1:on(t,e),cn(e),o&512&&(xt||a===null||Un(a,a.return)),o&64&&ta&&(e=e.updateQueue,e!==null&&(o=e.callbacks,o!==null&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=a===null?o:a.concat(o))));break;case 26:var d=jn;if(on(t,e),cn(e),o&512&&(xt||a===null||Un(a,a.return)),o&4){var h=a!==null?a.memoizedState:null;if(o=e.memoizedState,a===null)if(o===null)if(e.stateNode===null){e:{o=e.type,a=e.memoizedProps,d=d.ownerDocument||d;t:switch(o){case"title":h=d.getElementsByTagName("title")[0],(!h||h[Ns]||h[Yt]||h.namespaceURI==="http://www.w3.org/2000/svg"||h.hasAttribute("itemprop"))&&(h=d.createElement(o),d.head.insertBefore(h,d.querySelector("head > title"))),$t(h,o,a),h[Yt]=e,Et(h),o=h;break e;case"link":var y=bm("link","href",d).get(o+(a.href||""));if(y){for(var v=0;v<y.length;v++)if(h=y[v],h.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&h.getAttribute("rel")===(a.rel==null?null:a.rel)&&h.getAttribute("title")===(a.title==null?null:a.title)&&h.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){y.splice(v,1);break t}}h=d.createElement(o),$t(h,o,a),d.head.appendChild(h);break;case"meta":if(y=bm("meta","content",d).get(o+(a.content||""))){for(v=0;v<y.length;v++)if(h=y[v],h.getAttribute("content")===(a.content==null?null:""+a.content)&&h.getAttribute("name")===(a.name==null?null:a.name)&&h.getAttribute("property")===(a.property==null?null:a.property)&&h.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&h.getAttribute("charset")===(a.charSet==null?null:a.charSet)){y.splice(v,1);break t}}h=d.createElement(o),$t(h,o,a),d.head.appendChild(h);break;default:throw Error(i(468,o))}h[Yt]=e,Et(h),o=h}e.stateNode=o}else vm(d,e.type,e.stateNode);else e.stateNode=xm(d,o,e.memoizedProps);else h!==o?(h===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):h.count--,o===null?vm(d,e.type,e.stateNode):xm(d,o,e.memoizedProps)):o===null&&e.stateNode!==null&&Ed(e,e.memoizedProps,a.memoizedProps)}break;case 27:on(t,e),cn(e),o&512&&(xt||a===null||Un(a,a.return)),a!==null&&o&4&&Ed(e,e.memoizedProps,a.memoizedProps);break;case 5:if(on(t,e),cn(e),o&512&&(xt||a===null||Un(a,a.return)),e.flags&32){d=e.stateNode;try{Cr(d,"")}catch(V){lt(e,e.return,V)}}o&4&&e.stateNode!=null&&(d=e.memoizedProps,Ed(e,d,a!==null?a.memoizedProps:d)),o&1024&&(Rd=!0);break;case 6:if(on(t,e),cn(e),o&4){if(e.stateNode===null)throw Error(i(162));o=e.memoizedProps,a=e.stateNode;try{a.nodeValue=o}catch(V){lt(e,e.return,V)}}break;case 3:if(no=null,d=jn,jn=eo(t.containerInfo),on(t,e),jn=d,cn(e),o&4&&a!==null&&a.memoizedState.isDehydrated)try{yl(t.containerInfo)}catch(V){lt(e,e.return,V)}Rd&&(Rd=!1,jg(e));break;case 4:o=jn,jn=eo(e.stateNode.containerInfo),on(t,e),cn(e),jn=o;break;case 12:on(t,e),cn(e);break;case 13:on(t,e),cn(e),e.child.flags&8192&&e.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(Hd=Dt()),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,Od(e,o)));break;case 22:d=e.memoizedState!==null;var N=a!==null&&a.memoizedState!==null,B=ta,Z=xt;if(ta=B||d,xt=Z||N,on(t,e),xt=Z,ta=B,cn(e),o&8192)e:for(t=e.stateNode,t._visibility=d?t._visibility&-2:t._visibility|1,d&&(a===null||N||ta||xt||or(e)),a=null,t=e;;){if(t.tag===5||t.tag===26){if(a===null){N=a=t;try{if(h=N.stateNode,d)y=h.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{v=N.stateNode;var ae=N.memoizedProps.style,F=ae!=null&&ae.hasOwnProperty("display")?ae.display:null;v.style.display=F==null||typeof F=="boolean"?"":(""+F).trim()}}catch(V){lt(N,N.return,V)}}}else if(t.tag===6){if(a===null){N=t;try{N.stateNode.nodeValue=d?"":N.memoizedProps}catch(V){lt(N,N.return,V)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;a===t&&(a=null),t=t.return}a===t&&(a=null),t.sibling.return=t.return,t=t.sibling}o&4&&(o=e.updateQueue,o!==null&&(a=o.retryQueue,a!==null&&(o.retryQueue=null,Od(e,a))));break;case 19:on(t,e),cn(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,Od(e,o)));break;case 30:break;case 21:break;default:on(t,e),cn(e)}}function cn(e){var t=e.flags;if(t&2){try{for(var a,o=e.return;o!==null;){if(xg(o)){a=o;break}o=o.return}if(a==null)throw Error(i(160));switch(a.tag){case 27:var d=a.stateNode,h=Cd(e);Bi(e,h,d);break;case 5:var y=a.stateNode;a.flags&32&&(Cr(y,""),a.flags&=-33);var v=Cd(e);Bi(e,v,y);break;case 3:case 4:var N=a.stateNode.containerInfo,B=Cd(e);Ad(e,B,N);break;default:throw Error(i(161))}}catch(Z){lt(e,e.return,Z)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function jg(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;jg(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function ka(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)wg(e,t.alternate,t),t=t.sibling}function or(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:_a(4,t,t.return),or(t);break;case 1:Un(t,t.return);var a=t.stateNode;typeof a.componentWillUnmount=="function"&&pg(t,t.return,a),or(t);break;case 27:cl(t.stateNode);case 26:case 5:Un(t,t.return),or(t);break;case 22:t.memoizedState===null&&or(t);break;case 30:or(t);break;default:or(t)}e=e.sibling}}function Na(e,t,a){for(a=a&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var o=t.alternate,d=e,h=t,y=h.flags;switch(h.tag){case 0:case 11:case 15:Na(d,h,a),Js(4,h);break;case 1:if(Na(d,h,a),o=h,d=o.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(B){lt(o,o.return,B)}if(o=h,d=o.updateQueue,d!==null){var v=o.stateNode;try{var N=d.shared.hiddenCallbacks;if(N!==null)for(d.shared.hiddenCallbacks=null,d=0;d<N.length;d++)t0(N[d],v)}catch(B){lt(o,o.return,B)}}a&&y&64&&mg(h),el(h,h.return);break;case 27:bg(h);case 26:case 5:Na(d,h,a),a&&o===null&&y&4&&yg(h),el(h,h.return);break;case 12:Na(d,h,a);break;case 13:Na(d,h,a),a&&y&4&&Ng(d,h);break;case 22:h.memoizedState===null&&Na(d,h,a),el(h,h.return);break;case 30:break;default:Na(d,h,a)}t=t.sibling}}function Md(e,t){var a=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==a&&(e!=null&&e.refCount++,a!=null&&Hs(a))}function Id(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Hs(e))}function Ln(e,t,a,o){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Sg(e,t,a,o),t=t.sibling}function Sg(e,t,a,o){var d=t.flags;switch(t.tag){case 0:case 11:case 15:Ln(e,t,a,o),d&2048&&Js(9,t);break;case 1:Ln(e,t,a,o);break;case 3:Ln(e,t,a,o),d&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Hs(e)));break;case 12:if(d&2048){Ln(e,t,a,o),e=t.stateNode;try{var h=t.memoizedProps,y=h.id,v=h.onPostCommit;typeof v=="function"&&v(y,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(N){lt(t,t.return,N)}}else Ln(e,t,a,o);break;case 13:Ln(e,t,a,o);break;case 23:break;case 22:h=t.stateNode,y=t.alternate,t.memoizedState!==null?h._visibility&2?Ln(e,t,a,o):tl(e,t):h._visibility&2?Ln(e,t,a,o):(h._visibility|=2,Qr(e,t,a,o,(t.subtreeFlags&10256)!==0)),d&2048&&Md(y,t);break;case 24:Ln(e,t,a,o),d&2048&&Id(t.alternate,t);break;default:Ln(e,t,a,o)}}function Qr(e,t,a,o,d){for(d=d&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var h=e,y=t,v=a,N=o,B=y.flags;switch(y.tag){case 0:case 11:case 15:Qr(h,y,v,N,d),Js(8,y);break;case 23:break;case 22:var Z=y.stateNode;y.memoizedState!==null?Z._visibility&2?Qr(h,y,v,N,d):tl(h,y):(Z._visibility|=2,Qr(h,y,v,N,d)),d&&B&2048&&Md(y.alternate,y);break;case 24:Qr(h,y,v,N,d),d&&B&2048&&Id(y.alternate,y);break;default:Qr(h,y,v,N,d)}t=t.sibling}}function tl(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var a=e,o=t,d=o.flags;switch(o.tag){case 22:tl(a,o),d&2048&&Md(o.alternate,o);break;case 24:tl(a,o),d&2048&&Id(o.alternate,o);break;default:tl(a,o)}t=t.sibling}}var nl=8192;function Xr(e){if(e.subtreeFlags&nl)for(e=e.child;e!==null;)Dg(e),e=e.sibling}function Dg(e){switch(e.tag){case 26:Xr(e),e.flags&nl&&e.memoizedState!==null&&Xv(jn,e.memoizedState,e.memoizedProps);break;case 5:Xr(e);break;case 3:case 4:var t=jn;jn=eo(e.stateNode.containerInfo),Xr(e),jn=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=nl,nl=16777216,Xr(e),nl=t):Xr(e));break;default:Xr(e)}}function Eg(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function al(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var o=t[a];At=o,Ag(o,e)}Eg(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Cg(e),e=e.sibling}function Cg(e){switch(e.tag){case 0:case 11:case 15:al(e),e.flags&2048&&_a(9,e,e.return);break;case 3:al(e);break;case 12:al(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,qi(e)):al(e);break;default:al(e)}}function qi(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var o=t[a];At=o,Ag(o,e)}Eg(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:_a(8,t,t.return),qi(t);break;case 22:a=t.stateNode,a._visibility&2&&(a._visibility&=-3,qi(t));break;default:qi(t)}e=e.sibling}}function Ag(e,t){for(;At!==null;){var a=At;switch(a.tag){case 0:case 11:case 15:_a(8,a,t);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var o=a.memoizedState.cachePool.pool;o!=null&&o.refCount++}break;case 24:Hs(a.memoizedState.cache)}if(o=a.child,o!==null)o.return=a,At=o;else e:for(a=e;At!==null;){o=At;var d=o.sibling,h=o.return;if(_g(o),o===a){At=null;break e}if(d!==null){d.return=h,At=d;break e}At=h}}}var hv={getCacheForType:function(e){var t=Ft(_t),a=t.data.get(e);return a===void 0&&(a=e(),t.data.set(e,a)),a}},fv=typeof WeakMap=="function"?WeakMap:Map,Ke=0,ot=null,Ye=null,Ve=0,Ze=0,dn=null,Ta=!1,Kr=!1,Ud=!1,aa=0,gt=0,ja=0,cr=0,Ld=0,wn=0,Zr=0,rl=null,en=null,zd=!1,Hd=0,Yi=1/0,Fi=null,Sa=null,Ht=0,Da=null,Jr=null,es=0,$d=0,Bd=null,Rg=null,sl=0,qd=null;function un(){if((Ke&2)!==0&&Ve!==0)return Ve&-Ve;if(P.T!==null){var e=Br;return e!==0?e:Qd()}return Wh()}function Og(){wn===0&&(wn=(Ve&536870912)===0||Qe?ha():536870912);var e=vn.current;return e!==null&&(e.flags|=32),wn}function hn(e,t,a){(e===ot&&(Ze===2||Ze===9)||e.cancelPendingCommit!==null)&&(ts(e,0),Ea(e,Ve,wn,!1)),ks(e,a),((Ke&2)===0||e!==ot)&&(e===ot&&((Ke&2)===0&&(cr|=a),gt===4&&Ea(e,Ve,wn,!1)),zn(e))}function Mg(e,t,a){if((Ke&6)!==0)throw Error(i(327));var o=!a&&(t&124)===0&&(t&e.expiredLanes)===0||ze(e,t),d=o?pv(e,t):Gd(e,t,!0),h=o;do{if(d===0){Kr&&!o&&Ea(e,t,0,!1);break}else{if(a=e.current.alternate,h&&!gv(a)){d=Gd(e,t,!1),h=!1;continue}if(d===2){if(h=t,e.errorRecoveryDisabledLanes&h)var y=0;else y=e.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){t=y;e:{var v=e;d=rl;var N=v.current.memoizedState.isDehydrated;if(N&&(ts(v,y).flags|=256),y=Gd(v,y,!1),y!==2){if(Ud&&!N){v.errorRecoveryDisabledLanes|=h,cr|=h,d=4;break e}h=en,en=d,h!==null&&(en===null?en=h:en.push.apply(en,h))}d=y}if(h=!1,d!==2)continue}}if(d===1){ts(e,0),Ea(e,t,0,!0);break}e:{switch(o=e,h=d,h){case 0:case 1:throw Error(i(345));case 4:if((t&4194048)!==t)break;case 6:Ea(o,t,wn,!Ta);break e;case 2:en=null;break;case 3:case 5:break;default:throw Error(i(329))}if((t&62914560)===t&&(d=Hd+300-Dt(),10<d)){if(Ea(o,t,wn,!Ta),we(o,0,!0)!==0)break e;o.timeoutHandle=cm(Ig.bind(null,o,a,en,Fi,zd,t,wn,cr,Zr,Ta,h,2,-0,0),d);break e}Ig(o,a,en,Fi,zd,t,wn,cr,Zr,Ta,h,0,-0,0)}}break}while(!0);zn(e)}function Ig(e,t,a,o,d,h,y,v,N,B,Z,ae,F,V){if(e.timeoutHandle=-1,ae=t.subtreeFlags,(ae&8192||(ae&16785408)===16785408)&&(hl={stylesheets:null,count:0,unsuspend:Qv},Dg(t),ae=Kv(),ae!==null)){e.cancelPendingCommit=ae(qg.bind(null,e,t,h,a,o,d,y,v,N,Z,1,F,V)),Ea(e,h,y,!B);return}qg(e,t,h,a,o,d,y,v,N)}function gv(e){for(var t=e;;){var a=t.tag;if((a===0||a===11||a===15)&&t.flags&16384&&(a=t.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var o=0;o<a.length;o++){var d=a[o],h=d.getSnapshot;d=d.value;try{if(!sn(h(),d))return!1}catch{return!1}}if(a=t.child,t.subtreeFlags&16384&&a!==null)a.return=t,t=a;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ea(e,t,a,o){t&=~Ld,t&=~cr,e.suspendedLanes|=t,e.pingedLanes&=~t,o&&(e.warmLanes|=t),o=e.expirationTimes;for(var d=t;0<d;){var h=31-ne(d),y=1<<h;o[h]=-1,d&=~y}a!==0&&Gh(e,a,t)}function Gi(){return(Ke&6)===0?(ll(0),!1):!0}function Yd(){if(Ye!==null){if(Ze===0)var e=Ye.return;else e=Ye,Qn=ar=null,ld(e),Wr=null,Xs=0,e=Ye;for(;e!==null;)gg(e.alternate,e),e=e.return;Ye=null}}function ts(e,t){var a=e.timeoutHandle;a!==-1&&(e.timeoutHandle=-1,Rv(a)),a=e.cancelPendingCommit,a!==null&&(e.cancelPendingCommit=null,a()),Yd(),ot=e,Ye=a=Vn(e.current,null),Ve=t,Ze=0,dn=null,Ta=!1,Kr=ze(e,t),Ud=!1,Zr=wn=Ld=cr=ja=gt=0,en=rl=null,zd=!1,(t&8)!==0&&(t|=t&32);var o=e.entangledLanes;if(o!==0)for(e=e.entanglements,o&=t;0<o;){var d=31-ne(o),h=1<<d;t|=e[d],o&=~h}return aa=t,fi(),a}function Ug(e,t){He=null,P.H=Ri,t===Bs||t===_i?(t=Jf(),Ze=3):t===Xf?(t=Jf(),Ze=4):Ze=t===eg?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,dn=t,Ye===null&&(gt=1,Li(e,pn(t,e.current)))}function Lg(){var e=P.H;return P.H=Ri,e===null?Ri:e}function zg(){var e=P.A;return P.A=hv,e}function Fd(){gt=4,Ta||(Ve&4194048)!==Ve&&vn.current!==null||(Kr=!0),(ja&134217727)===0&&(cr&134217727)===0||ot===null||Ea(ot,Ve,wn,!1)}function Gd(e,t,a){var o=Ke;Ke|=2;var d=Lg(),h=zg();(ot!==e||Ve!==t)&&(Fi=null,ts(e,t)),t=!1;var y=gt;e:do try{if(Ze!==0&&Ye!==null){var v=Ye,N=dn;switch(Ze){case 8:Yd(),y=6;break e;case 3:case 2:case 9:case 6:vn.current===null&&(t=!0);var B=Ze;if(Ze=0,dn=null,ns(e,v,N,B),a&&Kr){y=0;break e}break;default:B=Ze,Ze=0,dn=null,ns(e,v,N,B)}}mv(),y=gt;break}catch(Z){Ug(e,Z)}while(!0);return t&&e.shellSuspendCounter++,Qn=ar=null,Ke=o,P.H=d,P.A=h,Ye===null&&(ot=null,Ve=0,fi()),y}function mv(){for(;Ye!==null;)Hg(Ye)}function pv(e,t){var a=Ke;Ke|=2;var o=Lg(),d=zg();ot!==e||Ve!==t?(Fi=null,Yi=Dt()+500,ts(e,t)):Kr=ze(e,t);e:do try{if(Ze!==0&&Ye!==null){t=Ye;var h=dn;t:switch(Ze){case 1:Ze=0,dn=null,ns(e,t,h,1);break;case 2:case 9:if(Kf(h)){Ze=0,dn=null,$g(t);break}t=function(){Ze!==2&&Ze!==9||ot!==e||(Ze=7),zn(e)},h.then(t,t);break e;case 3:Ze=7;break e;case 4:Ze=5;break e;case 7:Kf(h)?(Ze=0,dn=null,$g(t)):(Ze=0,dn=null,ns(e,t,h,7));break;case 5:var y=null;switch(Ye.tag){case 26:y=Ye.memoizedState;case 5:case 27:var v=Ye;if(!y||wm(y)){Ze=0,dn=null;var N=v.sibling;if(N!==null)Ye=N;else{var B=v.return;B!==null?(Ye=B,Vi(B)):Ye=null}break t}}Ze=0,dn=null,ns(e,t,h,5);break;case 6:Ze=0,dn=null,ns(e,t,h,6);break;case 8:Yd(),gt=6;break e;default:throw Error(i(462))}}yv();break}catch(Z){Ug(e,Z)}while(!0);return Qn=ar=null,P.H=o,P.A=d,Ke=a,Ye!==null?0:(ot=null,Ve=0,fi(),gt)}function yv(){for(;Ye!==null&&!Xe();)Hg(Ye)}function Hg(e){var t=hg(e.alternate,e,aa);e.memoizedProps=e.pendingProps,t===null?Vi(e):Ye=t}function $g(e){var t=e,a=t.alternate;switch(t.tag){case 15:case 0:t=lg(a,t,t.pendingProps,t.type,void 0,Ve);break;case 11:t=lg(a,t,t.pendingProps,t.type.render,t.ref,Ve);break;case 5:ld(t);default:gg(a,t),t=Ye=Bf(t,aa),t=hg(a,t,aa)}e.memoizedProps=e.pendingProps,t===null?Vi(e):Ye=t}function ns(e,t,a,o){Qn=ar=null,ld(t),Wr=null,Xs=0;var d=t.return;try{if(lv(e,d,t,a,Ve)){gt=1,Li(e,pn(a,e.current)),Ye=null;return}}catch(h){if(d!==null)throw Ye=d,h;gt=1,Li(e,pn(a,e.current)),Ye=null;return}t.flags&32768?(Qe||o===1?e=!0:Kr||(Ve&536870912)!==0?e=!1:(Ta=e=!0,(o===2||o===9||o===3||o===6)&&(o=vn.current,o!==null&&o.tag===13&&(o.flags|=16384))),Bg(t,e)):Vi(t)}function Vi(e){var t=e;do{if((t.flags&32768)!==0){Bg(t,Ta);return}e=t.return;var a=ov(t.alternate,t,aa);if(a!==null){Ye=a;return}if(t=t.sibling,t!==null){Ye=t;return}Ye=t=e}while(t!==null);gt===0&&(gt=5)}function Bg(e,t){do{var a=cv(e.alternate,e);if(a!==null){a.flags&=32767,Ye=a;return}if(a=e.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!t&&(e=e.sibling,e!==null)){Ye=e;return}Ye=e=a}while(e!==null);gt=6,Ye=null}function qg(e,t,a,o,d,h,y,v,N){e.cancelPendingCommit=null;do Wi();while(Ht!==0);if((Ke&6)!==0)throw Error(i(327));if(t!==null){if(t===e.current)throw Error(i(177));if(h=t.lanes|t.childLanes,h|=Ic,Qx(e,a,h,y,v,N),e===ot&&(Ye=ot=null,Ve=0),Jr=t,Da=e,es=a,$d=h,Bd=d,Rg=o,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,wv(_r,function(){return Wg(),null})):(e.callbackNode=null,e.callbackPriority=0),o=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||o){o=P.T,P.T=null,d=ce.p,ce.p=2,y=Ke,Ke|=4;try{dv(e,t,a)}finally{Ke=y,ce.p=d,P.T=o}}Ht=1,Yg(),Fg(),Gg()}}function Yg(){if(Ht===1){Ht=0;var e=Da,t=Jr,a=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||a){a=P.T,P.T=null;var o=ce.p;ce.p=2;var d=Ke;Ke|=4;try{Tg(t,e);var h=au,y=Af(e.containerInfo),v=h.focusedElem,N=h.selectionRange;if(y!==v&&v&&v.ownerDocument&&Cf(v.ownerDocument.documentElement,v)){if(N!==null&&Cc(v)){var B=N.start,Z=N.end;if(Z===void 0&&(Z=B),"selectionStart"in v)v.selectionStart=B,v.selectionEnd=Math.min(Z,v.value.length);else{var ae=v.ownerDocument||document,F=ae&&ae.defaultView||window;if(F.getSelection){var V=F.getSelection(),Ue=v.textContent.length,Re=Math.min(N.start,Ue),rt=N.end===void 0?Re:Math.min(N.end,Ue);!V.extend&&Re>rt&&(y=rt,rt=Re,Re=y);var U=Ef(v,Re),E=Ef(v,rt);if(U&&E&&(V.rangeCount!==1||V.anchorNode!==U.node||V.anchorOffset!==U.offset||V.focusNode!==E.node||V.focusOffset!==E.offset)){var $=ae.createRange();$.setStart(U.node,U.offset),V.removeAllRanges(),Re>rt?(V.addRange($),V.extend(E.node,E.offset)):($.setEnd(E.node,E.offset),V.addRange($))}}}}for(ae=[],V=v;V=V.parentNode;)V.nodeType===1&&ae.push({element:V,left:V.scrollLeft,top:V.scrollTop});for(typeof v.focus=="function"&&v.focus(),v=0;v<ae.length;v++){var te=ae[v];te.element.scrollLeft=te.left,te.element.scrollTop=te.top}}so=!!nu,au=nu=null}finally{Ke=d,ce.p=o,P.T=a}}e.current=t,Ht=2}}function Fg(){if(Ht===2){Ht=0;var e=Da,t=Jr,a=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||a){a=P.T,P.T=null;var o=ce.p;ce.p=2;var d=Ke;Ke|=4;try{wg(e,t.alternate,t)}finally{Ke=d,ce.p=o,P.T=a}}Ht=3}}function Gg(){if(Ht===4||Ht===3){Ht=0,Vt();var e=Da,t=Jr,a=es,o=Rg;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Ht=5:(Ht=0,Jr=Da=null,Vg(e,e.pendingLanes));var d=e.pendingLanes;if(d===0&&(Sa=null),cc(a),t=t.stateNode,Y&&typeof Y.onCommitFiberRoot=="function")try{Y.onCommitFiberRoot(q,t,void 0,(t.current.flags&128)===128)}catch{}if(o!==null){t=P.T,d=ce.p,ce.p=2,P.T=null;try{for(var h=e.onRecoverableError,y=0;y<o.length;y++){var v=o[y];h(v.value,{componentStack:v.stack})}}finally{P.T=t,ce.p=d}}(es&3)!==0&&Wi(),zn(e),d=e.pendingLanes,(a&4194090)!==0&&(d&42)!==0?e===qd?sl++:(sl=0,qd=e):sl=0,ll(0)}}function Vg(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Hs(t)))}function Wi(e){return Yg(),Fg(),Gg(),Wg()}function Wg(){if(Ht!==5)return!1;var e=Da,t=$d;$d=0;var a=cc(es),o=P.T,d=ce.p;try{ce.p=32>a?32:a,P.T=null,a=Bd,Bd=null;var h=Da,y=es;if(Ht=0,Jr=Da=null,es=0,(Ke&6)!==0)throw Error(i(331));var v=Ke;if(Ke|=4,Cg(h.current),Sg(h,h.current,y,a),Ke=v,ll(0,!1),Y&&typeof Y.onPostCommitFiberRoot=="function")try{Y.onPostCommitFiberRoot(q,h)}catch{}return!0}finally{ce.p=d,P.T=o,Vg(e,t)}}function Pg(e,t,a){t=pn(a,t),t=vd(e.stateNode,t,2),e=xa(e,t,2),e!==null&&(ks(e,2),zn(e))}function lt(e,t,a){if(e.tag===3)Pg(e,e,a);else for(;t!==null;){if(t.tag===3){Pg(t,e,a);break}else if(t.tag===1){var o=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Sa===null||!Sa.has(o))){e=pn(a,e),a=Z0(2),o=xa(t,a,2),o!==null&&(J0(a,o,t,e),ks(o,2),zn(o));break}}t=t.return}}function Vd(e,t,a){var o=e.pingCache;if(o===null){o=e.pingCache=new fv;var d=new Set;o.set(t,d)}else d=o.get(t),d===void 0&&(d=new Set,o.set(t,d));d.has(a)||(Ud=!0,d.add(a),e=xv.bind(null,e,t,a),t.then(e,e))}function xv(e,t,a){var o=e.pingCache;o!==null&&o.delete(t),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,ot===e&&(Ve&a)===a&&(gt===4||gt===3&&(Ve&62914560)===Ve&&300>Dt()-Hd?(Ke&2)===0&&ts(e,0):Ld|=a,Zr===Ve&&(Zr=0)),zn(e)}function Qg(e,t){t===0&&(t=Fh()),e=Lr(e,t),e!==null&&(ks(e,t),zn(e))}function bv(e){var t=e.memoizedState,a=0;t!==null&&(a=t.retryLane),Qg(e,a)}function vv(e,t){var a=0;switch(e.tag){case 13:var o=e.stateNode,d=e.memoizedState;d!==null&&(a=d.retryLane);break;case 19:o=e.stateNode;break;case 22:o=e.stateNode._retryCache;break;default:throw Error(i(314))}o!==null&&o.delete(t),Qg(e,a)}function wv(e,t){return tt(e,t)}var Pi=null,as=null,Wd=!1,Qi=!1,Pd=!1,dr=0;function zn(e){e!==as&&e.next===null&&(as===null?Pi=as=e:as=as.next=e),Qi=!0,Wd||(Wd=!0,kv())}function ll(e,t){if(!Pd&&Qi){Pd=!0;do for(var a=!1,o=Pi;o!==null;){if(e!==0){var d=o.pendingLanes;if(d===0)var h=0;else{var y=o.suspendedLanes,v=o.pingedLanes;h=(1<<31-ne(42|e)+1)-1,h&=d&~(y&~v),h=h&201326741?h&201326741|1:h?h|2:0}h!==0&&(a=!0,Jg(o,h))}else h=Ve,h=we(o,o===ot?h:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),(h&3)===0||ze(o,h)||(a=!0,Jg(o,h));o=o.next}while(a);Pd=!1}}function _v(){Xg()}function Xg(){Qi=Wd=!1;var e=0;dr!==0&&(Av()&&(e=dr),dr=0);for(var t=Dt(),a=null,o=Pi;o!==null;){var d=o.next,h=Kg(o,t);h===0?(o.next=null,a===null?Pi=d:a.next=d,d===null&&(as=a)):(a=o,(e!==0||(h&3)!==0)&&(Qi=!0)),o=d}ll(e)}function Kg(e,t){for(var a=e.suspendedLanes,o=e.pingedLanes,d=e.expirationTimes,h=e.pendingLanes&-62914561;0<h;){var y=31-ne(h),v=1<<y,N=d[y];N===-1?((v&a)===0||(v&o)!==0)&&(d[y]=qt(v,t)):N<=t&&(e.expiredLanes|=v),h&=~v}if(t=ot,a=Ve,a=we(e,e===t?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o=e.callbackNode,a===0||e===t&&(Ze===2||Ze===9)||e.cancelPendingCommit!==null)return o!==null&&o!==null&&st(o),e.callbackNode=null,e.callbackPriority=0;if((a&3)===0||ze(e,a)){if(t=a&-a,t===e.callbackPriority)return t;switch(o!==null&&st(o),cc(a)){case 2:case 8:a=ei;break;case 32:a=_r;break;case 268435456:a=ti;break;default:a=_r}return o=Zg.bind(null,e),a=tt(a,o),e.callbackPriority=t,e.callbackNode=a,t}return o!==null&&o!==null&&st(o),e.callbackPriority=2,e.callbackNode=null,2}function Zg(e,t){if(Ht!==0&&Ht!==5)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(Wi()&&e.callbackNode!==a)return null;var o=Ve;return o=we(e,e===ot?o:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o===0?null:(Mg(e,o,t),Kg(e,Dt()),e.callbackNode!=null&&e.callbackNode===a?Zg.bind(null,e):null)}function Jg(e,t){if(Wi())return null;Mg(e,t,!0)}function kv(){Ov(function(){(Ke&6)!==0?tt(Jl,_v):Xg()})}function Qd(){return dr===0&&(dr=ha()),dr}function em(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:li(""+e)}function tm(e,t){var a=t.ownerDocument.createElement("input");return a.name=t.name,a.value=t.value,e.id&&a.setAttribute("form",e.id),t.parentNode.insertBefore(a,t),e=new FormData(e),a.parentNode.removeChild(a),e}function Nv(e,t,a,o,d){if(t==="submit"&&a&&a.stateNode===d){var h=em((d[Xt]||null).action),y=o.submitter;y&&(t=(t=y[Xt]||null)?em(t.formAction):y.getAttribute("formAction"),t!==null&&(h=t,y=null));var v=new di("action","action",null,o,d);e.push({event:v,listeners:[{instance:null,listener:function(){if(o.defaultPrevented){if(dr!==0){var N=y?tm(d,y):new FormData(d);md(a,{pending:!0,data:N,method:d.method,action:h},null,N)}}else typeof h=="function"&&(v.preventDefault(),N=y?tm(d,y):new FormData(d),md(a,{pending:!0,data:N,method:d.method,action:h},h,N))},currentTarget:d}]})}}for(var Xd=0;Xd<Mc.length;Xd++){var Kd=Mc[Xd],Tv=Kd.toLowerCase(),jv=Kd[0].toUpperCase()+Kd.slice(1);Tn(Tv,"on"+jv)}Tn(Mf,"onAnimationEnd"),Tn(If,"onAnimationIteration"),Tn(Uf,"onAnimationStart"),Tn("dblclick","onDoubleClick"),Tn("focusin","onFocus"),Tn("focusout","onBlur"),Tn(Yb,"onTransitionRun"),Tn(Fb,"onTransitionStart"),Tn(Gb,"onTransitionCancel"),Tn(Lf,"onTransitionEnd"),Sr("onMouseEnter",["mouseout","mouseover"]),Sr("onMouseLeave",["mouseout","mouseover"]),Sr("onPointerEnter",["pointerout","pointerover"]),Sr("onPointerLeave",["pointerout","pointerover"]),Pa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Pa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Pa("onBeforeInput",["compositionend","keypress","textInput","paste"]),Pa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Pa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Pa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var il="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(il));function nm(e,t){t=(t&4)!==0;for(var a=0;a<e.length;a++){var o=e[a],d=o.event;o=o.listeners;e:{var h=void 0;if(t)for(var y=o.length-1;0<=y;y--){var v=o[y],N=v.instance,B=v.currentTarget;if(v=v.listener,N!==h&&d.isPropagationStopped())break e;h=v,d.currentTarget=B;try{h(d)}catch(Z){Ui(Z)}d.currentTarget=null,h=N}else for(y=0;y<o.length;y++){if(v=o[y],N=v.instance,B=v.currentTarget,v=v.listener,N!==h&&d.isPropagationStopped())break e;h=v,d.currentTarget=B;try{h(d)}catch(Z){Ui(Z)}d.currentTarget=null,h=N}}}}function Fe(e,t){var a=t[dc];a===void 0&&(a=t[dc]=new Set);var o=e+"__bubble";a.has(o)||(am(t,e,2,!1),a.add(o))}function Zd(e,t,a){var o=0;t&&(o|=4),am(a,e,o,t)}var Xi="_reactListening"+Math.random().toString(36).slice(2);function Jd(e){if(!e[Xi]){e[Xi]=!0,Qh.forEach(function(a){a!=="selectionchange"&&(Sv.has(a)||Zd(a,!1,e),Zd(a,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Xi]||(t[Xi]=!0,Zd("selectionchange",!1,t))}}function am(e,t,a,o){switch(Sm(t)){case 2:var d=ew;break;case 8:d=tw;break;default:d=fu}a=d.bind(null,t,a,e),d=void 0,!wc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(d=!0),o?d!==void 0?e.addEventListener(t,a,{capture:!0,passive:d}):e.addEventListener(t,a,!0):d!==void 0?e.addEventListener(t,a,{passive:d}):e.addEventListener(t,a,!1)}function eu(e,t,a,o,d){var h=o;if((t&1)===0&&(t&2)===0&&o!==null)e:for(;;){if(o===null)return;var y=o.tag;if(y===3||y===4){var v=o.stateNode.containerInfo;if(v===d)break;if(y===4)for(y=o.return;y!==null;){var N=y.tag;if((N===3||N===4)&&y.stateNode.containerInfo===d)return;y=y.return}for(;v!==null;){if(y=Nr(v),y===null)return;if(N=y.tag,N===5||N===6||N===26||N===27){o=h=y;continue e}v=v.parentNode}}o=o.return}df(function(){var B=h,Z=bc(a),ae=[];e:{var F=zf.get(e);if(F!==void 0){var V=di,Ue=e;switch(e){case"keypress":if(oi(a)===0)break e;case"keydown":case"keyup":V=wb;break;case"focusin":Ue="focus",V=Tc;break;case"focusout":Ue="blur",V=Tc;break;case"beforeblur":case"afterblur":V=Tc;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":V=ff;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":V=cb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":V=Nb;break;case Mf:case If:case Uf:V=hb;break;case Lf:V=jb;break;case"scroll":case"scrollend":V=ib;break;case"wheel":V=Db;break;case"copy":case"cut":case"paste":V=gb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":V=mf;break;case"toggle":case"beforetoggle":V=Cb}var Re=(t&4)!==0,rt=!Re&&(e==="scroll"||e==="scrollend"),U=Re?F!==null?F+"Capture":null:F;Re=[];for(var E=B,$;E!==null;){var te=E;if($=te.stateNode,te=te.tag,te!==5&&te!==26&&te!==27||$===null||U===null||(te=js(E,U),te!=null&&Re.push(ol(E,te,$))),rt)break;E=E.return}0<Re.length&&(F=new V(F,Ue,null,a,Z),ae.push({event:F,listeners:Re}))}}if((t&7)===0){e:{if(F=e==="mouseover"||e==="pointerover",V=e==="mouseout"||e==="pointerout",F&&a!==xc&&(Ue=a.relatedTarget||a.fromElement)&&(Nr(Ue)||Ue[kr]))break e;if((V||F)&&(F=Z.window===Z?Z:(F=Z.ownerDocument)?F.defaultView||F.parentWindow:window,V?(Ue=a.relatedTarget||a.toElement,V=B,Ue=Ue?Nr(Ue):null,Ue!==null&&(rt=u(Ue),Re=Ue.tag,Ue!==rt||Re!==5&&Re!==27&&Re!==6)&&(Ue=null)):(V=null,Ue=B),V!==Ue)){if(Re=ff,te="onMouseLeave",U="onMouseEnter",E="mouse",(e==="pointerout"||e==="pointerover")&&(Re=mf,te="onPointerLeave",U="onPointerEnter",E="pointer"),rt=V==null?F:Ts(V),$=Ue==null?F:Ts(Ue),F=new Re(te,E+"leave",V,a,Z),F.target=rt,F.relatedTarget=$,te=null,Nr(Z)===B&&(Re=new Re(U,E+"enter",Ue,a,Z),Re.target=$,Re.relatedTarget=rt,te=Re),rt=te,V&&Ue)t:{for(Re=V,U=Ue,E=0,$=Re;$;$=rs($))E++;for($=0,te=U;te;te=rs(te))$++;for(;0<E-$;)Re=rs(Re),E--;for(;0<$-E;)U=rs(U),$--;for(;E--;){if(Re===U||U!==null&&Re===U.alternate)break t;Re=rs(Re),U=rs(U)}Re=null}else Re=null;V!==null&&rm(ae,F,V,Re,!1),Ue!==null&&rt!==null&&rm(ae,rt,Ue,Re,!0)}}e:{if(F=B?Ts(B):window,V=F.nodeName&&F.nodeName.toLowerCase(),V==="select"||V==="input"&&F.type==="file")var ve=kf;else if(wf(F))if(Nf)ve=$b;else{ve=zb;var $e=Lb}else V=F.nodeName,!V||V.toLowerCase()!=="input"||F.type!=="checkbox"&&F.type!=="radio"?B&&yc(B.elementType)&&(ve=kf):ve=Hb;if(ve&&(ve=ve(e,B))){_f(ae,ve,a,Z);break e}$e&&$e(e,F,B),e==="focusout"&&B&&F.type==="number"&&B.memoizedProps.value!=null&&pc(F,"number",F.value)}switch($e=B?Ts(B):window,e){case"focusin":(wf($e)||$e.contentEditable==="true")&&(Mr=$e,Ac=B,Ms=null);break;case"focusout":Ms=Ac=Mr=null;break;case"mousedown":Rc=!0;break;case"contextmenu":case"mouseup":case"dragend":Rc=!1,Rf(ae,a,Z);break;case"selectionchange":if(qb)break;case"keydown":case"keyup":Rf(ae,a,Z)}var Te;if(Sc)e:{switch(e){case"compositionstart":var Me="onCompositionStart";break e;case"compositionend":Me="onCompositionEnd";break e;case"compositionupdate":Me="onCompositionUpdate";break e}Me=void 0}else Or?bf(e,a)&&(Me="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(Me="onCompositionStart");Me&&(pf&&a.locale!=="ko"&&(Or||Me!=="onCompositionStart"?Me==="onCompositionEnd"&&Or&&(Te=uf()):(ga=Z,_c="value"in ga?ga.value:ga.textContent,Or=!0)),$e=Ki(B,Me),0<$e.length&&(Me=new gf(Me,e,null,a,Z),ae.push({event:Me,listeners:$e}),Te?Me.data=Te:(Te=vf(a),Te!==null&&(Me.data=Te)))),(Te=Rb?Ob(e,a):Mb(e,a))&&(Me=Ki(B,"onBeforeInput"),0<Me.length&&($e=new gf("onBeforeInput","beforeinput",null,a,Z),ae.push({event:$e,listeners:Me}),$e.data=Te)),Nv(ae,e,B,a,Z)}nm(ae,t)})}function ol(e,t,a){return{instance:e,listener:t,currentTarget:a}}function Ki(e,t){for(var a=t+"Capture",o=[];e!==null;){var d=e,h=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||h===null||(d=js(e,a),d!=null&&o.unshift(ol(e,d,h)),d=js(e,t),d!=null&&o.push(ol(e,d,h))),e.tag===3)return o;e=e.return}return[]}function rs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function rm(e,t,a,o,d){for(var h=t._reactName,y=[];a!==null&&a!==o;){var v=a,N=v.alternate,B=v.stateNode;if(v=v.tag,N!==null&&N===o)break;v!==5&&v!==26&&v!==27||B===null||(N=B,d?(B=js(a,h),B!=null&&y.unshift(ol(a,B,N))):d||(B=js(a,h),B!=null&&y.push(ol(a,B,N)))),a=a.return}y.length!==0&&e.push({event:t,listeners:y})}var Dv=/\r\n?/g,Ev=/\u0000|\uFFFD/g;function sm(e){return(typeof e=="string"?e:""+e).replace(Dv,`
`).replace(Ev,"")}function lm(e,t){return t=sm(t),sm(e)===t}function Zi(){}function at(e,t,a,o,d,h){switch(a){case"children":typeof o=="string"?t==="body"||t==="textarea"&&o===""||Cr(e,o):(typeof o=="number"||typeof o=="bigint")&&t!=="body"&&Cr(e,""+o);break;case"className":ai(e,"class",o);break;case"tabIndex":ai(e,"tabindex",o);break;case"dir":case"role":case"viewBox":case"width":case"height":ai(e,a,o);break;case"style":of(e,o,h);break;case"data":if(t!=="object"){ai(e,"data",o);break}case"src":case"href":if(o===""&&(t!=="a"||a!=="href")){e.removeAttribute(a);break}if(o==null||typeof o=="function"||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(a);break}o=li(""+o),e.setAttribute(a,o);break;case"action":case"formAction":if(typeof o=="function"){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof h=="function"&&(a==="formAction"?(t!=="input"&&at(e,t,"name",d.name,d,null),at(e,t,"formEncType",d.formEncType,d,null),at(e,t,"formMethod",d.formMethod,d,null),at(e,t,"formTarget",d.formTarget,d,null)):(at(e,t,"encType",d.encType,d,null),at(e,t,"method",d.method,d,null),at(e,t,"target",d.target,d,null)));if(o==null||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(a);break}o=li(""+o),e.setAttribute(a,o);break;case"onClick":o!=null&&(e.onclick=Zi);break;case"onScroll":o!=null&&Fe("scroll",e);break;case"onScrollEnd":o!=null&&Fe("scrollend",e);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(i(61));if(a=o.__html,a!=null){if(d.children!=null)throw Error(i(60));e.innerHTML=a}}break;case"multiple":e.multiple=o&&typeof o!="function"&&typeof o!="symbol";break;case"muted":e.muted=o&&typeof o!="function"&&typeof o!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(o==null||typeof o=="function"||typeof o=="boolean"||typeof o=="symbol"){e.removeAttribute("xlink:href");break}a=li(""+o),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,""+o):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":o&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":o===!0?e.setAttribute(a,""):o!==!1&&o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(a,o):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":o!=null&&typeof o!="function"&&typeof o!="symbol"&&!isNaN(o)&&1<=o?e.setAttribute(a,o):e.removeAttribute(a);break;case"rowSpan":case"start":o==null||typeof o=="function"||typeof o=="symbol"||isNaN(o)?e.removeAttribute(a):e.setAttribute(a,o);break;case"popover":Fe("beforetoggle",e),Fe("toggle",e),ni(e,"popover",o);break;case"xlinkActuate":Fn(e,"http://www.w3.org/1999/xlink","xlink:actuate",o);break;case"xlinkArcrole":Fn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",o);break;case"xlinkRole":Fn(e,"http://www.w3.org/1999/xlink","xlink:role",o);break;case"xlinkShow":Fn(e,"http://www.w3.org/1999/xlink","xlink:show",o);break;case"xlinkTitle":Fn(e,"http://www.w3.org/1999/xlink","xlink:title",o);break;case"xlinkType":Fn(e,"http://www.w3.org/1999/xlink","xlink:type",o);break;case"xmlBase":Fn(e,"http://www.w3.org/XML/1998/namespace","xml:base",o);break;case"xmlLang":Fn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",o);break;case"xmlSpace":Fn(e,"http://www.w3.org/XML/1998/namespace","xml:space",o);break;case"is":ni(e,"is",o);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=sb.get(a)||a,ni(e,a,o))}}function tu(e,t,a,o,d,h){switch(a){case"style":of(e,o,h);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(i(61));if(a=o.__html,a!=null){if(d.children!=null)throw Error(i(60));e.innerHTML=a}}break;case"children":typeof o=="string"?Cr(e,o):(typeof o=="number"||typeof o=="bigint")&&Cr(e,""+o);break;case"onScroll":o!=null&&Fe("scroll",e);break;case"onScrollEnd":o!=null&&Fe("scrollend",e);break;case"onClick":o!=null&&(e.onclick=Zi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Xh.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(d=a.endsWith("Capture"),t=a.slice(2,d?a.length-7:void 0),h=e[Xt]||null,h=h!=null?h[a]:null,typeof h=="function"&&e.removeEventListener(t,h,d),typeof o=="function")){typeof h!="function"&&h!==null&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(t,o,d);break e}a in e?e[a]=o:o===!0?e.setAttribute(a,""):ni(e,a,o)}}}function $t(e,t,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fe("error",e),Fe("load",e);var o=!1,d=!1,h;for(h in a)if(a.hasOwnProperty(h)){var y=a[h];if(y!=null)switch(h){case"src":o=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:at(e,t,h,y,a,null)}}d&&at(e,t,"srcSet",a.srcSet,a,null),o&&at(e,t,"src",a.src,a,null);return;case"input":Fe("invalid",e);var v=h=y=d=null,N=null,B=null;for(o in a)if(a.hasOwnProperty(o)){var Z=a[o];if(Z!=null)switch(o){case"name":d=Z;break;case"type":y=Z;break;case"checked":N=Z;break;case"defaultChecked":B=Z;break;case"value":h=Z;break;case"defaultValue":v=Z;break;case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(i(137,t));break;default:at(e,t,o,Z,a,null)}}af(e,h,v,N,B,y,d,!1),ri(e);return;case"select":Fe("invalid",e),o=y=h=null;for(d in a)if(a.hasOwnProperty(d)&&(v=a[d],v!=null))switch(d){case"value":h=v;break;case"defaultValue":y=v;break;case"multiple":o=v;default:at(e,t,d,v,a,null)}t=h,a=y,e.multiple=!!o,t!=null?Er(e,!!o,t,!1):a!=null&&Er(e,!!o,a,!0);return;case"textarea":Fe("invalid",e),h=d=o=null;for(y in a)if(a.hasOwnProperty(y)&&(v=a[y],v!=null))switch(y){case"value":o=v;break;case"defaultValue":d=v;break;case"children":h=v;break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(i(91));break;default:at(e,t,y,v,a,null)}sf(e,o,d,h),ri(e);return;case"option":for(N in a)if(a.hasOwnProperty(N)&&(o=a[N],o!=null))switch(N){case"selected":e.selected=o&&typeof o!="function"&&typeof o!="symbol";break;default:at(e,t,N,o,a,null)}return;case"dialog":Fe("beforetoggle",e),Fe("toggle",e),Fe("cancel",e),Fe("close",e);break;case"iframe":case"object":Fe("load",e);break;case"video":case"audio":for(o=0;o<il.length;o++)Fe(il[o],e);break;case"image":Fe("error",e),Fe("load",e);break;case"details":Fe("toggle",e);break;case"embed":case"source":case"link":Fe("error",e),Fe("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(B in a)if(a.hasOwnProperty(B)&&(o=a[B],o!=null))switch(B){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:at(e,t,B,o,a,null)}return;default:if(yc(t)){for(Z in a)a.hasOwnProperty(Z)&&(o=a[Z],o!==void 0&&tu(e,t,Z,o,a,void 0));return}}for(v in a)a.hasOwnProperty(v)&&(o=a[v],o!=null&&at(e,t,v,o,a,null))}function Cv(e,t,a,o){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,h=null,y=null,v=null,N=null,B=null,Z=null;for(V in a){var ae=a[V];if(a.hasOwnProperty(V)&&ae!=null)switch(V){case"checked":break;case"value":break;case"defaultValue":N=ae;default:o.hasOwnProperty(V)||at(e,t,V,null,o,ae)}}for(var F in o){var V=o[F];if(ae=a[F],o.hasOwnProperty(F)&&(V!=null||ae!=null))switch(F){case"type":h=V;break;case"name":d=V;break;case"checked":B=V;break;case"defaultChecked":Z=V;break;case"value":y=V;break;case"defaultValue":v=V;break;case"children":case"dangerouslySetInnerHTML":if(V!=null)throw Error(i(137,t));break;default:V!==ae&&at(e,t,F,V,o,ae)}}mc(e,y,v,N,B,Z,h,d);return;case"select":V=y=v=F=null;for(h in a)if(N=a[h],a.hasOwnProperty(h)&&N!=null)switch(h){case"value":break;case"multiple":V=N;default:o.hasOwnProperty(h)||at(e,t,h,null,o,N)}for(d in o)if(h=o[d],N=a[d],o.hasOwnProperty(d)&&(h!=null||N!=null))switch(d){case"value":F=h;break;case"defaultValue":v=h;break;case"multiple":y=h;default:h!==N&&at(e,t,d,h,o,N)}t=v,a=y,o=V,F!=null?Er(e,!!a,F,!1):!!o!=!!a&&(t!=null?Er(e,!!a,t,!0):Er(e,!!a,a?[]:"",!1));return;case"textarea":V=F=null;for(v in a)if(d=a[v],a.hasOwnProperty(v)&&d!=null&&!o.hasOwnProperty(v))switch(v){case"value":break;case"children":break;default:at(e,t,v,null,o,d)}for(y in o)if(d=o[y],h=a[y],o.hasOwnProperty(y)&&(d!=null||h!=null))switch(y){case"value":F=d;break;case"defaultValue":V=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(i(91));break;default:d!==h&&at(e,t,y,d,o,h)}rf(e,F,V);return;case"option":for(var Ue in a)if(F=a[Ue],a.hasOwnProperty(Ue)&&F!=null&&!o.hasOwnProperty(Ue))switch(Ue){case"selected":e.selected=!1;break;default:at(e,t,Ue,null,o,F)}for(N in o)if(F=o[N],V=a[N],o.hasOwnProperty(N)&&F!==V&&(F!=null||V!=null))switch(N){case"selected":e.selected=F&&typeof F!="function"&&typeof F!="symbol";break;default:at(e,t,N,F,o,V)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Re in a)F=a[Re],a.hasOwnProperty(Re)&&F!=null&&!o.hasOwnProperty(Re)&&at(e,t,Re,null,o,F);for(B in o)if(F=o[B],V=a[B],o.hasOwnProperty(B)&&F!==V&&(F!=null||V!=null))switch(B){case"children":case"dangerouslySetInnerHTML":if(F!=null)throw Error(i(137,t));break;default:at(e,t,B,F,o,V)}return;default:if(yc(t)){for(var rt in a)F=a[rt],a.hasOwnProperty(rt)&&F!==void 0&&!o.hasOwnProperty(rt)&&tu(e,t,rt,void 0,o,F);for(Z in o)F=o[Z],V=a[Z],!o.hasOwnProperty(Z)||F===V||F===void 0&&V===void 0||tu(e,t,Z,F,o,V);return}}for(var U in a)F=a[U],a.hasOwnProperty(U)&&F!=null&&!o.hasOwnProperty(U)&&at(e,t,U,null,o,F);for(ae in o)F=o[ae],V=a[ae],!o.hasOwnProperty(ae)||F===V||F==null&&V==null||at(e,t,ae,F,o,V)}var nu=null,au=null;function Ji(e){return e.nodeType===9?e:e.ownerDocument}function im(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function om(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function ru(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var su=null;function Av(){var e=window.event;return e&&e.type==="popstate"?e===su?!1:(su=e,!0):(su=null,!1)}var cm=typeof setTimeout=="function"?setTimeout:void 0,Rv=typeof clearTimeout=="function"?clearTimeout:void 0,dm=typeof Promise=="function"?Promise:void 0,Ov=typeof queueMicrotask=="function"?queueMicrotask:typeof dm<"u"?function(e){return dm.resolve(null).then(e).catch(Mv)}:cm;function Mv(e){setTimeout(function(){throw e})}function Ca(e){return e==="head"}function um(e,t){var a=t,o=0,d=0;do{var h=a.nextSibling;if(e.removeChild(a),h&&h.nodeType===8)if(a=h.data,a==="/$"){if(0<o&&8>o){a=o;var y=e.ownerDocument;if(a&1&&cl(y.documentElement),a&2&&cl(y.body),a&4)for(a=y.head,cl(a),y=a.firstChild;y;){var v=y.nextSibling,N=y.nodeName;y[Ns]||N==="SCRIPT"||N==="STYLE"||N==="LINK"&&y.rel.toLowerCase()==="stylesheet"||a.removeChild(y),y=v}}if(d===0){e.removeChild(h),yl(t);return}d--}else a==="$"||a==="$?"||a==="$!"?d++:o=a.charCodeAt(0)-48;else o=0;a=h}while(a);yl(t)}function lu(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var a=t;switch(t=t.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":lu(a),uc(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}e.removeChild(a)}}function Iv(e,t,a,o){for(;e.nodeType===1;){var d=a;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!o&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(o){if(!e[Ns])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(h=e.getAttribute("rel"),h==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(h!==d.rel||e.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||e.getAttribute("title")!==(d.title==null?null:d.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(h=e.getAttribute("src"),(h!==(d.src==null?null:d.src)||e.getAttribute("type")!==(d.type==null?null:d.type)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&h&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var h=d.name==null?null:""+d.name;if(d.type==="hidden"&&e.getAttribute("name")===h)return e}else return e;if(e=Sn(e.nextSibling),e===null)break}return null}function Uv(e,t,a){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=Sn(e.nextSibling),e===null))return null;return e}function iu(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function Lv(e,t){var a=e.ownerDocument;if(e.data!=="$?"||a.readyState==="complete")t();else{var o=function(){t(),a.removeEventListener("DOMContentLoaded",o)};a.addEventListener("DOMContentLoaded",o),e._reactRetry=o}}function Sn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}var ou=null;function hm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"){if(t===0)return e;t--}else a==="/$"&&t++}e=e.previousSibling}return null}function fm(e,t,a){switch(t=Ji(a),e){case"html":if(e=t.documentElement,!e)throw Error(i(452));return e;case"head":if(e=t.head,!e)throw Error(i(453));return e;case"body":if(e=t.body,!e)throw Error(i(454));return e;default:throw Error(i(451))}}function cl(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);uc(e)}var _n=new Map,gm=new Set;function eo(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ra=ce.d;ce.d={f:zv,r:Hv,D:$v,C:Bv,L:qv,m:Yv,X:Gv,S:Fv,M:Vv};function zv(){var e=ra.f(),t=Gi();return e||t}function Hv(e){var t=Tr(e);t!==null&&t.tag===5&&t.type==="form"?M0(t):ra.r(e)}var ss=typeof document>"u"?null:document;function mm(e,t,a){var o=ss;if(o&&typeof t=="string"&&t){var d=mn(t);d='link[rel="'+e+'"][href="'+d+'"]',typeof a=="string"&&(d+='[crossorigin="'+a+'"]'),gm.has(d)||(gm.add(d),e={rel:e,crossOrigin:a,href:t},o.querySelector(d)===null&&(t=o.createElement("link"),$t(t,"link",e),Et(t),o.head.appendChild(t)))}}function $v(e){ra.D(e),mm("dns-prefetch",e,null)}function Bv(e,t){ra.C(e,t),mm("preconnect",e,t)}function qv(e,t,a){ra.L(e,t,a);var o=ss;if(o&&e&&t){var d='link[rel="preload"][as="'+mn(t)+'"]';t==="image"&&a&&a.imageSrcSet?(d+='[imagesrcset="'+mn(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(d+='[imagesizes="'+mn(a.imageSizes)+'"]')):d+='[href="'+mn(e)+'"]';var h=d;switch(t){case"style":h=ls(e);break;case"script":h=is(e)}_n.has(h)||(e=x({rel:"preload",href:t==="image"&&a&&a.imageSrcSet?void 0:e,as:t},a),_n.set(h,e),o.querySelector(d)!==null||t==="style"&&o.querySelector(dl(h))||t==="script"&&o.querySelector(ul(h))||(t=o.createElement("link"),$t(t,"link",e),Et(t),o.head.appendChild(t)))}}function Yv(e,t){ra.m(e,t);var a=ss;if(a&&e){var o=t&&typeof t.as=="string"?t.as:"script",d='link[rel="modulepreload"][as="'+mn(o)+'"][href="'+mn(e)+'"]',h=d;switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":h=is(e)}if(!_n.has(h)&&(e=x({rel:"modulepreload",href:e},t),_n.set(h,e),a.querySelector(d)===null)){switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(ul(h)))return}o=a.createElement("link"),$t(o,"link",e),Et(o),a.head.appendChild(o)}}}function Fv(e,t,a){ra.S(e,t,a);var o=ss;if(o&&e){var d=jr(o).hoistableStyles,h=ls(e);t=t||"default";var y=d.get(h);if(!y){var v={loading:0,preload:null};if(y=o.querySelector(dl(h)))v.loading=5;else{e=x({rel:"stylesheet",href:e,"data-precedence":t},a),(a=_n.get(h))&&cu(e,a);var N=y=o.createElement("link");Et(N),$t(N,"link",e),N._p=new Promise(function(B,Z){N.onload=B,N.onerror=Z}),N.addEventListener("load",function(){v.loading|=1}),N.addEventListener("error",function(){v.loading|=2}),v.loading|=4,to(y,t,o)}y={type:"stylesheet",instance:y,count:1,state:v},d.set(h,y)}}}function Gv(e,t){ra.X(e,t);var a=ss;if(a&&e){var o=jr(a).hoistableScripts,d=is(e),h=o.get(d);h||(h=a.querySelector(ul(d)),h||(e=x({src:e,async:!0},t),(t=_n.get(d))&&du(e,t),h=a.createElement("script"),Et(h),$t(h,"link",e),a.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},o.set(d,h))}}function Vv(e,t){ra.M(e,t);var a=ss;if(a&&e){var o=jr(a).hoistableScripts,d=is(e),h=o.get(d);h||(h=a.querySelector(ul(d)),h||(e=x({src:e,async:!0,type:"module"},t),(t=_n.get(d))&&du(e,t),h=a.createElement("script"),Et(h),$t(h,"link",e),a.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},o.set(d,h))}}function pm(e,t,a,o){var d=(d=ue.current)?eo(d):null;if(!d)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(t=ls(a.href),a=jr(d).hoistableStyles,o=a.get(t),o||(o={type:"style",instance:null,count:0,state:null},a.set(t,o)),o):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){e=ls(a.href);var h=jr(d).hoistableStyles,y=h.get(e);if(y||(d=d.ownerDocument||d,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},h.set(e,y),(h=d.querySelector(dl(e)))&&!h._p&&(y.instance=h,y.state.loading=5),_n.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},_n.set(e,a),h||Wv(d,e,a,y.state))),t&&o===null)throw Error(i(528,""));return y}if(t&&o!==null)throw Error(i(529,""));return null;case"script":return t=a.async,a=a.src,typeof a=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=is(a),a=jr(d).hoistableScripts,o=a.get(t),o||(o={type:"script",instance:null,count:0,state:null},a.set(t,o)),o):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function ls(e){return'href="'+mn(e)+'"'}function dl(e){return'link[rel="stylesheet"]['+e+"]"}function ym(e){return x({},e,{"data-precedence":e.precedence,precedence:null})}function Wv(e,t,a,o){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?o.loading=1:(t=e.createElement("link"),o.preload=t,t.addEventListener("load",function(){return o.loading|=1}),t.addEventListener("error",function(){return o.loading|=2}),$t(t,"link",a),Et(t),e.head.appendChild(t))}function is(e){return'[src="'+mn(e)+'"]'}function ul(e){return"script[async]"+e}function xm(e,t,a){if(t.count++,t.instance===null)switch(t.type){case"style":var o=e.querySelector('style[data-href~="'+mn(a.href)+'"]');if(o)return t.instance=o,Et(o),o;var d=x({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return o=(e.ownerDocument||e).createElement("style"),Et(o),$t(o,"style",d),to(o,a.precedence,e),t.instance=o;case"stylesheet":d=ls(a.href);var h=e.querySelector(dl(d));if(h)return t.state.loading|=4,t.instance=h,Et(h),h;o=ym(a),(d=_n.get(d))&&cu(o,d),h=(e.ownerDocument||e).createElement("link"),Et(h);var y=h;return y._p=new Promise(function(v,N){y.onload=v,y.onerror=N}),$t(h,"link",o),t.state.loading|=4,to(h,a.precedence,e),t.instance=h;case"script":return h=is(a.src),(d=e.querySelector(ul(h)))?(t.instance=d,Et(d),d):(o=a,(d=_n.get(h))&&(o=x({},a),du(o,d)),e=e.ownerDocument||e,d=e.createElement("script"),Et(d),$t(d,"link",o),e.head.appendChild(d),t.instance=d);case"void":return null;default:throw Error(i(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(o=t.instance,t.state.loading|=4,to(o,a.precedence,e));return t.instance}function to(e,t,a){for(var o=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=o.length?o[o.length-1]:null,h=d,y=0;y<o.length;y++){var v=o[y];if(v.dataset.precedence===t)h=v;else if(h!==d)break}h?h.parentNode.insertBefore(e,h.nextSibling):(t=a.nodeType===9?a.head:a,t.insertBefore(e,t.firstChild))}function cu(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function du(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var no=null;function bm(e,t,a){if(no===null){var o=new Map,d=no=new Map;d.set(a,o)}else d=no,o=d.get(a),o||(o=new Map,d.set(a,o));if(o.has(e))return o;for(o.set(e,null),a=a.getElementsByTagName(e),d=0;d<a.length;d++){var h=a[d];if(!(h[Ns]||h[Yt]||e==="link"&&h.getAttribute("rel")==="stylesheet")&&h.namespaceURI!=="http://www.w3.org/2000/svg"){var y=h.getAttribute(t)||"";y=e+y;var v=o.get(y);v?v.push(h):o.set(y,[h])}}return o}function vm(e,t,a){e=e.ownerDocument||e,e.head.insertBefore(a,t==="title"?e.querySelector("head > title"):null)}function Pv(e,t,a){if(a===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function wm(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}var hl=null;function Qv(){}function Xv(e,t,a){if(hl===null)throw Error(i(475));var o=hl;if(t.type==="stylesheet"&&(typeof a.media!="string"||matchMedia(a.media).matches!==!1)&&(t.state.loading&4)===0){if(t.instance===null){var d=ls(a.href),h=e.querySelector(dl(d));if(h){e=h._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(o.count++,o=ao.bind(o),e.then(o,o)),t.state.loading|=4,t.instance=h,Et(h);return}h=e.ownerDocument||e,a=ym(a),(d=_n.get(d))&&cu(a,d),h=h.createElement("link"),Et(h);var y=h;y._p=new Promise(function(v,N){y.onload=v,y.onerror=N}),$t(h,"link",a),t.instance=h}o.stylesheets===null&&(o.stylesheets=new Map),o.stylesheets.set(t,e),(e=t.state.preload)&&(t.state.loading&3)===0&&(o.count++,t=ao.bind(o),e.addEventListener("load",t),e.addEventListener("error",t))}}function Kv(){if(hl===null)throw Error(i(475));var e=hl;return e.stylesheets&&e.count===0&&uu(e,e.stylesheets),0<e.count?function(t){var a=setTimeout(function(){if(e.stylesheets&&uu(e,e.stylesheets),e.unsuspend){var o=e.unsuspend;e.unsuspend=null,o()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(a)}}:null}function ao(){if(this.count--,this.count===0){if(this.stylesheets)uu(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var ro=null;function uu(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,ro=new Map,t.forEach(Zv,e),ro=null,ao.call(e))}function Zv(e,t){if(!(t.state.loading&4)){var a=ro.get(e);if(a)var o=a.get(null);else{a=new Map,ro.set(e,a);for(var d=e.querySelectorAll("link[data-precedence],style[data-precedence]"),h=0;h<d.length;h++){var y=d[h];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(a.set(y.dataset.precedence,y),o=y)}o&&a.set(null,o)}d=t.instance,y=d.getAttribute("data-precedence"),h=a.get(y)||o,h===o&&a.set(null,d),a.set(y,d),this.count++,o=ao.bind(this),d.addEventListener("load",o),d.addEventListener("error",o),h?h.parentNode.insertBefore(d,h.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(d,e.firstChild)),t.state.loading|=4}}var fl={$$typeof:A,Provider:null,Consumer:null,_currentValue:pe,_currentValue2:pe,_threadCount:0};function Jv(e,t,a,o,d,h,y,v){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ic(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ic(0),this.hiddenUpdates=ic(null),this.identifierPrefix=o,this.onUncaughtError=d,this.onCaughtError=h,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=v,this.incompleteTransitions=new Map}function _m(e,t,a,o,d,h,y,v,N,B,Z,ae){return e=new Jv(e,t,a,y,v,N,B,ae),t=1,h===!0&&(t|=24),h=ln(3,null,null,t),e.current=h,h.stateNode=e,t=Vc(),t.refCount++,e.pooledCache=t,t.refCount++,h.memoizedState={element:o,isDehydrated:a,cache:t},Xc(h),e}function km(e){return e?(e=zr,e):zr}function Nm(e,t,a,o,d,h){d=km(d),o.context===null?o.context=d:o.pendingContext=d,o=ya(t),o.payload={element:a},h=h===void 0?null:h,h!==null&&(o.callback=h),a=xa(e,o,t),a!==null&&(hn(a,e,t),Ys(a,e,t))}function Tm(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<t?a:t}}function hu(e,t){Tm(e,t),(e=e.alternate)&&Tm(e,t)}function jm(e){if(e.tag===13){var t=Lr(e,67108864);t!==null&&hn(t,e,67108864),hu(e,67108864)}}var so=!0;function ew(e,t,a,o){var d=P.T;P.T=null;var h=ce.p;try{ce.p=2,fu(e,t,a,o)}finally{ce.p=h,P.T=d}}function tw(e,t,a,o){var d=P.T;P.T=null;var h=ce.p;try{ce.p=8,fu(e,t,a,o)}finally{ce.p=h,P.T=d}}function fu(e,t,a,o){if(so){var d=gu(o);if(d===null)eu(e,t,o,lo,a),Dm(e,o);else if(aw(d,e,t,a,o))o.stopPropagation();else if(Dm(e,o),t&4&&-1<nw.indexOf(e)){for(;d!==null;){var h=Tr(d);if(h!==null)switch(h.tag){case 3:if(h=h.stateNode,h.current.memoizedState.isDehydrated){var y=he(h.pendingLanes);if(y!==0){var v=h;for(v.pendingLanes|=2,v.entangledLanes|=2;y;){var N=1<<31-ne(y);v.entanglements[1]|=N,y&=~N}zn(h),(Ke&6)===0&&(Yi=Dt()+500,ll(0))}}break;case 13:v=Lr(h,2),v!==null&&hn(v,h,2),Gi(),hu(h,2)}if(h=gu(o),h===null&&eu(e,t,o,lo,a),h===d)break;d=h}d!==null&&o.stopPropagation()}else eu(e,t,o,null,a)}}function gu(e){return e=bc(e),mu(e)}var lo=null;function mu(e){if(lo=null,e=Nr(e),e!==null){var t=u(e);if(t===null)e=null;else{var a=t.tag;if(a===13){if(e=f(t),e!==null)return e;e=null}else if(a===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return lo=e,null}function Sm(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(sc()){case Jl:return 2;case ei:return 8;case _r:case lc:return 32;case ti:return 268435456;default:return 32}default:return 32}}var pu=!1,Aa=null,Ra=null,Oa=null,gl=new Map,ml=new Map,Ma=[],nw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Dm(e,t){switch(e){case"focusin":case"focusout":Aa=null;break;case"dragenter":case"dragleave":Ra=null;break;case"mouseover":case"mouseout":Oa=null;break;case"pointerover":case"pointerout":gl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ml.delete(t.pointerId)}}function pl(e,t,a,o,d,h){return e===null||e.nativeEvent!==h?(e={blockedOn:t,domEventName:a,eventSystemFlags:o,nativeEvent:h,targetContainers:[d]},t!==null&&(t=Tr(t),t!==null&&jm(t)),e):(e.eventSystemFlags|=o,t=e.targetContainers,d!==null&&t.indexOf(d)===-1&&t.push(d),e)}function aw(e,t,a,o,d){switch(t){case"focusin":return Aa=pl(Aa,e,t,a,o,d),!0;case"dragenter":return Ra=pl(Ra,e,t,a,o,d),!0;case"mouseover":return Oa=pl(Oa,e,t,a,o,d),!0;case"pointerover":var h=d.pointerId;return gl.set(h,pl(gl.get(h)||null,e,t,a,o,d)),!0;case"gotpointercapture":return h=d.pointerId,ml.set(h,pl(ml.get(h)||null,e,t,a,o,d)),!0}return!1}function Em(e){var t=Nr(e.target);if(t!==null){var a=u(t);if(a!==null){if(t=a.tag,t===13){if(t=f(a),t!==null){e.blockedOn=t,Xx(e.priority,function(){if(a.tag===13){var o=un();o=oc(o);var d=Lr(a,o);d!==null&&hn(d,a,o),hu(a,o)}});return}}else if(t===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function io(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var a=gu(e.nativeEvent);if(a===null){a=e.nativeEvent;var o=new a.constructor(a.type,a);xc=o,a.target.dispatchEvent(o),xc=null}else return t=Tr(a),t!==null&&jm(t),e.blockedOn=a,!1;t.shift()}return!0}function Cm(e,t,a){io(e)&&a.delete(t)}function rw(){pu=!1,Aa!==null&&io(Aa)&&(Aa=null),Ra!==null&&io(Ra)&&(Ra=null),Oa!==null&&io(Oa)&&(Oa=null),gl.forEach(Cm),ml.forEach(Cm)}function oo(e,t){e.blockedOn===t&&(e.blockedOn=null,pu||(pu=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,rw)))}var co=null;function Am(e){co!==e&&(co=e,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){co===e&&(co=null);for(var t=0;t<e.length;t+=3){var a=e[t],o=e[t+1],d=e[t+2];if(typeof o!="function"){if(mu(o||a)===null)continue;break}var h=Tr(a);h!==null&&(e.splice(t,3),t-=3,md(h,{pending:!0,data:d,method:a.method,action:o},o,d))}}))}function yl(e){function t(N){return oo(N,e)}Aa!==null&&oo(Aa,e),Ra!==null&&oo(Ra,e),Oa!==null&&oo(Oa,e),gl.forEach(t),ml.forEach(t);for(var a=0;a<Ma.length;a++){var o=Ma[a];o.blockedOn===e&&(o.blockedOn=null)}for(;0<Ma.length&&(a=Ma[0],a.blockedOn===null);)Em(a),a.blockedOn===null&&Ma.shift();if(a=(e.ownerDocument||e).$$reactFormReplay,a!=null)for(o=0;o<a.length;o+=3){var d=a[o],h=a[o+1],y=d[Xt]||null;if(typeof h=="function")y||Am(a);else if(y){var v=null;if(h&&h.hasAttribute("formAction")){if(d=h,y=h[Xt]||null)v=y.formAction;else if(mu(d)!==null)continue}else v=y.action;typeof v=="function"?a[o+1]=v:(a.splice(o,3),o-=3),Am(a)}}}function yu(e){this._internalRoot=e}uo.prototype.render=yu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(i(409));var a=t.current,o=un();Nm(a,o,e,t,null,null)},uo.prototype.unmount=yu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Nm(e.current,2,null,e,null,null),Gi(),t[kr]=null}};function uo(e){this._internalRoot=e}uo.prototype.unstable_scheduleHydration=function(e){if(e){var t=Wh();e={blockedOn:null,target:e,priority:t};for(var a=0;a<Ma.length&&t!==0&&t<Ma[a].priority;a++);Ma.splice(a,0,e),a===0&&Em(e)}};var Rm=n.version;if(Rm!=="19.1.0")throw Error(i(527,Rm,"19.1.0"));ce.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=m(t),e=e!==null?p(e):null,e=e===null?null:e.stateNode,e};var sw={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:P,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ho=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ho.isDisabled&&ho.supportsFiber)try{q=ho.inject(sw),Y=ho}catch{}}return wl.createRoot=function(e,t){if(!c(e))throw Error(i(299));var a=!1,o="",d=P0,h=Q0,y=X0,v=null;return t!=null&&(t.unstable_strictMode===!0&&(a=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onUncaughtError!==void 0&&(d=t.onUncaughtError),t.onCaughtError!==void 0&&(h=t.onCaughtError),t.onRecoverableError!==void 0&&(y=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(v=t.unstable_transitionCallbacks)),t=_m(e,1,!1,null,null,a,o,d,h,y,v,null),e[kr]=t.current,Jd(e),new yu(t)},wl.hydrateRoot=function(e,t,a){if(!c(e))throw Error(i(299));var o=!1,d="",h=P0,y=Q0,v=X0,N=null,B=null;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onUncaughtError!==void 0&&(h=a.onUncaughtError),a.onCaughtError!==void 0&&(y=a.onCaughtError),a.onRecoverableError!==void 0&&(v=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(N=a.unstable_transitionCallbacks),a.formState!==void 0&&(B=a.formState)),t=_m(e,1,!0,t,a??null,o,d,h,y,v,N,B),t.context=km(null),a=t.current,o=un(),o=oc(o),d=ya(o),d.callback=null,xa(a,d,o),a=o,t.current.lanes=a,ks(t,a),zn(t),e[kr]=t.current,Jd(e),new uo(t)},wl.version="19.1.0",wl}var Gm;function m_(){if(Gm)return ku.exports;Gm=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(n){console.error(n)}}return s(),ku.exports=g_(),ku.exports}var p_=m_();const y_="modulepreload",x_=function(s,n){return new URL(s,n).href},Vm={},Wa=function(n,r,i){let c=Promise.resolve();if(r&&r.length>0){let p=function(x){return Promise.all(x.map(b=>Promise.resolve(b).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};const f=document.getElementsByTagName("link"),g=document.querySelector("meta[property=csp-nonce]"),m=g?.nonce||g?.getAttribute("nonce");c=p(r.map(x=>{if(x=x_(x,i),x in Vm)return;Vm[x]=!0;const b=x.endsWith(".css"),w=b?'[rel="stylesheet"]':"";if(!!i)for(let z=f.length-1;z>=0;z--){const W=f[z];if(W.href===x&&(!b||W.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${x}"]${w}`))return;const T=document.createElement("link");if(T.rel=b?"stylesheet":y_,b||(T.as="script"),T.crossOrigin="",T.href=x,m&&T.setAttribute("nonce",m),document.head.appendChild(T),b)return new Promise((z,W)=>{T.addEventListener("load",z),T.addEventListener("error",()=>W(new Error(`Unable to preload CSS for ${x}`)))})}))}function u(f){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=f,window.dispatchEvent(g),!g.defaultPrevented)throw f}return c.then(f=>{for(const g of f||[])g.status==="rejected"&&u(g.reason);return n().catch(u)})};function ju(){return Date.now().toString(36)+Math.random().toString(36).substr(2,9)}function b_(s){return s.toLocaleString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}function Vo(s){switch(s){case 1:return"";case 2:return"";case 3:return"";case 4:return"";case 5:return"";case-1:return"";default:return`${s}`}}function v_(s){return{2024:["2024-01-01","2024-02-09","2024-02-10","2024-02-11","2024-02-12","2024-03-01","2024-04-10","2024-05-05","2024-05-06","2024-05-15","2024-06-06","2024-08-15","2024-09-16","2024-09-17","2024-09-18","2024-10-03","2024-10-09","2024-12-25"],2025:["2025-01-01","2025-01-28","2025-01-29","2025-01-30","2025-03-01","2025-05-05","2025-05-13","2025-06-06","2025-08-15","2025-10-05","2025-10-06","2025-10-07","2025-10-08","2025-10-03","2025-10-09","2025-12-25"],2026:["2026-01-01","2026-02-16","2026-02-17","2026-02-18","2026-03-01","2026-05-05","2026-05-02","2026-06-06","2026-08-15","2026-09-24","2026-09-25","2026-09-26","2026-10-03","2026-10-09","2026-12-25"]}[s.toString()]||[]}function w_(s){return{2024:[{date:"2024-01-01",name:"",isHoliday:!0},{date:"2024-02-09",name:"",isHoliday:!0},{date:"2024-02-10",name:"",isHoliday:!0},{date:"2024-02-11",name:"",isHoliday:!0},{date:"2024-02-12",name:"",isHoliday:!0},{date:"2024-03-01",name:"",isHoliday:!0},{date:"2024-04-10",name:"",isHoliday:!0},{date:"2024-05-05",name:"",isHoliday:!0},{date:"2024-05-06",name:"",isHoliday:!0},{date:"2024-05-15",name:"",isHoliday:!0},{date:"2024-06-06",name:"",isHoliday:!0},{date:"2024-08-15",name:"",isHoliday:!0},{date:"2024-09-16",name:"",isHoliday:!0},{date:"2024-09-17",name:"",isHoliday:!0},{date:"2024-09-18",name:"",isHoliday:!0},{date:"2024-10-03",name:"",isHoliday:!0},{date:"2024-10-09",name:"",isHoliday:!0},{date:"2024-12-25",name:"",isHoliday:!0}],2025:[{date:"2025-01-01",name:"",isHoliday:!0},{date:"2025-01-28",name:"",isHoliday:!0},{date:"2025-01-29",name:"",isHoliday:!0},{date:"2025-01-30",name:"",isHoliday:!0},{date:"2025-03-01",name:"",isHoliday:!0},{date:"2025-05-05",name:"",isHoliday:!0},{date:"2025-05-13",name:"",isHoliday:!0},{date:"2025-06-06",name:"",isHoliday:!0},{date:"2025-08-15",name:"",isHoliday:!0},{date:"2025-10-05",name:"",isHoliday:!0},{date:"2025-10-06",name:"",isHoliday:!0},{date:"2025-10-07",name:"",isHoliday:!0},{date:"2025-10-08",name:"",isHoliday:!0},{date:"2025-10-03",name:"",isHoliday:!0},{date:"2025-10-09",name:"",isHoliday:!0},{date:"2025-12-25",name:"",isHoliday:!0}],2026:[{date:"2026-01-01",name:"",isHoliday:!0},{date:"2026-02-16",name:"",isHoliday:!0},{date:"2026-02-17",name:"",isHoliday:!0},{date:"2026-02-18",name:"",isHoliday:!0},{date:"2026-03-01",name:"",isHoliday:!0},{date:"2026-05-05",name:"",isHoliday:!0},{date:"2026-05-02",name:"",isHoliday:!0},{date:"2026-06-06",name:"",isHoliday:!0},{date:"2026-08-15",name:"",isHoliday:!0},{date:"2026-09-24",name:"",isHoliday:!0},{date:"2026-09-25",name:"",isHoliday:!0},{date:"2026-09-26",name:"",isHoliday:!0},{date:"2026-10-03",name:"",isHoliday:!0},{date:"2026-10-09",name:"",isHoliday:!0},{date:"2026-12-25",name:"",isHoliday:!0}]}[s.toString()]||[]}function dy(s){const n=s.getFullYear(),r=(s.getMonth()+1).toString().padStart(2,"0"),i=s.getDate().toString().padStart(2,"0"),c=`${n}-${r}-${i}`;return v_(n).includes(c)}function Ha(s){const n=s.getDay();return n===0||n===6}function uy(s){return Ha(s)||dy(s)}function ch(s){const n=s.getFullYear(),r=(s.getMonth()+1).toString().padStart(2,"0"),i=s.getDate().toString().padStart(2,"0"),c=`${n}-${r}-${i}`;return w_(n).find(f=>f.date===c)||null}function hy(s,n){const r=new Date(s,n-1,1);let i=new Date(r);for(;uy(i);)i.setDate(i.getDate()+1);return i}function fy(s,n){const r=new Date(s,n,0);let i=new Date(r);for(;uy(i);)i.setDate(i.getDate()-1);return i}function So(s,n){if(dy(s))return!0;const r=s.getFullYear(),i=(s.getMonth()+1).toString().padStart(2,"0"),c=s.getDate().toString().padStart(2,"0"),u=`${r}-${i}-${c}`,f=`${i}-${c}`;return n.some(g=>{if(!!g.isRecurring){const p=g.date.split("-");if(p.length===3){const x=p[1].padStart(2,"0"),b=p[2].padStart(2,"0");return`${x}-${b}`===f}return g.date.endsWith(f)}return g.date===u})}class __{templates=[];setTemplates(n){this.templates=n}hasConflictingInstance(n,r,i){const c=this.templates.find(f=>f.title===i.targetTemplateTitle&&f.id!==r);if(!c)return!1;const u=this.generateInstancesForTemplate(c);for(const f of u)if(this.checkDateConflict(n,f.date,i.scope))return console.log(`[Conflict] ${n.toDateString()} ${c.title}()  `),!0;return!1}checkDateConflict(n,r,i){switch(i){case"same_date":return n.toDateString()===r.toDateString();case"same_week":const c=new Date(n);c.setDate(n.getDate()-n.getDay());const u=new Date(r);return u.setDate(r.getDate()-r.getDay()),c.toDateString()===u.toDateString();case"same_month":return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth();default:return!1}}generateInstancesForTemplate(n,r=[]){if(!n.isActive)return[];switch(n.recurrenceType){case"daily":return this.generateDailyInstancesRaw(n,r);case"weekly":return this.generateWeeklyInstancesRaw(n,r);case"monthly":return this.generateMonthlyInstancesRaw(n,r);default:return[]}}calculateWeekOfMonth(n){const r=n.getFullYear(),i=n.getMonth(),c=n.getDate();console.log(`calculateWeekOfMonth: ${n.toDateString()}, year=${r}, month=${i+1}, day=${c}`);const u=new Date(r,i,1),f=new Date(r,i+1,0),g=u.getDay(),m=Math.ceil((c+g)/7),p=f.getDate(),x=Math.ceil((p+g)/7);return console.log(`  firstWeekday=${g}, weekOfMonth=${m}, totalWeeks=${x}`),m===x?(console.log("   : -1 "),-1):(console.log(`   : ${m} `),m)}isLastOccurrenceOfWeekdayInMonth(n){const r=n.getFullYear(),i=n.getMonth(),c=n.getDay(),u=new Date(r,i+1,0);for(let f=u.getDate();f>=1;f--){const g=new Date(r,i,f);if(g.getDay()===c){const m=n.getDate()===f;return console.log(`  ${n.toDateString()}:  (${c})   ${g.toDateString()}, : ${m}`),m}}return!1}adjustForHolidays(n,r="show",i=[]){let c=new Date(n);if(r==="show")return console.log(`  'show' : ${c.toDateString()}  `),c;console.log(`   : ${n.toDateString()}, : ${r}`);const u=So(c,i),f=Ha(c);if(console.log(`     : =${u}, =${f}`),!u&&!f)return console.log("       "),c;c.getMonth();let g=0;const m=15;for(;g<m;){r==="before"?(c.setDate(c.getDate()-1),console.log(`     : ${c.toDateString()}`)):(c.setDate(c.getDate()+1),console.log(`     : ${c.toDateString()}`));const p=So(c,i),x=Ha(c);if(console.log(`   : =${p}, =${x}`),!p&&!x){console.log(`     : ${c.toDateString()}`);break}g++}return g>=m?(console.warn(`      (${m}),   `),console.log(`     : ${n.toDateString()}`),n):(console.log(`   : ${n.toDateString()}  ${c.toDateString()}`),c)}hasDuplicateOnDate(n,r,i){return!1}isExceptionDate(n,r,i){if(!r||r.length===0)return!1;for(const c of r)switch(c.type){case"date":const u=n.getDate();if(c.values.includes(u))return!0;break;case"weekday":const f=n.getDay();if(c.values.includes(f))return!0;break;case"week":const g=this.calculateWeekOfMonth(n);if(console.log(" :",n.toDateString(),":",g," :",c.values),c.values.includes(-1)){const p=this.isLastOccurrenceOfWeekdayInMonth(n);if(console.log(" :",n.toDateString(),"   :",p),p)return console.log("   ():",n.toDateString()),!0}if(c.values.includes(g))return console.log("  :",n.toDateString(),":",g),!0;break;case"month":const m=n.getMonth()+1;if(c.values.includes(m))return!0;break;case"conflict":if(i){const p=c.values;for(const x of p)if(console.log("  :",n.toDateString(),x),this.hasConflictingInstance(n,i,x))return console.log("   :",n.toDateString()),!0}break}return!1}generateDailyInstancesRaw(n,r=[]){if(n.recurrenceType!=="daily")return[];const i=[],c=new Date,u=new Date(n.createdAt),f=new Date(c);f.setFullYear(c.getFullYear()+1);let g=new Date(u);for(;g<=f;){const m=new Date(c.getFullYear(),c.getMonth(),c.getDate());if(new Date(g.getFullYear(),g.getMonth(),g.getDate())>=m&&!this.isExceptionDate(g,n.exceptions,n.id)){const x=n.holidayHandling||"show",b=this.adjustForHolidays(g,x,r);if(!this.hasDuplicateOnDate(b,n.id,n.title)){const w=`${b.getFullYear()}-${(b.getMonth()+1).toString().padStart(2,"0")}-${b.getDate().toString().padStart(2,"0")}`,L=`${n.id}_${w}`;i.push({id:L,templateId:n.id,date:b,completed:!1,createdAt:new Date,updatedAt:new Date,order:-1e3})}}g.setDate(g.getDate()+1)}return i}generateWeeklyInstancesRaw(n,r=[]){if(n.recurrenceType!=="weekly"||n.weekday===void 0)return[];const i=[],c=new Date,u=new Date(n.createdAt),f=new Date(c);f.setFullYear(c.getFullYear()+1);const g=n.weekday;let m=new Date(u);const p=(g-u.getDay()+7)%7;p>0&&m.setDate(u.getDate()+p);let x=new Date(m);for(;x<=f;){const b=new Date(c.getFullYear(),c.getMonth(),c.getDate());if(new Date(x.getFullYear(),x.getMonth(),x.getDate())>=b&&!this.isExceptionDate(x,n.exceptions,n.id)){const L=n.holidayHandling||"show";console.log(`[${n.title}]  : ${x.toDateString()},  : ${L}`),console.log(`[${n.title}]   :`,n);const T=ch(x)!==null,z=Ha(x);console.log(`[${n.title}]  : ${T},  : ${z}`);const W=this.adjustForHolidays(x,L,r);if(W.getTime()!==x.getTime()&&console.log(`[${n.title}]  : ${x.toDateString()}  ${W.toDateString()}`),this.hasDuplicateOnDate(W,n.id,n.title))console.log(`     : "${n.title}" - ${W.toDateString()}`);else{const k=`${W.getFullYear()}-${(W.getMonth()+1).toString().padStart(2,"0")}-${W.getDate().toString().padStart(2,"0")}`,S=`${n.id}_${k}`;n.title.includes("")&&(console.log("   :"),console.log(`    : ${W.toDateString()} (${W.getDate()})`),console.log(`    ID: ${S}`)),i.push({id:S,templateId:n.id,date:W,completed:!1,createdAt:new Date,updatedAt:new Date,order:-1e3})}}x.setDate(x.getDate()+7)}return i}findNthWeekdayOfMonth(n,r,i,c){const u=new Date(n,r-1,1),f=u.getDay();if(console.log(`   findNthWeekdayOfMonth: ${n} ${r}, ${i}  ${["","","","","","",""][c]}`),console.log(`    : ${u.toDateString()},   : ${["","","","","","",""][f]}`),i==="last"){const g=new Date(n,r,0);console.log(`    : ${g.toDateString()}`);for(let m=g.getDate();m>=1;m--){const p=new Date(n,r-1,m);if(p.getDay()===c)return console.log(`    ${["","","","","","",""][c]}: ${p.toDateString()}`),p}}else{const m={first:1,second:2,third:3,fourth:4}[i];let p=(c-f+7)%7,x=new Date(n,r-1,1+p);console.log(`     ${["","","","","","",""][c]}: ${x.toDateString()}`);let b=new Date(x);return b.setDate(b.getDate()+(m-1)*7),console.log(`   ${m} ${["","","","","","",""][c]}: ${b.toDateString()}`),b.getMonth()===r-1?b:(console.log(`    ${m}    `),null)}return null}generateMonthlyInstancesRaw(n,r=[]){if(n.recurrenceType!=="monthly")return[];console.log(`
 [${n.title}]     `),console.log("     :",JSON.stringify(n,null,2)),console.log(`   monthlyDate: ${n.monthlyDate}`),console.log(`   monthlyPattern: ${n.monthlyPattern}`),console.log(`   monthlyWeek: ${n.monthlyWeek}`),console.log(`   monthlyWeekday: ${n.monthlyWeekday}`);const i=[],c=new Set,u=new Date,f=u.getFullYear(),g=u.getMonth()+1,m=u.getDate();console.log(`   : ${f} ${g} ${m}`);for(let p=0;p<12;p++){let x=f,b=g+p;b>12&&(x+=Math.floor((b-1)/12),b=(b-1)%12+1),console.log(`
  : ${x} ${b}`);let w=null;if(n.monthlyPattern==="weekday"&&n.monthlyWeek&&n.monthlyWeekday!==void 0)console.log(`   :  ${n.monthlyWeek}  ${["","","","","","",""][n.monthlyWeekday]}`),w=this.findNthWeekdayOfMonth(x,b,n.monthlyWeek,n.monthlyWeekday),console.log(w?`   ${n.monthlyWeek}  ${["","","","","","",""][n.monthlyWeekday]}: ${w.toDateString()}`:`    ${x} ${b} ${n.monthlyWeek}  ${["","","","","","",""][n.monthlyWeekday]} `);else if(n.monthlyDate===-1)w=new Date(x,b,0),console.log(`   : ${w.toDateString()}`);else if(n.monthlyDate===-2)w=hy(x,b),console.log(`     : ${w.toDateString()}`);else if(n.monthlyDate===-3)w=fy(x,b),console.log(`    : ${w.toDateString()}`);else if(n.monthlyDate&&n.monthlyDate>0){if(w=new Date(x,b-1,n.monthlyDate),w.getMonth()!==b-1){console.log(`    ${x} ${b} ${n.monthlyDate} `);continue}console.log(`     ${n.monthlyDate}: ${w.toDateString()}`)}else w=new Date(x,b-1,1),console.log(`    ( 1): ${w.toDateString()}`);if(!w){console.log("      ");continue}const L=new Date(f,g-1,m);if(w<L){console.log(`      : ${w.toDateString()}`);continue}let T=w;if(n.monthlyDate&&n.monthlyDate>0){const k=n.holidayHandling||"show";T=this.adjustForHolidays(w,k,r),T.getTime()!==w.getTime()&&console.log(`     : ${w.toDateString()}  ${T.toDateString()}`)}if(this.isExceptionDate(T,n.exceptions,n.id)){console.log(`      : ${T.toDateString()}`);continue}const z=`${T.getFullYear()}-${(T.getMonth()+1).toString().padStart(2,"0")}-${T.getDate().toString().padStart(2,"0")}`;if(c.has(z)){console.log(`     : ${z}  `);continue}const W=`${n.id}_${z}`;c.add(z),i.push({id:W,templateId:n.id,date:T,completed:!1,createdAt:new Date,updatedAt:new Date,order:-1e3}),console.log(`     : ${T.toDateString()} (ID: ${W})`)}return console.log(` [${n.title}]  ${i.length}   `),i}calculateMonthlyWeekday(n,r,i,c){const u=r-1,f=new Date(n,u+1,0);if(console.log(` calculateMonthlyWeekday: ${n} ${r} ${i}  ${["","","","","","",""][c]}`),console.log(`    : ${f.getDate()}`),i==="last"){console.log(`   ${["","","","","","",""][c]}  ...`);for(let g=f.getDate();g>=1;g--){const m=new Date(n,u,g);if(m.getDay()===c)return console.log(`  ${["","","","","","",""][c]} : ${m.getFullYear()} ${m.getMonth()+1} ${m.getDate()}`),m}}else{const m={first:1,second:2,third:3,fourth:4}[i];let p=0;for(let x=1;x<=f.getDate();x++){const b=new Date(n,u,x);if(b.getDay()===c&&(p++,p===m))return b}}return null}generateDailyInstances(n,r=[]){return this.generateDailyInstancesRaw(n,r)}generateWeeklyInstances(n,r=[]){return this.generateWeeklyInstancesRaw(n,r)}generateMonthlyInstances(n,r=[]){return this.generateMonthlyInstancesRaw(n,r)}generateInstances(n,r=[]){if(!n.isActive)return[];let i=[];switch(n.recurrenceType){case"daily":i=this.generateDailyInstances(n,r);break;case"weekly":i=this.generateWeeklyInstances(n,r);break;case"monthly":i=this.generateMonthlyInstances(n,r);break;default:return[]}return this.removeDuplicateInstances(i)}removeDuplicateInstances(n){const r=new Map;for(const i of n){const c=`${i.templateId}_${i.date.toDateString()}`;(!r.has(c)||r.get(c).createdAt<i.createdAt)&&(r.has(c)&&console.log(`   : ${i.date.toDateString()}`),r.set(c,i))}return Array.from(r.values()).sort((i,c)=>i.date.getTime()-c.date.getTime())}convertToTodo(n,r){const i=`recurring_${n.id}`;n.id==="PUH4xT3lVY5aK2vuQyUe_2025-08-21"&&(console.log(" convertToTodo  - "),console.log("   instance.completed:",n.completed,typeof n.completed),console.log("   instance :",JSON.stringify(n,null,2)),console.log("   :",r.title)),r.title.includes("")&&console.log("  convertToTodo - ID:",n.id,":",n.completed);const c=r.title.includes("")||r.title.includes(" ")||r.title.includes("")||r.title.includes(" "),u=c?"urgent":r.priority;c&&r.priority!=="urgent"&&console.log(`    : ${r.priority}  urgent`);const f={id:i,title:r.title,description:r.description,completed:n.completed,priority:u,type:r.type,dueDate:void 0,startDate:n.date,createdAt:n.createdAt,updatedAt:n.updatedAt,completedAt:n.completedAt,tags:[...r.tags||[]],order:n.order,_isRecurringInstance:!0,_instanceId:n.id,_templateId:r.id};return n.id==="PUH4xT3lVY5aK2vuQyUe_2025-08-21"&&(console.log(" convertToTodo  - "),console.log("   todo.completed:",f.completed,typeof f.completed),console.log("   todo :",JSON.stringify(f,null,2))),f}getTodayInstances(n){const i=new Date().toDateString();return n.filter(c=>c.date.toDateString()===i)}getWeekInstances(n){const r=new Date,i=new Date(r);i.setDate(r.getDate()-r.getDay());const c=new Date(i);return c.setDate(i.getDate()+6),n.filter(u=>u.date>=i&&u.date<=c)}getMonthInstances(n){const r=new Date,i=new Date(r.getFullYear(),r.getMonth(),1),c=new Date(r.getFullYear(),r.getMonth()+1,0);return n.filter(u=>u.date>=i&&u.date<=c)}removeDuplicateTodos(n){const r=new Map,i=[];for(const f of n){if(!f._isRecurringInstance){i.push(f);continue}const g=`${f.title}_${f.dueDate?.toDateString()||"no-date"}`;r.has(g)?console.log(`    : "${f.title}" - ${f.dueDate?.toDateString()}`):(r.set(g,f),console.log(`   : "${f.title}" - ${f.dueDate?.toDateString()}`))}const c=Array.from(r.values()),u=[...i,...c];return console.log(`   : ${n.length}  ${u.length} (${n.length-u.length} )`),u.sort((f,g)=>{const m=f.order||0,p=g.order||0;if(m!==p)return m-p;const x=f.dueDate||new Date(0),b=g.dueDate||new Date(0);return x.getTime()-b.getTime()})}}const cs=new __;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gy="firebasestorage.googleapis.com",k_="storageBucket",N_=120*1e3,T_=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn extends Ow{constructor(n,r,i=0){super(Su(n),`Firebase Storage: ${r} (${Su(n)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Yn.prototype)}get status(){return this.status_}set status(n){this.status_=n}_codeEquals(n){return Su(n)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(n){this.customData.serverResponse=n,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Bn;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Bn||(Bn={}));function Su(s){return"storage/"+s}function j_(){const s="An unknown error occurred, please check the error payload for server response.";return new Yn(Bn.UNKNOWN,s)}function S_(){return new Yn(Bn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function D_(){return new Yn(Bn.CANCELED,"User canceled the upload/download.")}function E_(s){return new Yn(Bn.INVALID_URL,"Invalid URL '"+s+"'.")}function C_(s){return new Yn(Bn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function Wm(s){return new Yn(Bn.INVALID_ARGUMENT,s)}function my(){return new Yn(Bn.APP_DELETED,"The Firebase app was deleted.")}function A_(s){return new Yn(Bn.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(n,r){this.bucket=n,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const n=encodeURIComponent;return"/b/"+n(this.bucket)+"/o/"+n(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(n,r){let i;try{i=Cn.makeFromUrl(n,r)}catch{return new Cn(n,"")}if(i.path==="")return i;throw C_(n)}static makeFromUrl(n,r){let i=null;const c="([A-Za-z0-9.\\-_]+)";function u(D){D.path.charAt(D.path.length-1)==="/"&&(D.path_=D.path_.slice(0,-1))}const f="(/(.*))?$",g=new RegExp("^gs://"+c+f,"i"),m={bucket:1,path:3};function p(D){D.path_=decodeURIComponent(D.path)}const x="v[A-Za-z0-9_]+",b=r.replace(/[.]/g,"\\."),w="(/([^?#]*).*)?$",L=new RegExp(`^https?://${b}/${x}/b/${c}/o${w}`,"i"),T={bucket:1,path:3},z=r===gy?"(?:storage.googleapis.com|storage.cloud.google.com)":r,W="([^?#]*)",k=new RegExp(`^https?://${z}/${c}/${W}`,"i"),A=[{regex:g,indices:m,postModify:u},{regex:L,indices:T,postModify:p},{regex:k,indices:{bucket:1,path:2},postModify:p}];for(let D=0;D<A.length;D++){const _=A[D],H=_.regex.exec(n);if(H){const I=H[_.indices.bucket];let le=H[_.indices.path];le||(le=""),i=new Cn(I,le),_.postModify(i);break}}if(i==null)throw E_(n);return i}}class R_{constructor(n){this.promise_=Promise.reject(n)}getPromise(){return this.promise_}cancel(n=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O_(s,n,r){let i=1,c=null,u=null,f=!1,g=0;function m(){return g===2}let p=!1;function x(...W){p||(p=!0,n.apply(null,W))}function b(W){c=setTimeout(()=>{c=null,s(L,m())},W)}function w(){u&&clearTimeout(u)}function L(W,...k){if(p){w();return}if(W){w(),x.call(null,W,...k);return}if(m()||f){w(),x.call(null,W,...k);return}i<64&&(i*=2);let A;g===1?(g=2,A=0):A=(i+Math.random())*1e3,b(A)}let T=!1;function z(W){T||(T=!0,w(),!p&&(c!==null?(W||(g=2),clearTimeout(c),b(0)):W||(g=1)))}return b(0),u=setTimeout(()=>{f=!0,z(!0)},r),z}function M_(s){s(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I_(s){return s!==void 0}function Pm(s,n,r,i){if(i<n)throw Wm(`Invalid value for '${s}'. Expected ${n} or greater.`);if(i>r)throw Wm(`Invalid value for '${s}'. Expected ${r} or less.`)}function U_(s){const n=encodeURIComponent;let r="?";for(const i in s)if(s.hasOwnProperty(i)){const c=n(i)+"="+n(s[i]);r=r+c+"&"}return r=r.slice(0,-1),r}var Do;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(Do||(Do={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L_(s,n){const r=s>=500&&s<600,c=[408,429].indexOf(s)!==-1,u=n.indexOf(s)!==-1;return r||c||u}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_{constructor(n,r,i,c,u,f,g,m,p,x,b,w=!0,L=!1){this.url_=n,this.method_=r,this.headers_=i,this.body_=c,this.successCodes_=u,this.additionalRetryCodes_=f,this.callback_=g,this.errorCallback_=m,this.timeout_=p,this.progressCallback_=x,this.connectionFactory_=b,this.retry=w,this.isUsingEmulator=L,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,z)=>{this.resolve_=T,this.reject_=z,this.start_()})}start_(){const n=(i,c)=>{if(c){i(!1,new mo(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const f=g=>{const m=g.loaded,p=g.lengthComputable?g.total:-1;this.progressCallback_!==null&&this.progressCallback_(m,p)};this.progressCallback_!==null&&u.addUploadProgressListener(f),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(f),this.pendingConnection_=null;const g=u.getErrorCode()===Do.NO_ERROR,m=u.getStatus();if(!g||L_(m,this.additionalRetryCodes_)&&this.retry){const x=u.getErrorCode()===Do.ABORT;i(!1,new mo(!1,null,x));return}const p=this.successCodes_.indexOf(m)!==-1;i(!0,new mo(p,u))})},r=(i,c)=>{const u=this.resolve_,f=this.reject_,g=c.connection;if(c.wasSuccessCode)try{const m=this.callback_(g,g.getResponse());I_(m)?u(m):u()}catch(m){f(m)}else if(g!==null){const m=j_();m.serverResponse=g.getErrorText(),this.errorCallback_?f(this.errorCallback_(g,m)):f(m)}else if(c.canceled){const m=this.appDelete_?my():D_();f(m)}else{const m=S_();f(m)}};this.canceled_?r(!1,new mo(!1,null,!0)):this.backoffId_=O_(n,r,this.timeout_)}getPromise(){return this.promise_}cancel(n){this.canceled_=!0,this.appDelete_=n||!1,this.backoffId_!==null&&M_(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class mo{constructor(n,r,i){this.wasSuccessCode=n,this.connection=r,this.canceled=!!i}}function H_(s,n){n!==null&&n.length>0&&(s.Authorization="Firebase "+n)}function $_(s,n){s["X-Firebase-Storage-Version"]="webjs/"+(n??"AppManager")}function B_(s,n){n&&(s["X-Firebase-GMPID"]=n)}function q_(s,n){n!==null&&(s["X-Firebase-AppCheck"]=n)}function Y_(s,n,r,i,c,u,f=!0,g=!1){const m=U_(s.urlParams),p=s.url+m,x=Object.assign({},s.headers);return B_(x,n),H_(x,r),$_(x,u),q_(x,i),new z_(p,s.method,x,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,c,f,g)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F_(s){if(s.length===0)return null;const n=s.lastIndexOf("/");return n===-1?"":s.slice(0,n)}function G_(s){const n=s.lastIndexOf("/",s.length-2);return n===-1?s:s.slice(n+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{constructor(n,r){this._service=n,r instanceof Cn?this._location=r:this._location=Cn.makeFromUrl(r,n.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(n,r){return new Eo(n,r)}get root(){const n=new Cn(this._location.bucket,"");return this._newRef(this._service,n)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return G_(this._location.path)}get storage(){return this._service}get parent(){const n=F_(this._location.path);if(n===null)return null;const r=new Cn(this._location.bucket,n);return new Eo(this._service,r)}_throwIfRoot(n){if(this._location.path==="")throw A_(n)}}function Qm(s,n){const r=n?.[k_];return r==null?null:Cn.makeFromBucketSpec(r,s)}function V_(s,n,r,i={}){s.host=`${n}:${r}`;const c=ah(n);c&&(Zp(`https://${s.host}/b`),Jp("Storage",!0)),s._isUsingEmulator=!0,s._protocol=c?"https":"http";const{mockUserToken:u}=i;u&&(s._overrideAuthToken=typeof u=="string"?u:ey(u,s.app.options.projectId))}class W_{constructor(n,r,i,c,u,f=!1){this.app=n,this._authProvider=r,this._appCheckProvider=i,this._url=c,this._firebaseVersion=u,this._isUsingEmulator=f,this._bucket=null,this._host=gy,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=N_,this._maxUploadRetryTime=T_,this._requests=new Set,c!=null?this._bucket=Cn.makeFromBucketSpec(c,this._host):this._bucket=Qm(this._host,this.app.options)}get host(){return this._host}set host(n){this._host=n,this._url!=null?this._bucket=Cn.makeFromBucketSpec(this._url,n):this._bucket=Qm(n,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(n){Pm("time",0,Number.POSITIVE_INFINITY,n),this._maxUploadRetryTime=n}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(n){Pm("time",0,Number.POSITIVE_INFINITY,n),this._maxOperationRetryTime=n}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const n=this._authProvider.getImmediate({optional:!0});if(n){const r=await n.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(Pp(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=this._appCheckProvider.getImmediate({optional:!0});return n?(await n.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(n=>n.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(n){return new Eo(this,n)}_makeRequest(n,r,i,c,u=!0){if(this._deleted)return new R_(my());{const f=Y_(n,this._appId,i,c,r,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(f),f.getPromise().then(()=>this._requests.delete(f),()=>this._requests.delete(f)),f}}async makeRequestWithTokens(n,r){const[i,c]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(n,r,i,c).getPromise()}}const Xm="@firebase/storage",Km="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const py="storage";function P_(s=Qp(),n){s=Va(s);const i=Xp(s,py).getImmediate({identifier:n}),c=Kp("storage");return c&&Q_(i,...c),i}function Q_(s,n,r,i={}){V_(s,n,r,i)}function X_(s,{instanceIdentifier:n}){const r=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),c=s.getProvider("app-check-internal");return new W_(r,i,c,n,Wp)}function K_(){Gp(new Vp(py,X_,"PUBLIC").setMultipleInstances(!0)),No(Xm,Km,""),No(Xm,Km,"esm2020")}K_();const De={log:(s,n)=>{},warn:(s,n)=>{},error:(s,n)=>{console.error(s,n?.message||n)},info:(s,n)=>{},time:s=>{},timeEnd:s=>{}},$u={apiKey:"AIzaSyD8aBPw-o13mciSdV8gzRJN6TfaAy3OoWg",authDomain:"todolist-116f3.firebaseapp.com",databaseURL:"https://todolist-116f3-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"todolist-116f3",storageBucket:"todolist-116f3.firebasestorage.app",messagingSenderId:"470825187407",appId:"1:470825187407:web:4bd3f8c621c96890b2d23a",measurementId:"G-HS8CDYHDT1"},Z_=()=>{const s=["apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId"];for(const n of s)if(!$u[n])throw new Error(`Firebase configuration missing: ${n}`);if(!$u.apiKey.startsWith("AIzaSy"))throw new Error("Invalid Firebase API key format")};let Il;try{Z_();const s=ty();s.length===0?(Il=ny($u),De.log("Firebase app initialized")):(Il=s[0],De.log("Using existing Firebase app"))}catch(s){throw De.error("Firebase initialization failed:",s),s}const kn=Mw(Il),Ce=Iw(Il);P_(Il);const yr=new Uw;yr.addScope("email");yr.addScope("profile");yr.addScope("https://www.googleapis.com/auth/userinfo.email");yr.addScope("https://www.googleapis.com/auth/userinfo.profile");yr.setCustomParameters({prompt:"select_account"});const J_=()=>{if(window.location.protocol!=="https:")throw De.error("Firebase requires HTTPS in production"),new Error("HTTPS required for Firebase in production")};try{J_(),De.log("Firebase    ")}catch(s){De.error("Firebase security validation failed:",s)}const yy=O.createContext(void 0),ek=({children:s})=>{const[n,r]=O.useState(null),[i,c]=O.useState(!0),[u,f]=O.useState(!1);O.useEffect(()=>{if(!kn){console.log("Auth: Firebase disabled, using localStorage only"),c(!1);return}const z=Lw(kn,W=>{W?(r({uid:W.uid,email:W.email,displayName:W.displayName,photoURL:W.photoURL,isAnonymous:W.isAnonymous}),f(W.isAnonymous)):(r(null),f(!1)),c(!1)});return()=>z()},[]),O.useEffect(()=>{typeof window<"u"&&(window.authContext={signInWithGoogle:w})},[]);const g=async()=>{console.log("Auth: Use signInWithGoogle or signIn instead")},m=async()=>{kn?await Yw(kn):r(null)},p=async()=>{kn?await qw(kn):(r({uid:"local-user",email:null,displayName:"Local User",isAnonymous:!0}),f(!0))},x=async(z,W)=>{kn?await Bw(kn,z,W):console.log("Auth: SignIn not available in localStorage mode",{email:z,password:W})},b=async(z,W,k)=>{if(kn){const S=await Hw(kn,z,W);k&&S.user&&await $w(S.user,{displayName:k})}else console.log("Auth: SignUp not available in localStorage mode",{email:z,password:W,displayName:k})},w=async()=>{if(!kn||!yr)throw new Error("Firebase   .");try{const z=await zw(kn,yr);return console.log("  :",z.user),z.user}catch(z){throw console.error("  :",z),z.code==="auth/popup-closed-by-user"||z.code==="auth/cancelled-popup-request"?new Error(" ."):z.code==="auth/network-request-failed"?new Error("  ."):new Error("   : "+z.message)}},T={currentUser:n,loading:i,isAnonymous:u,login:g,logout:m,loginAnonymously:p,signIn:x,signUp:b,signInWithGoogle:w,signInAsGuest:async()=>{await p()}};return l.jsx(yy.Provider,{value:T,children:s})},Nn=()=>{const s=O.useContext(yy);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s};class sa extends Error{constructor(n,r="UNKNOWN_ERROR",i){super(n),this.code=r,this.originalError=i,this.name="TodoError"}}const Dl=(s,n)=>{if(s&&typeof s=="object"&&"code"in s){const r=s;switch(r.code){case"permission-denied":return new sa(" .   .","PERMISSION_DENIED",s);case"not-found":return new sa("    .","NOT_FOUND",s);case"unavailable":return new sa("    .    .","UNAVAILABLE",s);case"failed-precondition":return new sa("   .","FAILED_PRECONDITION",s);case"already-exists":return new sa("  .","ALREADY_EXISTS",s);default:return new sa(`${n}   : ${r.message}`,r.code||"FIRESTORE_ERROR",s)}}return s instanceof Error?new sa(`${n}   : ${s.message}`,"GENERAL_ERROR",s):new sa(`${n}      .`,"UNKNOWN_ERROR",s)},tk=s=>["unavailable","deadline-exceeded","internal","NETWORK_ERROR"].includes(s.code.toLowerCase()),po=async(s,n=3,r=1e3)=>{let i;for(let c=1;c<=n;c++)try{return await s()}catch(u){const f=u instanceof sa?u:Dl(u,"Operation");if(i=f,!tk(f)||c===n)throw f;const g=r*Math.pow(2,c-1);await new Promise(m=>setTimeout(m,g))}throw i},Je=s=>{if(s){if(s instanceof Date)return s;if(typeof s?.toDate=="function")return s.toDate();if(typeof s=="string")return new Date(s)}},la=s=>{if(s==null)return s;if(Array.isArray(s))return s.map(la);if(s instanceof Date)return s;if(typeof s=="object"){const n={};return Object.keys(s).forEach(r=>{const i=s[r];i!==void 0&&(n[r]=la(i))}),n}return s},nk=(s,n,r)=>{switch(r){case"same_date":return s.toDateString()===n.toDateString();case"same_week":const i=new Date(s);i.setDate(s.getDate()-s.getDay());const c=new Date(n);return c.setDate(n.getDate()-n.getDay()),i.toDateString()===c.toDateString();case"same_month":return s.getFullYear()===n.getFullYear()&&s.getMonth()===n.getMonth();default:return!1}},ak=s=>{const r=new Date(s.getFullYear(),s.getMonth(),1).getDay();return Math.ceil((s.getDate()+r)/7)},rk=s=>{const n=s.getFullYear(),r=s.getMonth(),i=s.getDay(),c=new Date(n,r+1,0);for(let u=c.getDate();u>=1;u--)if(new Date(n,r,u).getDay()===i)return s.getDate()===u;return!1},sk=(s,n,r,i)=>{const c=n-1;if(r==="last"){const u=new Date(s,c+1,0);for(let f=u.getDate();f>=1;f--){const g=new Date(s,c,f);if(g.getDay()===i)return g}}else{const f={first:1,second:2,third:3,fourth:4}[r];let g=0;const m=new Date(s,c+1,0).getDate();for(let p=1;p<=m;p++){const x=new Date(s,c,p);if(x.getDay()===i&&(g++,g===f))return x}}return null},lk=(s,n="show",r=[])=>{let i=new Date(s);if(n==="show")return i;const c=So(i,r),u=Ha(i);if(!c&&!u)return i;let f=0;for(;f<15;){n==="before"?i.setDate(i.getDate()-1):i.setDate(i.getDate()+1);const g=So(i,r),m=Ha(i);if(!g&&!m)break;f++}return i},Oe={getTodos:async s=>po(async()=>{try{if(!s)throw new Error("User ID is required");const n=et(Ce,`users/${s}/todos`),r=Dn(n,Ua("createdAt","desc")),c=(await Mt(r)).docs.map(u=>{const f=u.data();return{id:u.id,...f,createdAt:Je(f.createdAt)||new Date,updatedAt:Je(f.updatedAt)||new Date,dueDate:Je(f.dueDate),startDate:Je(f.startDate),completedAt:Je(f.completedAt),subTasks:f.subTasks?f.subTasks.map(g=>({...g,createdAt:Je(g.createdAt)||new Date,updatedAt:Je(g.updatedAt)||new Date,completedAt:g.completedAt?Je(g.completedAt):null})):[]}});return De.log("Firestore getTodos :",{count:c.length,uid:s}),c}catch(n){throw De.error("Firestore getTodos :",n),Dl(n,"getTodos")}}),addTodo:async(s,n)=>po(async()=>{try{if(!n||!s.title?.trim())throw new Error("User ID and todo title are required");const r=et(Ce,`users/${n}/todos`),c={...la(s),createdAt:bt(),updatedAt:bt()},u=await Sl(r,c);return De.log("Firestore addTodo :",u.id),u.id}catch(r){throw De.error("Firestore addTodo :",r),Dl(r,"addTodo")}}),updateTodo:async(s,n,r)=>{try{const i=Nt(Ce,`users/${r}/todos`,s);if(!(await go(i)).exists()){De.warn(`  ${s}  .  .`);return}const u={...n,updatedAt:bt()};await ur(i,u)}catch(i){throw De.error("Firestore updateTodo :",i),i}},deleteTodo:async(s,n)=>{try{const r=Nt(Ce,`users/${n}/todos`,s);await bo(r)}catch(r){throw console.error(" Firestore deleteTodo :",r),r}},subscribeTodos:(s,n)=>{try{const r=et(Ce,`users/${s}/todos`),i=Dn(r,Ua("createdAt","desc"));return jl(i,u=>{const f=u.docs.map(g=>{const m=g.data();return{...m,id:g.id,createdAt:Je(m.createdAt)||new Date,updatedAt:Je(m.updatedAt)||new Date,dueDate:Je(m.dueDate),startDate:Je(m.startDate),completedAt:Je(m.completedAt),subTasks:m.subTasks?m.subTasks.map(p=>({...p,createdAt:Je(p.createdAt)||new Date,updatedAt:Je(p.updatedAt)||new Date,completedAt:p.completedAt?Je(p.completedAt):null})):[]}});n(f)},u=>{console.error(" Firestore  :",u),n([])})}catch(r){return console.error(" Firestore subscribeTodos  :",r),n([]),()=>{}}},addSubTask:async(s,n,r)=>{const i=Nt(Ce,`users/${n}/todos`,r);await ur(i,{subTasks:Fw(s),updatedAt:bt()})},updateSubTask:async(s,n,r,i)=>{const c=Nt(Ce,`users/${r}/todos`,i),u=await go(c);if(!u.exists())throw new Error("   .");const m=(u.data().subTasks||[]).map(p=>p.id===s?{...p,...n,updatedAt:new Date}:p);await ur(c,{subTasks:m,updatedAt:bt()})},deleteSubTask:async(s,n,r)=>{const i=Nt(Ce,`users/${n}/todos`,r),c=await go(i);if(!c.exists())throw new Error("   .");const g=(c.data().subTasks||[]).filter(m=>m.id!==s);await ur(i,{subTasks:g,updatedAt:bt()})},getRecurringTemplates:async s=>{const n=et(Ce,`users/${s}/recurringTemplates`),r=Dn(n,Ua("createdAt","desc"));return(await Mt(r)).docs.map(c=>({id:c.id,...c.data(),createdAt:c.data().createdAt?.toDate()||new Date,updatedAt:c.data().updatedAt?.toDate()||new Date}))},addRecurringTemplate:async(s,n)=>{const r=et(Ce,`users/${n}/recurringTemplates`),c={...la(s),createdAt:bt(),updatedAt:bt()};return(await Sl(r,c)).id},updateRecurringTemplate:async(s,n,r)=>{const i=Nt(Ce,`users/${r}/recurringTemplates`,s),c=la(n);await ur(i,{...c,updatedAt:bt()})},deleteRecurringTemplate:async(s,n)=>{const r=za(Ce),i=Nt(Ce,`users/${n}/recurringTemplates`,s);r.delete(i);const c=et(Ce,`users/${n}/recurringInstances`),u=Dn(c,bu("templateId","==",s));(await Mt(u)).forEach(g=>r.delete(g.ref)),await r.commit()},subscribeProjectTemplates:(s,n)=>{try{De.log("   ",{uid:s});const r=et(Ce,`users/${s}/projectTemplates`),i=Dn(r,Ua("createdAt","desc"));return jl(i,u=>{const f=u.docs.map(g=>{const m=g.data();return{id:g.id,...m,createdAt:Je(m.createdAt)||new Date,updatedAt:Je(m.updatedAt)||new Date}});De.log("   ",{count:f.length}),n(f)},u=>{De.error("   :",u),n([])})}catch(r){return De.error("    :",r),n([]),()=>{}}},addProjectTemplate:async(s,n)=>{const r=et(Ce,`users/${n}/projectTemplates`),c={...la(s),createdAt:bt(),updatedAt:bt()};return(await Sl(r,c)).id},updateProjectTemplate:async(s,n,r)=>{const i=Nt(Ce,`users/${r}/projectTemplates`,s),c=la(n);await ur(i,{...c,updatedAt:bt()})},deleteProjectTemplate:async(s,n)=>{const r=Nt(Ce,`users/${n}/projectTemplates`,s);await bo(r)},subscribeRecurringTemplates:(s,n)=>{const r=et(Ce,`users/${s}/recurringTemplates`),i=Dn(r,Ua("createdAt","desc"));return jl(i,c=>{const u=c.docs.map(f=>({id:f.id,...f.data(),createdAt:Je(f.data().createdAt)||new Date,updatedAt:Je(f.data().updatedAt)||new Date}));n(u)})},getRecurringInstances:async s=>{const n=et(Ce,`users/${s}/recurringInstances`),r=Dn(n,Ua("date","asc"));return(await Mt(r)).docs.map(c=>({id:c.id,...c.data(),date:Je(c.data().date)||new Date,createdAt:Je(c.data().createdAt)||new Date,updatedAt:Je(c.data().updatedAt)||new Date,completedAt:Je(c.data().completedAt)}))},addRecurringInstance:async(s,n)=>{const r=et(Ce,`users/${n}/recurringInstances`),i=la(s);return(await Sl(r,{...i,createdAt:bt(),updatedAt:bt()})).id},updateRecurringInstance:async(s,n,r)=>{const i=Nt(Ce,`users/${r}/recurringInstances`,s),c=la(n);await ur(i,{...c,updatedAt:bt()})},deleteRecurringInstance:async(s,n)=>{const r=Nt(Ce,`users/${n}/recurringInstances`,s);await bo(r)},subscribeRecurringInstances:(s,n)=>{const r=et(Ce,`users/${s}/recurringInstances`),i=Dn(r,Ua("date","asc"));return jl(i,c=>{const u=c.docs.map(f=>({id:f.id,...f.data(),date:Je(f.data().date)||new Date,createdAt:Je(f.data().createdAt)||new Date,updatedAt:Je(f.data().updatedAt)||new Date,completedAt:Je(f.data().completedAt)}));n(u)})},async _isExceptionDate(s,n,r,i){if(i||!n.exceptions)return!1;for(const c of n.exceptions)switch(c.type){case"date":if(c.values.includes(s.getDate()))return!0;break;case"weekday":if(c.values.includes(s.getDay()))return!0;break;case"week":const u=ak(s);if(c.values.includes(u)||c.values.includes(-1)&&rk(s))return!0;break;case"month":if(c.values.includes(s.getMonth()+1))return!0;break;case"conflict":const f=c.values;for(const g of f)if(await this._hasConflictingInstance(s,n.id,g,r))return!0;break}return!1},async _hasConflictingInstance(s,n,r,i){const c=et(Ce,`users/${i}/recurringTemplates`),u=Dn(c,bu("title","==",r.targetTemplateTitle)),g=(await Mt(u)).docs.find(x=>x.id!==n);if(!g)return!1;const m={id:g.id,...g.data()},p=await this.generateInstancesForTemplate(m,i,!0,[]);for(const x of p)if(nk(s,x.date,r.scope))return De.log(`[Conflict] ${s.toDateString()} on ${n} conflicts with ${m.title}`),!0;return!1},async generateInstancesForTemplate(s,n,r=!1,i=[]){if(!s.isActive)return[];const c=[],u=new Set,f=new Date,g=new Date(f);g.setFullYear(f.getFullYear()+1);let m=new Date(f.getFullYear(),f.getMonth(),1);for(;m<=g;){let p=null;if(s.recurrenceType==="daily")p=new Date(m);else if(s.recurrenceType==="weekly")m.getDay()===s.weekday&&(p=new Date(m));else if(s.recurrenceType==="monthly"){let x=null;if(s.monthlyPattern==="weekday"&&s.monthlyWeek&&s.monthlyWeekday!==void 0)x=sk(m.getFullYear(),m.getMonth()+1,s.monthlyWeek,s.monthlyWeekday);else{const b=s.monthlyDate;if(b===-1)x=new Date(m.getFullYear(),m.getMonth()+1,0);else if(b===-2)x=hy(m.getFullYear(),m.getMonth()+1);else if(b===-3)x=fy(m.getFullYear(),m.getMonth()+1);else if(b&&b>0){const w=new Date(m.getFullYear(),m.getMonth(),b);w.getMonth()===m.getMonth()&&(x=w)}}x&&x.getFullYear()===m.getFullYear()&&x.getMonth()===m.getMonth()&&(p=x)}if(p&&p>=new Date(new Date().setHours(0,0,0,0))){let x=lk(p,s.holidayHandling,i);if(!await this._isExceptionDate(x,s,n,r)){const w=`${x.getFullYear()}-${(x.getMonth()+1).toString().padStart(2,"0")}-${x.getDate().toString().padStart(2,"0")}`;u.has(w)||(c.push({id:`${s.id}_${w}`,templateId:s.id,date:x,completed:!1,createdAt:new Date,updatedAt:new Date}),u.add(w))}}s.recurrenceType==="monthly"?(m.setMonth(m.getMonth()+1),m.setDate(1)):m.setDate(m.getDate()+1)}return c},async _copyCollection(s,n,r){const i=et(Ce,`users/${s}/${r}`),c=et(Ce,`users/${n}/${r}`),u=await Mt(i),f=za(Ce);u.forEach(g=>{const m=g.data();f.set(Nt(c,g.id),{...m,createdAt:m.createdAt||bt(),updatedAt:bt()})}),await f.commit()},async _deleteCollection(s,n){const r=et(Ce,`users/${s}/${n}`),i=await Mt(r),c=za(Ce);i.forEach(u=>{c.delete(u.ref)}),await c.commit()},migrateUserData:async(s,n)=>po(async()=>{try{if(!s||!n)throw new Error("Old UID and New UID are required for migration.");if(s===n)throw new Error("Cannot migrate data to the same UID.");De.log(`Starting data migration from old UID: ${s} to new UID: ${n}`),await Oe._copyCollection(s,n,"todos"),await Oe._copyCollection(s,n,"recurringTemplates"),await Oe._copyCollection(s,n,"recurringInstances"),await Oe._copyCollection(s,n,"projectTemplates"),De.log(`Deleting old data for UID: ${s}`),await Oe._deleteCollection(s,"todos"),await Oe._deleteCollection(s,"recurringTemplates"),await Oe._deleteCollection(s,"recurringInstances"),await Oe._deleteCollection(s,"projectTemplates"),De.log(`Data migration completed successfully from ${s} to ${n}`)}catch(r){throw De.error("Data migration failed:",r),Dl(r,"migrateUserData")}}),regenerateRecurringInstances:async(s,n)=>po(async()=>{try{if(!n||!s)throw new Error("User ID and template ID are required");De.log("    ",{templateId:s,uid:n});const r=et(Ce,`users/${n}/recurringInstances`),i=Nt(Ce,`users/${n}/recurringTemplates`,s),c=Dn(r,bu("templateId","==",s)),u=await Mt(c),f=new Map;u.forEach(z=>{f.set(z.id,z.data())}),De.log("    ",{count:f.size});const g=await go(i);if(!g.exists())throw new Error(`Template ${s} not found`);const m={id:g.id,...g.data()},p=et(Ce,`users/${n}/custom_holidays`),b=(await Mt(p)).docs.map(z=>{const W=z.data();return{id:z.id,date:W.date,name:W.name,isRecurring:W.isRecurring,createdAt:W.createdAt}}),w=await Oe.generateInstancesForTemplate(m,n,!1,b);De.log("   ",{count:w.length});const L=za(Ce),T=new Set;w.forEach(z=>{const W=Nt(r,z.id),k=f.get(z.id);k?(T.add(z.id),L.update(W,{...z,completed:k.completed||!1,completedAt:k.completedAt||null,updatedAt:bt()})):(T.add(z.id),L.set(W,{...z,createdAt:bt(),updatedAt:bt()}))}),f.forEach((z,W)=>{if(!T.has(W)){const k=Je(z.date),S=new Date;S.setHours(0,0,0,0),z.completed||k&&k>=S?(L.delete(Nt(r,W)),De.log("    (  )",{id:W})):De.log("     ",{id:W})}}),await L.commit(),De.log("    ",{templateId:s})}catch(r){throw De.error("    :",r),Dl(r,"regenerateRecurringInstances")}})},Du={cleanupOrphanedInstances:async s=>{try{console.log("    ");const n=et(Ce,`users/${s}/recurringTemplates`),r=await Mt(n),i=new Set;r.forEach(x=>{i.add(x.id)}),console.log(` : ${i.size}`);const c=et(Ce,`users/${s}/recurringInstances`),u=await Mt(c),f=[];u.forEach(x=>{const b=x.data();i.has(b.templateId)||(f.push(x.id),console.log(`  : ${x.id} (: ${b.templateId})`))});const g=et(Ce,`users/${s}/todos`),m=await Mt(g),p=[];if(m.forEach(x=>{const b=x.data();b._templateId&&!i.has(b._templateId)&&(p.push(x.id),console.log(`  : ${b.title} (: ${b._templateId})`))}),f.length>0||p.length>0){const x=za(Ce);f.forEach(b=>{const w=Nt(Ce,`users/${s}/recurringInstances`,b);x.delete(w)}),p.forEach(b=>{const w=Nt(Ce,`users/${s}/todos`,b);x.delete(w)}),await x.commit(),console.log(`  :  ${f.length},  ${p.length}`)}else console.log("    ");return{orphanedInstances:f.length,orphanedTodos:p.length,totalCleaned:f.length+p.length}}catch(n){throw console.error("    :",n),n}},validateTemplateConsistency:async s=>{try{console.log("     ");const n=et(Ce,`users/${s}/recurringTemplates`),r=await Mt(n),i=et(Ce,`users/${s}/recurringInstances`),c=await Mt(i),u=et(Ce,`users/${s}/todos`),f=await Mt(u),g=new Map;return r.forEach(m=>{const p=m.data();g.set(m.id,{templateTitle:p.title,instances:0,todos:0,isActive:p.isActive!==!1})}),c.forEach(m=>{const x=m.data().templateId;g.has(x)&&g.get(x).instances++}),f.forEach(m=>{const x=m.data()._templateId;x&&g.has(x)&&g.get(x).todos++}),console.log(`
   :`),console.log("=".repeat(60)),g.forEach((m,p)=>{console.log(`${m.templateTitle} (${p}):`),console.log(`  : ${m.isActive}`),console.log(`  : ${m.instances}`),console.log(`  : ${m.todos}`),m.instances>0&&m.todos===0&&console.log("   :     "),console.log("")}),g}catch(n){throw console.error("    :",n),n}},regenerateAllInstances:async s=>{try{console.log("    ");const n=et(Ce,`users/${s}/recurringInstances`),r=await Mt(n),i=za(Ce);r.forEach(c=>{i.delete(c.ref)}),await i.commit(),console.log(`   ${r.size}  `),console.log("       ")}catch(n){throw console.error("   :",n),n}},smartCleanupInstances:async s=>{try{console.log("    "),console.log("    ...");const n=et(Ce,`users/${s}/recurringTemplates`),r=await Mt(n),i=new Set;r.forEach(m=>{const p=m.data();p.isActive!==!1&&(i.add(m.id),console.log(` : ${p.title} (${m.id})`))}),console.log(` : ${i.size}`),console.log("2     ...");const c=et(Ce,`users/${s}/recurringInstances`),u=await Mt(c),f=[],g=[];if(u.forEach(m=>{const p=m.data(),x=p.templateId,b=p.completed===!0;!i.has(x)?f.push(m.id):g.push(m.id)}),console.log(`  :  ${f.length},  ${g.length}`),f.length>0){console.log("3    ...");const m=[];let p=za(Ce),x=0;f.forEach(b=>{const w=Nt(Ce,`users/${s}/recurringInstances`,b);p.delete(w),x++,x>=500&&(m.push(p),p=za(Ce),x=0)}),x>0&&m.push(p);for(let b=0;b<m.length;b++)await m[b].commit(),console.log(` ${b+1}/${m.length}  `);console.log(`  ${f.length}   `)}else console.log("  ");return console.log("   !"),console.log(`-  : ${i.size}`),console.log(`-  : ${f.length}`),console.log(`-  : ${g.length}`),console.log(`-  : ${u.size}`),{activeTemplates:i.size,deletedInstances:f.length,keptInstances:g.length,totalInstances:u.size}}catch(n){throw console.error("    :",n),n}}},xy=O.createContext(void 0),ik=({children:s})=>{const[n,r]=O.useState([]),[i,c]=O.useState(!0),{currentUser:u}=Nn();O.useEffect(()=>{if(!u){r([]),c(!1);return}const p=Dn(et(Ce,`users/${u.uid}/custom_holidays`),Ua("date","asc")),x=jl(p,b=>{const w=b.docs.map(L=>({id:L.id,...L.data()}));r(w),c(!1)},b=>{console.error("Error fetching custom holidays:",b),c(!1)});return()=>x()},[u]);const f=async(p,x,b=!1)=>{if(u)try{await Sl(et(Ce,`users/${u.uid}/custom_holidays`),{date:p,name:x,isRecurring:b,createdAt:bt()})}catch(w){throw console.error("Error adding custom holiday:",w),w}},g=async p=>{if(u)try{await bo(Nt(Ce,`users/${u.uid}/custom_holidays`,p))}catch(x){throw console.error("Error deleting custom holiday:",x),x}},m=p=>n.find(x=>{const b=new Date(x.date);b.setHours(0,0,0,0);const w=new Date(p);return w.setHours(0,0,0,0),b.getTime()===w.getTime()});return l.jsx(xy.Provider,{value:{customHolidays:n,addCustomHoliday:f,deleteCustomHoliday:g,getCustomHoliday:m,loading:i},children:s})},Wo=()=>{const s=O.useContext(xy);if(s===void 0)throw new Error("useCustomHolidays must be used within a CustomHolidayProvider");return s},by=O.createContext(void 0),ok={todos:[],recurringTemplates:[],recurringInstances:[],loading:!1,error:null,syncing:!1};function ck(s,n){switch(n.type){case"SET_LOADING":return{...s,loading:n.payload};case"SET_SYNCING":return{...s,syncing:n.payload};case"SET_ERROR":return{...s,error:n.payload};case"SET_TODOS":const r=n.payload.filter((u,f,g)=>g.findIndex(m=>m.id===u.id)===f);return r.length!==n.payload.length&&console.warn(` SET_TODOS  : ${n.payload.length}  ${r.length}`),{...s,todos:r};case"ADD_TODO":return s.todos.some(u=>u.id===n.payload.id)?(console.warn(` ADD_TODO  : ${n.payload.id}  `),s):{...s,todos:[n.payload,...s.todos]};case"UPDATE_TODO":return{...s,todos:s.todos.map(u=>u.id===n.payload.id?{...u,...n.payload.updates,updatedAt:new Date}:u)};case"DELETE_TODO":return{...s,todos:s.todos.filter(u=>u.id!==n.payload)};case"TOGGLE_TODO":{const u=new Date;return{...s,todos:s.todos.map(f=>{if(f.id===n.payload){const g=!f.completed;return g&&setTimeout(()=>{Wa(async()=>{const{notificationManager:m}=await Promise.resolve().then(()=>Tj);return{notificationManager:m}},void 0,import.meta.url).then(({notificationManager:m})=>{m.showCompletionCelebration(f)})},0),{...f,completed:g,completedAt:g?u:void 0,updatedAt:u}}return f})}}case"ADD_SUBTASK":return{...s,todos:s.todos.map(u=>u.id===n.payload.todoId?{...u,subTasks:[...u.subTasks||[],n.payload.subTask],updatedAt:new Date}:u)};case"UPDATE_SUBTASK":return{...s,todos:s.todos.map(u=>u.id===n.payload.todoId?{...u,subTasks:u.subTasks?.map(f=>f.id===n.payload.subTaskId?{...f,...n.payload.updates,updatedAt:new Date}:f)||[],updatedAt:new Date}:u)};case"DELETE_SUBTASK":return{...s,todos:s.todos.map(u=>u.id===n.payload.todoId?{...u,subTasks:u.subTasks?.filter(f=>f.id!==n.payload.subTaskId)||[],updatedAt:new Date}:u)};case"TOGGLE_SUBTASK":return{...s,todos:s.todos.map(u=>u.id===n.payload.todoId?{...u,subTasks:u.subTasks?.map(f=>f.id===n.payload.subTaskId?{...f,completed:!f.completed,updatedAt:new Date}:f)||[],updatedAt:new Date}:u)};case"SET_RECURRING_TEMPLATES":return{...s,recurringTemplates:n.payload};case"ADD_RECURRING_TEMPLATE":return{...s,recurringTemplates:[n.payload,...s.recurringTemplates]};case"UPDATE_RECURRING_TEMPLATE":return{...s,recurringTemplates:s.recurringTemplates.map(u=>u.id===n.payload.id?{...u,...n.payload.updates,updatedAt:new Date}:u)};case"DELETE_RECURRING_TEMPLATE":return{...s,recurringTemplates:s.recurringTemplates.filter(u=>u.id!==n.payload),recurringInstances:s.recurringInstances.filter(u=>u.templateId!==n.payload)};case"SET_RECURRING_INSTANCES":console.log(" SET_RECURRING_INSTANCES - Firebase  state "),console.log(`     : ${s.recurringInstances.length}`),console.log(`    Firebase  : ${n.payload.length}`);const c=n.payload.find(u=>u.id==="vCyWLYn3LuDq1nVUPSyE_2025-08-26");return c&&console.log(`    Firebase  : completed=${c.completed}`),{...s,recurringInstances:n.payload};case"UPDATE_RECURRING_INSTANCE":return{...s,recurringInstances:s.recurringInstances.map(u=>u.id===n.payload.id?{...u,...n.payload.updates,updatedAt:new Date}:u)};case"GENERATE_RECURRING_INSTANCES":{let u=[],f=[];try{const g=localStorage.getItem("recurringInstances");g&&(f=JSON.parse(g).map(p=>({...p,date:new Date(p.date),createdAt:new Date(p.createdAt),updatedAt:new Date(p.updatedAt),completedAt:p.completedAt?new Date(p.completedAt):void 0})),console.log(" localStorage   :",f.length,""))}catch(g){console.error(" localStorage   :",g)}return console.log("   -    "),s.recurringTemplates.filter(g=>g.isActive).forEach(g=>{try{const p=cs.generateInstances(g).map(x=>{const b=f.find(w=>w.id===x.id);return b?(console.log(` localStorage   : ${x.id} (: ${b.completed})`),{...x,completed:b.completed,completedAt:b.completedAt,updatedAt:b.updatedAt}):x});u=[...u,...p]}catch(m){console.error(` ${g.id}   :`,m)}}),{...s,recurringInstances:u}}default:return s}}const dk=({children:s})=>{const[n,r]=O.useReducer(ck,ok),{currentUser:i,loading:c}=Nn(),{customHolidays:u}=Wo(),[f,g]=O.useState(""),[m,p]=O.useState("all"),[x,b]=O.useState("all"),[w,L]=O.useState([]),T=O.useRef(null),z=O.useRef(null),W=O.useRef(null);O.useEffect(()=>{if(c)return;if(!i){console.log("  "),k();return}return console.log("   - :",i.uid),r({type:"SET_LOADING",payload:!0}),T.current&&(T.current(),T.current=null),z.current&&(z.current(),z.current=null),W.current&&(W.current(),W.current=null),(async()=>{try{if(await A(),!i)return;console.log("     - :",i.uid),console.log(" Firestore    -  ID:",i.uid),T.current=Oe.subscribeTodos(i.uid,ne=>{console.log(" Firestore   :",ne.length,""),console.log(" Firestore    ID:",ne.map(J=>J.id)),r({type:"SET_TODOS",payload:ne}),r({type:"SET_LOADING",payload:!1}),r({type:"SET_ERROR",payload:null})}),z.current=Oe.subscribeRecurringTemplates(i.uid,ne=>{r({type:"SET_RECURRING_TEMPLATES",payload:ne}),console.log("  Firestore :",ne.length,"")}),console.log("      ..."),console.log("       ..."),console.log("   :"),console.log("  UID:",i.uid),console.log("  Email:",i.email),console.log("  DisplayName:",i.displayName),console.log(" Firestore : users/"+i.uid+"/recurringInstances");const G=await Oe.getRecurringInstances(i.uid),q=G.find(ne=>ne.id==="PUH4xT3lVY5aK2vuQyUe_2025-08-21");q&&(console.log("    :"),console.log("  completed:",q.completed,typeof q.completed),console.log("  completedAt:",q.completedAt),console.log("   :",JSON.stringify(q,null,2)),console.log("    : users/"+i.uid+"/recurringInstances/PUH4xT3lVY5aK2vuQyUe_2025-08-21"));const Y=G.find(ne=>ne.id==="vCyWLYn3LuDq1nVUPSyE_2025-08-26");Y?(console.log("    :"),console.log("  ID:",Y.id),console.log("  completed:",Y.completed,typeof Y.completed),console.log("  completedAt:",Y.completedAt),console.log("  updatedAt:",Y.updatedAt)):(console.log("      "),console.log("    :",G.map(ne=>ne.id)));const se=Oe.subscribeRecurringInstances(i.uid,ne=>{console.log("     - :",ne.length),console.log("   :",new Date().toISOString());const J=ne.filter(Se=>Se.templateId==="vCyWLYn3LuDq1nVUPSyE");J.length>0&&(console.log(" Firebase  - :"),J.forEach(Se=>{console.log(`   ID: ${Se.id}, : ${Se.completed}`);const ye=n.recurringInstances.find(me=>me.id===Se.id);ye&&ye.completed!==Se.completed&&console.log(`     : (${ye.completed}) vs Firebase(${Se.completed})`)})),r({type:"SET_RECURRING_INSTANCES",payload:ne}),console.log(" Firebase   dispatch ")});se?(console.log("      "),W.current=se,setTimeout(async()=>{try{console.log(" Firebase   ...");const ne=await Oe.getRecurringInstances(i.uid),J=ne.find(Se=>Se.id==="vCyWLYn3LuDq1nVUPSyE_2025-08-26");J&&console.log(` Firebase : ID=${J.id}, =${J.completed}`),r({type:"SET_RECURRING_INSTANCES",payload:ne}),console.log(" Firebase   ")}catch(ne){console.error(" Firebase   :",ne)}},3e3)):console.error("      ")}catch(G){console.error("Firestore  :",G),r({type:"SET_LOADING",payload:!1}),r({type:"SET_ERROR",payload:"Firebase  ."})}})(),()=>{T.current&&T.current(),z.current&&z.current(),W.current&&W.current()}},[i,c]),O.useEffect(()=>{if(n.recurringTemplates.length===0)return;console.log("     -   "),console.log("   :",n.recurringTemplates.length),(async()=>{try{if(!i){const G=[];for(const q of n.recurringTemplates)try{console.log(`   : ${q.title}`);const Y=cs.generateInstances(q,u);G.push(...Y),console.log(`  ${q.title}: ${Y.length}  `)}catch(Y){console.error(`  ${q.title}   :`,Y)}console.log("   :",G.length),r({type:"SET_RECURRING_INSTANCES",payload:G});return}for(const G of n.recurringTemplates)try{console.log(` Firebase  : ${G.title}`),await Oe.regenerateRecurringInstances(G.id,i.uid)}catch(q){console.error(` Firebase  ${G.title}  :`,q)}console.log("    ")}catch(G){console.error("    :",G)}})()},[n.recurringTemplates,i,u]),O.useEffect(()=>{if(!i||n.recurringInstances.length===0)return;const G=setTimeout(async()=>{try{console.log(`   Firebase   ... ( ${n.recurringInstances.length})`);const q=await Oe.getRecurringInstances(i.uid),Y=new Set(q.map(ne=>ne.id));console.log(` Firebase  : ${q.length}`),console.log(`  : ${n.recurringInstances.length}`);const se=n.recurringInstances.filter(ne=>{const J=!Y.has(ne.id);return J&&console.log(`   : ${ne.id} (: ${ne.date})`),J});if(se.length>0){console.log(` Firebase    ${se.length}  ...`);for(const ne of se)try{const J=await Oe.addRecurringInstance({...ne,id:ne.id},i.uid);console.log(`   Firebase  : ${ne.id} -> Firestore ID: ${J}`)}catch(J){console.error(`   Firebase  : ${ne.id}`,J)}console.log("   Firebase  !")}else console.log("     Firebase  ")}catch(q){console.error("   Firebase  :",q)}},500);return()=>clearTimeout(G)},[n.recurringInstances,i]);const k=()=>{try{if(console.log("=== localStorage    ==="),i){console.log("   -  Firebase  "),r({type:"SET_TODOS",payload:[]}),r({type:"SET_RECURRING_TEMPLATES",payload:[]}),r({type:"SET_LOADING",payload:!1});return}if(i)console.log("  - localStorage    (Firestore )");else{const j=localStorage.getItem("todos");if(j){const q=JSON.parse(j).map(Y=>({...Y,createdAt:new Date(Y.createdAt),updatedAt:new Date(Y.updatedAt),dueDate:Y.dueDate?new Date(Y.dueDate):void 0,startDate:Y.startDate?new Date(Y.startDate):void 0,completedAt:Y.completedAt?new Date(Y.completedAt):void 0}));console.log("localStorage   ():",q.length,""),r({type:"SET_TODOS",payload:q})}}if(i)console.log("   - localStorage     (Firestore )");else{const j=localStorage.getItem("recurringTemplates");if(j){const q=JSON.parse(j).map(Y=>({...Y,createdAt:new Date(Y.createdAt),updatedAt:new Date(Y.updatedAt)}));console.log("localStorage   :",q.length,""),r({type:"SET_RECURRING_TEMPLATES",payload:q})}}r({type:"SET_LOADING",payload:!1}),console.log("=== localStorage    ===")}catch(j){console.error("localStorage   :",j),r({type:"SET_ERROR",payload:"localStorage     ."}),r({type:"SET_LOADING",payload:!1})}},S=()=>{if(i){console.log("  - localStorage  ");return}try{localStorage.setItem("todos",JSON.stringify(n.todos)),localStorage.setItem("recurringTemplates",JSON.stringify(n.recurringTemplates)),console.log("localStorage    ()")}catch(j){console.error("localStorage  :",j)}},A=async()=>{if(i)try{if(console.log("=== localStorage  Firestore   ==="),!i)return;if(console.log("   - localStorage   "),localStorage.getItem(`migrated_${i.uid}`)){console.log("   :",i.uid);return}console.log("  - :",i.uid);const G=localStorage.getItem("todos"),q=localStorage.getItem("recurringTemplates");if(G||q){if(console.log(" localStorage  "),G){const se=JSON.parse(G);if(se.length>0){console.log(`${se.length}  Firestore `);for(const ne of se)try{await Oe.addTodo({...ne,createdAt:new Date(ne.createdAt),updatedAt:new Date(ne.updatedAt),dueDate:ne.dueDate?new Date(ne.dueDate):void 0,startDate:ne.startDate?new Date(ne.startDate):void 0,completedAt:ne.completedAt?new Date(ne.completedAt):void 0},i.uid),console.log(`  : ${ne.title}`)}catch(J){console.error(`  : ${ne.title}`,J)}}}if(q){const se=JSON.parse(q);if(se.length>0){console.log(`${se.length}   Firestore `);for(const ne of se)try{await Oe.addRecurringTemplate({...ne,createdAt:new Date(ne.createdAt),updatedAt:new Date(ne.updatedAt)},i.uid),console.log(`   : ${ne.title}`)}catch(J){console.error(`   : ${ne.title}`,J)}}}const Y={todos:G?JSON.parse(G):[],recurringTemplates:q?JSON.parse(q):[],migratedAt:new Date().toISOString(),userId:i.uid};localStorage.setItem(`migrated_backup_${i.uid}`,JSON.stringify(Y)),localStorage.setItem(`migrated_${i.uid}`,new Date().toISOString()),localStorage.removeItem("todos"),localStorage.removeItem("recurringTemplates"),console.log("===  : localStorage   ===")}else console.log(" localStorage  "),localStorage.setItem(`migrated_${i.uid}`,new Date().toISOString())}catch(j){console.error(" :",j),r({type:"SET_ERROR",payload:"    ."})}};O.useEffect(()=>{if(i){console.log("   - simpleRecurringSystem  !");return}cs.setTemplates(n.recurringTemplates)},[n.recurringTemplates,i]),O.useEffect(()=>{!i&&!c&&(console.log(" localStorage   - todos :",n.todos.length),S())},[n.todos,i,c]),O.useEffect(()=>{!i&&!c&&(console.log(" localStorage   -  :",n.recurringTemplates.length),S())},[n.recurringTemplates,i,c]);const D=async()=>{if(i){r({type:"SET_SYNCING",payload:!0});try{const j=await Oe.getTodos(i.uid);r({type:"SET_TODOS",payload:j}),r({type:"SET_ERROR",payload:null}),setTimeout(()=>{Ne()},500),typeof window<"u"&&(window.initializeOrderValues=Ne,window.forceFirebaseSync=async()=>{if(!i){console.log("  ");return}try{console.log("  Firebase   ...");const G=await Oe.getRecurringInstances(i.uid),q=G.find(Y=>Y.id==="vCyWLYn3LuDq1nVUPSyE_2025-08-26");q&&console.log("   - Firebase  :",q.completed),r({type:"SET_RECURRING_INSTANCES",payload:G}),console.log("  Firebase  !"),setTimeout(()=>{const Y=G.find(se=>se.id==="vCyWLYn3LuDq1nVUPSyE_2025-08-26");Y&&console.log("    :",Y.completed)},1e3)}catch(G){console.error("  Firebase  :",G)}},console.log("   : window.forceFirebaseSync()"))}catch(j){console.error("Firestore  :",j),r({type:"SET_ERROR",payload:"   ."})}finally{r({type:"SET_SYNCING",payload:!1})}}},_=async j=>{console.log("addTodo :",j,":",i?.uid);const G=Y=>{const se=n.todos.filter(J=>J.priority===Y&&!J.completed);if(se.length===0)return{urgent:0,high:1e3,medium:2e3,low:3e3}[Y]||2e3;const ne=Math.min(...se.map(J=>J.order||999));return Math.max(0,ne-1)},q={...j,id:ju(),createdAt:new Date,updatedAt:new Date,order:G(j.priority)};try{if(i){console.log("Firestore   :",q.title);try{const Y=await Oe.addTodo(q,i.uid);console.log("Firestore   , ID:",Y);const se={...q,id:Y};r({type:"ADD_TODO",payload:se}),console.log("     - Firestore ID :",Y)}catch(Y){throw console.error("Firestore  :",Y),Y}}else console.log(" :   "),r({type:"ADD_TODO",payload:q}),console.log("   - localStorage   ")}catch(Y){console.error("  :",Y),r({type:"SET_ERROR",payload:"    ."})}},H=async(j,G)=>{try{i?await Oe.updateTodo(j,G,i.uid):(console.log(" :   "),r({type:"UPDATE_TODO",payload:{id:j,updates:G}}))}catch(q){console.error("  :",q),r({type:"SET_ERROR",payload:"    ."})}},I=async j=>{try{const q=[...n.todos,...oe()].find(se=>se.id===j);if(j.startsWith("recurring_")||q?._isRecurringInstance){console.log('   "" :',j);let se=q?._instanceId;if(!se&&j.startsWith("recurring_")&&(se=j.replace("recurring_","")),!se){console.error("  ID      :",j);return}const ne={skipped:!0,skippedReason:"manual_deletion"},J=n.recurringInstances.map(Se=>Se.id===se?{...Se,...ne}:Se);if(r({type:"SET_RECURRING_INSTANCES",payload:J}),i)try{await Oe.updateRecurringInstance(se,ne,i.uid),console.log(' Firestore   "skipped"  :',se)}catch(Se){console.error(" Firestore    :",Se),r({type:"SET_RECURRING_INSTANCES",payload:n.recurringInstances}),r({type:"SET_ERROR",payload:"   ."})}return}i?await Oe.deleteTodo(j,i.uid):r({type:"DELETE_TODO",payload:j}),console.log("    :",j)}catch(G){console.error("  :",G),r({type:"SET_ERROR",payload:"    ."})}},le=async j=>{console.log("   :",j),(j.includes("")||j.includes("vCyWLYn3LuDq1nVUPSyE"))&&(console.log("   !"),console.log("    ID:",j));const q=[...n.todos,...oe()].find(J=>J.id===j),Y=n.todos.find(J=>J.id===j);if(Y&&Y.startDate&&Y.dueDate&&!Y._isRecurringInstance){console.log("   :",j,":",Y.startDate,":",Y.dueDate);const J={completed:!Y.completed,...Y.completed?{completedAt:Um()}:{completedAt:new Date}};try{r({type:"TOGGLE_TODO",payload:j}),i?(await Oe.updateTodo(j,J,i.uid),console.log("   Firestore  :",j)):console.log("  :    "),console.log(`    : ${j}`);return}catch(Se){console.error("    :",Se),r({type:"TOGGLE_TODO",payload:j}),r({type:"SET_ERROR",payload:"     ."});return}}if(q&&q._isRecurringInstance){console.log("   :",j);let J=q._instanceId;!J&&j.startsWith("recurring_")?(J=j.replace("recurring_",""),console.log(" ID  ID :",J)):console.log("   ID:",J);const Se=n.recurringInstances.find(ye=>ye.id===J);if(Se){console.log("   :",Se);const ye={...Se,completed:!Se.completed,completedAt:Se.completed?void 0:new Date,updatedAt:new Date};if(i)try{console.log(` Firebase     : ${J}`),console.log("  :",{completed:ye.completed,completedAt:ye.completedAt});const me={completed:ye.completed};ye.completedAt===void 0?(console.log(" completedAt undefined -> null "),me.completedAt=null):(console.log(" completedAt :",ye.completedAt),me.completedAt=ye.completedAt),console.log("   :",me),console.log("  UI     ");const ke=n.recurringInstances.map(he=>he.id===J?ye:he);r({type:"SET_RECURRING_INSTANCES",payload:ke}),console.log("      (Firebase   )"),console.log(` Firestore   - instanceId: ${J}`),console.log("  :",me),console.log(`   : ${new Date().toISOString()}`),await Oe.updateRecurringInstance(J,me,i.uid),console.log("    Firebase  "),console.log(`   : ${new Date().toISOString()}`),q?.title.includes("")&&console.log("   :",ye.completed),J.includes("weekly_work_report")&&console.log(`  Firestore : completed=${me.completed}`),console.log(" Firestore   -   ")}catch(me){console.error(" Firebase  :",me),r({type:"SET_RECURRING_INSTANCES",payload:n.recurringInstances}),r({type:"SET_ERROR",payload:"      ."})}else{const me=n.recurringInstances.map(ke=>ke.id===J?ye:ke);r({type:"SET_RECURRING_INSTANCES",payload:me}),console.log("   - localStorage  ,  ")}console.log("     ");return}else{console.log("   .   :",J);const ye=J.split("_");if(ye.length>=2){const me=ye[0],ke=ye.slice(1).join("_"),he=n.recurringTemplates.find(we=>we.id===me);if(he){console.log("  :",he);const we={id:J,templateId:me,date:new Date(ke),completed:!0,completedAt:new Date,createdAt:new Date,updatedAt:new Date};if(i)try{console.log(` Firebase     : ${J}`),console.log("   :",we);const ze=[...n.recurringInstances,we];r({type:"SET_RECURRING_INSTANCES",payload:ze}),console.log("       "),await Oe.updateRecurringInstance(J,{templateId:we.templateId,date:we.date,completed:we.completed,completedAt:we.completedAt},i.uid),console.log("     Firebase  "),console.log("      -   ")}catch(ze){console.error("   Firebase  :",ze),r({type:"SET_RECURRING_INSTANCES",payload:n.recurringInstances}),r({type:"SET_ERROR",payload:"       ."})}else{const ze=[...n.recurringInstances,we];r({type:"SET_RECURRING_INSTANCES",payload:ze}),console.log("   - localStorage  ,  ")}console.log("     ");return}else console.error("    :",me)}else console.error("  ID  :",J);console.error("     :",J),console.log("   :",n.recurringInstances.map(me=>me.id)),console.log("   :",n.recurringTemplates.map(me=>me.id));return}}const se=n.todos.find(J=>J.id===j);if(!se){console.error("Todo not found:",j);return}const ne={completed:!se.completed,...se.completed?{completedAt:Um()}:{completedAt:new Date}};try{r({type:"TOGGLE_TODO",payload:j});const Se=[...n.todos,...oe()].find(me=>me.id===j),ye=j.startsWith("recurring_")||Se?._isRecurringInstance;i&&!ye?(await Oe.updateTodo(j,ne,i.uid),console.log("Firestore  :",j)):ye?(console.log("   :",j),ne.order!==void 0&&(console.log("  order :",j," order:",ne.order),r({type:"UPDATE_RECURRING_INSTANCE",payload:{id:j,updates:{order:ne.order}}}))):console.log(" :   "),console.log(`  : ${j} (: ${ye})`)}catch(J){console.error("  :",J),r({type:"TOGGLE_TODO",payload:j}),r({type:"SET_ERROR",payload:"     ."})}},ie=async(j,G)=>{const q={id:ju(),title:G,completed:!1,priority:"medium",createdAt:new Date,updatedAt:new Date};try{i?await Oe.addSubTask(q,i.uid,j):r({type:"ADD_SUBTASK",payload:{todoId:j,subTask:q}})}catch(Y){console.error("  :",Y),r({type:"SET_ERROR",payload:"     ."})}},be=async(j,G,q)=>{try{i?await Oe.updateSubTask(G,q,i.uid,j):r({type:"UPDATE_SUBTASK",payload:{todoId:j,subTaskId:G,updates:q}})}catch(Y){console.error("  :",Y),r({type:"SET_ERROR",payload:"     ."})}},Ee=async(j,G)=>{try{i?await Oe.deleteSubTask(G,i.uid,j):r({type:"DELETE_SUBTASK",payload:{todoId:j,subTaskId:G}})}catch(q){console.error("  :",q),r({type:"SET_ERROR",payload:"     ."})}},_e=async(j,G)=>{console.log("   :",{todoId:j,subTaskId:G});const Y=n.todos.find(J=>J.id===j)?.subTasks?.find(J=>J.id===G);if(!Y){console.error("    :",{todoId:j,subTaskId:G});return}const se=!Y.completed;console.log("  :",{:Y.completed,:se,:Y.completedAt});const ne={completed:se,completedAt:se?new Date:null};console.log("  :",ne),await be(j,G,ne)},ge=j=>{const G=new Map,q=[];j.forEach(se=>{const ne=se._isRecurringInstance||se.id.startsWith("recurring_"),J=se._templateId;ne&&J?(G.has(J)||G.set(J,[]),G.get(J).push(se)):q.push(se)});const Y=[];return G.forEach(se=>{const ne=se.filter(Se=>Se.completed);Y.push(...ne);const J=se.filter(Se=>!Se.completed);J.length>0&&(J.sort((Se,ye)=>{const me=Se.startDate?new Date(Se.startDate).getTime():0,ke=ye.startDate?new Date(ye.startDate).getTime():0;return me-ke}),Y.push(J[0]),J.length>1&&console.log(`  : ${J[0].title} (), ${J.length-1} `))}),[...q,...Y]},je=j=>{const G=j?new Date(j):new Date;G.setHours(0,0,0,0),console.log(" getTodayTodos ,  :",G.toDateString());const q=n.todos.filter(ye=>{if(console.log(`  : "${ye.title}"`),console.log(`  startDate: ${ye.startDate?new Date(ye.startDate).toDateString():"null"}`),console.log(`  dueDate: ${ye.dueDate?new Date(ye.dueDate).toDateString():"null"}`),console.log(`  completed: ${ye.completed}`),ye.completed){if(ye.completedAt){const he=new Date(ye.completedAt);if(he.setHours(0,0,0,0),he.getTime()===G.getTime())return!0}return ye.subTasks&&ye.subTasks.length>0&&ye.subTasks.some(we=>{if(we.completed&&we.completedAt&&we.completedAt!==null)try{const ze=new Date(we.completedAt);return ze.setHours(0,0,0,0),ze.getTime()===G.getTime()}catch{return!1}return!1})?(console.log(` "${ye.title}" -    `),!0):!1}const me=ye.startDate?new Date(ye.startDate):null,ke=ye.dueDate?new Date(ye.dueDate):null;if(me&&me.setHours(0,0,0,0),ke&&ke.setHours(0,0,0,0),console.log(`   startDate: ${me?me.toDateString():"null"}`),console.log(`   dueDate: ${ke?ke.toDateString():"null"}`),me&&ke){const he=G.getTime()>=me.getTime()&&G.getTime()<=ke.getTime();return console.log(`   : "${ye.title}"`),console.log(`  : ${me.toDateString()}, : ${ke.toDateString()}`),console.log(`  : ${G.toDateString()},   : ${he}`),he}return me&&!ke?G.getTime()>=me.getTime():!me&&ke?ke.getTime()>=G.getTime()?(console.log(`   : "${ye.title}" -  `),console.log(`  : ${ke.toDateString()}, : ${G.toDateString()}`),!0):(console.log(`   : "${ye.title}" -   `),!1):!ye.dueDate&&!ye.startDate}),se=oe().filter(ye=>{if(ye.startDate){const me=new Date(ye.startDate);if(me.setHours(0,0,0,0),me.getTime()===G.getTime())return!0;if(me.getTime()<G.getTime()&&!ye.completed)return console.log(`   : "${ye.title}" (${me.toLocaleDateString()})`),!0}return!1}),ne=new Set,Se=[...q,...se].filter(ye=>ne.has(ye.id)?(console.warn(`     : ${ye.id}`),!1):(ne.add(ye.id),!0));return ge(Se)},Ae=()=>{const j=new Date;j.setHours(0,0,0,0),console.log(" getWeekTodos ");const q=oe().filter(he=>he.title.includes(""));q.length>0&&console.log(" getWeekTodos - :",q[0]?.priority||"none");const Y=new Date(j);Y.setDate(j.getDate()-j.getDay()),Y.setHours(0,0,0,0);const se=new Date(Y);se.setDate(Y.getDate()+6),se.setHours(0,0,0,0);const ne=n.todos.filter(he=>{if(he.completed&&he.completedAt){const we=new Date(he.completedAt);return we.setHours(0,0,0,0),we>=Y&&we<=se}if(!he.completed){const we=he.startDate?new Date(he.startDate):null,ze=he.dueDate?new Date(he.dueDate):null;if(we&&we.setHours(0,0,0,0),ze&&ze.setHours(0,0,0,0),we&&ze)return ze.getTime()>=Y.getTime()&&we.getTime()<=se.getTime();if(we&&!ze)return we<=se;if(!we&&ze)return ze>=j;if(!we&&!ze)return!0}return!1}),Se=oe().filter(he=>{if(he.title.includes("")&&console.log(`  -  : completed=${he.completed}, completedAt=${he.completedAt}`),he.completed){if(he.completedAt){const qt=new Date(he.completedAt);qt.setHours(0,0,0,0);const ha=qt>=Y&&qt<=se;return he.title.includes("")&&console.log(`     : =${qt.toDateString()}, =${ha}`),ha}return he.title.includes("")&&console.log("     :   -  "),!1}const we=he.startDate?new Date(he.startDate):null,ze=he.dueDate?new Date(he.dueDate):null;if(we&&we.setHours(0,0,0,0),ze&&ze.setHours(0,0,0,0),we&&ze){const qt=ze.getTime()>=Y.getTime()&&we.getTime()<=se.getTime();return console.log(`     : "${he.title}"`),console.log(`   : ${we.toDateString()} ~ ${ze.toDateString()}`),console.log(`   : ${Y.toDateString()} ~ ${se.toDateString()}`),console.log(`   : ${qt}`),qt}return we&&!ze?we<=se:!we&&ze?ze>=Y:!we&&!ze}),ye=[...ne,...Se];console.log(" getWeekTodos    :",ye.filter(he=>he.title.includes("")).length);const me={urgent:0,high:1,medium:2,low:3},ke=ye.sort((he,we)=>{const ze=me[he.priority]-me[we.priority];if(ze!==0)return ze;const qt=he.order||0,ha=we.order||0;return qt!==ha?qt-ha:new Date(he.createdAt).getTime()-new Date(we.createdAt).getTime()});return console.log(" getWeekTodos   :",ke.filter(he=>he.title.includes("")).map(he=>`${he.title}: ${he.priority}`)),ge(ke)},P=()=>{const j=new Date;j.setHours(0,0,0,0),console.log(" getMonthTodos ");const G=new Date(j.getFullYear(),j.getMonth(),1);G.setHours(0,0,0,0);const q=new Date(j.getFullYear(),j.getMonth()+1,0);q.setHours(0,0,0,0);const Y=n.todos.filter(me=>{if(me.completed&&me.completedAt){const ke=new Date(me.completedAt);return ke.setHours(0,0,0,0),ke>=G&&ke<=q}if(!me.completed){const ke=me.startDate?new Date(me.startDate):null,he=me.dueDate?new Date(me.dueDate):null;if(ke&&ke.setHours(0,0,0,0),he&&he.setHours(0,0,0,0),ke&&he)return he.getTime()>=G.getTime()&&ke.getTime()<=q.getTime();if(ke&&!he)return ke<=q;if(!ke&&he)return he>=j;if(!ke&&!he)return!0}return!1}),ne=oe().filter(me=>{if(me.completed){if(me.completedAt){const we=new Date(me.completedAt);return we.setHours(0,0,0,0),we>=G&&we<=q}return!1}const ke=me.startDate?new Date(me.startDate):null,he=me.dueDate?new Date(me.dueDate):null;if(ke&&ke.setHours(0,0,0,0),he&&he.setHours(0,0,0,0),ke&&he){const we=he.getTime()>=G.getTime()&&ke.getTime()<=q.getTime();return console.log(`     : "${me.title}"`),console.log(`   : ${ke.toDateString()} ~ ${he.toDateString()}`),console.log(`   : ${G.toDateString()} ~ ${q.toDateString()}`),console.log(`   : ${we}`),we}return ke&&!he?ke<=q:!ke&&he?he>=G:!ke&&!he}),J=[...Y,...ne];console.log(" getMonthTodos    :",J.filter(me=>me.title.includes("")).length);const Se={urgent:0,high:1,medium:2,low:3},ye=J.sort((me,ke)=>{const he=Se[me.priority]-Se[ke.priority];if(he!==0)return he;const we=me.order||0,ze=ke.order||0;return we!==ze?we-ze:new Date(me.createdAt).getTime()-new Date(ke.createdAt).getTime()});return console.log(" getMonthTodos   :",ye.filter(me=>me.title.includes("")).map(me=>`${me.title}: ${me.priority}`)),ge(ye)},ce=()=>{const j=new Date;return j.setHours(0,0,0,0),n.todos.filter(G=>{if(!G.dueDate||G.completed)return!1;const q=new Date(G.dueDate);return q.setHours(0,0,0,0),q<j})},pe=j=>{const G=j||new Date,q=new Date(G);return q.setDate(q.getDate()+1),n.todos.filter(Y=>Y.dueDate?new Date(Y.dueDate).toDateString()===q.toDateString():!1)},R=j=>{const G=j||new Date,q=new Date(G);return q.setHours(0,0,0,0),n.todos.filter(Y=>{if(Y.completed||!Y.dueDate)return!1;const se=new Date(Y.dueDate);return se.setHours(0,0,0,0),se.getTime()<q.getTime()})},re=j=>{if(j.completed||!j.dueDate)return!1;const G=new Date;G.setHours(0,0,0,0);const q=new Date(j.dueDate);return q.setHours(0,0,0,0),q.getTime()<G.getTime()},C=async(j,G)=>{if(j.startsWith("recurring_")){const Y=j.replace("recurring_","");r({type:"UPDATE_RECURRING_INSTANCE",payload:{id:Y,updates:{order:G}}}),console.log("    ",{todoId:j,instanceId:Y,newOrder:G})}else if(r({type:"UPDATE_TODO",payload:{id:j,updates:{order:G,updatedAt:new Date}}}),i?.uid)try{await Oe.updateTodo(j,{order:G},i.uid),console.log("  Firestore  ",{todoId:j,newOrder:G})}catch(Y){console.error("  Firestore  :",Y)}},M=async(j,G,q)=>{const Y=Array.from(q),[se]=Y.splice(j,1);Y.splice(G,0,se);const ne=Y.map((J,Se)=>C(J.id,Se));try{await Promise.all(ne),console.log("    ",{count:ne.length})}catch(J){console.error("     :",J)}},Q=j=>{const G=[...n.todos,...oe()],q=new Date;return q.setHours(0,0,0,0),G.filter(Y=>{if(Y.startDate&&!j.completionDateFilter){const se=new Date(Y.startDate);if(se.setHours(0,0,0,0),se>q)return!1}if(j.searchTerm){const se=j.searchTerm.toLowerCase(),ne=Y.title.toLowerCase().includes(se),J=Y.description?.toLowerCase().includes(se)||!1,Se=Y.tags?.some(ye=>ye.toLowerCase().includes(se))||!1;if(!ne&&!J&&!Se)return!1}if(j.priorityFilter&&j.priorityFilter!=="all"&&Y.priority!==j.priorityFilter||j.typeFilter&&j.typeFilter!=="all"&&Y.type!==j.typeFilter||j.projectFilter&&j.projectFilter!=="all"&&Y.project!==j.projectFilter)return!1;if(j.tagFilter&&j.tagFilter.length>0){const se=Y.tags||[];if(!j.tagFilter.some(J=>se.includes(J)))return!1}if(j.completionDateFilter&&j.completionDateFilter!=="all"&&Y.completedAt){const se=new Date(Y.completedAt),ne=new Date;switch(j.completionDateFilter){case"today":if(se.toDateString()!==ne.toDateString())return!1;break;case"yesterday":const J=new Date;if(J.setDate(ne.getDate()-1),se.toDateString()!==J.toDateString())return!1;break;case"thisWeek":const Se=new Date(ne);if(Se.setDate(ne.getDate()-ne.getDay()),Se.setHours(0,0,0,0),se<Se)return!1;break;case"lastWeek":const ye=new Date(ne);ye.setDate(ne.getDate()-ne.getDay()-7),ye.setHours(0,0,0,0);const me=new Date(ne);if(me.setDate(ne.getDate()-ne.getDay()-1),me.setHours(23,59,59,999),se<ye||se>me)return!1;break;case"thisMonth":const ke=new Date(ne.getFullYear(),ne.getMonth(),1);if(se<ke)return!1;break}}return!(j.includeCompleted===!1&&Y.completed)})},xe=async j=>{console.log("===     ==="),console.log("currentUser:",i),console.log("templateData:",j);try{if(i){console.log("Firestore   ");const G=await Oe.addRecurringTemplate(j,i.uid);console.log("  Firestore  :",G),console.log("    -  useEffect  ")}else{console.log(" :    ");const G={...j,id:ju(),createdAt:new Date,updatedAt:new Date};r({type:"ADD_RECURRING_TEMPLATE",payload:G})}console.log("===     ===")}catch(G){console.error("   :",G),r({type:"SET_ERROR",payload:"     ."})}},X=async(j,G)=>{console.log("    "),console.log(" ID:",j),console.log(" :",G);try{if(i)console.log(" Firebase  -   ( useEffect  )"),console.log("1 Firestore   "),await Oe.updateRecurringTemplate(j,G,i.uid),console.log("   Firestore  :",j),console.log("2    "),r({type:"UPDATE_RECURRING_TEMPLATE",payload:{id:j,updates:G}}),console.log("     "),console.log("   useEffect  .");else{console.log(" :    ");const q=n.todos.filter(Y=>Y._templateId===j);console.log(` ${j}   ${q.length} `);for(const Y of q)console.log(` : ${Y.title} (${Y.id})`),r({type:"DELETE_TODO",payload:Y.id});r({type:"UPDATE_RECURRING_TEMPLATE",payload:{id:j,updates:G}}),setTimeout(()=>{console.log("     "),ee()},100)}console.log("===     ===")}catch(q){console.error("   :",q),r({type:"SET_ERROR",payload:"     ."})}},ue=async j=>{try{i?(r({type:"DELETE_RECURRING_TEMPLATE",payload:j}),console.log("  UI   :",j),await Oe.deleteRecurringTemplate(j,i.uid),console.log("   Firestore  :",j)):(console.log(" :    "),r({type:"DELETE_RECURRING_TEMPLATE",payload:j}),console.log("   - localStorage  ,  "))}catch(G){console.error("   :",G),r({type:"SET_ERROR",payload:"     ."})}},K=async()=>{if(!i)return;console.log("      (Deep Check)");const j={};n.recurringTemplates.forEach(q=>{const se=[q.title,q.recurrenceType,q.recurrenceType==="weekly"?q.weekday:"",q.recurrenceType==="monthly"?`${q.monthlyDate}-${q.monthlyPattern}-${q.monthlyWeek}-${q.monthlyWeekday}`:""].join("|");j[se]||(j[se]=[]),j[se].push(q)});const G=Object.values(j).filter(q=>q.length>1);if(G.length>0){console.log(` ${G.length}    `);for(const q of G){const Y=q.sort((J,Se)=>new Date(Se.createdAt).getTime()-new Date(J.createdAt).getTime()),se=Y[0],ne=Y.slice(1);console.log(` '${se.title}'  ${ne.length}  `);for(const J of ne)await ue(J.id)}console.log("   ")}else console.log("   .")};O.useEffect(()=>{if(n.recurringTemplates.length>0&&i){const j=setTimeout(()=>{K()},2e3);return()=>clearTimeout(j)}},[n.recurringTemplates,i]);const ee=()=>{if(i){console.log("   -     !");return}if(c){console.log("    -   ");return}let j=[];n.recurringTemplates.filter(G=>G.isActive).forEach(G=>{try{const q=cs.generateInstances(G);j=[...j,...q]}catch(q){console.error(` ${G.id}   :`,q)}}),r({type:"SET_RECURRING_INSTANCES",payload:j})},oe=()=>n.recurringTemplates.length===0||n.recurringInstances.length===0?[]:n.recurringInstances.filter(q=>!q.skipped).map(q=>{const Y=n.recurringTemplates.find(se=>se.id===q.templateId);return Y?cs.convertToTodo(q,Y):null}).filter(q=>q!==null),Ne=()=>{const j=n.todos.filter(J=>!J.completed&&(J.order===void 0||J.order===null)),G=oe().filter(J=>!J.completed&&(J.order===void 0||J.order===null)),q=[...j,...G];if(q.length===0)return;console.log(" Order   :",q.length,"");const Y={urgent:q.filter(J=>J.priority==="urgent"),high:q.filter(J=>J.priority==="high"),medium:q.filter(J=>J.priority==="medium"),low:q.filter(J=>J.priority==="low")},se=[],ne=[];Object.entries(Y).forEach(([J,Se],ye)=>{if(Se.length===0)return;const me=Se.sort((he,we)=>new Date(he.createdAt).getTime()-new Date(we.createdAt).getTime()),ke=ye*1e3;me.forEach((he,we)=>{const ze=ke+we*10;if(he._isRecurringInstance){console.log("  order :",he.title,"",ze);const qt=he._instanceId;ne.push(qt),r({type:"UPDATE_RECURRING_INSTANCE",payload:{id:qt,updates:{order:ze}}})}else se.push({...he,order:ze})})}),se.forEach(async J=>{try{i&&await Oe.updateTodo(J.id,{order:J.order},i.uid),r({type:"UPDATE_TODO",payload:{id:J.id,updates:{order:J.order}}})}catch(Se){console.error("Order   :",J.id,Se)}}),console.log(" Order  :",se.length,"  ,",ne.length," ")},de=async()=>{if(!i){console.log("   ");return}console.log(" Firestore   ..."),r({type:"SET_LOADING",payload:!0});try{const j=await Oe.getTodos(i.uid);console.log("   :",j.length," "),r({type:"SET_TODOS",payload:j}),r({type:"SET_ERROR",payload:null})}catch(j){console.error("   :",j),r({type:"SET_ERROR",payload:"  ."})}finally{r({type:"SET_LOADING",payload:!1})}},Le=async()=>{if(!i){console.log("   ");return}console.log("  : Firebase     ");try{console.log("1      ...");const j=await Oe.getRecurringInstances(i.uid);console.log(`  : ${j.length}`);for(const q of j)await Oe.deleteRecurringInstance(q.id,i.uid),console.log(`  : ${q.id}`);console.log("2    ...");const G=n.recurringTemplates.filter(q=>q.isActive);console.log(`  : ${G.length}`);for(const q of G){console.log(`  : ${q.title} (monthlyDate: ${q.monthlyDate})`);const Y=cs.generateInstances(q);console.log(` : ${Y.length}`);for(const se of Y){const ne={templateId:se.templateId,date:se.date,completed:!1,createdAt:se.createdAt,updatedAt:se.updatedAt},J=await Oe.addRecurringInstance(ne,i.uid);console.log(`  : ${J} - ${se.date.toDateString()}`)}}console.log("3    ..."),await de(),console.log("   !"),alert(`    !
 .`)}catch(j){console.error("   :",j),alert("    .")}},tt=async()=>{if(!i){console.log("   ");return}console.log("    (  )");try{const j=await Oe.getTodos(i.uid);console.log("   :",j.length," "),r({type:"SET_TODOS",payload:j})}catch(j){console.error("   :",j)}},st=O.useCallback(async()=>{if(!i?.uid){console.log("  ...");return}try{console.log("    ");const j=await Du.cleanupOrphanedInstances(i.uid);console.log("    :",j),alert(`  !
-  : ${j.orphanedInstances}
-  : ${j.orphanedTodos}
-  : ${j.totalCleaned}`),await de()}catch(j){console.error("    :",j),alert("    .")}},[i]),Xe=O.useCallback(async()=>{if(!i?.uid){console.log("  ...");return}try{console.log("    ");const j=await Du.validateTemplateConsistency(i.uid);console.log("     -  "),alert(`  !
 ${j.size}     .`)}catch(j){console.error("    :",j),alert("    .")}},[i]),Vt=O.useCallback(async()=>{if(!i?.uid){console.log("  ...");return}if(!window.confirm(`   :

 :    
 :    

   . ?`)){console.log("  ");return}try{console.log("   ");const G=await Du.smartCleanupInstances(i.uid);console.log("   :",G),alert(`   !

: ${G.deletedInstances}  
: ${G.keptInstances}  

   ! `),setTimeout(()=>{window.location.reload()},1e3)}catch(G){console.error("   :",G),alert("     .")}},[i]);O.useEffect(()=>{typeof window<"u"&&(window.fixRecurringInstances=Le,window.cleanupOrphanedData=st,window.validateDataConsistency=Xe,window.smartCleanupInstances=Vt,window.checkLoginStatus=()=>{console.log(" :",i?" ":"  "),i&&console.log(":",i.email)},window.forceRegenerateInstances=async()=>{if(!i?.uid){console.log("   ");return}console.log("     ...");try{await Promise.all(n.recurringTemplates.filter(j=>j.isActive!==!1).map(j=>Oe.regenerateRecurringInstances(j.id,i.uid))),console.log("   !  ."),setTimeout(()=>window.location.reload(),1e3)}catch(j){console.error("   :",j)}},window.fixBusinessTripTemplate=async()=>{if(!i?.uid){console.log("   ");return}try{console.log("      ...");const j=n.recurringTemplates.find(q=>q.title.includes("")&&q.title.includes("")&&q.title.includes(""));if(!j){console.log("       "),console.log("  :",n.recurringTemplates.map(q=>q.title));return}console.log("   :",j);const G={monthlyPattern:"weekday",monthlyWeek:"fourth",monthlyWeekday:2,monthlyDate:void 0};console.log("  :"),console.log("  0=, 1=, 2=, 3=, 4=, 5=, 6="),console.log(`   2 = ${["","","","","","",""][2]}`),console.log("  :",G),await Oe.updateRecurringTemplate(j.id,G,i.uid),console.log("      !"),console.log("   ..."),await Oe.regenerateRecurringInstances(j.id,i.uid),console.log("   !  ."),setTimeout(()=>window.location.reload(),1e3)}catch(j){console.error("   :",j)}},console.log("  - cleanupOrphanedData():   "))},[]);const Dt=O.useCallback(()=>{const j={todos:n.todos,recurringTemplates:n.recurringTemplates,recurringInstances:n.recurringInstances,exportedAt:new Date().toISOString(),version:"1.0.0"};return JSON.stringify(j,null,2)},[n]),sc=O.useCallback(async j=>{try{const G=JSON.parse(j);if(!G.todos)throw new Error("Invalid data format");const q=G.todos.map(Y=>({...Y,createdAt:new Date(Y.createdAt),updatedAt:new Date(Y.updatedAt),dueDate:Y.dueDate?new Date(Y.dueDate):void 0,startDate:Y.startDate?new Date(Y.startDate):void 0,completedAt:Y.completedAt?new Date(Y.completedAt):void 0}));return r(i?{type:"SET_TODOS",payload:q}:{type:"SET_TODOS",payload:q}),!0}catch(G){return console.error("Import failed:",G),!1}},[i]),Jl=O.useCallback(async()=>{const j=n.todos.filter(G=>G.completed);for(const G of j)await I(G.id)},[n.todos,I]),ei=O.useCallback(async()=>{await D()},[D]),_r=O.useMemo(()=>({total:n.todos.length,completed:n.todos.filter(j=>j.completed).length,pending:n.todos.filter(j=>!j.completed).length}),[n.todos]),lc=O.useMemo(()=>{const j=new Set;return n.todos.forEach(G=>{G.tags?.forEach(q=>j.add(q))}),Array.from(j).sort()},[n.todos]),ti={...n,addTodo:_,updateTodo:H,deleteTodo:I,toggleTodo:le,addSubTask:ie,updateSubTask:be,deleteSubTask:Ee,toggleSubTask:_e,syncWithFirestore:D,getTodayTodos:je,getWeekTodos:Ae,getMonthTodos:P,getOverdueTodos:ce,getTomorrowTodos:pe,getYesterdayIncompleteTodos:R,isYesterdayIncompleteTodo:re,updateTodoOrder:C,reorderTodos:M,getFilteredTodos:Q,addRecurringTemplate:xe,updateRecurringTemplate:X,deleteRecurringTemplate:ue,generateRecurringInstances:ee,getRecurringTodos:oe,cleanupDuplicateTemplates:K,forceRefresh:de,manualRefresh:tt,initializeOrderValues:Ne,fixRecurringInstances:Le,cleanupOrphanedData:st,validateDataConsistency:Xe,smartCleanupInstances:Vt,exportData:Dt,importData:sc,clearCompleted:Jl,syncWithCloud:ei,stats:_r,searchQuery:f,setSearchQuery:g,filterStatus:m,setFilterStatus:p,filterPriority:x,setFilterPriority:b,filterTags:w,setFilterTags:L,allTags:lc};return l.jsx(by.Provider,{value:ti,children:s})},Qt=()=>{const s=O.useContext(by);if(s===void 0)throw new Error("useTodos must be used within a TodoProvider");return s},vy=O.createContext(void 0),wy=()=>{const s=O.useContext(vy);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s},uk=({children:s})=>{const[n,r]=O.useState(()=>localStorage.getItem("theme")||"system"),[i,c]=O.useState(!1);return O.useEffect(()=>{const u=window.document.documentElement,f=()=>{u.classList.remove("dark");let g;n==="system"?g=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":g=n,g==="dark"&&u.classList.add("dark"),c(g==="dark")};if(f(),n==="system"){const g=window.matchMedia("(prefers-color-scheme: dark)"),m=()=>f();return g.addEventListener("change",m),()=>g.removeEventListener("change",m)}},[n]),O.useEffect(()=>{localStorage.setItem("theme",n)},[n]),l.jsx(vy.Provider,{value:{theme:n,setTheme:r,isDark:i},children:s})},hk=["lkd0115lkd@gmail.com"],$a=s=>s?hk.includes(s):!1;var Zm={};const Jm="@firebase/database",ep="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _y="";function fk(s){_y=s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{constructor(n){this.domStorage_=n,this.prefix_="firebase:"}set(n,r){r==null?this.domStorage_.removeItem(this.prefixedName_(n)):this.domStorage_.setItem(this.prefixedName_(n),Tt(r))}get(n){const r=this.domStorage_.getItem(this.prefixedName_(n));return r==null?null:rh(r)}remove(n){this.domStorage_.removeItem(this.prefixedName_(n))}prefixedName_(n){return this.prefix_+n}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(n,r){r==null?delete this.cache_[n]:this.cache_[n]=r}get(n){return da(this.cache_,n)?this.cache_[n]:null}remove(n){delete this.cache_[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ky=function(s){try{if(typeof window<"u"&&typeof window[s]<"u"){const n=window[s];return n.setItem("firebase:sentinel","cache"),n.removeItem("firebase:sentinel"),new gk(n)}}catch{}return new mk},mr=ky("localStorage"),pk=ky("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hs=new Gw("@firebase/database"),yk=function(){let s=1;return function(){return s++}}(),Ny=function(s){const n=Vw(s),r=new Ww;r.update(n);const i=r.digest();return Pw.encodeByteArray(i)},Wl=function(...s){let n="";for(let r=0;r<s.length;r++){const i=s[r];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?n+=Wl.apply(null,i):typeof i=="object"?n+=Tt(i):n+=i,n+=" "}return n};let El=null,tp=!0;const xk=function(s,n){fe(!0,"Can't turn on custom loggers persistently."),hs.logLevel=Qw.VERBOSE,El=hs.log.bind(hs)},Gt=function(...s){if(tp===!0&&(tp=!1,El===null&&pk.get("logging_enabled")===!0&&xk()),El){const n=Wl.apply(null,s);El(n)}},Pl=function(s){return function(...n){Gt(s,...n)}},Bu=function(...s){const n="FIREBASE INTERNAL ERROR: "+Wl(...s);hs.error(n)},ca=function(...s){const n=`FIREBASE FATAL ERROR: ${Wl(...s)}`;throw hs.error(n),new Error(n)},nn=function(...s){const n="FIREBASE WARNING: "+Wl(...s);hs.warn(n)},bk=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&nn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Ty=function(s){return typeof s=="number"&&(s!==s||s===Number.POSITIVE_INFINITY||s===Number.NEGATIVE_INFINITY)},vk=function(s){if(document.readyState==="complete")s();else{let n=!1;const r=function(){if(!document.body){setTimeout(r,Math.floor(10));return}n||(n=!0,s())};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&r()}),window.attachEvent("onload",r))}},ps="[MIN_NAME]",xr="[MAX_NAME]",vs=function(s,n){if(s===n)return 0;if(s===ps||n===xr)return-1;if(n===ps||s===xr)return 1;{const r=np(s),i=np(n);return r!==null?i!==null?r-i===0?s.length-n.length:r-i:-1:i!==null?1:s<n?-1:1}},wk=function(s,n){return s===n?0:s<n?-1:1},_l=function(s,n){if(n&&s in n)return n[s];throw new Error("Missing required key ("+s+") in object: "+Tt(n))},dh=function(s){if(typeof s!="object"||s===null)return Tt(s);const n=[];for(const i in s)n.push(i);n.sort();let r="{";for(let i=0;i<n.length;i++)i!==0&&(r+=","),r+=Tt(n[i]),r+=":",r+=dh(s[n[i]]);return r+="}",r},jy=function(s,n){const r=s.length;if(r<=n)return[s];const i=[];for(let c=0;c<r;c+=n)c+n>r?i.push(s.substring(c,r)):i.push(s.substring(c,c+n));return i};function rn(s,n){for(const r in s)s.hasOwnProperty(r)&&n(r,s[r])}const Sy=function(s){fe(!Ty(s),"Invalid JSON number");const n=11,r=52,i=(1<<n-1)-1;let c,u,f,g,m;s===0?(u=0,f=0,c=1/s===-1/0?1:0):(c=s<0,s=Math.abs(s),s>=Math.pow(2,1-i)?(g=Math.min(Math.floor(Math.log(s)/Math.LN2),i),u=g+i,f=Math.round(s*Math.pow(2,r-g)-Math.pow(2,r))):(u=0,f=Math.round(s/Math.pow(2,1-i-r))));const p=[];for(m=r;m;m-=1)p.push(f%2?1:0),f=Math.floor(f/2);for(m=n;m;m-=1)p.push(u%2?1:0),u=Math.floor(u/2);p.push(c?1:0),p.reverse();const x=p.join("");let b="";for(m=0;m<64;m+=8){let w=parseInt(x.substr(m,8),2).toString(16);w.length===1&&(w="0"+w),b=b+w}return b.toLowerCase()},_k=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},kk=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function Nk(s,n){let r="Unknown Error";s==="too_big"?r="The data requested exceeds the maximum size that can be accessed with a single request.":s==="permission_denied"?r="Client doesn't have permission to access the desired data.":s==="unavailable"&&(r="The service is unavailable");const i=new Error(s+" at "+n._path.toString()+": "+r);return i.code=s.toUpperCase(),i}const Tk=new RegExp("^-?(0*)\\d{1,10}$"),jk=-2147483648,Sk=2147483647,np=function(s){if(Tk.test(s)){const n=Number(s);if(n>=jk&&n<=Sk)return n}return null},ws=function(s){try{s()}catch(n){setTimeout(()=>{const r=n.stack||"";throw nn("Exception was thrown by user callback.",r),n},Math.floor(0))}},Dk=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Cl=function(s,n){const r=setTimeout(s,n);return typeof r=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(r):typeof r=="object"&&r.unref&&r.unref(),r};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ek{constructor(n,r){this.appCheckProvider=r,this.appName=n.name,Pp(n)&&n.settings.appCheckToken&&(this.serverAppAppCheckToken=n.settings.appCheckToken),this.appCheck=r?.getImmediate({optional:!0}),this.appCheck||r?.get().then(i=>this.appCheck=i)}getToken(n){if(this.serverAppAppCheckToken){if(n)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(n):new Promise((r,i)=>{setTimeout(()=>{this.appCheck?this.getToken(n).then(r,i):r(null)},0)})}addTokenChangeListener(n){this.appCheckProvider?.get().then(r=>r.addTokenListener(n))}notifyForInvalidToken(){nn(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck{constructor(n,r,i){this.appName_=n,this.firebaseOptions_=r,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(c=>this.auth_=c)}getToken(n){return this.auth_?this.auth_.getToken(n).catch(r=>r&&r.code==="auth/token-not-initialized"?(Gt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(r)):new Promise((r,i)=>{setTimeout(()=>{this.auth_?this.getToken(n).then(r,i):r(null)},0)})}addTokenChangeListener(n){this.auth_?this.auth_.addAuthTokenListener(n):this.authProvider_.get().then(r=>r.addAuthTokenListener(n))}removeTokenChangeListener(n){this.authProvider_.get().then(r=>r.removeAuthTokenListener(n))}notifyForInvalidToken(){let n='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?n+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?n+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':n+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',nn(n)}}class vo{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}vo.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uh="5",Dy="v",Ey="s",Cy="r",Ay="f",Ry=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Oy="ls",My="p",qu="ac",Iy="websocket",Uy="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly{constructor(n,r,i,c,u=!1,f="",g=!1,m=!1,p=null){this.secure=r,this.namespace=i,this.webSocketOnly=c,this.nodeAdmin=u,this.persistenceKey=f,this.includeNamespaceInQueryParams=g,this.isUsingEmulator=m,this.emulatorOptions=p,this._host=n.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=mr.get("host:"+n)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(n){n!==this.internalHost&&(this.internalHost=n,this.isCacheableHost()&&mr.set("host:"+this._host,this.internalHost))}toString(){let n=this.toURLString();return this.persistenceKey&&(n+="<"+this.persistenceKey+">"),n}toURLString(){const n=this.secure?"https://":"http://",r=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${n}${this.host}/${r}`}}function Ak(s){return s.host!==s.internalHost||s.isCustomHost()||s.includeNamespaceInQueryParams}function zy(s,n,r){fe(typeof n=="string","typeof type must == string"),fe(typeof r=="object","typeof params must == object");let i;if(n===Iy)i=(s.secure?"wss://":"ws://")+s.internalHost+"/.ws?";else if(n===Uy)i=(s.secure?"https://":"http://")+s.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+n);Ak(s)&&(r.ns=s.namespace);const c=[];return rn(r,(u,f)=>{c.push(u+"="+f)}),i+c.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rk{constructor(){this.counters_={}}incrementCounter(n,r=1){da(this.counters_,n)||(this.counters_[n]=0),this.counters_[n]+=r}get(){return e_(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eu={},Cu={};function hh(s){const n=s.toString();return Eu[n]||(Eu[n]=new Rk),Eu[n]}function Ok(s,n){const r=s.toString();return Cu[r]||(Cu[r]=n()),Cu[r]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{constructor(n){this.onMessage_=n,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(n,r){this.closeAfterResponse=n,this.onClose=r,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(n,r){for(this.pendingResponses[n]=r;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let c=0;c<i.length;++c)i[c]&&ws(()=>{this.onMessage_(i[c])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ap="start",Ik="close",Uk="pLPCommand",Lk="pRTLPCB",Hy="id",$y="pw",By="ser",zk="cb",Hk="seg",$k="ts",Bk="d",qk="dframe",qy=1870,Yy=30,Yk=qy-Yy,Fk=25e3,Gk=3e4;class us{constructor(n,r,i,c,u,f,g){this.connId=n,this.repoInfo=r,this.applicationId=i,this.appCheckToken=c,this.authToken=u,this.transportSessionId=f,this.lastSessionId=g,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Pl(n),this.stats_=hh(r),this.urlFn=m=>(this.appCheckToken&&(m[qu]=this.appCheckToken),zy(r,Uy,m))}open(n,r){this.curSegmentNum=0,this.onDisconnect_=r,this.myPacketOrderer=new Mk(n),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Gk)),vk(()=>{if(this.isClosed_)return;this.scriptTagHolder=new fh((...u)=>{const[f,g,m,p,x]=u;if(this.incrementIncomingBytes_(u),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,f===ap)this.id=g,this.password=m;else if(f===Ik)g?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(g,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+f)},(...u)=>{const[f,g]=u;this.incrementIncomingBytes_(u),this.myPacketOrderer.handleResponse(f,g)},()=>{this.onClosed_()},this.urlFn);const i={};i[ap]="t",i[By]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[zk]=this.scriptTagHolder.uniqueCallbackIdentifier),i[Dy]=uh,this.transportSessionId&&(i[Ey]=this.transportSessionId),this.lastSessionId&&(i[Oy]=this.lastSessionId),this.applicationId&&(i[My]=this.applicationId),this.appCheckToken&&(i[qu]=this.appCheckToken),typeof location<"u"&&location.hostname&&Ry.test(location.hostname)&&(i[Cy]=Ay);const c=this.urlFn(i);this.log_("Connecting via long-poll to "+c),this.scriptTagHolder.addTag(c,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){us.forceAllow_=!0}static forceDisallow(){us.forceDisallow_=!0}static isAvailable(){return us.forceAllow_?!0:!us.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!_k()&&!kk()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(n){const r=Tt(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=t_(r),c=jy(i,Yk);for(let u=0;u<c.length;u++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,c.length,c[u]),this.curSegmentNum++}addDisconnectPingFrame(n,r){this.myDisconnFrame=document.createElement("iframe");const i={};i[qk]="t",i[Hy]=n,i[$y]=r,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(n){const r=Tt(n).length;this.bytesReceived+=r,this.stats_.incrementCounter("bytes_received",r)}}class fh{constructor(n,r,i,c){this.onDisconnect=i,this.urlFn=c,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=yk(),window[Uk+this.uniqueCallbackIdentifier]=n,window[Lk+this.uniqueCallbackIdentifier]=r,this.myIFrame=fh.createIFrame_();let u="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(u='<script>document.domain="'+document.domain+'";<\/script>');const f="<html><body>"+u+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(f),this.myIFrame.doc.close()}catch(g){Gt("frame writing exception"),g.stack&&Gt(g.stack),Gt(g)}}}static createIFrame_(){const n=document.createElement("iframe");if(n.style.display="none",document.body){document.body.appendChild(n);try{n.contentWindow.document||Gt("No IE domain setting required")}catch{const i=document.domain;n.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return n.contentDocument?n.doc=n.contentDocument:n.contentWindow?n.doc=n.contentWindow.document:n.document&&(n.doc=n.document),n}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const n=this.onDisconnect;n&&(this.onDisconnect=null,n())}startLongPoll(n,r){for(this.myID=n,this.myPW=r,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const n={};n[Hy]=this.myID,n[$y]=this.myPW,n[By]=this.currentSerial;let r=this.urlFn(n),i="",c=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Yy+i.length<=qy;){const f=this.pendingSegs.shift();i=i+"&"+Hk+c+"="+f.seg+"&"+$k+c+"="+f.ts+"&"+Bk+c+"="+f.d,c++}return r=r+i,this.addLongPollTag_(r,this.currentSerial),!0}else return!1}enqueueSegment(n,r,i){this.pendingSegs.push({seg:n,ts:r,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(n,r){this.outstandingRequests.add(r);const i=()=>{this.outstandingRequests.delete(r),this.newRequest_()},c=setTimeout(i,Math.floor(Fk)),u=()=>{clearTimeout(c),i()};this.addTag(n,u)}addTag(n,r){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=n,i.onload=i.onreadystatechange=function(){const c=i.readyState;(!c||c==="loaded"||c==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),r())},i.onerror=()=>{Gt("Long-poll script failed to load: "+n),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vk=16384,Wk=45e3;let Co=null;typeof MozWebSocket<"u"?Co=MozWebSocket:typeof WebSocket<"u"&&(Co=WebSocket);class En{constructor(n,r,i,c,u,f,g){this.connId=n,this.applicationId=i,this.appCheckToken=c,this.authToken=u,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Pl(this.connId),this.stats_=hh(r),this.connURL=En.connectionURL_(r,f,g,c,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,c,u){const f={};return f[Dy]=uh,typeof location<"u"&&location.hostname&&Ry.test(location.hostname)&&(f[Cy]=Ay),r&&(f[Ey]=r),i&&(f[Oy]=i),c&&(f[qu]=c),u&&(f[My]=u),zy(n,Iy,f)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,mr.set("previous_websocket_failure",!0);try{let i;n_(),this.mySock=new Co(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const c=i.message||i.data;c&&this.log_(c),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const c=i.message||i.data;c&&this.log_(c),this.onClosed_()}}start(){}static forceDisallow(){En.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){const r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&Co!==null&&!En.forceDisallow_}static previouslyFailed(){return mr.isInMemoryStorage||mr.get("previous_websocket_failure")===!0}markConnectionHealthy(){mr.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=rh(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(fe(this.frames===null,"We already have a frame buffer"),n.length<=6){const r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;const r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();const r=Tt(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=jy(r,Vk);i.length>1&&this.sendString_(String(i.length));for(let c=0;c<i.length;c++)this.sendString_(i[c])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Wk))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}En.responsesRequiredToBeHealthy=2;En.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul{static get ALL_TRANSPORTS(){return[us,En]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(n){this.initTransports_(n)}initTransports_(n){const r=En&&En.isAvailable();let i=r&&!En.previouslyFailed();if(n.webSocketOnly&&(r||nn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[En];else{const c=this.transports_=[];for(const u of Ul.ALL_TRANSPORTS)u&&u.isAvailable()&&c.push(u);Ul.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Ul.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pk=6e4,Qk=5e3,Xk=10*1024,Kk=100*1024,Au="t",rp="d",Zk="s",sp="r",Jk="e",lp="o",ip="a",op="n",cp="p",eN="h";class tN{constructor(n,r,i,c,u,f,g,m,p,x){this.id=n,this.repoInfo_=r,this.applicationId_=i,this.appCheckToken_=c,this.authToken_=u,this.onMessage_=f,this.onReady_=g,this.onDisconnect_=m,this.onKill_=p,this.lastSessionId=x,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Pl("c:"+this.id+":"),this.transportManager_=new Ul(r),this.log_("Connection created"),this.start_()}start_(){const n=this.transportManager_.initialTransport();this.conn_=new n(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=n.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(r,i)},Math.floor(0));const c=n.healthyTimeout||0;c>0&&(this.healthyTimeout_=Cl(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Kk?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Xk?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(c)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(n){return r=>{n===this.conn_?this.onConnectionLost_(r):n===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(n){return r=>{this.state_!==2&&(n===this.rx_?this.onPrimaryMessageReceived_(r):n===this.secondaryConn_?this.onSecondaryMessageReceived_(r):this.log_("message on old connection"))}}sendRequest(n){const r={t:"d",d:n};this.sendData_(r)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(n){if(Au in n){const r=n[Au];r===ip?this.upgradeIfSecondaryHealthy_():r===sp?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):r===lp&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(n){const r=_l("t",n),i=_l("d",n);if(r==="c")this.onSecondaryControl_(i);else if(r==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+r)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:cp,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:ip,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:op,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(n){const r=_l("t",n),i=_l("d",n);r==="c"?this.onControl_(i):r==="d"&&this.onDataMessage_(i)}onDataMessage_(n){this.onPrimaryResponse_(),this.onMessage_(n)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(n){const r=_l(Au,n);if(rp in n){const i=n[rp];if(r===eN){const c={...i};this.repoInfo_.isUsingEmulator&&(c.h=this.repoInfo_.host),this.onHandshake_(c)}else if(r===op){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let c=0;c<this.pendingDataMessages.length;++c)this.onDataMessage_(this.pendingDataMessages[c]);this.pendingDataMessages=[],this.tryCleanupConnection()}else r===Zk?this.onConnectionShutdown_(i):r===sp?this.onReset_(i):r===Jk?Bu("Server Error: "+i):r===lp?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Bu("Unknown control packet command: "+r)}}onHandshake_(n){const r=n.ts,i=n.v,c=n.h;this.sessionId=n.s,this.repoInfo_.host=c,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,r),uh!==i&&nn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const n=this.transportManager_.upgradeTransport();n&&this.startUpgrade_(n)}startUpgrade_(n){this.secondaryConn_=new n(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=n.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(r,i),Cl(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Pk))}onReset_(n){this.log_("Reset packet received.  New host: "+n),this.repoInfo_.host=n,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(n,r){this.log_("Realtime connection established."),this.conn_=n,this.state_=1,this.onReady_&&(this.onReady_(r,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Cl(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Qk))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:cp,d:{}}}))}onSecondaryConnectionLost_(){const n=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===n||this.rx_===n)&&this.close()}onConnectionLost_(n){this.conn_=null,!n&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(mr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(n){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(n),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(n){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(n)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{put(n,r,i,c){}merge(n,r,i,c){}refreshAuthToken(n){}refreshAppCheckToken(n){}onDisconnectPut(n,r,i){}onDisconnectMerge(n,r,i){}onDisconnectCancel(n,r){}reportStats(n){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gy{constructor(n){this.allowedEvents_=n,this.listeners_={},fe(Array.isArray(n)&&n.length>0,"Requires a non-empty array")}trigger(n,...r){if(Array.isArray(this.listeners_[n])){const i=[...this.listeners_[n]];for(let c=0;c<i.length;c++)i[c].callback.apply(i[c].context,r)}}on(n,r,i){this.validateEventType_(n),this.listeners_[n]=this.listeners_[n]||[],this.listeners_[n].push({callback:r,context:i});const c=this.getInitialEvent(n);c&&r.apply(i,c)}off(n,r,i){this.validateEventType_(n);const c=this.listeners_[n]||[];for(let u=0;u<c.length;u++)if(c[u].callback===r&&(!i||i===c[u].context)){c.splice(u,1);return}}validateEventType_(n){fe(this.allowedEvents_.find(r=>r===n),"Unknown event: "+n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao extends Gy{static getInstance(){return new Ao}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!ay()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(n){return fe(n==="online","Unknown event type: "+n),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dp=32,up=768;class it{constructor(n,r){if(r===void 0){this.pieces_=n.split("/");let i=0;for(let c=0;c<this.pieces_.length;c++)this.pieces_[c].length>0&&(this.pieces_[i]=this.pieces_[c],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=n,this.pieceNum_=r}toString(){let n="";for(let r=this.pieceNum_;r<this.pieces_.length;r++)this.pieces_[r]!==""&&(n+="/"+this.pieces_[r]);return n||"/"}}function Pe(){return new it("")}function Be(s){return s.pieceNum_>=s.pieces_.length?null:s.pieces_[s.pieceNum_]}function Ya(s){return s.pieces_.length-s.pieceNum_}function ct(s){let n=s.pieceNum_;return n<s.pieces_.length&&n++,new it(s.pieces_,n)}function Vy(s){return s.pieceNum_<s.pieces_.length?s.pieces_[s.pieces_.length-1]:null}function nN(s){let n="";for(let r=s.pieceNum_;r<s.pieces_.length;r++)s.pieces_[r]!==""&&(n+="/"+encodeURIComponent(String(s.pieces_[r])));return n||"/"}function Wy(s,n=0){return s.pieces_.slice(s.pieceNum_+n)}function Py(s){if(s.pieceNum_>=s.pieces_.length)return null;const n=[];for(let r=s.pieceNum_;r<s.pieces_.length-1;r++)n.push(s.pieces_[r]);return new it(n,0)}function jt(s,n){const r=[];for(let i=s.pieceNum_;i<s.pieces_.length;i++)r.push(s.pieces_[i]);if(n instanceof it)for(let i=n.pieceNum_;i<n.pieces_.length;i++)r.push(n.pieces_[i]);else{const i=n.split("/");for(let c=0;c<i.length;c++)i[c].length>0&&r.push(i[c])}return new it(r,0)}function Ge(s){return s.pieceNum_>=s.pieces_.length}function Pt(s,n){const r=Be(s),i=Be(n);if(r===null)return n;if(r===i)return Pt(ct(s),ct(n));throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+s+")")}function gh(s,n){if(Ya(s)!==Ya(n))return!1;for(let r=s.pieceNum_,i=n.pieceNum_;r<=s.pieces_.length;r++,i++)if(s.pieces_[r]!==n.pieces_[i])return!1;return!0}function An(s,n){let r=s.pieceNum_,i=n.pieceNum_;if(Ya(s)>Ya(n))return!1;for(;r<s.pieces_.length;){if(s.pieces_[r]!==n.pieces_[i])return!1;++r,++i}return!0}class aN{constructor(n,r){this.errorPrefix_=r,this.parts_=Wy(n,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=Go(this.parts_[i]);Qy(this)}}function rN(s,n){s.parts_.length>0&&(s.byteLength_+=1),s.parts_.push(n),s.byteLength_+=Go(n),Qy(s)}function sN(s){const n=s.parts_.pop();s.byteLength_-=Go(n),s.parts_.length>0&&(s.byteLength_-=1)}function Qy(s){if(s.byteLength_>up)throw new Error(s.errorPrefix_+"has a key path longer than "+up+" bytes ("+s.byteLength_+").");if(s.parts_.length>dp)throw new Error(s.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+dp+") or object contains a cycle "+hr(s))}function hr(s){return s.parts_.length===0?"":"in property '"+s.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh extends Gy{static getInstance(){return new mh}constructor(){super(["visible"]);let n,r;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(r="visibilitychange",n="hidden"):typeof document.mozHidden<"u"?(r="mozvisibilitychange",n="mozHidden"):typeof document.msHidden<"u"?(r="msvisibilitychange",n="msHidden"):typeof document.webkitHidden<"u"&&(r="webkitvisibilitychange",n="webkitHidden")),this.visible_=!0,r&&document.addEventListener(r,()=>{const i=!document[n];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}getInitialEvent(n){return fe(n==="visible","Unknown event type: "+n),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kl=1e3,lN=300*1e3,hp=30*1e3,iN=1.3,oN=3e4,cN="server_kill",fp=3;class oa extends Fy{constructor(n,r,i,c,u,f,g,m){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=c,this.onServerInfoUpdate_=u,this.authTokenProvider_=f,this.appCheckTokenProvider_=g,this.authOverride_=m,this.id=oa.nextPersistentConnectionId_++,this.log_=Pl("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=kl,this.maxReconnectDelay_=lN,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,m)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");mh.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&Ao.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){const c=++this.requestNumber_,u={r:c,a:n,b:r};this.log_(Tt(u)),fe(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(u),i&&(this.requestCBHash_[c]=i)}get(n){this.initConnection_();const r=new lh,c={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:f=>{const g=f.d;f.s==="ok"?r.resolve(g):r.reject(g)}};this.outstandingGets_.push(c),this.outstandingGetCount_++;const u=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(u),r.promise}listen(n,r,i,c){this.initConnection_();const u=n._queryIdentifier,f=n._path.toString();this.log_("Listen called for "+f+" "+u),this.listens.has(f)||this.listens.set(f,new Map),fe(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),fe(!this.listens.get(f).has(u),"listen() called twice for same path/queryId.");const g={onComplete:c,hashFn:r,query:n,tag:i};this.listens.get(f).set(u,g),this.connected_&&this.sendListen_(g)}sendGet_(n){const r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){const r=n.query,i=r._path.toString(),c=r._queryIdentifier;this.log_("Listen on "+i+" for "+c);const u={p:i},f="q";n.tag&&(u.q=r._queryObject,u.t=n.tag),u.h=n.hashFn(),this.sendRequest(f,u,g=>{const m=g.d,p=g.s;oa.warnOnListenWarnings_(m,r),(this.listens.get(i)&&this.listens.get(i).get(c))===n&&(this.log_("listen response",g),p!=="ok"&&this.removeListen_(i,c),n.onComplete&&n.onComplete(p,m))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&da(n,"w")){const i=ms(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const c='".indexOn": "'+r._queryParams.getIndex().toString()+'"',u=r._path.toString();nn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${c} at ${u} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||Kw(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=hp)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const n=this.authToken_,r=Zw(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,c=>{const u=c.s,f=c.d||"error";this.authToken_===n&&(u==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(u,f))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{const r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){const i=n._path.toString(),c=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+c),fe(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,c)&&this.connected_&&this.sendUnlisten_(i,c,n._queryObject,r)}sendUnlisten_(n,r,i,c){this.log_("Unlisten on "+n+" for "+r);const u={p:n},f="n";c&&(u.q=i,u.t=c),this.sendRequest(f,u)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,c){const u={p:r,d:i};this.log_("onDisconnect "+n,u),this.sendRequest(n,u,f=>{c&&setTimeout(()=>{c(f.s,f.d)},Math.floor(0))})}put(n,r,i,c){this.putInternal("p",n,r,i,c)}merge(n,r,i,c){this.putInternal("m",n,r,i,c)}putInternal(n,r,i,c,u){this.initConnection_();const f={p:r,d:i};u!==void 0&&(f.h=u),this.outstandingPuts_.push({action:n,request:f,onComplete:c}),this.outstandingPutCount_++;const g=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(g):this.log_("Buffering put: "+r)}sendPut_(n){const r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,c=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,u=>{this.log_(r+" response",u),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),c&&c(u.s,u.d)})}reportStats(n){if(this.connected_){const r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){const u=i.d;this.log_("reportStats","Error sending stats: "+u)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+Tt(n));const r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):Bu("Unrecognized action received from server: "+Tt(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){fe(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=kl,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=kl,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>oN&&(this.reconnectDelay_=kl),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const n=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*iN)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),c=this.id+":"+oa.nextConnectionId_++,u=this.lastSessionId;let f=!1,g=null;const m=function(){g?g.close():(f=!0,i())},p=function(b){fe(g,"sendRequest call when we're not connected not allowed."),g.sendRequest(b)};this.realtime_={close:m,sendRequest:p};const x=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[b,w]=await Promise.all([this.authTokenProvider_.getToken(x),this.appCheckTokenProvider_.getToken(x)]);f?Gt("getToken() completed but was canceled"):(Gt("getToken() completed. Creating connection."),this.authToken_=b&&b.accessToken,this.appCheckToken_=w&&w.token,g=new tN(c,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,L=>{nn(L+" ("+this.repoInfo_.toString()+")"),this.interrupt(cN)},u))}catch(b){this.log_("Failed to get token: "+b),f||(this.repoInfo_.nodeAdmin&&nn(b),m())}}}interrupt(n){Gt("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){Gt("Resuming connection for reason: "+n),delete this.interruptReasons_[n],Lm(this.interruptReasons_)&&(this.reconnectDelay_=kl,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){const r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){const r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(u=>dh(u)).join("$"):i="default";const c=this.removeListen_(n,i);c&&c.onComplete&&c.onComplete("permission_denied")}removeListen_(n,r){const i=new it(n).toString();let c;if(this.listens.has(i)){const u=this.listens.get(i);c=u.get(r),u.delete(r),u.size===0&&this.listens.delete(i)}else c=void 0;return c}onAuthRevoked_(n,r){Gt("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=fp&&(this.reconnectDelay_=hp,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){Gt("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=fp&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const n of this.listens.values())for(const r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){const n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){const n={};let r="js";n["sdk."+r+"."+_y.replace(/\./g,"-")]=1,ay()?n["framework.cordova"]=1:Jw()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){const n=Ao.getInstance().currentlyOnline();return Lm(this.interruptReasons_)&&n}}oa.nextPersistentConnectionId_=0;oa.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(n,r){this.name=n,this.node=r}static Wrap(n,r){return new qe(n,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{getCompare(){return this.compare.bind(this)}indexedValueChanged(n,r){const i=new qe(ps,n),c=new qe(ps,r);return this.compare(i,c)!==0}minPost(){return qe.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yo;class Xy extends Po{static get __EMPTY_NODE(){return yo}static set __EMPTY_NODE(n){yo=n}compare(n,r){return vs(n.name,r.name)}isDefinedOn(n){throw Vl("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(n,r){return!1}minPost(){return qe.MIN}maxPost(){return new qe(xr,yo)}makePost(n,r){return fe(typeof n=="string","KeyIndex indexValue must always be a string."),new qe(n,yo)}toString(){return".key"}}const fs=new Xy;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(n,r,i,c,u=null){this.isReverse_=c,this.resultGenerator_=u,this.nodeStack_=[];let f=1;for(;!n.isEmpty();)if(n=n,f=r?i(n.key,r):1,c&&(f*=-1),f<0)this.isReverse_?n=n.left:n=n.right;else if(f===0){this.nodeStack_.push(n);break}else this.nodeStack_.push(n),this.isReverse_?n=n.right:n=n.left}getNext(){if(this.nodeStack_.length===0)return null;let n=this.nodeStack_.pop(),r;if(this.resultGenerator_?r=this.resultGenerator_(n.key,n.value):r={key:n.key,value:n.value},this.isReverse_)for(n=n.left;!n.isEmpty();)this.nodeStack_.push(n),n=n.right;else for(n=n.right;!n.isEmpty();)this.nodeStack_.push(n),n=n.left;return r}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const n=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(n.key,n.value):{key:n.key,value:n.value}}}class It{constructor(n,r,i,c,u){this.key=n,this.value=r,this.color=i??It.RED,this.left=c??tn.EMPTY_NODE,this.right=u??tn.EMPTY_NODE}copy(n,r,i,c,u){return new It(n??this.key,r??this.value,i??this.color,c??this.left,u??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let c=this;const u=i(n,c.key);return u<0?c=c.copy(null,null,null,c.left.insert(n,r,i),null):u===0?c=c.copy(null,r,null,null,null):c=c.copy(null,null,null,null,c.right.insert(n,r,i)),c.fixUp_()}removeMin_(){if(this.left.isEmpty())return tn.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,c;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return tn.EMPTY_NODE;c=i.right.min_(),i=i.copy(c.key,c.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){const n=this.copy(null,null,It.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){const n=this.copy(null,null,It.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){const n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){const n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}It.RED=!0;It.BLACK=!1;class dN{copy(n,r,i,c,u){return this}insert(n,r,i){return new It(n,r,null)}remove(n,r){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class tn{constructor(n,r=tn.EMPTY_NODE){this.comparator_=n,this.root_=r}insert(n,r){return new tn(this.comparator_,this.root_.insert(n,r,this.comparator_).copy(null,null,It.BLACK,null,null))}remove(n){return new tn(this.comparator_,this.root_.remove(n,this.comparator_).copy(null,null,It.BLACK,null,null))}get(n){let r,i=this.root_;for(;!i.isEmpty();){if(r=this.comparator_(n,i.key),r===0)return i.value;r<0?i=i.left:r>0&&(i=i.right)}return null}getPredecessorKey(n){let r,i=this.root_,c=null;for(;!i.isEmpty();)if(r=this.comparator_(n,i.key),r===0){if(i.left.isEmpty())return c?c.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else r<0?i=i.left:r>0&&(c=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(n){return this.root_.inorderTraversal(n)}reverseTraversal(n){return this.root_.reverseTraversal(n)}getIterator(n){return new xo(this.root_,null,this.comparator_,!1,n)}getIteratorFrom(n,r){return new xo(this.root_,n,this.comparator_,!1,r)}getReverseIteratorFrom(n,r){return new xo(this.root_,n,this.comparator_,!0,r)}getReverseIterator(n){return new xo(this.root_,null,this.comparator_,!0,n)}}tn.EMPTY_NODE=new dN;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uN(s,n){return vs(s.name,n.name)}function ph(s,n){return vs(s,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yu;function hN(s){Yu=s}const Ky=function(s){return typeof s=="number"?"number:"+Sy(s):"string:"+s},Zy=function(s){if(s.isLeafNode()){const n=s.val();fe(typeof n=="string"||typeof n=="number"||typeof n=="object"&&da(n,".sv"),"Priority must be a string or number.")}else fe(s===Yu||s.isEmpty(),"priority of unexpected type.");fe(s===Yu||s.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gp;class Ot{static set __childrenNodeConstructor(n){gp=n}static get __childrenNodeConstructor(){return gp}constructor(n,r=Ot.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,fe(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Zy(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new Ot(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:Ot.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return Ge(n)?this:Be(n)===".priority"?this.priorityNode_:Ot.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:Ot.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){const i=Be(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(fe(i!==".priority"||Ya(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,Ot.__childrenNodeConstructor.EMPTY_NODE.updateChild(ct(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+Ky(this.priorityNode_.val())+":");const r=typeof this.value_;n+=r+":",r==="number"?n+=Sy(this.value_):n+=this.value_,this.lazyHash_=Ny(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===Ot.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof Ot.__childrenNodeConstructor?-1:(fe(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){const r=typeof n.value_,i=typeof this.value_,c=Ot.VALUE_TYPE_ORDER.indexOf(r),u=Ot.VALUE_TYPE_ORDER.indexOf(i);return fe(c>=0,"Unknown leaf type: "+r),fe(u>=0,"Unknown leaf type: "+i),c===u?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:u-c}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){const r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}Ot.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jy,ex;function fN(s){Jy=s}function gN(s){ex=s}class mN extends Po{compare(n,r){const i=n.node.getPriority(),c=r.node.getPriority(),u=i.compareTo(c);return u===0?vs(n.name,r.name):u}isDefinedOn(n){return!n.getPriority().isEmpty()}indexedValueChanged(n,r){return!n.getPriority().equals(r.getPriority())}minPost(){return qe.MIN}maxPost(){return new qe(xr,new Ot("[PRIORITY-POST]",ex))}makePost(n,r){const i=Jy(n);return new qe(r,new Ot("[PRIORITY-POST]",i))}toString(){return".priority"}}const pt=new mN;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pN=Math.log(2);class yN{constructor(n){const r=u=>parseInt(Math.log(u)/pN,10),i=u=>parseInt(Array(u+1).join("1"),2);this.count=r(n+1),this.current_=this.count-1;const c=i(this.count);this.bits_=n+1&c}nextBitIsOne(){const n=!(this.bits_&1<<this.current_);return this.current_--,n}}const Ro=function(s,n,r,i){s.sort(n);const c=function(m,p){const x=p-m;let b,w;if(x===0)return null;if(x===1)return b=s[m],w=r?r(b):b,new It(w,b.node,It.BLACK,null,null);{const L=parseInt(x/2,10)+m,T=c(m,L),z=c(L+1,p);return b=s[L],w=r?r(b):b,new It(w,b.node,It.BLACK,T,z)}},u=function(m){let p=null,x=null,b=s.length;const w=function(T,z){const W=b-T,k=b;b-=T;const S=c(W+1,k),A=s[W],D=r?r(A):A;L(new It(D,A.node,z,null,S))},L=function(T){p?(p.left=T,p=T):(x=T,p=T)};for(let T=0;T<m.count;++T){const z=m.nextBitIsOne(),W=Math.pow(2,m.count-(T+1));z?w(W,It.BLACK):(w(W,It.BLACK),w(W,It.RED))}return x},f=new yN(s.length),g=u(f);return new tn(i||n,g)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ru;const os={};class ia{static get Default(){return fe(os&&pt,"ChildrenNode.ts has not been loaded"),Ru=Ru||new ia({".priority":os},{".priority":pt}),Ru}constructor(n,r){this.indexes_=n,this.indexSet_=r}get(n){const r=ms(this.indexes_,n);if(!r)throw new Error("No index defined for "+n);return r instanceof tn?r:null}hasIndex(n){return da(this.indexSet_,n.toString())}addIndex(n,r){fe(n!==fs,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let c=!1;const u=r.getIterator(qe.Wrap);let f=u.getNext();for(;f;)c=c||n.isDefinedOn(f.node),i.push(f),f=u.getNext();let g;c?g=Ro(i,n.getCompare()):g=os;const m=n.toString(),p={...this.indexSet_};p[m]=n;const x={...this.indexes_};return x[m]=g,new ia(x,p)}addToIndexes(n,r){const i=To(this.indexes_,(c,u)=>{const f=ms(this.indexSet_,u);if(fe(f,"Missing index implementation for "+u),c===os)if(f.isDefinedOn(n.node)){const g=[],m=r.getIterator(qe.Wrap);let p=m.getNext();for(;p;)p.name!==n.name&&g.push(p),p=m.getNext();return g.push(n),Ro(g,f.getCompare())}else return os;else{const g=r.get(n.name);let m=c;return g&&(m=m.remove(new qe(n.name,g))),m.insert(n,n.node)}});return new ia(i,this.indexSet_)}removeFromIndexes(n,r){const i=To(this.indexes_,c=>{if(c===os)return c;{const u=r.get(n.name);return u?c.remove(new qe(n.name,u)):c}});return new ia(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nl;class Ie{static get EMPTY_NODE(){return Nl||(Nl=new Ie(new tn(ph),null,ia.Default))}constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&Zy(this.priorityNode_),this.children_.isEmpty()&&fe(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Nl}updatePriority(n){return this.children_.isEmpty()?this:new Ie(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{const r=this.children_.get(n);return r===null?Nl:r}}getChild(n){const r=Be(n);return r===null?this:this.getImmediateChild(r).getChild(ct(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(fe(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{const i=new qe(n,r);let c,u;r.isEmpty()?(c=this.children_.remove(n),u=this.indexMap_.removeFromIndexes(i,this.children_)):(c=this.children_.insert(n,r),u=this.indexMap_.addToIndexes(i,this.children_));const f=c.isEmpty()?Nl:this.priorityNode_;return new Ie(c,f,u)}}updateChild(n,r){const i=Be(n);if(i===null)return r;{fe(Be(n)!==".priority"||Ya(n)===1,".priority must be the last token in a path");const c=this.getImmediateChild(i).updateChild(ct(n),r);return this.updateImmediateChild(i,c)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;const r={};let i=0,c=0,u=!0;if(this.forEachChild(pt,(f,g)=>{r[f]=g.val(n),i++,u&&Ie.INTEGER_REGEXP_.test(f)?c=Math.max(c,Number(f)):u=!1}),!n&&u&&c<2*i){const f=[];for(const g in r)f[g]=r[g];return f}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+Ky(this.getPriority().val())+":"),this.forEachChild(pt,(r,i)=>{const c=i.hash();c!==""&&(n+=":"+r+":"+c)}),this.lazyHash_=n===""?"":Ny(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){const c=this.resolveIndex_(i);if(c){const u=c.getPredecessorKey(new qe(n,r));return u?u.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){const r=this.resolveIndex_(n);if(r){const i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){const r=this.getFirstChildName(n);return r?new qe(r,this.children_.get(r)):null}getLastChildName(n){const r=this.resolveIndex_(n);if(r){const i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){const r=this.getLastChildName(n);return r?new qe(r,this.children_.get(r)):null}forEachChild(n,r){const i=this.resolveIndex_(n);return i?i.inorderTraversal(c=>r(c.name,c.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,c=>c);{const c=this.children_.getIteratorFrom(n.name,qe.Wrap);let u=c.peek();for(;u!=null&&r.compare(u,n)<0;)c.getNext(),u=c.peek();return c}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,c=>c);{const c=this.children_.getReverseIteratorFrom(n.name,qe.Wrap);let u=c.peek();for(;u!=null&&r.compare(u,n)>0;)c.getNext(),u=c.peek();return c}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===Ql?-1:0}withIndex(n){if(n===fs||this.indexMap_.hasIndex(n))return this;{const r=this.indexMap_.addIndex(n,this.children_);return new Ie(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===fs||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{const r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){const i=this.getIterator(pt),c=r.getIterator(pt);let u=i.getNext(),f=c.getNext();for(;u&&f;){if(u.name!==f.name||!u.node.equals(f.node))return!1;u=i.getNext(),f=c.getNext()}return u===null&&f===null}else return!1;else return!1}}resolveIndex_(n){return n===fs?null:this.indexMap_.get(n.toString())}}Ie.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class xN extends Ie{constructor(){super(new tn(ph),Ie.EMPTY_NODE,ia.Default)}compareTo(n){return n===this?0:1}equals(n){return n===this}getPriority(){return this}getImmediateChild(n){return Ie.EMPTY_NODE}isEmpty(){return!1}}const Ql=new xN;Object.defineProperties(qe,{MIN:{value:new qe(ps,Ie.EMPTY_NODE)},MAX:{value:new qe(xr,Ql)}});Xy.__EMPTY_NODE=Ie.EMPTY_NODE;Ot.__childrenNodeConstructor=Ie;hN(Ql);gN(Ql);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bN=!0;function Lt(s,n=null){if(s===null)return Ie.EMPTY_NODE;if(typeof s=="object"&&".priority"in s&&(n=s[".priority"]),fe(n===null||typeof n=="string"||typeof n=="number"||typeof n=="object"&&".sv"in n,"Invalid priority type found: "+typeof n),typeof s=="object"&&".value"in s&&s[".value"]!==null&&(s=s[".value"]),typeof s!="object"||".sv"in s){const r=s;return new Ot(r,Lt(n))}if(!(s instanceof Array)&&bN){const r=[];let i=!1;if(rn(s,(f,g)=>{if(f.substring(0,1)!=="."){const m=Lt(g);m.isEmpty()||(i=i||!m.getPriority().isEmpty(),r.push(new qe(f,m)))}}),r.length===0)return Ie.EMPTY_NODE;const u=Ro(r,uN,f=>f.name,ph);if(i){const f=Ro(r,pt.getCompare());return new Ie(u,Lt(n),new ia({".priority":f},{".priority":pt}))}else return new Ie(u,Lt(n),ia.Default)}else{let r=Ie.EMPTY_NODE;return rn(s,(i,c)=>{if(da(s,i)&&i.substring(0,1)!=="."){const u=Lt(c);(u.isLeafNode()||!u.isEmpty())&&(r=r.updateImmediateChild(i,u))}}),r.updatePriority(Lt(n))}}fN(Lt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vN extends Po{constructor(n){super(),this.indexPath_=n,fe(!Ge(n)&&Be(n)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(n){return n.getChild(this.indexPath_)}isDefinedOn(n){return!n.getChild(this.indexPath_).isEmpty()}compare(n,r){const i=this.extractChild(n.node),c=this.extractChild(r.node),u=i.compareTo(c);return u===0?vs(n.name,r.name):u}makePost(n,r){const i=Lt(n),c=Ie.EMPTY_NODE.updateChild(this.indexPath_,i);return new qe(r,c)}maxPost(){const n=Ie.EMPTY_NODE.updateChild(this.indexPath_,Ql);return new qe(xr,n)}toString(){return Wy(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN extends Po{compare(n,r){const i=n.node.compareTo(r.node);return i===0?vs(n.name,r.name):i}isDefinedOn(n){return!0}indexedValueChanged(n,r){return!n.equals(r)}minPost(){return qe.MIN}maxPost(){return qe.MAX}makePost(n,r){const i=Lt(n);return new qe(r,i)}toString(){return".value"}}const _N=new wN;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tx(s){return{type:"value",snapshotNode:s}}function ys(s,n){return{type:"child_added",snapshotNode:n,childName:s}}function Ll(s,n){return{type:"child_removed",snapshotNode:n,childName:s}}function zl(s,n,r){return{type:"child_changed",snapshotNode:n,childName:s,oldSnap:r}}function kN(s,n){return{type:"child_moved",snapshotNode:n,childName:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(n){this.index_=n}updateChild(n,r,i,c,u,f){fe(n.isIndexed(this.index_),"A node must be indexed if only a child is updated");const g=n.getImmediateChild(r);return g.getChild(c).equals(i.getChild(c))&&g.isEmpty()===i.isEmpty()||(f!=null&&(i.isEmpty()?n.hasChild(r)?f.trackChildChange(Ll(r,g)):fe(n.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):g.isEmpty()?f.trackChildChange(ys(r,i)):f.trackChildChange(zl(r,i,g))),n.isLeafNode()&&i.isEmpty())?n:n.updateImmediateChild(r,i).withIndex(this.index_)}updateFullNode(n,r,i){return i!=null&&(n.isLeafNode()||n.forEachChild(pt,(c,u)=>{r.hasChild(c)||i.trackChildChange(Ll(c,u))}),r.isLeafNode()||r.forEachChild(pt,(c,u)=>{if(n.hasChild(c)){const f=n.getImmediateChild(c);f.equals(u)||i.trackChildChange(zl(c,u,f))}else i.trackChildChange(ys(c,u))})),r.withIndex(this.index_)}updatePriority(n,r){return n.isEmpty()?Ie.EMPTY_NODE:n.updatePriority(r)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(n){this.indexedFilter_=new yh(n.getIndex()),this.index_=n.getIndex(),this.startPost_=Hl.getStartPost_(n),this.endPost_=Hl.getEndPost_(n),this.startIsInclusive_=!n.startAfterSet_,this.endIsInclusive_=!n.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(n){const r=this.startIsInclusive_?this.index_.compare(this.getStartPost(),n)<=0:this.index_.compare(this.getStartPost(),n)<0,i=this.endIsInclusive_?this.index_.compare(n,this.getEndPost())<=0:this.index_.compare(n,this.getEndPost())<0;return r&&i}updateChild(n,r,i,c,u,f){return this.matches(new qe(r,i))||(i=Ie.EMPTY_NODE),this.indexedFilter_.updateChild(n,r,i,c,u,f)}updateFullNode(n,r,i){r.isLeafNode()&&(r=Ie.EMPTY_NODE);let c=r.withIndex(this.index_);c=c.updatePriority(Ie.EMPTY_NODE);const u=this;return r.forEachChild(pt,(f,g)=>{u.matches(new qe(f,g))||(c=c.updateImmediateChild(f,Ie.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(n,c,i)}updatePriority(n,r){return n}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(n){if(n.hasStart()){const r=n.getIndexStartName();return n.getIndex().makePost(n.getIndexStartValue(),r)}else return n.getIndex().minPost()}static getEndPost_(n){if(n.hasEnd()){const r=n.getIndexEndName();return n.getIndex().makePost(n.getIndexEndValue(),r)}else return n.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NN{constructor(n){this.withinDirectionalStart=r=>this.reverse_?this.withinEndPost(r):this.withinStartPost(r),this.withinDirectionalEnd=r=>this.reverse_?this.withinStartPost(r):this.withinEndPost(r),this.withinStartPost=r=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),r);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=r=>{const i=this.index_.compare(r,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new Hl(n),this.index_=n.getIndex(),this.limit_=n.getLimit(),this.reverse_=!n.isViewFromLeft(),this.startIsInclusive_=!n.startAfterSet_,this.endIsInclusive_=!n.endBeforeSet_}updateChild(n,r,i,c,u,f){return this.rangedFilter_.matches(new qe(r,i))||(i=Ie.EMPTY_NODE),n.getImmediateChild(r).equals(i)?n:n.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(n,r,i,c,u,f):this.fullLimitUpdateChild_(n,r,i,u,f)}updateFullNode(n,r,i){let c;if(r.isLeafNode()||r.isEmpty())c=Ie.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<r.numChildren()&&r.isIndexed(this.index_)){c=Ie.EMPTY_NODE.withIndex(this.index_);let u;this.reverse_?u=r.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):u=r.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let f=0;for(;u.hasNext()&&f<this.limit_;){const g=u.getNext();if(this.withinDirectionalStart(g))if(this.withinDirectionalEnd(g))c=c.updateImmediateChild(g.name,g.node),f++;else break;else continue}}else{c=r.withIndex(this.index_),c=c.updatePriority(Ie.EMPTY_NODE);let u;this.reverse_?u=c.getReverseIterator(this.index_):u=c.getIterator(this.index_);let f=0;for(;u.hasNext();){const g=u.getNext();f<this.limit_&&this.withinDirectionalStart(g)&&this.withinDirectionalEnd(g)?f++:c=c.updateImmediateChild(g.name,Ie.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(n,c,i)}updatePriority(n,r){return n}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(n,r,i,c,u){let f;if(this.reverse_){const b=this.index_.getCompare();f=(w,L)=>b(L,w)}else f=this.index_.getCompare();const g=n;fe(g.numChildren()===this.limit_,"");const m=new qe(r,i),p=this.reverse_?g.getFirstChild(this.index_):g.getLastChild(this.index_),x=this.rangedFilter_.matches(m);if(g.hasChild(r)){const b=g.getImmediateChild(r);let w=c.getChildAfterChild(this.index_,p,this.reverse_);for(;w!=null&&(w.name===r||g.hasChild(w.name));)w=c.getChildAfterChild(this.index_,w,this.reverse_);const L=w==null?1:f(w,m);if(x&&!i.isEmpty()&&L>=0)return u?.trackChildChange(zl(r,i,b)),g.updateImmediateChild(r,i);{u?.trackChildChange(Ll(r,b));const z=g.updateImmediateChild(r,Ie.EMPTY_NODE);return w!=null&&this.rangedFilter_.matches(w)?(u?.trackChildChange(ys(w.name,w.node)),z.updateImmediateChild(w.name,w.node)):z}}else return i.isEmpty()?n:x&&f(p,m)>=0?(u!=null&&(u.trackChildChange(Ll(p.name,p.node)),u.trackChildChange(ys(r,i))),g.updateImmediateChild(r,i).updateImmediateChild(p.name,Ie.EMPTY_NODE)):n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=pt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return fe(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return fe(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ps}hasEnd(){return this.endSet_}getIndexEndValue(){return fe(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return fe(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:xr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return fe(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===pt}copy(){const n=new xh;return n.limitSet_=this.limitSet_,n.limit_=this.limit_,n.startSet_=this.startSet_,n.startAfterSet_=this.startAfterSet_,n.indexStartValue_=this.indexStartValue_,n.startNameSet_=this.startNameSet_,n.indexStartName_=this.indexStartName_,n.endSet_=this.endSet_,n.endBeforeSet_=this.endBeforeSet_,n.indexEndValue_=this.indexEndValue_,n.endNameSet_=this.endNameSet_,n.indexEndName_=this.indexEndName_,n.index_=this.index_,n.viewFrom_=this.viewFrom_,n}}function TN(s){return s.loadsAllData()?new yh(s.getIndex()):s.hasLimit()?new NN(s):new Hl(s)}function mp(s){const n={};if(s.isDefault())return n;let r;if(s.index_===pt?r="$priority":s.index_===_N?r="$value":s.index_===fs?r="$key":(fe(s.index_ instanceof vN,"Unrecognized index type!"),r=s.index_.toString()),n.orderBy=Tt(r),s.startSet_){const i=s.startAfterSet_?"startAfter":"startAt";n[i]=Tt(s.indexStartValue_),s.startNameSet_&&(n[i]+=","+Tt(s.indexStartName_))}if(s.endSet_){const i=s.endBeforeSet_?"endBefore":"endAt";n[i]=Tt(s.indexEndValue_),s.endNameSet_&&(n[i]+=","+Tt(s.indexEndName_))}return s.limitSet_&&(s.isViewFromLeft()?n.limitToFirst=s.limit_:n.limitToLast=s.limit_),n}function pp(s){const n={};if(s.startSet_&&(n.sp=s.indexStartValue_,s.startNameSet_&&(n.sn=s.indexStartName_),n.sin=!s.startAfterSet_),s.endSet_&&(n.ep=s.indexEndValue_,s.endNameSet_&&(n.en=s.indexEndName_),n.ein=!s.endBeforeSet_),s.limitSet_){n.l=s.limit_;let r=s.viewFrom_;r===""&&(s.isViewFromLeft()?r="l":r="r"),n.vf=r}return s.index_!==pt&&(n.i=s.index_.toString()),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo extends Fy{reportStats(n){throw new Error("Method not implemented.")}static getListenId_(n,r){return r!==void 0?"tag$"+r:(fe(n._queryParams.isDefault(),"should have a tag if it's not a default query."),n._path.toString())}constructor(n,r,i,c){super(),this.repoInfo_=n,this.onDataUpdate_=r,this.authTokenProvider_=i,this.appCheckTokenProvider_=c,this.log_=Pl("p:rest:"),this.listens_={}}listen(n,r,i,c){const u=n._path.toString();this.log_("Listen called for "+u+" "+n._queryIdentifier);const f=Oo.getListenId_(n,i),g={};this.listens_[f]=g;const m=mp(n._queryParams);this.restRequest_(u+".json",m,(p,x)=>{let b=x;if(p===404&&(b=null,p=null),p===null&&this.onDataUpdate_(u,b,!1,i),ms(this.listens_,f)===g){let w;p?p===401?w="permission_denied":w="rest_error:"+p:w="ok",c(w,null)}})}unlisten(n,r){const i=Oo.getListenId_(n,r);delete this.listens_[i]}get(n){const r=mp(n._queryParams),i=n._path.toString(),c=new lh;return this.restRequest_(i+".json",r,(u,f)=>{let g=f;u===404&&(g=null,u=null),u===null?(this.onDataUpdate_(i,g,!1,null),c.resolve(g)):c.reject(new Error(g))}),c.promise}refreshAuthToken(n){}restRequest_(n,r={},i){return r.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([c,u])=>{c&&c.accessToken&&(r.auth=c.accessToken),u&&u.token&&(r.ac=u.token);const f=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+n+"?ns="+this.repoInfo_.namespace+Xw(r);this.log_("Sending REST request for "+f);const g=new XMLHttpRequest;g.onreadystatechange=()=>{if(i&&g.readyState===4){this.log_("REST Response for "+f+" received. status:",g.status,"response:",g.responseText);let m=null;if(g.status>=200&&g.status<300){try{m=rh(g.responseText)}catch{nn("Failed to parse JSON response for "+f+": "+g.responseText)}i(null,m)}else g.status!==401&&g.status!==404&&nn("Got unsuccessful REST response for "+f+" Status: "+g.status),i(g.status);i=null}},g.open("GET",f,!0),g.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jN{constructor(){this.rootNode_=Ie.EMPTY_NODE}getNode(n){return this.rootNode_.getChild(n)}updateSnapshot(n,r){this.rootNode_=this.rootNode_.updateChild(n,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mo(){return{value:null,children:new Map}}function nx(s,n,r){if(Ge(n))s.value=r,s.children.clear();else if(s.value!==null)s.value=s.value.updateChild(n,r);else{const i=Be(n);s.children.has(i)||s.children.set(i,Mo());const c=s.children.get(i);n=ct(n),nx(c,n,r)}}function Fu(s,n,r){s.value!==null?r(n,s.value):SN(s,(i,c)=>{const u=new it(n.toString()+"/"+i);Fu(c,u,r)})}function SN(s,n){s.children.forEach((r,i)=>{n(i,r)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DN{constructor(n){this.collection_=n,this.last_=null}get(){const n=this.collection_.get(),r={...n};return this.last_&&rn(this.last_,(i,c)=>{r[i]=r[i]-c}),this.last_=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yp=10*1e3,EN=30*1e3,CN=300*1e3;class AN{constructor(n,r){this.server_=r,this.statsToReport_={},this.statsListener_=new DN(n);const i=yp+(EN-yp)*Math.random();Cl(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const n=this.statsListener_.get(),r={};let i=!1;rn(n,(c,u)=>{u>0&&da(this.statsToReport_,c)&&(r[c]=u,i=!0)}),i&&this.server_.reportStats(r),Cl(this.reportStats_.bind(this),Math.floor(Math.random()*2*CN))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rn;(function(s){s[s.OVERWRITE=0]="OVERWRITE",s[s.MERGE=1]="MERGE",s[s.ACK_USER_WRITE=2]="ACK_USER_WRITE",s[s.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Rn||(Rn={}));function ax(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function bh(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function vh(s){return{fromUser:!1,fromServer:!0,queryId:s,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(n,r,i){this.path=n,this.affectedTree=r,this.revert=i,this.type=Rn.ACK_USER_WRITE,this.source=ax()}operationForChild(n){if(Ge(this.path)){if(this.affectedTree.value!=null)return fe(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const r=this.affectedTree.subtree(new it(n));return new Io(Pe(),r,this.revert)}}else return fe(Be(this.path)===n,"operationForChild called for unrelated child."),new Io(ct(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(n,r){this.source=n,this.path=r,this.type=Rn.LISTEN_COMPLETE}operationForChild(n){return Ge(this.path)?new $l(this.source,Pe()):new $l(this.source,ct(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(n,r,i){this.source=n,this.path=r,this.snap=i,this.type=Rn.OVERWRITE}operationForChild(n){return Ge(this.path)?new br(this.source,Pe(),this.snap.getImmediateChild(n)):new br(this.source,ct(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(n,r,i){this.source=n,this.path=r,this.children=i,this.type=Rn.MERGE}operationForChild(n){if(Ge(this.path)){const r=this.children.subtree(new it(n));return r.isEmpty()?null:r.value?new br(this.source,Pe(),r.value):new Bl(this.source,Pe(),r)}else return fe(Be(this.path)===n,"Can't get a merge for a child not on the path of the operation"),new Bl(this.source,ct(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(n,r,i){this.node_=n,this.fullyInitialized_=r,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(n){if(Ge(n))return this.isFullyInitialized()&&!this.filtered_;const r=Be(n);return this.isCompleteForChild(r)}isCompleteForChild(n){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(n)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RN{constructor(n){this.query_=n,this.index_=this.query_._queryParams.getIndex()}}function ON(s,n,r,i){const c=[],u=[];return n.forEach(f=>{f.type==="child_changed"&&s.index_.indexedValueChanged(f.oldSnap,f.snapshotNode)&&u.push(kN(f.childName,f.snapshotNode))}),Tl(s,c,"child_removed",n,i,r),Tl(s,c,"child_added",n,i,r),Tl(s,c,"child_moved",u,i,r),Tl(s,c,"child_changed",n,i,r),Tl(s,c,"value",n,i,r),c}function Tl(s,n,r,i,c,u){const f=i.filter(g=>g.type===r);f.sort((g,m)=>IN(s,g,m)),f.forEach(g=>{const m=MN(s,g,u);c.forEach(p=>{p.respondsTo(g.type)&&n.push(p.createEvent(m,s.query_))})})}function MN(s,n,r){return n.type==="value"||n.type==="child_removed"||(n.prevName=r.getPredecessorChildName(n.childName,n.snapshotNode,s.index_)),n}function IN(s,n,r){if(n.childName==null||r.childName==null)throw Vl("Should only compare child_ events.");const i=new qe(n.childName,n.snapshotNode),c=new qe(r.childName,r.snapshotNode);return s.index_.compare(i,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qo(s,n){return{eventCache:s,serverCache:n}}function Al(s,n,r,i){return Qo(new Fa(n,r,i),s.serverCache)}function rx(s,n,r,i){return Qo(s.eventCache,new Fa(n,r,i))}function Uo(s){return s.eventCache.isFullyInitialized()?s.eventCache.getNode():null}function vr(s){return s.serverCache.isFullyInitialized()?s.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ou;const UN=()=>(Ou||(Ou=new tn(wk)),Ou);class dt{static fromObject(n){let r=new dt(null);return rn(n,(i,c)=>{r=r.set(new it(i),c)}),r}constructor(n,r=UN()){this.value=n,this.children=r}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(n,r){if(this.value!=null&&r(this.value))return{path:Pe(),value:this.value};if(Ge(n))return null;{const i=Be(n),c=this.children.get(i);if(c!==null){const u=c.findRootMostMatchingPathAndValue(ct(n),r);return u!=null?{path:jt(new it(i),u.path),value:u.value}:null}else return null}}findRootMostValueAndPath(n){return this.findRootMostMatchingPathAndValue(n,()=>!0)}subtree(n){if(Ge(n))return this;{const r=Be(n),i=this.children.get(r);return i!==null?i.subtree(ct(n)):new dt(null)}}set(n,r){if(Ge(n))return new dt(r,this.children);{const i=Be(n),u=(this.children.get(i)||new dt(null)).set(ct(n),r),f=this.children.insert(i,u);return new dt(this.value,f)}}remove(n){if(Ge(n))return this.children.isEmpty()?new dt(null):new dt(null,this.children);{const r=Be(n),i=this.children.get(r);if(i){const c=i.remove(ct(n));let u;return c.isEmpty()?u=this.children.remove(r):u=this.children.insert(r,c),this.value===null&&u.isEmpty()?new dt(null):new dt(this.value,u)}else return this}}get(n){if(Ge(n))return this.value;{const r=Be(n),i=this.children.get(r);return i?i.get(ct(n)):null}}setTree(n,r){if(Ge(n))return r;{const i=Be(n),u=(this.children.get(i)||new dt(null)).setTree(ct(n),r);let f;return u.isEmpty()?f=this.children.remove(i):f=this.children.insert(i,u),new dt(this.value,f)}}fold(n){return this.fold_(Pe(),n)}fold_(n,r){const i={};return this.children.inorderTraversal((c,u)=>{i[c]=u.fold_(jt(n,c),r)}),r(n,this.value,i)}findOnPath(n,r){return this.findOnPath_(n,Pe(),r)}findOnPath_(n,r,i){const c=this.value?i(r,this.value):!1;if(c)return c;if(Ge(n))return null;{const u=Be(n),f=this.children.get(u);return f?f.findOnPath_(ct(n),jt(r,u),i):null}}foreachOnPath(n,r){return this.foreachOnPath_(n,Pe(),r)}foreachOnPath_(n,r,i){if(Ge(n))return this;{this.value&&i(r,this.value);const c=Be(n),u=this.children.get(c);return u?u.foreachOnPath_(ct(n),jt(r,c),i):new dt(null)}}foreach(n){this.foreach_(Pe(),n)}foreach_(n,r){this.children.inorderTraversal((i,c)=>{c.foreach_(jt(n,i),r)}),this.value&&r(n,this.value)}foreachChild(n){this.children.inorderTraversal((r,i)=>{i.value&&n(r,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(n){this.writeTree_=n}static empty(){return new On(new dt(null))}}function Rl(s,n,r){if(Ge(n))return new On(new dt(r));{const i=s.writeTree_.findRootMostValueAndPath(n);if(i!=null){const c=i.path;let u=i.value;const f=Pt(c,n);return u=u.updateChild(f,r),new On(s.writeTree_.set(c,u))}else{const c=new dt(r),u=s.writeTree_.setTree(n,c);return new On(u)}}}function xp(s,n,r){let i=s;return rn(r,(c,u)=>{i=Rl(i,jt(n,c),u)}),i}function bp(s,n){if(Ge(n))return On.empty();{const r=s.writeTree_.setTree(n,new dt(null));return new On(r)}}function Gu(s,n){return wr(s,n)!=null}function wr(s,n){const r=s.writeTree_.findRootMostValueAndPath(n);return r!=null?s.writeTree_.get(r.path).getChild(Pt(r.path,n)):null}function vp(s){const n=[],r=s.writeTree_.value;return r!=null?r.isLeafNode()||r.forEachChild(pt,(i,c)=>{n.push(new qe(i,c))}):s.writeTree_.children.inorderTraversal((i,c)=>{c.value!=null&&n.push(new qe(i,c.value))}),n}function Ba(s,n){if(Ge(n))return s;{const r=wr(s,n);return r!=null?new On(new dt(r)):new On(s.writeTree_.subtree(n))}}function Vu(s){return s.writeTree_.isEmpty()}function xs(s,n){return sx(Pe(),s.writeTree_,n)}function sx(s,n,r){if(n.value!=null)return r.updateChild(s,n.value);{let i=null;return n.children.inorderTraversal((c,u)=>{c===".priority"?(fe(u.value!==null,"Priority writes must always be leaf nodes"),i=u.value):r=sx(jt(s,c),u,r)}),!r.getChild(s).isEmpty()&&i!==null&&(r=r.updateChild(jt(s,".priority"),i)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xo(s,n){return cx(n,s)}function LN(s,n,r,i,c){fe(i>s.lastWriteId,"Stacking an older write on top of newer ones"),c===void 0&&(c=!0),s.allWrites.push({path:n,snap:r,writeId:i,visible:c}),c&&(s.visibleWrites=Rl(s.visibleWrites,n,r)),s.lastWriteId=i}function zN(s,n){for(let r=0;r<s.allWrites.length;r++){const i=s.allWrites[r];if(i.writeId===n)return i}return null}function HN(s,n){const r=s.allWrites.findIndex(g=>g.writeId===n);fe(r>=0,"removeWrite called with nonexistent writeId.");const i=s.allWrites[r];s.allWrites.splice(r,1);let c=i.visible,u=!1,f=s.allWrites.length-1;for(;c&&f>=0;){const g=s.allWrites[f];g.visible&&(f>=r&&$N(g,i.path)?c=!1:An(i.path,g.path)&&(u=!0)),f--}if(c){if(u)return BN(s),!0;if(i.snap)s.visibleWrites=bp(s.visibleWrites,i.path);else{const g=i.children;rn(g,m=>{s.visibleWrites=bp(s.visibleWrites,jt(i.path,m))})}return!0}else return!1}function $N(s,n){if(s.snap)return An(s.path,n);for(const r in s.children)if(s.children.hasOwnProperty(r)&&An(jt(s.path,r),n))return!0;return!1}function BN(s){s.visibleWrites=lx(s.allWrites,qN,Pe()),s.allWrites.length>0?s.lastWriteId=s.allWrites[s.allWrites.length-1].writeId:s.lastWriteId=-1}function qN(s){return s.visible}function lx(s,n,r){let i=On.empty();for(let c=0;c<s.length;++c){const u=s[c];if(n(u)){const f=u.path;let g;if(u.snap)An(r,f)?(g=Pt(r,f),i=Rl(i,g,u.snap)):An(f,r)&&(g=Pt(f,r),i=Rl(i,Pe(),u.snap.getChild(g)));else if(u.children){if(An(r,f))g=Pt(r,f),i=xp(i,g,u.children);else if(An(f,r))if(g=Pt(f,r),Ge(g))i=xp(i,Pe(),u.children);else{const m=ms(u.children,Be(g));if(m){const p=m.getChild(ct(g));i=Rl(i,Pe(),p)}}}else throw Vl("WriteRecord should have .snap or .children")}}return i}function ix(s,n,r,i,c){if(!i&&!c){const u=wr(s.visibleWrites,n);if(u!=null)return u;{const f=Ba(s.visibleWrites,n);if(Vu(f))return r;if(r==null&&!Gu(f,Pe()))return null;{const g=r||Ie.EMPTY_NODE;return xs(f,g)}}}else{const u=Ba(s.visibleWrites,n);if(!c&&Vu(u))return r;if(!c&&r==null&&!Gu(u,Pe()))return null;{const f=function(p){return(p.visible||c)&&(!i||!~i.indexOf(p.writeId))&&(An(p.path,n)||An(n,p.path))},g=lx(s.allWrites,f,n),m=r||Ie.EMPTY_NODE;return xs(g,m)}}}function YN(s,n,r){let i=Ie.EMPTY_NODE;const c=wr(s.visibleWrites,n);if(c)return c.isLeafNode()||c.forEachChild(pt,(u,f)=>{i=i.updateImmediateChild(u,f)}),i;if(r){const u=Ba(s.visibleWrites,n);return r.forEachChild(pt,(f,g)=>{const m=xs(Ba(u,new it(f)),g);i=i.updateImmediateChild(f,m)}),vp(u).forEach(f=>{i=i.updateImmediateChild(f.name,f.node)}),i}else{const u=Ba(s.visibleWrites,n);return vp(u).forEach(f=>{i=i.updateImmediateChild(f.name,f.node)}),i}}function FN(s,n,r,i,c){fe(i||c,"Either existingEventSnap or existingServerSnap must exist");const u=jt(n,r);if(Gu(s.visibleWrites,u))return null;{const f=Ba(s.visibleWrites,u);return Vu(f)?c.getChild(r):xs(f,c.getChild(r))}}function GN(s,n,r,i){const c=jt(n,r),u=wr(s.visibleWrites,c);if(u!=null)return u;if(i.isCompleteForChild(r)){const f=Ba(s.visibleWrites,c);return xs(f,i.getNode().getImmediateChild(r))}else return null}function VN(s,n){return wr(s.visibleWrites,n)}function WN(s,n,r,i,c,u,f){let g;const m=Ba(s.visibleWrites,n),p=wr(m,Pe());if(p!=null)g=p;else if(r!=null)g=xs(m,r);else return[];if(g=g.withIndex(f),!g.isEmpty()&&!g.isLeafNode()){const x=[],b=f.getCompare(),w=u?g.getReverseIteratorFrom(i,f):g.getIteratorFrom(i,f);let L=w.getNext();for(;L&&x.length<c;)b(L,i)!==0&&x.push(L),L=w.getNext();return x}else return[]}function PN(){return{visibleWrites:On.empty(),allWrites:[],lastWriteId:-1}}function Lo(s,n,r,i){return ix(s.writeTree,s.treePath,n,r,i)}function wh(s,n){return YN(s.writeTree,s.treePath,n)}function wp(s,n,r,i){return FN(s.writeTree,s.treePath,n,r,i)}function zo(s,n){return VN(s.writeTree,jt(s.treePath,n))}function QN(s,n,r,i,c,u){return WN(s.writeTree,s.treePath,n,r,i,c,u)}function _h(s,n,r){return GN(s.writeTree,s.treePath,n,r)}function ox(s,n){return cx(jt(s.treePath,n),s.writeTree)}function cx(s,n){return{treePath:s,writeTree:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XN{constructor(){this.changeMap=new Map}trackChildChange(n){const r=n.type,i=n.childName;fe(r==="child_added"||r==="child_changed"||r==="child_removed","Only child changes supported for tracking"),fe(i!==".priority","Only non-priority child changes can be tracked.");const c=this.changeMap.get(i);if(c){const u=c.type;if(r==="child_added"&&u==="child_removed")this.changeMap.set(i,zl(i,n.snapshotNode,c.snapshotNode));else if(r==="child_removed"&&u==="child_added")this.changeMap.delete(i);else if(r==="child_removed"&&u==="child_changed")this.changeMap.set(i,Ll(i,c.oldSnap));else if(r==="child_changed"&&u==="child_added")this.changeMap.set(i,ys(i,n.snapshotNode));else if(r==="child_changed"&&u==="child_changed")this.changeMap.set(i,zl(i,n.snapshotNode,c.oldSnap));else throw Vl("Illegal combination of changes: "+n+" occurred after "+c)}else this.changeMap.set(i,n)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KN{getCompleteChild(n){return null}getChildAfterChild(n,r,i){return null}}const dx=new KN;class kh{constructor(n,r,i=null){this.writes_=n,this.viewCache_=r,this.optCompleteServerCache_=i}getCompleteChild(n){const r=this.viewCache_.eventCache;if(r.isCompleteForChild(n))return r.getNode().getImmediateChild(n);{const i=this.optCompleteServerCache_!=null?new Fa(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return _h(this.writes_,n,i)}}getChildAfterChild(n,r,i){const c=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:vr(this.viewCache_),u=QN(this.writes_,c,r,1,i,n);return u.length===0?null:u[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZN(s){return{filter:s}}function JN(s,n){fe(n.eventCache.getNode().isIndexed(s.filter.getIndex()),"Event snap not indexed"),fe(n.serverCache.getNode().isIndexed(s.filter.getIndex()),"Server snap not indexed")}function eT(s,n,r,i,c){const u=new XN;let f,g;if(r.type===Rn.OVERWRITE){const p=r;p.source.fromUser?f=Wu(s,n,p.path,p.snap,i,c,u):(fe(p.source.fromServer,"Unknown source."),g=p.source.tagged||n.serverCache.isFiltered()&&!Ge(p.path),f=Ho(s,n,p.path,p.snap,i,c,g,u))}else if(r.type===Rn.MERGE){const p=r;p.source.fromUser?f=nT(s,n,p.path,p.children,i,c,u):(fe(p.source.fromServer,"Unknown source."),g=p.source.tagged||n.serverCache.isFiltered(),f=Pu(s,n,p.path,p.children,i,c,g,u))}else if(r.type===Rn.ACK_USER_WRITE){const p=r;p.revert?f=sT(s,n,p.path,i,c,u):f=aT(s,n,p.path,p.affectedTree,i,c,u)}else if(r.type===Rn.LISTEN_COMPLETE)f=rT(s,n,r.path,i,u);else throw Vl("Unknown operation type: "+r.type);const m=u.getChanges();return tT(n,f,m),{viewCache:f,changes:m}}function tT(s,n,r){const i=n.eventCache;if(i.isFullyInitialized()){const c=i.getNode().isLeafNode()||i.getNode().isEmpty(),u=Uo(s);(r.length>0||!s.eventCache.isFullyInitialized()||c&&!i.getNode().equals(u)||!i.getNode().getPriority().equals(u.getPriority()))&&r.push(tx(Uo(n)))}}function ux(s,n,r,i,c,u){const f=n.eventCache;if(zo(i,r)!=null)return n;{let g,m;if(Ge(r))if(fe(n.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),n.serverCache.isFiltered()){const p=vr(n),x=p instanceof Ie?p:Ie.EMPTY_NODE,b=wh(i,x);g=s.filter.updateFullNode(n.eventCache.getNode(),b,u)}else{const p=Lo(i,vr(n));g=s.filter.updateFullNode(n.eventCache.getNode(),p,u)}else{const p=Be(r);if(p===".priority"){fe(Ya(r)===1,"Can't have a priority with additional path components");const x=f.getNode();m=n.serverCache.getNode();const b=wp(i,r,x,m);b!=null?g=s.filter.updatePriority(x,b):g=f.getNode()}else{const x=ct(r);let b;if(f.isCompleteForChild(p)){m=n.serverCache.getNode();const w=wp(i,r,f.getNode(),m);w!=null?b=f.getNode().getImmediateChild(p).updateChild(x,w):b=f.getNode().getImmediateChild(p)}else b=_h(i,p,n.serverCache);b!=null?g=s.filter.updateChild(f.getNode(),p,b,x,c,u):g=f.getNode()}}return Al(n,g,f.isFullyInitialized()||Ge(r),s.filter.filtersNodes())}}function Ho(s,n,r,i,c,u,f,g){const m=n.serverCache;let p;const x=f?s.filter:s.filter.getIndexedFilter();if(Ge(r))p=x.updateFullNode(m.getNode(),i,null);else if(x.filtersNodes()&&!m.isFiltered()){const L=m.getNode().updateChild(r,i);p=x.updateFullNode(m.getNode(),L,null)}else{const L=Be(r);if(!m.isCompleteForPath(r)&&Ya(r)>1)return n;const T=ct(r),W=m.getNode().getImmediateChild(L).updateChild(T,i);L===".priority"?p=x.updatePriority(m.getNode(),W):p=x.updateChild(m.getNode(),L,W,T,dx,null)}const b=rx(n,p,m.isFullyInitialized()||Ge(r),x.filtersNodes()),w=new kh(c,b,u);return ux(s,b,r,c,w,g)}function Wu(s,n,r,i,c,u,f){const g=n.eventCache;let m,p;const x=new kh(c,n,u);if(Ge(r))p=s.filter.updateFullNode(n.eventCache.getNode(),i,f),m=Al(n,p,!0,s.filter.filtersNodes());else{const b=Be(r);if(b===".priority")p=s.filter.updatePriority(n.eventCache.getNode(),i),m=Al(n,p,g.isFullyInitialized(),g.isFiltered());else{const w=ct(r),L=g.getNode().getImmediateChild(b);let T;if(Ge(w))T=i;else{const z=x.getCompleteChild(b);z!=null?Vy(w)===".priority"&&z.getChild(Py(w)).isEmpty()?T=z:T=z.updateChild(w,i):T=Ie.EMPTY_NODE}if(L.equals(T))m=n;else{const z=s.filter.updateChild(g.getNode(),b,T,w,x,f);m=Al(n,z,g.isFullyInitialized(),s.filter.filtersNodes())}}}return m}function _p(s,n){return s.eventCache.isCompleteForChild(n)}function nT(s,n,r,i,c,u,f){let g=n;return i.foreach((m,p)=>{const x=jt(r,m);_p(n,Be(x))&&(g=Wu(s,g,x,p,c,u,f))}),i.foreach((m,p)=>{const x=jt(r,m);_p(n,Be(x))||(g=Wu(s,g,x,p,c,u,f))}),g}function kp(s,n,r){return r.foreach((i,c)=>{n=n.updateChild(i,c)}),n}function Pu(s,n,r,i,c,u,f,g){if(n.serverCache.getNode().isEmpty()&&!n.serverCache.isFullyInitialized())return n;let m=n,p;Ge(r)?p=i:p=new dt(null).setTree(r,i);const x=n.serverCache.getNode();return p.children.inorderTraversal((b,w)=>{if(x.hasChild(b)){const L=n.serverCache.getNode().getImmediateChild(b),T=kp(s,L,w);m=Ho(s,m,new it(b),T,c,u,f,g)}}),p.children.inorderTraversal((b,w)=>{const L=!n.serverCache.isCompleteForChild(b)&&w.value===null;if(!x.hasChild(b)&&!L){const T=n.serverCache.getNode().getImmediateChild(b),z=kp(s,T,w);m=Ho(s,m,new it(b),z,c,u,f,g)}}),m}function aT(s,n,r,i,c,u,f){if(zo(c,r)!=null)return n;const g=n.serverCache.isFiltered(),m=n.serverCache;if(i.value!=null){if(Ge(r)&&m.isFullyInitialized()||m.isCompleteForPath(r))return Ho(s,n,r,m.getNode().getChild(r),c,u,g,f);if(Ge(r)){let p=new dt(null);return m.getNode().forEachChild(fs,(x,b)=>{p=p.set(new it(x),b)}),Pu(s,n,r,p,c,u,g,f)}else return n}else{let p=new dt(null);return i.foreach((x,b)=>{const w=jt(r,x);m.isCompleteForPath(w)&&(p=p.set(x,m.getNode().getChild(w)))}),Pu(s,n,r,p,c,u,g,f)}}function rT(s,n,r,i,c){const u=n.serverCache,f=rx(n,u.getNode(),u.isFullyInitialized()||Ge(r),u.isFiltered());return ux(s,f,r,i,dx,c)}function sT(s,n,r,i,c,u){let f;if(zo(i,r)!=null)return n;{const g=new kh(i,n,c),m=n.eventCache.getNode();let p;if(Ge(r)||Be(r)===".priority"){let x;if(n.serverCache.isFullyInitialized())x=Lo(i,vr(n));else{const b=n.serverCache.getNode();fe(b instanceof Ie,"serverChildren would be complete if leaf node"),x=wh(i,b)}x=x,p=s.filter.updateFullNode(m,x,u)}else{const x=Be(r);let b=_h(i,x,n.serverCache);b==null&&n.serverCache.isCompleteForChild(x)&&(b=m.getImmediateChild(x)),b!=null?p=s.filter.updateChild(m,x,b,ct(r),g,u):n.eventCache.getNode().hasChild(x)?p=s.filter.updateChild(m,x,Ie.EMPTY_NODE,ct(r),g,u):p=m,p.isEmpty()&&n.serverCache.isFullyInitialized()&&(f=Lo(i,vr(n)),f.isLeafNode()&&(p=s.filter.updateFullNode(p,f,u)))}return f=n.serverCache.isFullyInitialized()||zo(i,Pe())!=null,Al(n,p,f,s.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lT{constructor(n,r){this.query_=n,this.eventRegistrations_=[];const i=this.query_._queryParams,c=new yh(i.getIndex()),u=TN(i);this.processor_=ZN(u);const f=r.serverCache,g=r.eventCache,m=c.updateFullNode(Ie.EMPTY_NODE,f.getNode(),null),p=u.updateFullNode(Ie.EMPTY_NODE,g.getNode(),null),x=new Fa(m,f.isFullyInitialized(),c.filtersNodes()),b=new Fa(p,g.isFullyInitialized(),u.filtersNodes());this.viewCache_=Qo(b,x),this.eventGenerator_=new RN(this.query_)}get query(){return this.query_}}function iT(s){return s.viewCache_.serverCache.getNode()}function oT(s){return Uo(s.viewCache_)}function cT(s,n){const r=vr(s.viewCache_);return r&&(s.query._queryParams.loadsAllData()||!Ge(n)&&!r.getImmediateChild(Be(n)).isEmpty())?r.getChild(n):null}function Np(s){return s.eventRegistrations_.length===0}function dT(s,n){s.eventRegistrations_.push(n)}function Tp(s,n,r){const i=[];if(r){fe(n==null,"A cancel should cancel all event registrations.");const c=s.query._path;s.eventRegistrations_.forEach(u=>{const f=u.createCancelEvent(r,c);f&&i.push(f)})}if(n){let c=[];for(let u=0;u<s.eventRegistrations_.length;++u){const f=s.eventRegistrations_[u];if(!f.matches(n))c.push(f);else if(n.hasAnyCallback()){c=c.concat(s.eventRegistrations_.slice(u+1));break}}s.eventRegistrations_=c}else s.eventRegistrations_=[];return i}function jp(s,n,r,i){n.type===Rn.MERGE&&n.source.queryId!==null&&(fe(vr(s.viewCache_),"We should always have a full cache before handling merges"),fe(Uo(s.viewCache_),"Missing event cache, even though we have a server cache"));const c=s.viewCache_,u=eT(s.processor_,c,n,r,i);return JN(s.processor_,u.viewCache),fe(u.viewCache.serverCache.isFullyInitialized()||!c.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),s.viewCache_=u.viewCache,hx(s,u.changes,u.viewCache.eventCache.getNode(),null)}function uT(s,n){const r=s.viewCache_.eventCache,i=[];return r.getNode().isLeafNode()||r.getNode().forEachChild(pt,(u,f)=>{i.push(ys(u,f))}),r.isFullyInitialized()&&i.push(tx(r.getNode())),hx(s,i,r.getNode(),n)}function hx(s,n,r,i){const c=i?[i]:s.eventRegistrations_;return ON(s.eventGenerator_,n,r,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $o;class fx{constructor(){this.views=new Map}}function hT(s){fe(!$o,"__referenceConstructor has already been defined"),$o=s}function fT(){return fe($o,"Reference.ts has not been loaded"),$o}function gT(s){return s.views.size===0}function Nh(s,n,r,i){const c=n.source.queryId;if(c!==null){const u=s.views.get(c);return fe(u!=null,"SyncTree gave us an op for an invalid query."),jp(u,n,r,i)}else{let u=[];for(const f of s.views.values())u=u.concat(jp(f,n,r,i));return u}}function gx(s,n,r,i,c){const u=n._queryIdentifier,f=s.views.get(u);if(!f){let g=Lo(r,c?i:null),m=!1;g?m=!0:i instanceof Ie?(g=wh(r,i),m=!1):(g=Ie.EMPTY_NODE,m=!1);const p=Qo(new Fa(g,m,!1),new Fa(i,c,!1));return new lT(n,p)}return f}function mT(s,n,r,i,c,u){const f=gx(s,n,i,c,u);return s.views.has(n._queryIdentifier)||s.views.set(n._queryIdentifier,f),dT(f,r),uT(f,r)}function pT(s,n,r,i){const c=n._queryIdentifier,u=[];let f=[];const g=Ga(s);if(c==="default")for(const[m,p]of s.views.entries())f=f.concat(Tp(p,r,i)),Np(p)&&(s.views.delete(m),p.query._queryParams.loadsAllData()||u.push(p.query));else{const m=s.views.get(c);m&&(f=f.concat(Tp(m,r,i)),Np(m)&&(s.views.delete(c),m.query._queryParams.loadsAllData()||u.push(m.query)))}return g&&!Ga(s)&&u.push(new(fT())(n._repo,n._path)),{removed:u,events:f}}function mx(s){const n=[];for(const r of s.views.values())r.query._queryParams.loadsAllData()||n.push(r);return n}function qa(s,n){let r=null;for(const i of s.views.values())r=r||cT(i,n);return r}function px(s,n){if(n._queryParams.loadsAllData())return Ko(s);{const i=n._queryIdentifier;return s.views.get(i)}}function yx(s,n){return px(s,n)!=null}function Ga(s){return Ko(s)!=null}function Ko(s){for(const n of s.views.values())if(n.query._queryParams.loadsAllData())return n;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bo;function yT(s){fe(!Bo,"__referenceConstructor has already been defined"),Bo=s}function xT(){return fe(Bo,"Reference.ts has not been loaded"),Bo}let bT=1;class Sp{constructor(n){this.listenProvider_=n,this.syncPointTree_=new dt(null),this.pendingWriteTree_=PN(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function xx(s,n,r,i,c){return LN(s.pendingWriteTree_,n,r,i,c),c?Kl(s,new br(ax(),n,r)):[]}function pr(s,n,r=!1){const i=zN(s.pendingWriteTree_,n);if(HN(s.pendingWriteTree_,n)){let u=new dt(null);return i.snap!=null?u=u.set(Pe(),!0):rn(i.children,f=>{u=u.set(new it(f),!0)}),Kl(s,new Io(i.path,u,r))}else return[]}function Xl(s,n,r){return Kl(s,new br(bh(),n,r))}function vT(s,n,r){const i=dt.fromObject(r);return Kl(s,new Bl(bh(),n,i))}function wT(s,n){return Kl(s,new $l(bh(),n))}function _T(s,n,r){const i=jh(s,r);if(i){const c=Sh(i),u=c.path,f=c.queryId,g=Pt(u,n),m=new $l(vh(f),g);return Dh(s,u,m)}else return[]}function qo(s,n,r,i,c=!1){const u=n._path,f=s.syncPointTree_.get(u);let g=[];if(f&&(n._queryIdentifier==="default"||yx(f,n))){const m=pT(f,n,r,i);gT(f)&&(s.syncPointTree_=s.syncPointTree_.remove(u));const p=m.removed;if(g=m.events,!c){const x=p.findIndex(w=>w._queryParams.loadsAllData())!==-1,b=s.syncPointTree_.findOnPath(u,(w,L)=>Ga(L));if(x&&!b){const w=s.syncPointTree_.subtree(u);if(!w.isEmpty()){const L=TT(w);for(let T=0;T<L.length;++T){const z=L[T],W=z.query,k=_x(s,z);s.listenProvider_.startListening(Ol(W),ql(s,W),k.hashFn,k.onComplete)}}}!b&&p.length>0&&!i&&(x?s.listenProvider_.stopListening(Ol(n),null):p.forEach(w=>{const L=s.queryToTagMap.get(Zo(w));s.listenProvider_.stopListening(Ol(w),L)}))}jT(s,p)}return g}function bx(s,n,r,i){const c=jh(s,i);if(c!=null){const u=Sh(c),f=u.path,g=u.queryId,m=Pt(f,n),p=new br(vh(g),m,r);return Dh(s,f,p)}else return[]}function kT(s,n,r,i){const c=jh(s,i);if(c){const u=Sh(c),f=u.path,g=u.queryId,m=Pt(f,n),p=dt.fromObject(r),x=new Bl(vh(g),m,p);return Dh(s,f,x)}else return[]}function Qu(s,n,r,i=!1){const c=n._path;let u=null,f=!1;s.syncPointTree_.foreachOnPath(c,(w,L)=>{const T=Pt(w,c);u=u||qa(L,T),f=f||Ga(L)});let g=s.syncPointTree_.get(c);g?(f=f||Ga(g),u=u||qa(g,Pe())):(g=new fx,s.syncPointTree_=s.syncPointTree_.set(c,g));let m;u!=null?m=!0:(m=!1,u=Ie.EMPTY_NODE,s.syncPointTree_.subtree(c).foreachChild((L,T)=>{const z=qa(T,Pe());z&&(u=u.updateImmediateChild(L,z))}));const p=yx(g,n);if(!p&&!n._queryParams.loadsAllData()){const w=Zo(n);fe(!s.queryToTagMap.has(w),"View does not exist, but we have a tag");const L=ST();s.queryToTagMap.set(w,L),s.tagToQueryMap.set(L,w)}const x=Xo(s.pendingWriteTree_,c);let b=mT(g,n,r,x,u,m);if(!p&&!f&&!i){const w=px(g,n);b=b.concat(DT(s,n,w))}return b}function Th(s,n,r){const c=s.pendingWriteTree_,u=s.syncPointTree_.findOnPath(n,(f,g)=>{const m=Pt(f,n),p=qa(g,m);if(p)return p});return ix(c,n,u,r,!0)}function NT(s,n){const r=n._path;let i=null;s.syncPointTree_.foreachOnPath(r,(p,x)=>{const b=Pt(p,r);i=i||qa(x,b)});let c=s.syncPointTree_.get(r);c?i=i||qa(c,Pe()):(c=new fx,s.syncPointTree_=s.syncPointTree_.set(r,c));const u=i!=null,f=u?new Fa(i,!0,!1):null,g=Xo(s.pendingWriteTree_,n._path),m=gx(c,n,g,u?f.getNode():Ie.EMPTY_NODE,u);return oT(m)}function Kl(s,n){return vx(n,s.syncPointTree_,null,Xo(s.pendingWriteTree_,Pe()))}function vx(s,n,r,i){if(Ge(s.path))return wx(s,n,r,i);{const c=n.get(Pe());r==null&&c!=null&&(r=qa(c,Pe()));let u=[];const f=Be(s.path),g=s.operationForChild(f),m=n.children.get(f);if(m&&g){const p=r?r.getImmediateChild(f):null,x=ox(i,f);u=u.concat(vx(g,m,p,x))}return c&&(u=u.concat(Nh(c,s,i,r))),u}}function wx(s,n,r,i){const c=n.get(Pe());r==null&&c!=null&&(r=qa(c,Pe()));let u=[];return n.children.inorderTraversal((f,g)=>{const m=r?r.getImmediateChild(f):null,p=ox(i,f),x=s.operationForChild(f);x&&(u=u.concat(wx(x,g,m,p)))}),c&&(u=u.concat(Nh(c,s,i,r))),u}function _x(s,n){const r=n.query,i=ql(s,r);return{hashFn:()=>(iT(n)||Ie.EMPTY_NODE).hash(),onComplete:c=>{if(c==="ok")return i?_T(s,r._path,i):wT(s,r._path);{const u=Nk(c,r);return qo(s,r,null,u)}}}}function ql(s,n){const r=Zo(n);return s.queryToTagMap.get(r)}function Zo(s){return s._path.toString()+"$"+s._queryIdentifier}function jh(s,n){return s.tagToQueryMap.get(n)}function Sh(s){const n=s.indexOf("$");return fe(n!==-1&&n<s.length-1,"Bad queryKey."),{queryId:s.substr(n+1),path:new it(s.substr(0,n))}}function Dh(s,n,r){const i=s.syncPointTree_.get(n);fe(i,"Missing sync point for query tag that we're tracking");const c=Xo(s.pendingWriteTree_,n);return Nh(i,r,c,null)}function TT(s){return s.fold((n,r,i)=>{if(r&&Ga(r))return[Ko(r)];{let c=[];return r&&(c=mx(r)),rn(i,(u,f)=>{c=c.concat(f)}),c}})}function Ol(s){return s._queryParams.loadsAllData()&&!s._queryParams.isDefault()?new(xT())(s._repo,s._path):s}function jT(s,n){for(let r=0;r<n.length;++r){const i=n[r];if(!i._queryParams.loadsAllData()){const c=Zo(i),u=s.queryToTagMap.get(c);s.queryToTagMap.delete(c),s.tagToQueryMap.delete(u)}}}function ST(){return bT++}function DT(s,n,r){const i=n._path,c=ql(s,n),u=_x(s,r),f=s.listenProvider_.startListening(Ol(n),c,u.hashFn,u.onComplete),g=s.syncPointTree_.subtree(i);if(c)fe(!Ga(g.value),"If we're adding a query, it shouldn't be shadowed");else{const m=g.fold((p,x,b)=>{if(!Ge(p)&&x&&Ga(x))return[Ko(x).query];{let w=[];return x&&(w=w.concat(mx(x).map(L=>L.query))),rn(b,(L,T)=>{w=w.concat(T)}),w}});for(let p=0;p<m.length;++p){const x=m[p];s.listenProvider_.stopListening(Ol(x),ql(s,x))}}return f}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(n){this.node_=n}getImmediateChild(n){const r=this.node_.getImmediateChild(n);return new Eh(r)}node(){return this.node_}}class Ch{constructor(n,r){this.syncTree_=n,this.path_=r}getImmediateChild(n){const r=jt(this.path_,n);return new Ch(this.syncTree_,r)}node(){return Th(this.syncTree_,this.path_)}}const ET=function(s){return s=s||{},s.timestamp=s.timestamp||new Date().getTime(),s},Dp=function(s,n,r){if(!s||typeof s!="object")return s;if(fe(".sv"in s,"Unexpected leaf node or priority contents"),typeof s[".sv"]=="string")return CT(s[".sv"],n,r);if(typeof s[".sv"]=="object")return AT(s[".sv"],n);fe(!1,"Unexpected server value: "+JSON.stringify(s,null,2))},CT=function(s,n,r){switch(s){case"timestamp":return r.timestamp;default:fe(!1,"Unexpected server value: "+s)}},AT=function(s,n,r){s.hasOwnProperty("increment")||fe(!1,"Unexpected server value: "+JSON.stringify(s,null,2));const i=s.increment;typeof i!="number"&&fe(!1,"Unexpected increment value: "+i);const c=n.node();if(fe(c!==null&&typeof c<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!c.isLeafNode())return i;const f=c.getValue();return typeof f!="number"?i:f+i},RT=function(s,n,r,i){return Ah(n,new Ch(r,s),i)},kx=function(s,n,r){return Ah(s,new Eh(n),r)};function Ah(s,n,r){const i=s.getPriority().val(),c=Dp(i,n.getImmediateChild(".priority"),r);let u;if(s.isLeafNode()){const f=s,g=Dp(f.getValue(),n,r);return g!==f.getValue()||c!==f.getPriority().val()?new Ot(g,Lt(c)):s}else{const f=s;return u=f,c!==f.getPriority().val()&&(u=u.updatePriority(new Ot(c))),f.forEachChild(pt,(g,m)=>{const p=Ah(m,n.getImmediateChild(g),r);p!==m&&(u=u.updateImmediateChild(g,p))}),u}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(n="",r=null,i={children:{},childCount:0}){this.name=n,this.parent=r,this.node=i}}function Oh(s,n){let r=n instanceof it?n:new it(n),i=s,c=Be(r);for(;c!==null;){const u=ms(i.node.children,c)||{children:{},childCount:0};i=new Rh(c,i,u),r=ct(r),c=Be(r)}return i}function _s(s){return s.node.value}function Nx(s,n){s.node.value=n,Xu(s)}function Tx(s){return s.node.childCount>0}function OT(s){return _s(s)===void 0&&!Tx(s)}function Jo(s,n){rn(s.node.children,(r,i)=>{n(new Rh(r,s,i))})}function jx(s,n,r,i){r&&n(s),Jo(s,c=>{jx(c,n,!0)})}function MT(s,n,r){let i=s.parent;for(;i!==null;){if(n(i))return!0;i=i.parent}return!1}function Zl(s){return new it(s.parent===null?s.name:Zl(s.parent)+"/"+s.name)}function Xu(s){s.parent!==null&&IT(s.parent,s.name,s)}function IT(s,n,r){const i=OT(r),c=da(s.node.children,n);i&&c?(delete s.node.children[n],s.node.childCount--,Xu(s)):!i&&!c&&(s.node.children[n]=r.node,s.node.childCount++,Xu(s))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UT=/[\[\].#$\/\u0000-\u001F\u007F]/,LT=/[\[\].#$\u0000-\u001F\u007F]/,Mu=10*1024*1024,Sx=function(s){return typeof s=="string"&&s.length!==0&&!UT.test(s)},Dx=function(s){return typeof s=="string"&&s.length!==0&&!LT.test(s)},zT=function(s){return s&&(s=s.replace(/^\/*\.info(\/|$)/,"/")),Dx(s)},Ex=function(s,n,r,i){i&&n===void 0||Mh(sh(s,"value"),n,r)},Mh=function(s,n,r){const i=r instanceof it?new aN(r,s):r;if(n===void 0)throw new Error(s+"contains undefined "+hr(i));if(typeof n=="function")throw new Error(s+"contains a function "+hr(i)+" with contents = "+n.toString());if(Ty(n))throw new Error(s+"contains "+n.toString()+" "+hr(i));if(typeof n=="string"&&n.length>Mu/3&&Go(n)>Mu)throw new Error(s+"contains a string greater than "+Mu+" utf8 bytes "+hr(i)+" ('"+n.substring(0,50)+"...')");if(n&&typeof n=="object"){let c=!1,u=!1;if(rn(n,(f,g)=>{if(f===".value")c=!0;else if(f!==".priority"&&f!==".sv"&&(u=!0,!Sx(f)))throw new Error(s+" contains an invalid key ("+f+") "+hr(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);rN(i,f),Mh(s,g,i),sN(i)}),c&&u)throw new Error(s+' contains ".value" child '+hr(i)+" in addition to actual children.")}},Cx=function(s,n,r,i){if(!Dx(r))throw new Error(sh(s,n)+'was an invalid path = "'+r+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},HT=function(s,n,r,i){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),Cx(s,n,r)},Ih=function(s,n){if(Be(n)===".info")throw new Error(s+" failed = Can't modify data under /.info/")},$T=function(s,n){const r=n.path.toString();if(typeof n.repoInfo.host!="string"||n.repoInfo.host.length===0||!Sx(n.repoInfo.namespace)&&n.repoInfo.host.split(":")[0]!=="localhost"||r.length!==0&&!zT(r))throw new Error(sh(s,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Uh(s,n){let r=null;for(let i=0;i<n.length;i++){const c=n[i],u=c.getPath();r!==null&&!gh(u,r.path)&&(s.eventLists_.push(r),r=null),r===null&&(r={events:[],path:u}),r.events.push(c)}r&&s.eventLists_.push(r)}function Ax(s,n,r){Uh(s,r),Rx(s,i=>gh(i,n))}function qn(s,n,r){Uh(s,r),Rx(s,i=>An(i,n)||An(n,i))}function Rx(s,n){s.recursionDepth_++;let r=!0;for(let i=0;i<s.eventLists_.length;i++){const c=s.eventLists_[i];if(c){const u=c.path;n(u)?(qT(s.eventLists_[i]),s.eventLists_[i]=null):r=!1}}r&&(s.eventLists_=[]),s.recursionDepth_--}function qT(s){for(let n=0;n<s.events.length;n++){const r=s.events[n];if(r!==null){s.events[n]=null;const i=r.getEventRunner();El&&Gt("event: "+r.toString()),ws(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YT="repo_interrupt",FT=25;class GT{constructor(n,r,i,c){this.repoInfo_=n,this.forceRestClient_=r,this.authTokenProvider_=i,this.appCheckProvider_=c,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new BT,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Mo(),this.transactionQueueTree_=new Rh,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function VT(s,n,r){if(s.stats_=hh(s.repoInfo_),s.forceRestClient_||Dk())s.server_=new Oo(s.repoInfo_,(i,c,u,f)=>{Ep(s,i,c,u,f)},s.authTokenProvider_,s.appCheckProvider_),setTimeout(()=>Cp(s,!0),0);else{if(typeof r<"u"&&r!==null){if(typeof r!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Tt(r)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}s.persistentConnection_=new oa(s.repoInfo_,n,(i,c,u,f)=>{Ep(s,i,c,u,f)},i=>{Cp(s,i)},i=>{WT(s,i)},s.authTokenProvider_,s.appCheckProvider_,r),s.server_=s.persistentConnection_}s.authTokenProvider_.addTokenChangeListener(i=>{s.server_.refreshAuthToken(i)}),s.appCheckProvider_.addTokenChangeListener(i=>{s.server_.refreshAppCheckToken(i.token)}),s.statsReporter_=Ok(s.repoInfo_,()=>new AN(s.stats_,s.server_)),s.infoData_=new jN,s.infoSyncTree_=new Sp({startListening:(i,c,u,f)=>{let g=[];const m=s.infoData_.getNode(i._path);return m.isEmpty()||(g=Xl(s.infoSyncTree_,i._path,m),setTimeout(()=>{f("ok")},0)),g},stopListening:()=>{}}),zh(s,"connected",!1),s.serverSyncTree_=new Sp({startListening:(i,c,u,f)=>(s.server_.listen(i,u,c,(g,m)=>{const p=f(g,m);qn(s.eventQueue_,i._path,p)}),[]),stopListening:(i,c)=>{s.server_.unlisten(i,c)}})}function Ox(s){const r=s.infoData_.getNode(new it(".info/serverTimeOffset")).val()||0;return new Date().getTime()+r}function Lh(s){return ET({timestamp:Ox(s)})}function Ep(s,n,r,i,c){s.dataUpdateCount++;const u=new it(n);r=s.interceptServerDataCallback_?s.interceptServerDataCallback_(n,r):r;let f=[];if(c)if(i){const m=To(r,p=>Lt(p));f=kT(s.serverSyncTree_,u,m,c)}else{const m=Lt(r);f=bx(s.serverSyncTree_,u,m,c)}else if(i){const m=To(r,p=>Lt(p));f=vT(s.serverSyncTree_,u,m)}else{const m=Lt(r);f=Xl(s.serverSyncTree_,u,m)}let g=u;f.length>0&&(g=tc(s,u)),qn(s.eventQueue_,g,f)}function Cp(s,n){zh(s,"connected",n),n===!1&&XT(s)}function WT(s,n){rn(n,(r,i)=>{zh(s,r,i)})}function zh(s,n,r){const i=new it("/.info/"+n),c=Lt(r);s.infoData_.updateSnapshot(i,c);const u=Xl(s.infoSyncTree_,i,c);qn(s.eventQueue_,i,u)}function Mx(s){return s.nextWriteId_++}function PT(s,n,r){const i=NT(s.serverSyncTree_,n);return i!=null?Promise.resolve(i):s.server_.get(n).then(c=>{const u=Lt(c).withIndex(n._queryParams.getIndex());Qu(s.serverSyncTree_,n,r,!0);let f;if(n._queryParams.loadsAllData())f=Xl(s.serverSyncTree_,n._path,u);else{const g=ql(s.serverSyncTree_,n);f=bx(s.serverSyncTree_,n._path,u,g)}return qn(s.eventQueue_,n._path,f),qo(s.serverSyncTree_,n,r,null,!0),u},c=>(ec(s,"get for query "+Tt(n)+" failed: "+c),Promise.reject(new Error(c))))}function QT(s,n,r,i,c){ec(s,"set",{path:n.toString(),value:r,priority:i});const u=Lh(s),f=Lt(r,i),g=Th(s.serverSyncTree_,n),m=kx(f,g,u),p=Mx(s),x=xx(s.serverSyncTree_,n,m,p,!0);Uh(s.eventQueue_,x),s.server_.put(n.toString(),f.val(!0),(w,L)=>{const T=w==="ok";T||nn("set at "+n+" failed: "+w);const z=pr(s.serverSyncTree_,p,!T);qn(s.eventQueue_,n,z),e1(s,c,w,L)});const b=Hx(s,n);tc(s,b),qn(s.eventQueue_,b,[])}function XT(s){ec(s,"onDisconnectEvents");const n=Lh(s),r=Mo();Fu(s.onDisconnect_,Pe(),(c,u)=>{const f=RT(c,u,s.serverSyncTree_,n);nx(r,c,f)});let i=[];Fu(r,Pe(),(c,u)=>{i=i.concat(Xl(s.serverSyncTree_,c,u));const f=Hx(s,c);tc(s,f)}),s.onDisconnect_=Mo(),qn(s.eventQueue_,Pe(),i)}function KT(s,n,r){let i;Be(n._path)===".info"?i=Qu(s.infoSyncTree_,n,r):i=Qu(s.serverSyncTree_,n,r),Ax(s.eventQueue_,n._path,i)}function ZT(s,n,r){let i;Be(n._path)===".info"?i=qo(s.infoSyncTree_,n,r):i=qo(s.serverSyncTree_,n,r),Ax(s.eventQueue_,n._path,i)}function JT(s){s.persistentConnection_&&s.persistentConnection_.interrupt(YT)}function ec(s,...n){let r="";s.persistentConnection_&&(r=s.persistentConnection_.id+":"),Gt(r,...n)}function e1(s,n,r,i){n&&ws(()=>{if(r==="ok")n(null);else{const c=(r||"error").toUpperCase();let u=c;i&&(u+=": "+i);const f=new Error(u);f.code=c,n(f)}})}function Ix(s,n,r){return Th(s.serverSyncTree_,n,r)||Ie.EMPTY_NODE}function Hh(s,n=s.transactionQueueTree_){if(n||nc(s,n),_s(n)){const r=Lx(s,n);fe(r.length>0,"Sending zero length transaction queue"),r.every(c=>c.status===0)&&t1(s,Zl(n),r)}else Tx(n)&&Jo(n,r=>{Hh(s,r)})}function t1(s,n,r){const i=r.map(p=>p.currentWriteId),c=Ix(s,n,i);let u=c;const f=c.hash();for(let p=0;p<r.length;p++){const x=r[p];fe(x.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),x.status=1,x.retryCount++;const b=Pt(n,x.path);u=u.updateChild(b,x.currentOutputSnapshotRaw)}const g=u.val(!0),m=n;s.server_.put(m.toString(),g,p=>{ec(s,"transaction put response",{path:m.toString(),status:p});let x=[];if(p==="ok"){const b=[];for(let w=0;w<r.length;w++)r[w].status=2,x=x.concat(pr(s.serverSyncTree_,r[w].currentWriteId)),r[w].onComplete&&b.push(()=>r[w].onComplete(null,!0,r[w].currentOutputSnapshotResolved)),r[w].unwatcher();nc(s,Oh(s.transactionQueueTree_,n)),Hh(s,s.transactionQueueTree_),qn(s.eventQueue_,n,x);for(let w=0;w<b.length;w++)ws(b[w])}else{if(p==="datastale")for(let b=0;b<r.length;b++)r[b].status===3?r[b].status=4:r[b].status=0;else{nn("transaction at "+m.toString()+" failed: "+p);for(let b=0;b<r.length;b++)r[b].status=4,r[b].abortReason=p}tc(s,n)}},f)}function tc(s,n){const r=Ux(s,n),i=Zl(r),c=Lx(s,r);return n1(s,c,i),i}function n1(s,n,r){if(n.length===0)return;const i=[];let c=[];const f=n.filter(g=>g.status===0).map(g=>g.currentWriteId);for(let g=0;g<n.length;g++){const m=n[g],p=Pt(r,m.path);let x=!1,b;if(fe(p!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),m.status===4)x=!0,b=m.abortReason,c=c.concat(pr(s.serverSyncTree_,m.currentWriteId,!0));else if(m.status===0)if(m.retryCount>=FT)x=!0,b="maxretry",c=c.concat(pr(s.serverSyncTree_,m.currentWriteId,!0));else{const w=Ix(s,m.path,f);m.currentInputSnapshot=w;const L=n[g].update(w.val());if(L!==void 0){Mh("transaction failed: Data returned ",L,m.path);let T=Lt(L);typeof L=="object"&&L!=null&&da(L,".priority")||(T=T.updatePriority(w.getPriority()));const W=m.currentWriteId,k=Lh(s),S=kx(T,w,k);m.currentOutputSnapshotRaw=T,m.currentOutputSnapshotResolved=S,m.currentWriteId=Mx(s),f.splice(f.indexOf(W),1),c=c.concat(xx(s.serverSyncTree_,m.path,S,m.currentWriteId,m.applyLocally)),c=c.concat(pr(s.serverSyncTree_,W,!0))}else x=!0,b="nodata",c=c.concat(pr(s.serverSyncTree_,m.currentWriteId,!0))}qn(s.eventQueue_,r,c),c=[],x&&(n[g].status=2,function(w){setTimeout(w,Math.floor(0))}(n[g].unwatcher),n[g].onComplete&&(b==="nodata"?i.push(()=>n[g].onComplete(null,!1,n[g].currentInputSnapshot)):i.push(()=>n[g].onComplete(new Error(b),!1,null))))}nc(s,s.transactionQueueTree_);for(let g=0;g<i.length;g++)ws(i[g]);Hh(s,s.transactionQueueTree_)}function Ux(s,n){let r,i=s.transactionQueueTree_;for(r=Be(n);r!==null&&_s(i)===void 0;)i=Oh(i,r),n=ct(n),r=Be(n);return i}function Lx(s,n){const r=[];return zx(s,n,r),r.sort((i,c)=>i.order-c.order),r}function zx(s,n,r){const i=_s(n);if(i)for(let c=0;c<i.length;c++)r.push(i[c]);Jo(n,c=>{zx(s,c,r)})}function nc(s,n){const r=_s(n);if(r){let i=0;for(let c=0;c<r.length;c++)r[c].status!==2&&(r[i]=r[c],i++);r.length=i,Nx(n,r.length>0?r:void 0)}Jo(n,i=>{nc(s,i)})}function Hx(s,n){const r=Zl(Ux(s,n)),i=Oh(s.transactionQueueTree_,n);return MT(i,c=>{Iu(s,c)}),Iu(s,i),jx(i,c=>{Iu(s,c)}),r}function Iu(s,n){const r=_s(n);if(r){const i=[];let c=[],u=-1;for(let f=0;f<r.length;f++)r[f].status===3||(r[f].status===1?(fe(u===f-1,"All SENT items should be at beginning of queue."),u=f,r[f].status=3,r[f].abortReason="set"):(fe(r[f].status===0,"Unexpected transaction status in abort"),r[f].unwatcher(),c=c.concat(pr(s.serverSyncTree_,r[f].currentWriteId,!0)),r[f].onComplete&&i.push(r[f].onComplete.bind(null,new Error("set"),!1,null))));u===-1?Nx(n,void 0):r.length=u+1,qn(s.eventQueue_,Zl(n),c);for(let f=0;f<i.length;f++)ws(i[f])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a1(s){let n="";const r=s.split("/");for(let i=0;i<r.length;i++)if(r[i].length>0){let c=r[i];try{c=decodeURIComponent(c.replace(/\+/g," "))}catch{}n+="/"+c}return n}function r1(s){const n={};s.charAt(0)==="?"&&(s=s.substring(1));for(const r of s.split("&")){if(r.length===0)continue;const i=r.split("=");i.length===2?n[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):nn(`Invalid query segment '${r}' in query '${s}'`)}return n}const Ap=function(s,n){const r=s1(s),i=r.namespace;r.domain==="firebase.com"&&ca(r.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&r.domain!=="localhost"&&ca("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),r.secure||bk();const c=r.scheme==="ws"||r.scheme==="wss";return{repoInfo:new Ly(r.host,r.secure,i,c,n,"",i!==r.subdomain),path:new it(r.pathString)}},s1=function(s){let n="",r="",i="",c="",u="",f=!0,g="https",m=443;if(typeof s=="string"){let p=s.indexOf("//");p>=0&&(g=s.substring(0,p-1),s=s.substring(p+2));let x=s.indexOf("/");x===-1&&(x=s.length);let b=s.indexOf("?");b===-1&&(b=s.length),n=s.substring(0,Math.min(x,b)),x<b&&(c=a1(s.substring(x,b)));const w=r1(s.substring(Math.min(s.length,b)));p=n.indexOf(":"),p>=0?(f=g==="https"||g==="wss",m=parseInt(n.substring(p+1),10)):p=n.length;const L=n.slice(0,p);if(L.toLowerCase()==="localhost")r="localhost";else if(L.split(".").length<=2)r=L;else{const T=n.indexOf(".");i=n.substring(0,T).toLowerCase(),r=n.substring(T+1),u=i}"ns"in w&&(u=w.ns)}return{host:n,port:m,domain:r,subdomain:i,secure:f,scheme:g,pathString:c,namespace:u}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rp="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",l1=function(){let s=0;const n=[];return function(r){const i=r===s;s=r;let c;const u=new Array(8);for(c=7;c>=0;c--)u[c]=Rp.charAt(r%64),r=Math.floor(r/64);fe(r===0,"Cannot push at time == 0");let f=u.join("");if(i){for(c=11;c>=0&&n[c]===63;c--)n[c]=0;n[c]++}else for(c=0;c<12;c++)n[c]=Math.floor(Math.random()*64);for(c=0;c<12;c++)f+=Rp.charAt(n[c]);return fe(f.length===20,"nextPushId: Length should be 20."),f}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{constructor(n,r,i,c){this.eventType=n,this.eventRegistration=r,this.snapshot=i,this.prevName=c}getPath(){const n=this.snapshot.ref;return this.eventType==="value"?n._path:n.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Tt(this.snapshot.exportVal())}}class o1{constructor(n,r,i){this.eventRegistration=n,this.error=r,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $x{constructor(n,r){this.snapshotCallback=n,this.cancelCallback=r}onValue(n,r){this.snapshotCallback.call(null,n,r)}onCancel(n){return fe(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,n)}get hasCancelCallback(){return!!this.cancelCallback}matches(n){return this.snapshotCallback===n.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===n.snapshotCallback.userCallback&&this.snapshotCallback.context===n.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(n,r,i,c){this._repo=n,this._path=r,this._queryParams=i,this._orderByCalled=c}get key(){return Ge(this._path)?null:Vy(this._path)}get ref(){return new ua(this._repo,this._path)}get _queryIdentifier(){const n=pp(this._queryParams),r=dh(n);return r==="{}"?"default":r}get _queryObject(){return pp(this._queryParams)}isEqual(n){if(n=Va(n),!(n instanceof $h))return!1;const r=this._repo===n._repo,i=gh(this._path,n._path),c=this._queryIdentifier===n._queryIdentifier;return r&&i&&c}toJSON(){return this.toString()}toString(){return this._repo.toString()+nN(this._path)}}class ua extends $h{constructor(n,r){super(n,r,new xh,!1)}get parent(){const n=Py(this._path);return n===null?null:new ua(this._repo,n)}get root(){let n=this;for(;n.parent!==null;)n=n.parent;return n}}class Yl{constructor(n,r,i){this._node=n,this.ref=r,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(n){const r=new it(n),i=Fl(this.ref,n);return new Yl(this._node.getChild(r),i,pt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(n){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,c)=>n(new Yl(c,Fl(this.ref,i),pt)))}hasChild(n){const r=new it(n);return!this._node.getChild(r).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Hn(s,n){return s=Va(s),s._checkNotDeleted("ref"),n!==void 0?Fl(s._root,n):s._root}function Fl(s,n){return s=Va(s),Be(s._path)===null?HT("child","path",n):Cx("child","path",n),new ua(s._repo,jt(s._path,n))}function c1(s,n){s=Va(s),Ih("push",s._path),Ex("push",n,s._path,!0);const r=Ox(s._repo),i=l1(r),c=Fl(s,i),u=Fl(s,i);let f;return f=Promise.resolve(u),c.then=f.then.bind(f),c.catch=f.then.bind(f,void 0),c}function Op(s){return Ih("remove",s._path),ds(s,null)}function ds(s,n){s=Va(s),Ih("set",s._path),Ex("set",n,s._path,!1);const r=new lh;return QT(s._repo,s._path,n,null,r.wrapCallback(()=>{})),r.promise}function Uu(s){s=Va(s);const n=new $x(()=>{}),r=new ac(n);return PT(s._repo,s,r).then(i=>new Yl(i,new ua(s._repo,s._path),s._queryParams.getIndex()))}class ac{constructor(n){this.callbackContext=n}respondsTo(n){return n==="value"}createEvent(n,r){const i=r._queryParams.getIndex();return new i1("value",this,new Yl(n.snapshotNode,new ua(r._repo,r._path),i))}getEventRunner(n){return n.getEventType()==="cancel"?()=>this.callbackContext.onCancel(n.error):()=>this.callbackContext.onValue(n.snapshot,null)}createCancelEvent(n,r){return this.callbackContext.hasCancelCallback?new o1(this,n,r):null}matches(n){return n instanceof ac?!n.callbackContext||!this.callbackContext?!0:n.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function d1(s,n,r,i,c){const u=new $x(r,void 0),f=new ac(u);return KT(s._repo,s,f),()=>ZT(s._repo,s,f)}function Mp(s,n,r,i){return d1(s,"value",n)}hT(ua);yT(ua);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u1="FIREBASE_DATABASE_EMULATOR_HOST",Ku={};let h1=!1;function f1(s,n,r,i){const c=n.lastIndexOf(":"),u=n.substring(0,c),f=ah(u);s.repoInfo_=new Ly(n,f,s.repoInfo_.namespace,s.repoInfo_.webSocketOnly,s.repoInfo_.nodeAdmin,s.repoInfo_.persistenceKey,s.repoInfo_.includeNamespaceInQueryParams,!0,r),i&&(s.authTokenProvider_=i)}function g1(s,n,r,i,c){let u=i||s.options.databaseURL;u===void 0&&(s.options.projectId||ca("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Gt("Using default host for project ",s.options.projectId),u=`${s.options.projectId}-default-rtdb.firebaseio.com`);let f=Ap(u,c),g=f.repoInfo,m;typeof process<"u"&&Zm&&(m=Zm[u1]),m?(u=`http://${m}?ns=${g.namespace}`,f=Ap(u,c),g=f.repoInfo):f.repoInfo.secure;const p=new Ck(s.name,s.options,n);$T("Invalid Firebase Database URL",f),Ge(f.path)||ca("Database URL must point to the root of a Firebase Database (not including a child path).");const x=p1(g,s,p,new Ek(s,r));return new y1(x,s)}function m1(s,n){const r=Ku[n];(!r||r[s.key]!==s)&&ca(`Database ${n}(${s.repoInfo_}) has already been deleted.`),JT(s),delete r[s.key]}function p1(s,n,r,i){let c=Ku[n.name];c||(c={},Ku[n.name]=c);let u=c[s.toURLString()];return u&&ca("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),u=new GT(s,h1,r,i),c[s.toURLString()]=u,u}class y1{constructor(n,r){this._repoInternal=n,this.app=r,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(VT(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ua(this._repo,Pe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(m1(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(n){this._rootInternal===null&&ca("Cannot call "+n+" on a deleted database.")}}function x1(s=Qp(),n){const r=Xp(s,"database").getImmediate({identifier:n});if(!r._instanceStarted){const i=Kp("database");i&&b1(r,...i)}return r}function b1(s,n,r,i={}){s=Va(s),s._checkNotDeleted("useEmulator");const c=`${n}:${r}`,u=s._repoInternal;if(s._instanceStarted){if(c===s._repoInternal.repoInfo_.host&&a_(i,u.repoInfo_.emulatorOptions))return;ca("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let f;if(u.repoInfo_.nodeAdmin)i.mockUserToken&&ca('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),f=new vo(vo.OWNER);else if(i.mockUserToken){const g=typeof i.mockUserToken=="string"?i.mockUserToken:ey(i.mockUserToken,s.app.options.projectId);f=new vo(g)}ah(n)&&(Zp(n),Jp("Database",!0)),f1(u,c,i,f)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v1(s){fk(Wp),Gp(new Vp("database",(n,{instanceIdentifier:r})=>{const i=n.getProvider("app").getImmediate(),c=n.getProvider("auth-internal"),u=n.getProvider("app-check-internal");return g1(i,c,u,r)},"PUBLIC").setMultipleInstances(!0)),No(Jm,ep,s),No(Jm,ep,"esm2020")}oa.prototype.simpleListen=function(s,n){this.sendRequest("q",{p:s},n)};oa.prototype.echo=function(s,n){this.sendRequest("echo",{d:s},n)};v1();const w1={apiKey:"AIzaSyCaQ6ndqGrR_x6fvTrZxdf5cHTNnRIj2Gg",authDomain:"busvacation-e894a.firebaseapp.com",databaseURL:"https://busvacation-e894a-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"busvacation-e894a",storageBucket:"busvacation-e894a.appspot.com",messagingSenderId:"919121046118",appId:"1:919121046118:web:033047c3f1bba2164e5ba7"},_1=()=>{const s=ty().find(n=>n.name==="vacation-management");return s||ny(w1,"vacation-management")},k1=_1(),$n=x1(k1);class N1{constructor(){this.listeners=new Map}listeners;sanitizeDepartmentCode(n){try{return btoa(encodeURIComponent(n)).replace(/[/+=]/g,"_")}catch{return n.replace(/[^a-zA-Z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"")}}getDepartmentPath(n,r){return`departments/${this.sanitizeDepartmentCode(n)}/${r}`}async getEmployees(n){const r=this.getDepartmentPath(n,"employees");try{const i=await Uu(Hn($n,r));return i.exists()?i.val():[]}catch(i){return console.error(` [${n}]    :`,i),[]}}async saveEmployees(n,r){const i=this.getDepartmentPath(n,"employees");try{return await ds(Hn($n,i),r),console.log(` [${n}]    `),{success:!0}}catch(c){return console.error(` [${n}]    :`,c),{success:!1,error:c}}}async getVacations(n){const r=this.getDepartmentPath(n,"vacations");try{const i=await Uu(Hn($n,r));if(i.exists()){const c=i.val();return Array.isArray(c)?c:Object.keys(c||{}).map(u=>({...c[u],id:u}))}return[]}catch(i){return console.error(` [${n}]    :`,i),[]}}async saveVacations(n,r){const i=this.getDepartmentPath(n,"vacations");try{return await ds(Hn($n,i),r),console.log(` [${n}]    `),{success:!0}}catch(c){return console.error(` [${n}]    :`,c),{success:!1,error:c}}}async addVacation(n,r){const i=this.getDepartmentPath(n,"vacations");try{const c=Hn($n,i),u=c1(c),f={...r,id:u.key,createdAt:Date.now(),updatedAt:Date.now()};return await ds(u,f),console.log(` [${n}]   :`,f.id),{success:!0,vacation:f}}catch(c){return console.error(` [${n}]   :`,c),{success:!1,error:c}}}async updateVacation(n,r,i){const c=`${this.getDepartmentPath(n,"vacations")}/${r}`;try{const u={...i,updatedAt:Date.now()};return await ds(Hn($n,c),u),console.log(` [${n}]   :`,r),{success:!0}}catch(u){return console.error(` [${n}]   :`,u),{success:!1,error:u}}}async deleteVacation(n,r){const i=`${this.getDepartmentPath(n,"vacations")}/${r}`;try{return await Op(Hn($n,i)),console.log(` [${n}]   :`,r),{success:!0}}catch(c){return console.error(` [${n}]   :`,c),{success:!1,error:c}}}subscribeToVacations(n,r){const i=this.getDepartmentPath(n,"vacations"),c=Hn($n,i),u=Mp(c,g=>{const m=g.exists()?g.val():[],p=Array.isArray(m)?m:Object.keys(m||{}).map(x=>({...m[x],id:x}));r(p)}),f=`vacations_${n}`;return this.listeners.set(f,{ref:c,unsubscribe:u}),()=>{u(),this.listeners.delete(f)}}subscribeToEmployees(n,r){const i=this.getDepartmentPath(n,"employees"),c=Hn($n,i),u=Mp(c,g=>{const m=g.exists()?g.val():[];r(m)}),f=`employees_${n}`;return this.listeners.set(f,{ref:c,unsubscribe:u}),()=>{u(),this.listeners.delete(f)}}async testConnection(){try{const n=Hn($n,"connection_test");await ds(n,{timestamp:Date.now(),test:!0});const r=await Uu(n),i=r.exists()&&r.val().test===!0;return i&&await Op(n),console.log(`  Firebase   ${i?"":""}`),i}catch(n){return console.error(" Firebase   :",n),!1}}cleanup(){console.log("  Firebase   ..."),this.listeners.forEach(({unsubscribe:n},r)=>{n(),console.log(`  : ${r}`)}),this.listeners.clear()}}const gr=new N1,Bx=O.createContext(void 0),T1=({children:s})=>{const{currentUser:n}=Nn(),[r,i]=O.useState([]),[c,u]=O.useState([]),[f,g]=O.useState(!1),[m,p]=O.useState(()=>{const T=localStorage.getItem("showVacationsInTodos");return T?JSON.parse(T):!0}),x=()=>{const T=!m;p(T),localStorage.setItem("showVacationsInTodos",JSON.stringify(T))},b=async()=>{if(!(!n||!$a(n.email))){g(!0);try{const[T,z]=await Promise.all([gr.getEmployees(""),gr.getVacations("")]);i(T),u(z)}catch(T){console.error("   :",T)}finally{g(!1)}}},w=T=>{if(!m)return[];const z=new Date(T.getTime()-T.getTimezoneOffset()*6e4),W=z.toISOString().split("T")[0];return console.log("  :",{originalDate:T,localDate:z,dateStr:W,availableVacations:c.map(k=>({id:k.id,date:k.date,type:k.type}))}),c.filter(k=>k.date===W)};O.useEffect(()=>{n&&$a(n.email)&&b()},[n]);const L={employees:r,vacations:c,loading:f,showVacationsInTodos:m,toggleVacationDisplay:x,refreshVacationData:b,getVacationsForDate:w};return l.jsx(Bx.Provider,{value:L,children:s})},Bh=()=>{const s=O.useContext(Bx);if(s===void 0)throw new Error("useVacation must be used within a VacationProvider");return s},qx=O.createContext(void 0),j1=({children:s,onOpenAddTodo:n,onFocusSearch:r,onToggleSidebar:i,onSwitchToTodayView:c,onSwitchToWeekView:u,onSwitchToMonthView:f})=>{const g={openAddTodoModal:n,focusSearch:r,toggleSidebar:i,switchToTodayView:c,switchToWeekView:u,switchToMonthView:f};return l.jsx(qx.Provider,{value:g,children:s})},S1=()=>{const s=O.useContext(qx);if(s===void 0)throw new Error("useKeyboard must be used within a KeyboardProvider");return s},Yx=O.createContext(void 0),D1=()=>{const s=O.useContext(Yx);if(s===void 0)throw new Error("useFontSize must be used within a FontSizeProvider");return s},E1=({children:s})=>{const[n,r]=O.useState(()=>{const i=localStorage.getItem("fontSizeLevel");if(i){const c=parseInt(i,10);if(c>=1&&c<=7)return c}return 4});return O.useEffect(()=>{localStorage.setItem("fontSizeLevel",n.toString());const i=document.documentElement;i.classList.remove("font-size-1","font-size-2","font-size-3","font-size-4","font-size-5","font-size-6","font-size-7"),i.classList.add(`font-size-${n}`);const c={1:.55,2:.65,3:.75,4:.85,5:.95,6:1.05,7:1.15};i.style.setProperty("--font-scale",c[n].toString())},[n]),l.jsx(Yx.Provider,{value:{fontSizeLevel:n,setFontSizeLevel:r},children:s})},C1=()=>{const{openAddTodoModal:s,focusSearch:n,toggleSidebar:r,switchToTodayView:i,switchToWeekView:c,switchToMonthView:u}=S1();O.useEffect(()=>{const f=m=>{if(m.ctrlKey||m.metaKey)switch(m.key.toLowerCase()){case"1":m.preventDefault(),i();break;case"2":m.preventDefault(),c();break;case"3":m.preventDefault(),u();break;case"b":m.preventDefault(),r();break;case"n":m.preventDefault(),s();break;case"f":m.preventDefault(),n();break;case"k":m.preventDefault(),g();break}if(m.key==="Escape"){const p=document.querySelectorAll('[role="dialog"]');if(p.length>0){m.preventDefault();const x=p[p.length-1].querySelector('[aria-label=""], [data-close]');x&&x.click()}}},g=()=>{alert(`  :

`+["Ctrl+1:  ","Ctrl+2:  ","Ctrl+3:  ","Ctrl+N:   ","Ctrl+F: ","Ctrl+B:  ","Ctrl+K:  ","ESC:  "].join(`
`))};return document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)},[s,n,r,i,c,u])};class A1{metrics=[];observers=[];constructor(){this.setupObservers(),this.measureInitialLoad()}setupObservers(){try{if("PerformanceObserver"in window){const n=new PerformanceObserver(u=>{const f=u.getEntries(),g=f[f.length-1];this.recordMetric("LCP",g.startTime,this.getRating("LCP",g.startTime))});n.observe({entryTypes:["largest-contentful-paint"]}),this.observers.push(n);const r=new PerformanceObserver(u=>{for(const f of u.getEntries()){const g=f.processingStart-f.startTime;this.recordMetric("FID",g,this.getRating("FID",g))}});r.observe({entryTypes:["first-input"]}),this.observers.push(r);let i=0;const c=new PerformanceObserver(u=>{for(const f of u.getEntries())f.hadRecentInput||(i+=f.value);this.recordMetric("CLS",i,this.getRating("CLS",i))});c.observe({entryTypes:["layout-shift"]}),this.observers.push(c)}}catch(n){De.error("Performance observer setup failed:",n)}}measureInitialLoad(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>this.collectNavigationMetrics()):this.collectNavigationMetrics()}collectNavigationMetrics(){if(performance.getEntriesByType){const n=performance.getEntriesByType("navigation")[0];if(n){const r=n.responseStart-n.requestStart;this.recordMetric("TTFB",r,this.getRating("TTFB",r));const i=n.domContentLoadedEventEnd-n.domContentLoadedEventStart;this.recordMetric("DOM_LOADED",i,this.getRating("DOM_LOADED",i));const c=n.loadEventEnd-n.loadEventStart;this.recordMetric("LOAD_COMPLETE",c,this.getRating("LOAD_COMPLETE",c))}}}getRating(n,r){const c={LCP:{good:2500,poor:4e3},FID:{good:100,poor:300},CLS:{good:.1,poor:.25},TTFB:{good:800,poor:1800},DOM_LOADED:{good:1e3,poor:3e3},LOAD_COMPLETE:{good:2e3,poor:5e3}}[n];return!c||r<=c.good?"good":r<=c.poor?"needs-improvement":"poor"}recordMetric(n,r,i){const c={name:n,value:r,rating:i,timestamp:Date.now()};this.metrics.push(c),De.log(`Performance metric: ${n} = ${r.toFixed(2)}ms (${i})`),i==="poor"&&De.warn(`Poor performance detected: ${n} = ${r.toFixed(2)}ms`)}measureMemoryUsage(){if("memory"in performance){const n=performance.memory;De.log("Memory usage:",{used:`${(n.usedJSHeapSize/1024/1024).toFixed(2)}MB`,total:`${(n.totalJSHeapSize/1024/1024).toFixed(2)}MB`,limit:`${(n.jsHeapSizeLimit/1024/1024).toFixed(2)}MB`})}}getMetrics(){return[...this.metrics]}getSummary(){const n={};return[...new Set(this.metrics.map(i=>i.name))].forEach(i=>{const c=this.metrics.filter(u=>u.name===i).sort((u,f)=>f.timestamp-u.timestamp)[0];c&&(n[i]={value:c.value,rating:c.rating})}),n}cleanup(){this.observers.forEach(n=>n.disconnect()),this.observers=[],this.metrics=[]}}const R1=new A1,O1=s=>{const n=performance.now();return()=>{const i=performance.now()-n;De.log(`Render time for ${s}: ${i.toFixed(2)}ms`),i>16.67&&De.warn(`Slow render detected: ${s} took ${i.toFixed(2)}ms`)}};class M1{errors=[];maxErrors=100;constructor(){this.setupGlobalErrorHandling()}setupGlobalErrorHandling(){window.addEventListener("error",n=>{this.trackError({message:n.message,stack:n.error?.stack,severity:"high",context:{filename:n.filename,lineno:n.lineno,colno:n.colno}})}),window.addEventListener("unhandledrejection",n=>{const r=n.reason;this.trackError({message:r?.message||"Unhandled promise rejection",stack:r?.stack,severity:"high",context:{type:"unhandled_promise_rejection",reason:r}})}),window.addEventListener("error",n=>{n.target!==window&&this.trackError({message:"Resource loading failed",severity:"medium",context:{type:"resource_error",element:n.target?.tagName,source:n.target?.src||n.target?.href}})},!0)}trackError(n){const r={id:this.generateErrorId(),message:n.message,stack:n.stack,severity:n.severity,timestamp:Date.now(),url:window.location.href,userAgent:navigator.userAgent,userId:n.userId,context:n.context,resolved:!1};return this.errors.push(r),this.errors.length>this.maxErrors&&(this.errors=this.errors.slice(-this.maxErrors)),r.severity==="critical"||r.severity==="high"?De.error(`[ErrorTracker] ${r.severity.toUpperCase()}: ${r.message}`,{id:r.id,stack:r.stack,context:r.context}):De.warn(`[ErrorTracker] ${r.severity.toUpperCase()}: ${r.message}`),r.id}trackReactError(n,r,i){return this.trackError({message:`React Error: ${n.message}`,stack:n.stack,severity:"high",context:{type:"react_error",componentStack:r.componentStack,errorBoundary:r.errorBoundary},userId:i})}trackFirebaseError(n,r,i){const c=this.getFirebaseErrorSeverity(n.code);return this.trackError({message:`Firebase Error in ${r}: ${n.message}`,stack:n.stack,severity:c,context:{type:"firebase_error",code:n.code,operation:r,customData:n.customData},userId:i})}trackUserActionError(n,r,i){return this.trackError({message:`User Action Error (${n}): ${r.message}`,stack:r.stack,severity:"medium",context:{type:"user_action_error",action:n,timestamp:Date.now()},userId:i})}getFirebaseErrorSeverity(n){const r=["internal","unavailable","data-loss"],i=["permission-denied","unauthenticated","failed-precondition"],c=["not-found","already-exists","invalid-argument"];return r.includes(n)?"critical":i.includes(n)?"high":c.includes(n)?"medium":"low"}generateErrorId(){return`err_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}resolveError(n){const r=this.errors.find(i=>i.id===n);return r?(r.resolved=!0,!0):!1}getErrorStats(){const n=this.errors.length,r=this.errors.filter(f=>f.resolved).length,i=n-r,c=this.errors.reduce((f,g)=>(f[g.severity]=(f[g.severity]||0)+1,f),{}),u=this.errors.slice(-10).sort((f,g)=>g.timestamp-f.timestamp);return{total:n,resolved:r,unresolved:i,bySeverity:c,recent:u}}getCriticalErrors(){return this.errors.filter(n=>(n.severity==="critical"||n.severity==="high")&&!n.resolved)}searchErrors(n){const r=n.toLowerCase();return this.errors.filter(i=>i.message.toLowerCase().includes(r)||i.stack?.toLowerCase().includes(r))}exportErrors(){return JSON.stringify(this.errors,null,2)}cleanup(){this.errors=[]}}const Fx=new M1,Vj=s=>(n,r)=>{Fx.trackReactError(n,{componentStack:r.componentStack,errorBoundary:s})},I1=()=>{const s=document.querySelector('meta[http-equiv="Content-Security-Policy"]');s&&De.log("CSP policy found:",s.getAttribute("content"))},U1=()=>{try{const s="_security_test",n="test";localStorage.setItem(s,n);const r=localStorage.getItem(s);localStorage.removeItem(s),r!==n?De.error("localStorage security test failed"):De.log("localStorage security validation passed")}catch(s){De.error("localStorage access error:",s)}},L1=async()=>{try{return typeof window<"u"&&window.firebase?(De.log("Firebase is properly initialized"),!0):(De.warn("Firebase not found or not initialized"),!1)}catch(s){return De.error("Firebase validation error:",s),!1}},Gx=()=>({https:window.location.protocol==="https:",secureContext:window.isSecureContext,cookieSecure:document.cookie.includes("Secure"),localStorage:!!window.localStorage,sessionStorage:!!window.sessionStorage}),z1=()=>{I1(),U1(),Gx(),L1(),window.addEventListener("error",s=>{s.error&&s.error.name==="SecurityError"&&De.error("Security error detected:",s.error)})},Ip=()=>{const s=[],n=Gx();return s.push({name:"HTTPS",status:n.https?"pass":"fail",details:n.https?"Site served over HTTPS":"Site not served over HTTPS"}),s.push({name:"Secure Context",status:n.secureContext?"pass":"fail",details:n.secureContext?"Running in secure context":"Not running in secure context"}),s.push({name:"Local Storage",status:n.localStorage?"pass":"fail",details:n.localStorage?"localStorage available":"localStorage not available"}),{timestamp:Date.now(),checks:s}},H1={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},$1=(s,n,r)=>{let i;const c=H1[s];return typeof c=="string"?i=c:n===1?i=c.one:i=c.other.replace("{{count}}",n.toString()),r?.addSuffix?r.comparison&&r.comparison>0?i+" ":i+" ":i},B1={full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},q1={full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},Y1={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},F1={date:vu({formats:B1,defaultWidth:"full"}),time:vu({formats:q1,defaultWidth:"full"}),dateTime:vu({formats:Y1,defaultWidth:"full"})},G1={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},V1=(s,n,r,i)=>G1[s],W1={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},P1={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},Q1={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},X1={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},K1={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},Z1={narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},J1=(s,n)=>{const r=Number(s);switch(String(n?.unit)){case"minute":case"second":return String(r);case"date":return r+"";default:return r+""}},ej={ordinalNumber:J1,era:xl({values:W1,defaultWidth:"wide"}),quarter:xl({values:P1,defaultWidth:"wide",argumentCallback:s=>s-1}),month:xl({values:Q1,defaultWidth:"wide"}),day:xl({values:X1,defaultWidth:"wide"}),dayPeriod:xl({values:K1,defaultWidth:"wide",formattingValues:Z1,defaultFormattingWidth:"wide"})},tj=/^(\d+)(|)?/i,nj=/\d+/i,aj={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},rj={any:[/^(bc|)/i,/^(ad|)/i]},sj={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},lj={any:[/1/i,/2/i,/3/i,/4/i]},ij={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},oj={any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},cj={narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},dj={any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},uj={any:/^(am|pm|||||||)/i},hj={any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},fj={ordinalNumber:r_({matchPattern:tj,parsePattern:nj,valueCallback:s=>parseInt(s,10)}),era:bl({matchPatterns:aj,defaultMatchWidth:"wide",parsePatterns:rj,defaultParseWidth:"any"}),quarter:bl({matchPatterns:sj,defaultMatchWidth:"wide",parsePatterns:lj,defaultParseWidth:"any",valueCallback:s=>s+1}),month:bl({matchPatterns:ij,defaultMatchWidth:"wide",parsePatterns:oj,defaultParseWidth:"any"}),day:bl({matchPatterns:cj,defaultMatchWidth:"wide",parsePatterns:dj,defaultParseWidth:"any"}),dayPeriod:bl({matchPatterns:uj,defaultMatchWidth:"any",parsePatterns:hj,defaultParseWidth:"any"})},fn={code:"ko",formatDistance:$1,formatLong:F1,formatRelative:V1,localize:ej,match:fj,options:{weekStartsOn:0,firstWeekContainsDate:1}},rc=(s,n={})=>{const{minSwipeDistance:r=50,preventDefaultTouchmoveEvent:i=!1}=n,c=O.useRef(null),u=O.useRef(null),f=O.useRef(null),g=O.useRef(null);return{onTouchStart:b=>{c.current=b.touches[0].clientX,u.current=b.touches[0].clientY},onTouchMove:b=>{i&&b.preventDefault()},onTouchEnd:b=>{if(!c.current||!u.current)return;f.current=b.changedTouches[0].clientX,g.current=b.changedTouches[0].clientY;const w=c.current-f.current,L=u.current-g.current;Math.abs(w)>Math.abs(L)&&Math.abs(w)>r&&(w>0?s.onSwipeLeft?.():s.onSwipeRight?.()),c.current=null,u.current=null,f.current=null,g.current=null}}},Vx=({todoId:s,subTasks:n})=>{const{addSubTask:r,updateSubTask:i,deleteSubTask:c,toggleSubTask:u}=Qt(),[f,g]=O.useState(""),[m,p]=O.useState(!1),[x,b]=O.useState(null),w=S=>{S.preventDefault(),f.trim()&&(r(s,f.trim()),g(""),p(!1))},L=S=>{b({id:S.id,title:S.title})},T=()=>{!x||!x.title.trim()||(i(s,x.id,{title:x.title.trim()}),b(null))},z=()=>{b(null)},W=S=>{confirm("   ?")&&c(s,S)},k=(S,A)=>{S.key==="Enter"?(S.preventDefault(),A==="add"?w(S):T()):S.key==="Escape"&&(A==="add"?(p(!1),g("")):z())};return l.jsxs("div",{className:"mt-4 space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["  (",n.length,")"]}),!m&&l.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-1 px-2 py-1 text-xs text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",children:[l.jsx(Bt,{className:"w-3 h-3"}),""]})]}),l.jsxs("div",{className:"space-y-2",children:[n.map(S=>l.jsx("div",{className:"flex items-center gap-2 p-2 bg-gray-50 dark:bg-gray-700/50 rounded-lg group",children:x?.id===S.id?l.jsxs(l.Fragment,{children:[l.jsx("input",{type:"checkbox",checked:S.completed,onChange:()=>u(s,S.id),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),l.jsx("input",{type:"text",value:x.title,onChange:A=>b({...x,title:A.target.value}),onKeyDown:A=>k(A,"edit"),className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-600 dark:text-white",placeholder:"  ",autoFocus:!0}),l.jsx("button",{onClick:T,className:"p-1 text-green-600 hover:bg-green-100 dark:hover:bg-green-900/20 rounded",title:"",children:l.jsx(gs,{className:"w-3 h-3"})}),l.jsx("button",{onClick:z,className:"p-1 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-600 rounded",title:"",children:l.jsx(St,{className:"w-3 h-3"})})]}):l.jsxs(l.Fragment,{children:[l.jsx("input",{type:"checkbox",checked:S.completed,onChange:()=>u(s,S.id),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("span",{className:`text-sm ${S.completed?"line-through text-gray-500":"text-gray-700 dark:text-gray-300"}`,children:S.title}),S.completed&&S.completedAt&&S.completedAt!==null&&l.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:[": ",(()=>{try{const A=new Date(S.completedAt);return isNaN(A.getTime())?(console.warn("Invalid Date detected for subtask:",S.id,S.completedAt)," "):A.toLocaleString("ko-KR")}catch(A){return console.error("Date parsing error:",A,S.completedAt)," "}})()]})]}),l.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[l.jsx("button",{onClick:()=>L(S),className:"p-1 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-900/20 rounded",title:"",children:l.jsx(zp,{className:"w-3 h-3"})}),l.jsx("button",{onClick:()=>W(S.id),className:"p-1 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/20 rounded",title:"",children:l.jsx(St,{className:"w-3 h-3"})})]})]})},S.id)),m&&l.jsxs("form",{onSubmit:w,className:"flex items-center gap-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[l.jsx("input",{type:"text",value:f,onChange:S=>g(S.target.value),onKeyDown:S=>k(S,"add"),className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-600 dark:text-white",placeholder:"   ",autoFocus:!0}),l.jsx("button",{type:"submit",className:"p-1 text-green-600 hover:bg-green-100 dark:hover:bg-green-900/20 rounded",title:"",children:l.jsx(gs,{className:"w-3 h-3"})}),l.jsx("button",{type:"button",onClick:()=>{p(!1),g("")},className:"p-1 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-600 rounded",title:"",children:l.jsx(St,{className:"w-3 h-3"})})]}),n.length===0&&!m&&l.jsx("div",{className:"text-center py-4 text-sm text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-700/30 rounded-lg border-2 border-dashed border-gray-200 dark:border-gray-600",children:"  "})]})]})},fr=({todo:s,onEdit:n,compact:r=!1})=>{const{toggleTodo:i,deleteTodo:c,updateTodo:u}=Qt(),[f,g]=O.useState(!1),m=O.useRef(null),[p,x]=O.useState(!1),b=s.subTasks?.length||0,w=s.subTasks?.filter(_=>_.completed).length||0,L=b>0,T=L?w/b*100:0,z=s.dueDate&&zm(new Date(s.dueDate),wu(new Date))&&!s.completed;s.dueDate&&s_(new Date(s.dueDate),wu(new Date))&&zm(new Date(s.dueDate),Ml(wu(new Date),1));const W=_=>Ut(new Date(_),"yyyy.MM.dd",{locale:fn}),k=()=>{if(!s.startDate&&!s.dueDate)return null;if(s.startDate&&s.dueDate)return l.jsxs("div",{className:"flex items-center gap-1 text-[10px] font-medium text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 px-1.5 py-0.5 rounded",children:[l.jsx("span",{children:W(s.startDate)}),l.jsx("span",{className:"text-gray-400",children:"~"}),l.jsx("span",{className:`${z?"text-red-500 font-bold":""}`,children:W(s.dueDate)})]});if(s.startDate)return l.jsxs("div",{className:"flex items-center gap-1 text-[10px] font-medium text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 px-1.5 py-0.5 rounded",children:[l.jsx(Lu,{className:"w-3 h-3 text-blue-500"}),l.jsx("span",{children:W(s.startDate)})]});if(s.dueDate)return l.jsxs("div",{className:`flex items-center gap-1 text-[10px] font-medium bg-gray-100 dark:bg-gray-800 px-1.5 py-0.5 rounded ${z?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400"}`,children:[l.jsx(Gl,{className:`w-3 h-3 ${z?"text-red-500 fill-red-500":"text-gray-400"}`}),l.jsx("span",{children:W(s.dueDate)})]})},S=()=>{f||i(s.id)},A=rc({onSwipeLeft:()=>{confirm(" ?")&&c(s.id)},onSwipeRight:()=>i(s.id)},{minSwipeDistance:50}),D=()=>{if(s.completed)return"border-gray-200 dark:border-gray-700";switch(s.priority){case"urgent":return"border-red-500 dark:border-red-500";case"high":return"border-orange-500 dark:border-orange-500";case"medium":return"border-blue-500 dark:border-blue-500";default:return"border-gray-200 dark:border-gray-700"}};return l.jsx("div",{ref:m,className:`
        relative group mb-3 transition-all duration-300 ease-out
        ${s.completed?"opacity-60":"opacity-100"}
      `,...A,children:l.jsxs("div",{className:`
        relative p-5 rounded-2xl border backdrop-blur-sm transition-all duration-300
        ${s.completed?"bg-gray-50/50 dark:bg-gray-800/30 border-gray-200 dark:border-gray-700":`bg-white/70 dark:bg-gray-800/70 shadow-sm hover:shadow-md hover:-translate-y-0.5 ${D()} md:border-white/50 md:dark:border-gray-700`}
      `,children:[l.jsxs("div",{className:"hidden md:flex absolute top-4 right-20 flex-col items-end gap-1.5 z-10",children:[l.jsxs("div",{className:"flex items-center gap-1.5",children:[s.recurrence&&s.recurrence!=="none"&&l.jsxs("span",{className:"px-1.5 py-0.5 text-[10px] font-bold bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300 rounded-full border border-purple-200 dark:border-purple-800 flex items-center gap-1",children:[l.jsx(iw,{className:"w-3 h-3"}),""]}),s.priority&&s.priority!=="medium"&&l.jsx("span",{className:`px-2 py-0.5 text-[10px] font-bold rounded-full border flex items-center gap-1 ${s.priority==="urgent"?"bg-red-100 text-red-700 border-red-200 dark:bg-red-900/30 dark:text-red-300 dark:border-red-800":"bg-orange-100 text-orange-700 border-orange-200 dark:bg-orange-900/30 dark:text-orange-300 dark:border-orange-800"}`,children:s.priority==="urgent"?"":""}),s.type==="project"&&l.jsxs("span",{className:"px-2 py-0.5 text-[10px] font-bold bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-300 rounded-full border border-indigo-200 dark:border-indigo-800 flex items-center gap-1",children:[s.project==="longterm"?"":"",L&&l.jsxs("span",{className:"ml-1 opacity-80",children:[w,"/",b]})]})]}),k()]}),l.jsxs("div",{className:"md:hidden absolute top-4 right-20 flex items-center gap-1.5 z-10",children:[s.recurrence&&s.recurrence!=="none"&&l.jsx(Ju,{className:"w-4 h-4 text-purple-500"}),s.type==="project"&&s.project==="longterm"&&l.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-bold bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-300 rounded-full border border-indigo-200 dark:border-indigo-800",children:""})]}),l.jsxs("div",{className:"absolute top-4 right-4 z-20 flex flex-col items-end gap-1",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:_=>{_.stopPropagation(),n?.(s)},className:"p-1.5 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",title:"",children:l.jsx(_o,{className:"w-4 h-4"})}),l.jsx("button",{onClick:_=>{_.stopPropagation(),window.confirm(" ?")&&c(s.id)},className:"p-1.5 text-gray-400 hover:text-red-600 dark:hover:text-red-400 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:"",children:l.jsx(an,{className:"w-4 h-4"})})]}),l.jsx("div",{className:"md:hidden mt-1",children:k()})]}),l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("button",{onClick:S,className:`
              flex-shrink-0 w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all duration-300 mt-1
              ${s.completed?"bg-blue-500 border-blue-500 text-white scale-110":"border-gray-300 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-400 bg-white dark:bg-gray-800"}
            `,children:s.completed&&l.jsx(gs,{className:"w-4 h-4",strokeWidth:3})}),l.jsxs("div",{className:"flex-1 min-w-0 pt-0.5 pr-28 sm:pr-24",children:[l.jsxs("div",{className:"flex items-start gap-2",children:[l.jsx("h3",{className:`
                text-base font-semibold leading-snug transition-all duration-300 break-words
                ${s.completed?"text-gray-400 dark:text-gray-500 line-through decoration-2 decoration-gray-300":"text-gray-900 dark:text-white"}
              `,children:s.title}),L&&l.jsx("button",{onClick:_=>{_.stopPropagation(),x(!p)},className:"p-0.5 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-400 transition-colors",children:p?l.jsx(Hp,{className:"w-4 h-4"}):l.jsx(eh,{className:"w-4 h-4"})})]}),s.description&&l.jsx("p",{className:`mt-1.5 text-sm line-clamp-2 ${s.completed?"text-gray-400":"text-gray-600 dark:text-gray-300"}`,children:s.description}),l.jsx("div",{className:"flex flex-wrap items-center gap-2 mt-3",children:s.tags&&s.tags.length>0&&l.jsx("div",{className:"flex flex-wrap gap-1",children:s.tags.map((_,H)=>l.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-md font-medium",children:["#",_]},H))})}),L&&!s.completed&&l.jsxs("div",{className:"mt-3 w-full",children:[l.jsxs("div",{className:"flex justify-between text-[10px] text-gray-500 mb-1",children:[l.jsx("span",{children:""}),l.jsxs("span",{children:[Math.round(T),"%"]})]}),l.jsx("div",{className:"h-1.5 w-full bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden",children:l.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${T===100?"bg-green-500":"bg-blue-500"}`,style:{width:`${T}%`}})})]}),p&&l.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100 dark:border-gray-700/50 animate-fade-in-down",children:l.jsx(Vx,{todoId:s.id,subTasks:s.subTasks||[]})})]})]})]})})},Up=({vacation:s,employee:n,compact:r=!1})=>{const i=c=>{switch(c){case"":return"bg-green-100 text-green-700 border-green-200 dark:bg-green-900/20 dark:text-green-300 dark:border-green-800";case"":return"bg-blue-100 text-blue-700 border-blue-200 dark:bg-blue-900/20 dark:text-blue-300 dark:border-blue-800";case"":return"bg-purple-100 text-purple-700 border-purple-200 dark:bg-purple-900/20 dark:text-purple-300 dark:border-purple-800";case"":return"bg-yellow-100 text-yellow-700 border-yellow-200 dark:bg-yellow-900/20 dark:text-yellow-300 dark:border-yellow-800";case"":return"bg-red-100 text-red-700 border-red-200 dark:bg-red-900/20 dark:text-red-300 dark:border-red-800";case"":return"bg-gray-100 text-gray-700 border-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600";default:return"bg-gray-100 text-gray-700 border-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600"}};return r?l.jsx("div",{className:`p-2 mb-1.5 rounded border ${i(s.type)}`,children:l.jsxs("div",{className:"flex items-center gap-2",children:[n&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-4 h-4 rounded-full flex items-center justify-center text-white text-xs font-semibold flex-shrink-0",style:{backgroundColor:n.color},children:n.name.charAt(0)}),l.jsx("span",{className:"text-xs font-medium truncate",children:n.name})]}),l.jsx("span",{className:"text-[8px] font-medium px-1 py-0.5 rounded",children:s.type})]})}):l.jsx("div",{className:`p-3 rounded-lg border ${i(s.type)}`,children:l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("div",{className:"flex items-center gap-2",children:n?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-white text-xs font-semibold",style:{backgroundColor:n.color},children:n.name.charAt(0)}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium",children:n.name}),l.jsx("div",{className:"text-xs opacity-75",children:n.team})]})]}):l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Yo,{className:"w-5 h-5"}),l.jsxs("span",{className:"font-medium",children:[" ID: ",s.employeeId]})]})}),l.jsx("span",{className:"text-sm font-medium px-2 py-1 rounded",children:s.type})]})})},Zu=O.memo(({currentView:s,searchTerm:n="",priorityFilter:r="all",typeFilter:i="all",projectFilter:c="all",tagFilter:u=[],completionDateFilter:f="all",selectedDate:g,onDateChange:m,onEdit:p})=>{const{todos:x,getTodayTodos:b,getWeekTodos:w,getMonthTodos:L,reorderTodos:T,getYesterdayIncompleteTodos:z,getTomorrowTodos:W}=Qt(),{currentUser:k}=Nn(),{showVacationsInTodos:S,getVacationsForDate:A,employees:D}=Bh(),[_,H]=O.useState(null),[I,le]=O.useState(null),ie=rc({onSwipeLeft:()=>{s==="today"&&m&&g&&m(Ml(g,1))},onSwipeRight:()=>{s==="today"&&m&&g&&m(ry(g))}},{minSwipeDistance:60}),be=O.useMemo(()=>{let K=[];switch(s){case"today":K=b(g);break;case"week":K=w();break;case"month":K=L();break;default:K=x}return K},[s,g,b,w,L,x]),Ee=O.useMemo(()=>(ee=>{const oe=new Set;return ee.filter(de=>oe.has(de.id)?!1:(oe.add(de.id),!0)).filter(de=>{if(n){const Le=n.toLowerCase(),tt=de.title.toLowerCase().includes(Le),st=de.description?.toLowerCase().includes(Le)||!1;if(!tt&&!st)return!1}return!(r!=="all"&&de.priority!==r||i!=="all"&&de.type!==i||c!=="all"&&de.type==="project"&&de.project!==c||u.length>0&&(!de.tags||de.tags.length===0||!de.tags.some(tt=>u.includes(tt))))})})(be),[be,n,r,i,c,u,f]),_e=Ee.filter(K=>!K.completed),ge=Ee.filter(K=>K.completed),je=[];if(s==="today"){const K=g||new Date;K.setHours(0,0,0,0),Ee.forEach(ee=>{ee.subTasks&&ee.subTasks.length>0&&ee.subTasks.forEach(oe=>{if(oe.completed&&oe.completedAt&&oe.completedAt!==null)try{const Ne=new Date(oe.completedAt);Ne.setHours(0,0,0,0),Ne.getTime()===K.getTime()&&je.push({...oe,type:"simple",recurrence:"none",isSubTask:!0,parentTitle:ee.title,parentDescription:ee.description,createdAt:oe.createdAt,updatedAt:oe.updatedAt})}catch{}})})}const Ae=[...ge,...je],P=()=>s==="today"&&g?g:new Date,pe=$a(k?.email)&&S?A(P()):[],R=(K,ee)=>{H(ee),K.dataTransfer.effectAllowed="move",K.dataTransfer.setData("text/plain",ee.toString())},re=async(K,ee)=>{if(K.preventDefault(),_!==null){try{if(_!==ee){let oe=ee;ee>_&&(oe=ee-1),await T(_,oe,Q)}}catch(oe){console.error("Drop error:",oe)}H(null),le(null)}},C=()=>{H(null),le(null)},Q=(K=>{const ee={urgent:0,high:1,medium:2,low:3};return K.sort((Ne,de)=>{const Le=ee[Ne.priority]-ee[de.priority];if(Le!==0)return Le;const tt=Ne.order,st=de.order;return tt!==void 0&&st!==void 0&&tt!==st?tt-st:tt!==void 0&&st===void 0?-1:tt===void 0&&st!==void 0?1:Ne.dueDate&&de.dueDate?new Date(Ne.dueDate).getTime()-new Date(de.dueDate).getTime():Ne.dueDate?-1:de.dueDate?1:new Date(de.createdAt).getTime()-new Date(Ne.createdAt).getTime()})})(_e),xe=Ae.sort((K,ee)=>{const oe=Ne=>{if(Ne.isSubTask&&Ne.completedAt)try{return new Date(Ne.completedAt).getTime()}catch{return 0}if(Ne.completedAt)try{return new Date(Ne.completedAt).getTime()}catch{return new Date(Ne.updatedAt).getTime()}return new Date(Ne.updatedAt).getTime()};return oe(ee)-oe(K)}),X=s==="today"?z(g):[],ue=s==="today"?W(g):[];return s==="today"?l.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-12 gap-8 items-start",onTouchStart:ie.onTouchStart,onTouchMove:ie.onTouchMove,onTouchEnd:ie.onTouchEnd,children:[l.jsx("div",{className:"xl:col-span-2 space-y-4",children:l.jsxs("div",{className:"glass-card p-3 sm:p-4 rounded-xl",children:[l.jsxs("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 mb-3 flex items-center gap-2",children:[l.jsx(Ju,{className:"w-4 h-4"}),"  ",l.jsx("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 px-1.5 py-0.5 rounded-full text-gray-600 dark:text-gray-300",children:X.length})]}),l.jsx("div",{className:"space-y-2",children:X.length>0?X.map(K=>l.jsx("div",{className:"opacity-75 hover:opacity-100 transition-opacity",children:l.jsx(fr,{todo:K,compact:!0,onEdit:p})},K.id)):l.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 text-center py-4",children:"   "})})]})}),l.jsxs("div",{className:"xl:col-span-8 space-y-6",children:[pe.length>0&&l.jsxs("div",{className:"glass-card p-4 sm:p-6 relative overflow-hidden group mb-4 sm:mb-6",children:[l.jsxs("h3",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white mb-3 sm:mb-4 flex items-center gap-2 relative z-10",children:[l.jsx(mt,{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-500"}),"  ",l.jsxs("span",{className:"text-sm sm:text-base font-medium text-gray-500 dark:text-gray-300 ml-1",children:["(",pe.length,")"]})]}),l.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-3",children:pe.map(K=>{const ee=D.find(oe=>oe.id===K.employeeId);return l.jsx(Up,{vacation:K,employee:ee,compact:!0},K.id)})})]}),l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:["   (",Q.length,")"]}),Q.length===0&&pe.length===0?l.jsx("div",{className:"glass-card p-12 text-center text-gray-500 dark:text-gray-400",children:l.jsx("p",{className:"text-lg",children:" "})}):l.jsx("div",{className:"relative",onDragOver:K=>{if(K.preventDefault(),_===null)return;const ee=K.currentTarget,oe=ee.getBoundingClientRect(),Ne=K.clientY-oe.top,de=ee.querySelectorAll("[data-todo-index]");let Le=de.length;for(let tt=0;tt<de.length;tt++){const st=de[tt].getBoundingClientRect(),Xe=st.top-oe.top,Vt=st.bottom-oe.top,Dt=Xe+(Vt-Xe)/2;if(Ne<Dt){Le=tt;break}}if(Le===_){le(null);return}le(Le)},onDrop:K=>{K.preventDefault(),I!==null&&re(K,I)},children:Q.map((K,ee)=>l.jsxs("div",{className:"relative",children:[_!==null&&I===ee&&l.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-blue-500 z-30"}),l.jsx("div",{"data-todo-index":ee,draggable:!0,onDragStart:oe=>R(oe,ee),onDragEnd:C,className:`
                          cursor-grab active:cursor-grabbing transition-all duration-200 relative
                          ${_===ee?"scale-105 shadow-lg z-20":""}
                          mb-1
                        `,children:l.jsx(fr,{todo:K,onEdit:p})}),_!==null&&I===ee+1&&ee===Q.length-1&&l.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-blue-500 z-30"})]},K.id))})]}),xe.length>0&&l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-green-700 dark:text-green-300 mb-4 flex items-center gap-2",children:[l.jsx(fo,{className:"w-5 h-5"}),"  (",xe.length,")"]}),l.jsx("div",{className:"space-y-2",children:xe.map(K=>{if(K.isSubTask){const ee=K,oe=ee.completedAt?new Date(ee.completedAt):new Date(ee.updatedAt);return l.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(fo,{className:"w-4 h-4 text-green-600 dark:text-green-400"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("span",{className:"text-sm font-medium text-green-800 dark:text-green-200 line-through",children:K.title}),l.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-green-100 dark:bg-green-800 text-green-800 dark:text-green-200 rounded border",children:""})]}),l.jsxs("div",{className:"text-xs text-green-700 dark:text-green-300",children:[l.jsx("span",{className:"font-medium",children:" :"})," ",ee.parentTitle,ee.parentDescription&&l.jsxs("span",{className:"ml-2 opacity-75",children:[" ",ee.parentDescription]})]}),l.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:[": ",oe.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})]})]})]},`subtask-${K.id}`)}return l.jsx(fr,{todo:K,onEdit:p},K.id)})})]})]}),l.jsx("div",{className:"xl:col-span-2 space-y-4",children:l.jsxs("div",{className:"glass-card p-3 sm:p-4 rounded-xl",children:[l.jsxs("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 mb-3 flex items-center gap-2",children:[l.jsx(La,{className:"w-4 h-4"})," ",l.jsx("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 px-1.5 py-0.5 rounded-full text-gray-600 dark:text-gray-300",children:ue.length})]}),l.jsx("div",{className:"space-y-2",children:ue.length>0?ue.map(K=>l.jsx("div",{className:"opacity-75 hover:opacity-100 transition-opacity",children:l.jsx(fr,{todo:K,compact:!0,onEdit:p})},K.id)):l.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 text-center py-4",children:"   "})})]})})]}):l.jsxs("div",{className:"space-y-6 relative",children:[pe.length>0&&l.jsxs("div",{className:"glass-card p-6 relative overflow-hidden group mb-6",children:[l.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2 relative z-10",children:[l.jsx(mt,{className:"w-6 h-6 text-blue-500"}),"  ",l.jsxs("span",{className:"text-base font-medium text-gray-500 dark:text-gray-300 ml-1",children:["(",pe.length,")"]})]}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:pe.map(K=>{const ee=D.find(oe=>oe.id===K.employeeId);return l.jsx(Up,{vacation:K,employee:ee,compact:!1},K.id)})})]}),Q.length>0&&l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:["   (",Q.length,")"]}),l.jsx("div",{className:"relative",onDragOver:K=>{if(K.preventDefault(),_===null)return;const ee=K.currentTarget,oe=ee.getBoundingClientRect(),Ne=K.clientY-oe.top,de=ee.querySelectorAll("[data-todo-index]");let Le=de.length;for(let tt=0;tt<de.length;tt++){const st=de[tt].getBoundingClientRect(),Xe=st.top-oe.top,Vt=st.bottom-oe.top,Dt=Xe+(Vt-Xe)/2;if(Ne<Dt){Le=tt;break}}if(Le===_){le(null);return}le(Le)},onDrop:K=>{K.preventDefault(),I!==null&&re(K,I)},children:Q.map((K,ee)=>l.jsxs("div",{className:"relative",children:[_!==null&&I===ee&&l.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-blue-500 z-30"}),l.jsx("div",{"data-todo-index":ee,draggable:!0,onDragStart:oe=>R(oe,ee),onDragEnd:C,className:`
                      cursor-grab active:cursor-grabbing transition-all duration-200 relative
                      ${_===ee?"scale-105 shadow-lg z-20":""}
                      mb-1
                    `,children:l.jsx(fr,{todo:K,onEdit:p})}),_!==null&&I===ee+1&&ee===Q.length-1&&l.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-blue-500 z-30"})]},K.id))})]}),xe.length>0&&(s==="today"||s==="week"||s==="month")&&l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-green-700 dark:text-green-300 mb-4 flex items-center gap-2",children:[l.jsx(fo,{className:"w-5 h-5"}),"  (",xe.length,")"]}),l.jsx("div",{className:"space-y-2",children:xe.map(K=>{if(K.isSubTask){const ee=K,oe=ee.completedAt?new Date(ee.completedAt):new Date(ee.updatedAt);return l.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(fo,{className:"w-4 h-4 text-green-600 dark:text-green-400"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("span",{className:"text-sm font-medium text-green-800 dark:text-green-200 line-through",children:K.title}),l.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-green-100 dark:bg-green-800 text-green-800 dark:text-green-200 rounded border",children:""})]}),l.jsxs("div",{className:"text-xs text-green-700 dark:text-green-300",children:[l.jsx("span",{className:"font-medium",children:" :"})," ",ee.parentTitle,ee.parentDescription&&l.jsxs("span",{className:"ml-2 opacity-75",children:[" ",ee.parentDescription]})]}),l.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:[": ",oe.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})]})]})]},`subtask-${K.id}`)}return l.jsx(fr,{todo:K,onEdit:p},K.id)})})]})]})});Zu.displayName="TodoList";var gj=Fp();const qh=({isOpen:s,onClose:n,todo:r,isMobile:i=!1})=>{const{updateTodo:c,updateRecurringTemplate:u}=Qt(),[f,g]=O.useState({title:"",description:"",priority:"medium",type:"simple",startDate:"",startTime:"",dueDate:"",dueTime:"",showStartTime:!1,showDueTime:!1,recurrence:"none",recurrenceDay:1,recurrenceDate:1,project:"shortterm",tags:[],exceptions:[]}),[m,p]=O.useState({}),[x,b]=O.useState(!1);O.useEffect(()=>{if(r&&s){const D=r.id.startsWith("recurring_");b(D),g({title:r.title.replace(" ",""),description:r.description||"",priority:r.priority,type:r.type,startDate:r.startDate?new Date(r.startDate).toISOString().split("T")[0]:"",startTime:r.startTime||"",dueDate:r.dueDate?new Date(r.dueDate).toISOString().split("T")[0]:"",dueTime:r.dueDate?new Date(r.dueDate).toTimeString().split(" ")[0].substring(0,5):r.dueTime||"",showStartTime:r.showStartTime||!1,showDueTime:r.showDueTime||!1,recurrence:r.recurrence||"none",recurrenceDay:r.recurrenceDay||1,recurrenceDate:r.recurrenceDate||1,project:r.project||"shortterm",tags:r.tags||[],exceptions:[]})}},[r,s]);const w=()=>{const D={};if(f.title.trim()||(D.title="  ."),f.startDate&&f.dueDate)try{const _=new Date(`${f.startDate}T${f.startTime||"00:00"}`),H=new Date(`${f.dueDate}T${f.dueTime||"23:59"}`);_>=H&&(D.startDate="   ")}catch(_){console.error("  :",_),D.general="  "}return p(D),Object.keys(D).length===0},L=async D=>{if(D.preventDefault(),!(!w()||!r))try{if(x){const _=r._templateId;_&&u(_,{title:f.title,description:f.description,priority:f.priority,type:f.type,tags:f.tags,exceptions:f.exceptions})}else{const _={title:f.title.trim(),description:f.description.trim()||"",priority:f.priority,type:f.type,tags:f.tags};if(f.startDate)try{_.startDate=new Date(f.startDate),console.log(":  :",_.startDate)}catch(H){throw console.error(":   :",H),new Error("   ")}if(f.startTime&&(_.startTime=f.startTime,console.log(":   :",_.startTime)),_.showStartTime=f.showStartTime,_.showDueTime=f.showDueTime,f.dueDate)try{const H=f.dueDate,I=f.dueTime||"23:59",le=`${H}T${I}:00`;_.dueDate=new Date(le),console.log(`:  : ${H} ${I} `,_.dueDate),f.dueTime&&console.log(":  dueDate :",f.dueTime)}catch(H){throw console.error(":   :",H),new Error(`   : ${f.dueDate} ${f.dueTime||""}`)}f.type==="project"&&(_.project=f.project),await c(r.id,_)}n()}catch(_){console.error("  :",_),p({general:"    ."})}},T=(D,_)=>{g(H=>({...H,[D]:_})),m[D]&&p(H=>({...H,[D]:""}))},z=()=>{g(D=>({...D,exceptions:[...D.exceptions,{type:"date",values:[]}]}))},W=D=>{g(_=>({..._,exceptions:_.exceptions.filter((H,I)=>I!==D)}))},k=(D,_,H)=>{g(I=>({...I,exceptions:I.exceptions.map((le,ie)=>ie===D?{...le,[_]:H}:le)}))},S=(D,_)=>{g(H=>({...H,exceptions:H.exceptions.map((I,le)=>le===D?{...I,values:_}:I)}))};if(!s||!r)return null;const A=[{value:1,label:""},{value:2,label:""},{value:3,label:""},{value:4,label:""},{value:5,label:""},{value:6,label:""},{value:0,label:""}];return gj.createPortal(l.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-50 z-[9999] ${i?"":"flex items-center justify-center p-4"}`,children:l.jsxs("div",{className:`bg-white dark:bg-gray-800 shadow-xl overflow-y-auto ${i?"w-full h-full fixed inset-0":"w-full max-w-2xl max-h-[90vh] rounded-lg"}`,children:[l.jsxs("div",{className:`flex items-center justify-between border-b border-gray-200 dark:border-gray-700 ${i?"px-4 py-3":"p-6"}`,children:[l.jsxs("h2",{className:`font-semibold text-gray-900 dark:text-white ${i?"text-lg":"text-xl"}`,children:["  ",x?"( )":""]}),l.jsx("button",{onClick:n,className:`hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg ${i?"p-3":"p-2"}`,children:l.jsx(St,{className:"w-5 h-5"})})]}),l.jsxs("form",{onSubmit:L,className:`${i?"px-4 py-4":"p-6"}`,children:[l.jsxs("div",{className:`${i?"space-y-4":"space-y-6"}`,children:[m.general&&l.jsx("div",{className:"p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:m.general}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx($p,{className:"w-4 h-4 inline mr-1"})," *"]}),l.jsx("input",{type:"text",value:f.title,onChange:D=>T("title",D.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white ${m.title?"border-red-500":"border-gray-300 dark:border-gray-600"}`,placeholder:" "}),m.title&&l.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.title})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),l.jsx("textarea",{value:f.description,onChange:D=>T("description",D.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"    "})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 sm:mb-2",children:[l.jsx(Bp,{className:"w-3 h-3 sm:w-4 sm:h-4 inline mr-1"}),""]}),l.jsxs("select",{value:f.type,onChange:D=>T("type",D.target.value),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[l.jsx("option",{value:"simple",children:" "}),l.jsx("option",{value:"project",children:""})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 sm:mb-2",children:[l.jsx(Gl,{className:"w-3 h-3 sm:w-4 sm:h-4 inline mr-1"}),""]}),l.jsxs("select",{value:f.priority,onChange:D=>T("priority",D.target.value),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[l.jsx("option",{value:"low",children:""}),l.jsx("option",{value:"medium",children:""}),l.jsx("option",{value:"high",children:""}),l.jsx("option",{value:"urgent",children:""})]})]})]}),f.type==="project"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",value:"shortterm",checked:f.project==="shortterm",onChange:D=>T("project",D.target.value),className:"mr-2"})," "]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",value:"longterm",checked:f.project==="longterm",onChange:D=>T("project",D.target.value),className:"mr-2"})," "]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 sm:mb-2",children:[l.jsx(mt,{className:"w-3 h-3 sm:w-4 sm:h-4 inline mr-1"})," "]}),l.jsx("input",{type:"date",value:f.startDate,onChange:D=>T("startDate",D.target.value),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 sm:mb-2",children:[l.jsx(La,{className:"w-3 h-3 sm:w-4 sm:h-4 inline mr-1"})," "]}),l.jsx("input",{type:"time",value:f.startTime,onChange:D=>T("startTime",D.target.value),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 sm:mb-2",children:[l.jsx(mt,{className:"w-3 h-3 sm:w-4 sm:h-4 inline mr-1"})," "]}),l.jsx("input",{type:"date",value:f.dueDate,onChange:D=>T("dueDate",D.target.value),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 sm:mb-2",children:[l.jsx(La,{className:"w-3 h-3 sm:w-4 sm:h-4 inline mr-1"})," "]}),l.jsx("input",{type:"time",value:f.dueTime,onChange:D=>T("dueTime",D.target.value),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]})]}),l.jsxs("div",{className:"flex items-center space-x-4 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:f.showStartTime,onChange:D=>T("showStartTime",D.target.checked),className:"mr-2"}),l.jsx(La,{className:"w-4 h-4 inline mr-1"})," "]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:f.showDueTime,onChange:D=>T("showDueTime",D.target.checked),className:"mr-2"}),l.jsx(La,{className:"w-4 h-4 inline mr-1"})," "]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),l.jsx("input",{type:"text",value:f.tags.join(", "),onChange:D=>T("tags",D.target.value.split(",").map(_=>_.trim()).filter(_=>_)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"    (: , , )"})]}),f.type==="project"&&r&&!x&&l.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:l.jsx(Vx,{todoId:r.id,subTasks:r.subTasks||[]})}),x&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[l.jsx(th,{className:"w-4 h-4 inline mr-1"}),"  (  )"]}),l.jsxs("button",{type:"button",onClick:z,className:"flex items-center gap-1 px-2 py-1 text-sm bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-900/30",children:[l.jsx(Bt,{className:"w-3 h-3"})," "]})]}),f.exceptions.map((D,_)=>l.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("select",{value:D.type,onChange:H=>k(_,"type",H.target.value),className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[l.jsx("option",{value:"date",children:" "}),l.jsx("option",{value:"weekday",children:" "}),l.jsx("option",{value:"week",children:" "}),l.jsx("option",{value:"month",children:" "})]}),l.jsx("button",{type:"button",onClick:()=>W(_),className:"ml-2 p-1 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/20 rounded",children:l.jsx(St,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-6 gap-2",children:[D.type==="date"&&Array.from({length:31},(H,I)=>I+1).map(H=>l.jsxs("label",{className:"flex items-center space-x-1",children:[l.jsx("input",{type:"checkbox",checked:D.values.includes(H),onChange:I=>{const le=D.values,ie=I.target.checked?[...le,H]:le.filter(be=>be!==H);S(_,ie)},className:"text-sm"}),l.jsxs("span",{className:"text-xs",children:[H,""]})]},H)),D.type==="weekday"&&A.map(H=>l.jsxs("label",{className:"flex items-center space-x-1",children:[l.jsx("input",{type:"checkbox",checked:D.values.includes(H.value),onChange:I=>{const le=D.values,ie=I.target.checked?[...le,H.value]:le.filter(be=>be!==H.value);S(_,ie)},className:"text-sm"}),l.jsx("span",{className:"text-xs",children:H.label})]},H.value)),D.type==="week"&&[1,2,3,4,-1].map(H=>l.jsxs("label",{className:"flex items-center space-x-1",children:[l.jsx("input",{type:"checkbox",checked:D.values.includes(H),onChange:I=>{const le=D.values,ie=I.target.checked?[...le,H]:le.filter(be=>be!==H);S(_,ie)},className:"text-sm"}),l.jsx("span",{className:"text-xs",children:Vo(H)})]},H)),D.type==="month"&&Array.from({length:12},(H,I)=>I+1).map(H=>l.jsxs("label",{className:"flex items-center space-x-1",children:[l.jsx("input",{type:"checkbox",checked:D.values.includes(H),onChange:I=>{const le=D.values,ie=I.target.checked?[...le,H]:le.filter(be=>be!==H);S(_,ie)},className:"text-sm"}),l.jsxs("span",{className:"text-xs",children:[H,""]})]},H))]}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:D.values.length>0&&l.jsxs("span",{children:[" ",D.type==="date"?"":D.type==="weekday"?"":D.type==="week"?"":"",": ",D.values.join(", ")]})})]},_))]})]}),l.jsxs("div",{className:`flex justify-end space-x-3 ${i?"mt-6":"mt-8"}`,children:[l.jsx("button",{type:"button",onClick:n,className:`text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg ${i?"px-6 py-3":"px-4 py-2"}`,children:""}),l.jsxs("button",{type:"submit",className:`flex items-center gap-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 ${i?"px-6 py-3":"px-4 py-2"}`,children:[l.jsx(zu,{className:"w-4 h-4"}),""]})]})]})]})}),document.body)},mj=({currentDate:s,onDateChange:n,searchTerm:r,priorityFilter:i,typeFilter:c,projectFilter:u,tagFilter:f,completionDateFilter:g,onAddTodo:m,isMobile:p=!1})=>{const[x,b]=O.useState({}),[w,L]=O.useState(null),[T,z]=O.useState(!1),[W,k]=O.useState(!1),[S,A]=O.useState([]),[D,_]=O.useState([]),{getFilteredTodos:H,toggleTodo:I,deleteTodo:le}=Qt(),{currentUser:ie}=Nn(),{showVacationsInTodos:be,getVacationsForDate:Ee,employees:_e}=Bh(),{getCustomHoliday:ge}=Wo(),je=O.useMemo(()=>{const M=ih(s,{weekStartsOn:0}),Q=oh(s,{weekStartsOn:0});return sy({start:M,end:Q})},[s]),Ae=O.useMemo(()=>l_(s,{weekStartsOn:0}),[s]);O.useEffect(()=>{(()=>{const Q={};je.forEach(xe=>{const X=ch(xe),ue=ge(xe);ue?Q[xe.toISOString().split("T")[0]]={date:xe.toISOString().split("T")[0],name:ue.name,isHoliday:!0,type:"custom"}:X&&(Q[xe.toISOString().split("T")[0]]=X)}),b(Q)})()},[je]);const P=O.useMemo(()=>H({searchTerm:r,priorityFilter:i,typeFilter:c,projectFilter:u,tagFilter:f,completionDateFilter:g,includeCompleted:!0}),[r,i,c,u,f,g,H]),ce=M=>{const Q=P.filter(X=>{if(X.completed&&X.completedAt)return jo(X.completedAt,M);if(!X.completed){const ue=X.startDate?new Date(X.startDate):null,K=X.dueDate?new Date(X.dueDate):null;if(ue&&K){const ee=new Date(M);return ue.setHours(0,0,0,0),K.setHours(0,0,0,0),ee.setHours(0,0,0,0),ee.getTime()>=ue.getTime()&&ee.getTime()<=K.getTime()}if(ue&&!K){const ee=new Date(M);ue.setHours(0,0,0,0),ee.setHours(0,0,0,0);const oe=new Date;return oe.setHours(0,0,0,0),ee.getTime()===ue.getTime()?!0:ee.getTime()>ue.getTime()&&ee.getTime()<=oe.getTime()?!X.completed:!1}return!ue&&K?jo(K,M):!1}return!1}),xe={urgent:0,high:1,medium:2,low:3};return Q.sort((X,ue)=>{const K=xe[X.priority]-xe[ue.priority];if(K!==0)return K;const ee=X.order||0,oe=ue.order||0;return ee!==oe?ee-oe:new Date(X.createdAt).getTime()-new Date(ue.createdAt).getTime()})},pe=()=>{n(ly(s))},R=()=>{n(iy(s,1))},re=()=>{n(new Date)},C=rc({onSwipeLeft:R,onSwipeRight:pe},{minSwipeDistance:60});return l.jsxs("div",{className:"space-y-4",...p?{onTouchStart:C.onTouchStart,onTouchMove:C.onTouchMove,onTouchEnd:C.onTouchEnd}:{},children:[l.jsxs("div",{className:`flex items-center ${p?"flex-col gap-2":"justify-between"}`,children:[l.jsxs("div",{className:`flex items-center ${p?"w-full justify-between":"gap-4"}`,children:[l.jsxs("h2",{className:`${p?"text-base":"text-xl"} font-semibold text-gray-900 dark:text-white ${p?"flex-1 text-center min-w-0":""}`,children:[Ut(s,"yyyy M",{locale:fn})," ",Ae,""]}),l.jsxs("div",{className:`flex items-center ${p?"gap-1":"gap-2"}`,children:[l.jsx("button",{onClick:pe,className:`${p?"p-1":"p-2"} hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg`,title:" ",children:l.jsx(Fo,{className:`${p?"w-3 h-3":"w-4 h-4"}`})}),l.jsx("button",{onClick:re,className:`${p?"px-2 py-1 text-xs":"px-3 py-1 text-sm"} bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/40`,children:" "}),l.jsx("button",{onClick:R,className:`${p?"p-1":"p-2"} hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg`,title:" ",children:l.jsx(bs,{className:`${p?"w-3 h-3":"w-4 h-4"}`})})]})]}),!p&&l.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[Ut(je[0],"M d",{locale:fn})," - ",Ut(je[6],"M d",{locale:fn})]})]}),l.jsx("div",{className:"grid grid-cols-7 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:je.map((M,Q)=>{const xe=ce(M);xe.filter(de=>de.completed).length,xe.length;const X=M.toISOString().split("T")[0],ue=x[X],K=Ha(M),ee=Hu(M),Ne=$a(ie?.email)&&be?Ee(M):[];return l.jsxs("div",{className:"border-r border-gray-200 dark:border-gray-700 last:border-r-0 relative flex flex-col",children:[l.jsxs("div",{className:`${p?"p-1":"p-2"} border-b border-gray-200 dark:border-gray-700 text-center cursor-pointer hover:bg-opacity-80 transition-colors ${ee?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":ue||K?"bg-red-50 dark:bg-red-900/20":"bg-gray-50 dark:bg-gray-700/50"}`,onClick:()=>{(xe.length>0||Ne.length>0)&&(A(xe),_(Ne),k(!0))},children:[l.jsx("div",{className:`text-xs font-medium mb-1 ${ue||K?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400"}`,children:Ut(M,"E",{locale:fn})}),l.jsxs("div",{className:"flex items-center justify-center",children:[l.jsx("div",{className:`text-lg font-semibold ${ee?"text-blue-700 dark:text-blue-300":ue||K?"text-red-700 dark:text-red-300":"text-gray-900 dark:text-white"}`,children:Ut(M,"d")}),ue&&!p&&l.jsx("div",{className:"text-xs text-red-600 dark:text-red-400 font-medium ml-1",children:ue.name})]})]}),l.jsxs("div",{className:`${p?"px-0.5 py-1 min-h-[150px] space-y-0.5":"p-2 min-h-[200px] space-y-1"} flex-1`,children:[Ne.slice(0,Math.max(0,8-xe.length)).map(de=>{const Le=_e.find(tt=>tt.id===de.employeeId);return l.jsx("div",{className:`${p?"p-1 text-[9px]":"p-2 text-xs"} rounded border cursor-pointer hover:shadow-md transition-all ${de.type===""?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800 hover:bg-green-100 dark:hover:bg-green-900/30":de.type===""||de.type===""?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 hover:bg-blue-100 dark:hover:bg-blue-900/30":de.type===""?"bg-purple-50 dark:bg-purple-900/20 border-purple-200 dark:border-purple-800 hover:bg-purple-100 dark:hover:bg-purple-900/30":de.type===""?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 hover:bg-red-100 dark:hover:bg-red-900/30":"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800 hover:bg-yellow-100 dark:hover:bg-yellow-900/30"}`,title:Le?`${Le.name} - ${de.type}`:` ${de.employeeId} - ${de.type}`,children:l.jsx("div",{className:"truncate",children:p?`${de.type}`:Le?`${Le.name} ${de.type}`:`${de.employeeId} ${de.type}`})},`vacation-${de.id}`)}),xe.slice(0,Math.max(0,8-Ne.length)).map(de=>l.jsxs("div",{className:`group relative ${p?"p-1":"p-2"} rounded ${p?"text-[10px]":"text-xs"} border cursor-pointer hover:shadow-md transition-all ${de.completed?"bg-gray-50 dark:bg-gray-700 border-gray-200 dark:border-gray-600 opacity-60":de.priority==="urgent"?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 hover:bg-red-100 dark:hover:bg-red-900/30":de.priority==="high"?"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800 hover:bg-orange-100 dark:hover:bg-orange-900/30":"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 hover:bg-blue-100 dark:hover:bg-blue-900/30"}`,onClick:()=>{L(de),z(!0)},children:[l.jsx("div",{className:`font-medium truncate ${p?"text-[10px]":"text-xs"} ${de.completed?"line-through text-gray-500":"text-gray-900 dark:text-white"}`,children:de.title}),l.jsxs("div",{className:`${p?"text-[9px]":"text-xs"} text-gray-500 dark:text-gray-400 ${p?"mt-0.5":"mt-1"}`,children:[de.showStartTime&&de.startTime&&l.jsxs("span",{children:[": ",de.startTime]}),de.showStartTime&&de.startTime&&de.showDueTime&&de.dueDate&&new Date(de.dueDate).getHours()!==23&&new Date(de.dueDate).getMinutes()!==59&&l.jsx("span",{children:" | "}),de.showDueTime&&de.dueDate&&(()=>{const Le=new Date(de.dueDate);return Le.getHours()===23&&Le.getMinutes()===59?null:l.jsxs("span",{children:[": ",Le.toTimeString().slice(0,5)]})})()]}),l.jsxs("div",{className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity flex gap-1",children:[l.jsx("button",{onClick:Le=>{Le.stopPropagation(),I(de.id)},className:"p-1.5 bg-white dark:bg-gray-800 rounded shadow-sm hover:bg-gray-100 dark:hover:bg-gray-700",title:de.completed?" ":" ",children:l.jsx("div",{className:`w-3 h-3 rounded-full ${de.completed?"bg-green-600":"border border-gray-400"}`})}),l.jsx("button",{onClick:Le=>{Le.stopPropagation(),confirm(`"${de.title}"  ?`)&&le(de.id)},className:"p-1.5 bg-white dark:bg-gray-800 rounded shadow-sm hover:bg-red-100 dark:hover:bg-red-900/30",title:"",children:l.jsx(an,{className:"w-3 h-3 text-red-600"})})]})]},de.id)),xe.length+Ne.length>8&&l.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center py-1 cursor-pointer hover:text-blue-600",onClick:()=>{A(xe),_(Ne),k(!0)},children:["+",xe.length+Ne.length-8," "]}),l.jsx("button",{onClick:m,className:`w-full ${p?"h-6":"h-8"} border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg flex items-center justify-center text-gray-400 hover:border-blue-400 hover:text-blue-400 transition-colors`,title:" ",children:l.jsx(Bt,{className:`${p?"w-2.5 h-2.5":"w-3 h-3"}`})})]}),ue&&p&&l.jsx("div",{className:"absolute bottom-0 left-0 right-0",children:l.jsx("div",{className:"text-[9px] text-red-600 dark:text-red-400 font-medium text-center bg-red-50 dark:bg-red-900/20 py-0.5 leading-tight",children:ue.name})})]},Q)})}),je.some(M=>{const Q=ce(M),X=$a(ie?.email)&&be?Ee(M):[];return Q.length>0||X.length>0})&&l.jsxs("div",{className:"mt-8",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"   "}),l.jsx("div",{className:"space-y-2",children:je.map(M=>{const Q=ce(M),X=$a(ie?.email)&&be?Ee(M):[];return Q.length===0&&X.length===0?null:l.jsxs("div",{children:[l.jsxs("h4",{className:"text-md font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[l.jsx(mt,{className:"w-4 h-4"}),Ut(M,"M d (E)",{locale:fn}),Hu(M)&&l.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300 rounded",children:""})]}),l.jsxs("div",{className:"space-y-2",children:[X.map(ue=>{const K=_e.find(ee=>ee.id===ue.employeeId);return l.jsx("div",{className:`p-3 rounded-lg border cursor-pointer hover:shadow-md transition-all ${ue.type===""?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":ue.type===""||ue.type===""?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":ue.type===""?"bg-purple-50 dark:bg-purple-900/20 border-purple-200 dark:border-purple-800":ue.type===""?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800":"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800"}`,children:l.jsxs("div",{className:"flex items-center gap-3",children:[K&&l.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-white text-sm font-semibold",style:{backgroundColor:K.color},children:K.name.charAt(0)}),l.jsx("div",{className:"flex-1 truncate",children:l.jsx("div",{className:`font-medium text-gray-900 dark:text-white truncate ${p?"text-sm":"text-base"}`,children:K?K.name:` ${ue.employeeId}`})}),l.jsx("div",{className:`px-2 py-1 text-xs font-medium rounded ${ue.type===""?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200":ue.type===""||ue.type===""?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200":ue.type===""?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-200":ue.type===""?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-200"}`,children:ue.type})]})},`vacation-${ue.id}`)}),Q.map(ue=>l.jsx(fr,{todo:ue},ue.id))]})]},M.toISOString())})})]}),w&&l.jsx(qh,{isOpen:T,onClose:()=>{z(!1),L(null)},todo:w,isMobile:p}),W&&l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>k(!1),children:l.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-lg shadow-xl ${p?"w-[90vw] max-h-[80vh]":"w-[500px] max-h-[600px]"} overflow-hidden`,onClick:M=>M.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[l.jsx(mt,{className:"w-5 h-5"}),S.length>0&&S[0].dueDate?Ut(S[0].dueDate,"M d (E)",{locale:fn}):"  "," (",S.length+D.length,")"]}),l.jsx("button",{onClick:()=>k(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:l.jsx(St,{className:"w-4 h-4"})})]}),l.jsx("div",{className:"p-4 overflow-y-auto max-h-[500px]",children:S.length>0||D.length>0?l.jsxs("div",{className:"space-y-3",children:[D.map(M=>{const Q=_e.find(xe=>xe.id===M.employeeId);return l.jsx("div",{className:`p-2 rounded border ${M.type===""?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":M.type===""||M.type===""?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":M.type===""?"bg-purple-50 dark:bg-purple-900/20 border-purple-200 dark:border-purple-800":M.type===""?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800":"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800"}`,children:l.jsxs("div",{className:"flex items-center gap-3",children:[Q&&l.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-semibold",style:{backgroundColor:Q.color},children:Q.name.charAt(0)}),l.jsx("div",{className:"flex-1",children:l.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:Q?Q.name:` ${M.employeeId}`})}),l.jsx("div",{className:`px-2 py-1 text-xs font-medium rounded ${M.type===""?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200":M.type===""||M.type===""?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200":M.type===""?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-200":M.type===""?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-200"}`,children:M.type})]})},`vacation-${M.id}`)}),S.map(M=>l.jsx("div",{className:`p-2 rounded border cursor-pointer hover:shadow-md transition-all ${M.completed?"bg-gray-50 dark:bg-gray-700 border-gray-200 dark:border-gray-600 opacity-60":M.priority==="urgent"?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800":M.priority==="high"?"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800":"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800"}`,onClick:()=>{L(M),z(!0),k(!1)},children:l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:`font-medium truncate ${M.completed?"line-through text-gray-500":"text-gray-900 dark:text-white"}`,children:M.title}),(M.showStartTime&&M.startTime||M.showDueTime&&M.dueDate)&&l.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[M.showStartTime&&M.startTime&&l.jsxs("span",{children:[": ",M.startTime]}),M.showStartTime&&M.startTime&&M.showDueTime&&M.dueDate&&(()=>{const Q=new Date(M.dueDate);return Q.getHours()===23&&Q.getMinutes()===59?null:l.jsx("span",{children:" | "})})(),M.showDueTime&&M.dueDate&&(()=>{const Q=new Date(M.dueDate);return Q.getHours()===23&&Q.getMinutes()===59?null:l.jsxs("span",{children:[": ",Q.toTimeString().slice(0,5)]})})()]})]}),l.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[M.type==="project"&&l.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${M.project==="longterm"?"bg-purple-100 text-purple-700 dark:bg-purple-900/20 dark:text-purple-400":"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400"}`,children:M.project==="longterm"?"":""}),M.priority&&M.priority!=="medium"&&l.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${M.priority==="urgent"?"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400":M.priority==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/20 dark:text-orange-400":"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-400"}`,children:M.priority==="urgent"?"":M.priority==="high"?"":""}),l.jsx("button",{onClick:Q=>{Q.stopPropagation(),I(M.id)},className:"p-1 bg-white dark:bg-gray-700 rounded shadow-sm hover:bg-gray-100 dark:hover:bg-gray-600 border border-gray-200 dark:border-gray-600",title:M.completed?" ":" ",children:l.jsx("div",{className:`w-3 h-3 rounded-full ${M.completed?"bg-green-600":"border border-gray-400"}`})}),l.jsx("button",{onClick:Q=>{Q.stopPropagation(),confirm(`"${M.title}"  ?`)&&(le(M.id),S.filter(X=>X.id!==M.id).length===0&&D.length===0&&k(!1))},className:"p-1 bg-white dark:bg-gray-700 rounded shadow-sm hover:bg-red-100 dark:hover:bg-red-800 border border-gray-200 dark:border-gray-600",title:"",children:l.jsx(an,{className:"w-3 h-3 text-red-600"})})]})]})},M.id))]}):l.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"   ."})}),l.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 flex justify-end",children:l.jsx("button",{onClick:()=>k(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",children:""})})]})})]})},pj=({currentDate:s,onDateChange:n,searchTerm:r,priorityFilter:i,typeFilter:c,projectFilter:u,tagFilter:f,completionDateFilter:g,onAddTodo:m,isMobile:p=!1})=>{const[x,b]=O.useState({}),[w,L]=O.useState(null),[T,z]=O.useState(!1),[W,k]=O.useState(!1),[S,A]=O.useState([]),[D,_]=O.useState([]),{getFilteredTodos:H,toggleTodo:I,deleteTodo:le}=Qt(),{currentUser:ie}=Nn(),{showVacationsInTodos:be,getVacationsForDate:Ee,employees:_e}=Bh(),{getCustomHoliday:ge}=Wo(),je=i_(s),Ae=o_(je),P=ih(je,{weekStartsOn:0}),ce=oh(Ae,{weekStartsOn:0}),pe=O.useMemo(()=>sy({start:P,end:ce}),[P,ce]);O.useEffect(()=>{(()=>{const ue={};pe.forEach(K=>{const ee=ch(K),oe=ge(K);oe?ue[K.toISOString().split("T")[0]]={date:K.toISOString().split("T")[0],name:oe.name,isHoliday:!0,type:"custom"}:ee&&(ue[K.toISOString().split("T")[0]]=ee)}),b(ue)})()},[pe]);const R=O.useMemo(()=>H({searchTerm:r,priorityFilter:i,typeFilter:c,projectFilter:u,tagFilter:f,completionDateFilter:g,includeCompleted:!0}),[r,i,c,u,f,g,H]),re=X=>{const ue=R.filter(ee=>{if(ee.completed&&ee.completedAt)return jo(ee.completedAt,X);if(!ee.completed){const oe=ee.startDate?new Date(ee.startDate):null,Ne=ee.dueDate?new Date(ee.dueDate):null;if(oe&&Ne){const de=new Date(X);return oe.setHours(0,0,0,0),Ne.setHours(0,0,0,0),de.setHours(0,0,0,0),de.getTime()>=oe.getTime()&&de.getTime()<=Ne.getTime()}if(oe&&!Ne){const de=new Date(X);oe.setHours(0,0,0,0),de.setHours(0,0,0,0);const Le=new Date;return Le.setHours(0,0,0,0),de.getTime()===oe.getTime()?!0:de.getTime()>oe.getTime()&&de.getTime()<=Le.getTime()?!ee.completed:!1}return!oe&&Ne?jo(Ne,X):!1}return!1}),K={urgent:0,high:1,medium:2,low:3};return ue.sort((ee,oe)=>{const Ne=K[ee.priority]-K[oe.priority];if(Ne!==0)return Ne;const de=ee.order||0,Le=oe.order||0;return de!==Le?de-Le:new Date(ee.createdAt).getTime()-new Date(oe.createdAt).getTime()})},C=()=>{n(oy(s))},M=()=>{n(cy(s,1))},Q=()=>{n(new Date)},xe=rc({onSwipeLeft:M,onSwipeRight:C},{minSwipeDistance:60});return l.jsxs("div",{className:"space-y-4",...p?{onTouchStart:xe.onTouchStart,onTouchMove:xe.onTouchMove,onTouchEnd:xe.onTouchEnd}:{},children:[l.jsx("div",{className:`flex items-center ${p?"flex-col gap-2":"justify-between"}`,children:l.jsxs("div",{className:`flex items-center ${p?"w-full justify-between":"gap-4"}`,children:[l.jsx("h2",{className:`${p?"text-base":"text-xl"} font-semibold text-gray-900 dark:text-white ${p?"flex-1 text-center min-w-0":""}`,children:Ut(s,"yyyy M",{locale:fn})}),l.jsxs("div",{className:`flex items-center ${p?"gap-1":"gap-2"}`,children:[l.jsx("button",{onClick:C,className:`${p?"p-1":"p-2"} hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg`,title:" ",children:l.jsx(Fo,{className:`${p?"w-3 h-3":"w-4 h-4"}`})}),l.jsx("button",{onClick:Q,className:`${p?"px-2 py-1 text-xs":"px-3 py-1 text-sm"} bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/40`,children:" "}),l.jsx("button",{onClick:M,className:`${p?"p-1":"p-2"} hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg`,title:" ",children:l.jsx(bs,{className:`${p?"w-3 h-3":"w-4 h-4"}`})})]})]})}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[l.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200 dark:border-gray-700",children:["","","","","","",""].map((X,ue)=>l.jsx("div",{className:`text-center py-2 text-sm font-medium ${ue===0?"text-red-600 dark:text-red-400":ue===6?"text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400"}`,children:X},X))}),l.jsx("div",{className:"grid grid-cols-7",children:pe.map((X,ue)=>{const K=re(X),ee=X.toISOString().split("T")[0],oe=x[ee],Ne=Ha(X),de=Hu(X),Le=c_(X,s),st=$a(ie?.email)&&be?Ee(X):[];return l.jsxs("div",{className:`min-h-[100px] border-b border-r border-gray-200 dark:border-gray-700 relative ${Le?"":"bg-gray-50/50 dark:bg-gray-900/20"} ${ue%7===6?"border-r-0":""} hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors cursor-pointer`,onClick:()=>{(K.length>0||st.length>0)&&(A(K),_(st),k(!0))},children:[l.jsxs("div",{className:`p-1 text-right ${Le?"":"opacity-30"}`,children:[l.jsx("span",{className:`inline-block w-6 h-6 text-center leading-6 rounded-full text-sm ${de?"bg-blue-600 text-white":oe||Ne&&Hm(X)===0?"text-red-600 dark:text-red-400 font-medium":Ne&&Hm(X)===6?"text-blue-600 dark:text-blue-400 font-medium":"text-gray-700 dark:text-gray-300"}`,children:Ut(X,"d")}),oe&&l.jsx("div",{className:"text-[10px] text-red-600 dark:text-red-400 font-medium truncate px-1",children:oe.name})]}),l.jsxs("div",{className:"px-1 pb-1 space-y-0.5",children:[st.slice(0,3).map(Xe=>{const Vt=_e.find(Dt=>Dt.id===Xe.employeeId);return l.jsxs("div",{className:`px-1.5 py-0.5 text-[10px] rounded truncate ${Xe.type===""?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200":Xe.type===""||Xe.type===""?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200":Xe.type===""?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-200":Xe.type===""?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-200"}`,title:Vt?`${Vt.name} - ${Xe.type}`:` ${Xe.employeeId} - ${Xe.type}`,children:[Vt?Vt.name:`${Xe.employeeId}`," ",Xe.type]},`vacation-${Xe.id}`)}),K.slice(0,Math.max(0,3-st.length)).map(Xe=>l.jsx("div",{className:`px-1.5 py-0.5 text-[10px] rounded truncate cursor-pointer ${Xe.completed?"bg-gray-100 text-gray-500 line-through dark:bg-gray-700 dark:text-gray-400":Xe.priority==="urgent"?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200":Xe.priority==="high"?"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-200":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200"}`,onClick:Vt=>{Vt.stopPropagation(),L(Xe),z(!0)},children:Xe.title},Xe.id)),K.length+st.length>3&&l.jsxs("div",{className:"text-[10px] text-gray-500 dark:text-gray-400 text-center",children:["+",K.length+st.length-3,""]})]})]},X.toISOString())})})]}),w&&l.jsx(qh,{isOpen:T,onClose:()=>{z(!1),L(null)},todo:w,isMobile:p}),W&&l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>k(!1),children:l.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-lg shadow-xl ${p?"w-[90vw] max-h-[80vh]":"w-[500px] max-h-[600px]"} overflow-hidden`,onClick:X=>X.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[l.jsx(mt,{className:"w-5 h-5"}),S.length>0&&S[0].dueDate?Ut(S[0].dueDate,"M d (E)",{locale:fn}):"  "," (",S.length+D.length,")"]}),l.jsx("button",{onClick:()=>k(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:l.jsx(St,{className:"w-4 h-4"})})]}),l.jsx("div",{className:"p-4 overflow-y-auto max-h-[500px]",children:S.length>0||D.length>0?l.jsxs("div",{className:"space-y-3",children:[D.map(X=>{const ue=_e.find(K=>K.id===X.employeeId);return l.jsx("div",{className:`p-2 rounded border ${X.type===""?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":X.type===""||X.type===""?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":X.type===""?"bg-purple-50 dark:bg-purple-900/20 border-purple-200 dark:border-purple-800":X.type===""?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800":"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800"}`,children:l.jsxs("div",{className:"flex items-center gap-3",children:[ue&&l.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-semibold",style:{backgroundColor:ue.color},children:ue.name.charAt(0)}),l.jsx("div",{className:"flex-1",children:l.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:ue?ue.name:` ${X.employeeId}`})}),l.jsx("div",{className:`px-2 py-1 text-xs font-medium rounded ${X.type===""?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200":X.type===""||X.type===""?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200":X.type===""?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-200":X.type===""?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-200"}`,children:X.type})]})},`vacation-${X.id}`)}),S.map(X=>l.jsx("div",{className:`p-2 rounded border cursor-pointer hover:shadow-md transition-all ${X.completed?"bg-gray-50 dark:bg-gray-700 border-gray-200 dark:border-gray-600 opacity-60":X.priority==="urgent"?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800":X.priority==="high"?"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800":"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800"}`,onClick:()=>{L(X),z(!0),k(!1)},children:l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:`font-medium truncate ${X.completed?"line-through text-gray-500":"text-gray-900 dark:text-white"}`,children:X.title}),(X.showStartTime&&X.startTime||X.showDueTime&&X.dueDate)&&l.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[X.showStartTime&&X.startTime&&l.jsxs("span",{children:[": ",X.startTime]}),X.showStartTime&&X.startTime&&X.showDueTime&&X.dueDate&&(()=>{const ue=new Date(X.dueDate);return ue.getHours()===23&&ue.getMinutes()===59?null:l.jsx("span",{children:" | "})})(),X.showDueTime&&X.dueDate&&(()=>{const ue=new Date(X.dueDate);return ue.getHours()===23&&ue.getMinutes()===59?null:l.jsxs("span",{children:[": ",ue.toTimeString().slice(0,5)]})})()]})]}),l.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[X.type==="project"&&l.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${X.project==="longterm"?"bg-purple-100 text-purple-700 dark:bg-purple-900/20 dark:text-purple-400":"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400"}`,children:X.project==="longterm"?"":""}),X.priority&&X.priority!=="medium"&&l.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${X.priority==="urgent"?"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400":X.priority==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/20 dark:text-orange-400":"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-400"}`,children:X.priority==="urgent"?"":X.priority==="high"?"":""}),l.jsx("button",{onClick:ue=>{ue.stopPropagation(),I(X.id)},className:"p-1 bg-white dark:bg-gray-700 rounded shadow-sm hover:bg-gray-100 dark:hover:bg-gray-600 border border-gray-200 dark:border-gray-600",title:X.completed?" ":" ",children:l.jsx("div",{className:`w-3 h-3 rounded-full ${X.completed?"bg-green-600":"border border-gray-400"}`})}),l.jsx("button",{onClick:ue=>{ue.stopPropagation(),confirm(`"${X.title}"  ?`)&&(le(X.id),S.filter(ee=>ee.id!==X.id).length===0&&D.length===0&&k(!1))},className:"p-1 bg-white dark:bg-gray-700 rounded shadow-sm hover:bg-red-100 dark:hover:bg-red-800 border border-gray-200 dark:border-gray-600",title:"",children:l.jsx(an,{className:"w-3 h-3 text-red-600"})})]})]})},X.id))]}):l.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"   ."})}),l.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 flex justify-end",children:l.jsx("button",{onClick:()=>k(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",children:""})})]})})]})},yj=({layout:s="sidebar"})=>{const{todos:n,getTodayTodos:r,getWeekTodos:i,getOverdueTodos:c}=Qt(),u=n.length,f=n.filter(S=>S.completed).length,g=u>0?Math.round(f/u*100):0,m=r(),p=m.filter(S=>S.completed).length,x=m.length,b=i(),w=b.filter(S=>S.completed).length,L=b.length,T=L>0?Math.round(w/L*100):0,z=c().length,W=({value:S,color:A,size:D=60})=>{const _=D/2-4,H=2*Math.PI*_,I=H-S/100*H;return l.jsxs("div",{className:"relative flex items-center justify-center",style:{width:D,height:D},children:[l.jsxs("svg",{className:"transform -rotate-90 w-full h-full",children:[l.jsx("circle",{className:"text-gray-200 dark:text-gray-700",strokeWidth:"4",stroke:"currentColor",fill:"transparent",r:_,cx:D/2,cy:D/2}),l.jsx("circle",{className:A,strokeWidth:"4",strokeDasharray:H,strokeDashoffset:I,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:_,cx:D/2,cy:D/2})]}),l.jsxs("span",{className:"absolute text-xs font-bold text-gray-700 dark:text-gray-200",children:[S,"%"]})]})},k=[{title:" ",value:`${g}%`,icon:l.jsx(ow,{className:"w-5 h-5"}),textColor:"text-green-600",bgColor:"bg-green-50 dark:bg-green-900/20",borderColor:"border-green-100 dark:border-green-800",chart:l.jsx(W,{value:g,color:"text-green-500"})},{title:" ",value:`${p}/${x}`,icon:l.jsx(cw,{className:"w-5 h-5"}),textColor:"text-blue-600",bgColor:"bg-blue-50 dark:bg-blue-900/20",borderColor:"border-blue-100 dark:border-blue-800",chart:l.jsx("div",{className:"w-full h-2 bg-blue-100 dark:bg-blue-900/30 rounded-full overflow-hidden mt-2",children:l.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-all duration-500",style:{width:`${x>0?p/x*100:0}%`}})})},{title:" ",value:`${T}%`,icon:l.jsx(dw,{className:"w-5 h-5"}),textColor:"text-purple-600",bgColor:"bg-purple-50 dark:bg-purple-900/20",borderColor:"border-purple-100 dark:border-purple-800",chart:l.jsx(W,{value:T,color:"text-purple-500"})},{title:" ",value:z.toString(),icon:l.jsx(uw,{className:"w-5 h-5"}),textColor:"text-red-600",bgColor:"bg-red-50 dark:bg-red-900/20",borderColor:"border-red-100 dark:border-red-800",chart:l.jsx("div",{className:"flex items-center justify-center h-[60px]",children:l.jsx("span",{className:"text-3xl font-bold text-red-500",children:z})})}];return s==="compact"?l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("div",{className:"text-center min-w-[28px]",children:[l.jsxs("p",{className:"text-green-600 text-xs font-bold leading-none",children:[g,"%"]}),l.jsx("p",{className:"text-[9px] text-gray-500 dark:text-gray-400 leading-none mt-0.5",children:""})]}),l.jsxs("div",{className:"text-center min-w-[28px]",children:[l.jsxs("p",{className:"text-blue-600 text-xs font-bold leading-none",children:[p,"/",x]}),l.jsx("p",{className:"text-[9px] text-gray-500 dark:text-gray-400 leading-none mt-0.5",children:""})]}),l.jsxs("div",{className:"text-center min-w-[28px]",children:[l.jsxs("p",{className:"text-purple-600 text-xs font-bold leading-none",children:[T,"%"]}),l.jsx("p",{className:"text-[9px] text-gray-500 dark:text-gray-400 leading-none mt-0.5",children:""})]}),l.jsxs("div",{className:"text-center min-w-[28px]",children:[l.jsx("p",{className:"text-red-600 text-xs font-bold leading-none",children:z}),l.jsx("p",{className:"text-[9px] text-gray-500 dark:text-gray-400 leading-none mt-0.5",children:""})]})]}):l.jsx("div",{className:`grid ${s==="full"?"grid-cols-2 lg:grid-cols-4":"grid-cols-2"} gap-4 lg:gap-6`,children:k.map((S,A)=>l.jsxs("div",{className:`${S.bgColor} ${S.borderColor} rounded-xl p-4 lg:p-6 border transition-all duration-300 hover:shadow-md hover:-translate-y-1 flex flex-col justify-between min-h-[140px]`,children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("div",{className:`p-2.5 rounded-xl bg-white dark:bg-gray-800 ${S.textColor} shadow-sm`,children:S.icon}),l.jsx("p",{className:"text-sm lg:text-base font-semibold text-gray-600 dark:text-gray-400",children:S.title})]}),l.jsxs("div",{className:"flex items-end justify-between mt-2",children:[l.jsx("div",{className:"flex flex-col",children:l.jsx("span",{className:`text-2xl lg:text-3xl font-bold ${S.textColor} dark:text-gray-200 tracking-tight`,children:S.value})}),l.jsx("div",{className:"flex items-center justify-center scale-110 lg:scale-125 origin-bottom-right",children:S.chart})]})]},A))})},Lp=({layout:s="full"})=>{const{todos:n}=Qt(),r=n.filter(p=>p.type==="project"),i=r.filter(p=>p.project==="longterm").length,c=r.filter(p=>p.project==="shortterm").length,u=n.length-r.length,f=n.length,g=({size:p=100})=>{if(f===0)return null;const x=p/2-10,b=2*Math.PI*x,w=i/f*100,L=c/f*100,T=u/f*100;return l.jsxs("div",{className:"relative flex items-center justify-center",style:{width:p,height:p},children:[l.jsxs("svg",{className:"transform -rotate-90 w-full h-full",children:[l.jsx("circle",{className:"text-gray-100 dark:text-gray-700",strokeWidth:"8",stroke:"currentColor",fill:"transparent",r:x,cx:p/2,cy:p/2}),i>0&&l.jsx("circle",{className:"text-purple-500 transition-all duration-1000 ease-out",strokeWidth:"8",strokeDasharray:b,strokeDashoffset:b-w/100*b,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:x,cx:p/2,cy:p/2}),c>0&&l.jsx("circle",{className:"text-green-500 transition-all duration-1000 ease-out",strokeWidth:"8",strokeDasharray:b,strokeDashoffset:b-L/100*b,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:x,cx:p/2,cy:p/2,style:{transform:`rotate(${w/100*360}deg)`,transformOrigin:"center"}}),u>0&&l.jsx("circle",{className:"text-orange-500 transition-all duration-1000 ease-out",strokeWidth:"8",strokeDasharray:b,strokeDashoffset:b-T/100*b,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:x,cx:p/2,cy:p/2,style:{transform:`rotate(${(w+L)/100*360}deg)`,transformOrigin:"center"}})]}),l.jsxs("div",{className:"absolute flex flex-col items-center",children:[l.jsx("span",{className:"text-xl lg:text-3xl font-bold text-gray-800 dark:text-white",children:f}),l.jsx("span",{className:"text-[10px] lg:text-xs text-gray-500",children:"Total"})]})]})},m=[{label:" ",value:r.length,icon:l.jsx(hw,{className:"w-5 h-5"}),color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-50 dark:bg-blue-900/20",borderColor:"border-blue-100 dark:border-blue-800"},{label:" ",value:i,icon:l.jsx(fw,{className:"w-5 h-5"}),color:"text-purple-600 dark:text-purple-400",bgColor:"bg-purple-50 dark:bg-purple-900/20",borderColor:"border-purple-100 dark:border-purple-800"},{label:" ",value:c,icon:l.jsx(gw,{className:"w-5 h-5"}),color:"text-green-600 dark:text-green-400",bgColor:"bg-green-50 dark:bg-green-900/20",borderColor:"border-green-100 dark:border-green-800"},{label:" ",value:u,icon:l.jsx(mw,{className:"w-5 h-5"}),color:"text-orange-600 dark:text-orange-400",bgColor:"bg-orange-50 dark:bg-orange-900/20",borderColor:"border-orange-100 dark:border-orange-800"}];return s==="compact"?l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("div",{className:"text-center min-w-[28px]",children:[l.jsx("p",{className:"text-blue-600 text-xs font-bold leading-none",children:r.length}),l.jsx("p",{className:"text-[9px] text-gray-500 dark:text-gray-400 leading-none mt-0.5",children:""})]}),l.jsxs("div",{className:"text-center min-w-[28px]",children:[l.jsx("p",{className:"text-orange-600 text-xs font-bold leading-none",children:u}),l.jsx("p",{className:"text-[9px] text-gray-500 dark:text-gray-400 leading-none mt-0.5",children:""})]}),l.jsxs("div",{className:"text-center min-w-[28px]",children:[l.jsx("p",{className:"text-purple-600 text-xs font-bold leading-none",children:i}),l.jsx("p",{className:"text-[9px] text-gray-500 dark:text-gray-400 leading-none mt-0.5",children:""})]}),l.jsxs("div",{className:"text-center min-w-[28px]",children:[l.jsx("p",{className:"text-green-600 text-xs font-bold leading-none",children:c}),l.jsx("p",{className:"text-[9px] text-gray-500 dark:text-gray-400 leading-none mt-0.5",children:""})]})]}):l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 lg:p-8 border border-gray-100 dark:border-gray-700 shadow-sm",children:[l.jsx("div",{className:"flex items-center justify-between mb-8",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:l.jsx(qp,{className:"w-6 h-6 text-gray-600 dark:text-gray-300"})}),l.jsx("h3",{className:"text-lg lg:text-xl font-bold text-gray-900 dark:text-white",children:" "})]})}),l.jsxs("div",{className:"flex flex-col lg:flex-row items-center gap-10 lg:gap-16",children:[l.jsxs("div",{className:"flex-shrink-0 relative",children:[l.jsx(g,{size:180}),l.jsx("div",{className:"absolute -bottom-8 left-1/2 transform -translate-x-1/2 text-sm font-medium text-gray-500 whitespace-nowrap",children:"  "})]}),l.jsx("div",{className:"flex-1 w-full grid grid-cols-2 gap-4 lg:gap-6",children:m.map((p,x)=>l.jsxs("div",{className:`${p.bgColor} ${p.borderColor} rounded-xl p-4 lg:p-5 border transition-all duration-300 hover:shadow-md hover:-translate-y-1`,children:[l.jsx("div",{className:"flex items-center justify-between mb-3",children:l.jsx("div",{className:`p-2.5 rounded-xl bg-white dark:bg-gray-800 ${p.color} shadow-sm`,children:p.icon})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:p.label}),l.jsx("p",{className:`text-2xl lg:text-3xl font-bold ${p.color}`,children:p.value})]})]},x))})]})]})},xj=({isOpen:s,onClose:n})=>{const{addRecurringTemplate:r,recurringTemplates:i}=Qt(),[c,u]=O.useState({title:"",description:"",priority:"medium",type:"simple",recurrenceType:"daily",weekday:1,monthlyDate:1,monthlyPattern:"date",monthlyWeek:"first",monthlyWeekday:3,tags:[],exceptions:[],holidayHandling:"show"}),[f,g]=O.useState(!1),m=()=>{u(k=>({...k,exceptions:[...k.exceptions,{type:"date",values:[]}]}))},p=k=>{u(S=>({...S,exceptions:S.exceptions.filter((A,D)=>D!==k)}))},x=(k,S,A)=>{u(D=>({...D,exceptions:D.exceptions.map((_,H)=>H===k?{..._,[S]:A}:_)}))},b=(k,S)=>{u(A=>({...A,exceptions:A.exceptions.map((D,_)=>_===k?{...D,values:S}:D)}))},w=k=>{const A=c.exceptions[k].values||[],D={targetTemplateTitle:"",scope:"same_week"};b(k,[...A,D])},L=(k,S)=>{const D=c.exceptions[k].values||[];b(k,D.filter((_,H)=>H!==S))},T=(k,S,A,D)=>{const I=(c.exceptions[k].values||[]).map((le,ie)=>ie===S?{...le,[A]:D}:le);b(k,I)},z=[{value:0,label:""},{value:1,label:""},{value:2,label:""},{value:3,label:""},{value:4,label:""},{value:5,label:""},{value:6,label:""}],W=async k=>{if(k.preventDefault(),!!c.title.trim()){g(!0);try{const S={title:c.title.trim(),description:c.description.trim()||void 0,priority:c.priority,type:c.type,recurrenceType:c.recurrenceType,isActive:!0,tags:c.tags,exceptions:c.exceptions,holidayHandling:c.holidayHandling};c.recurrenceType==="weekly"?S.weekday=c.weekday:c.recurrenceType==="monthly"&&(c.monthlyPattern==="weekday"?(S.monthlyPattern="weekday",S.monthlyWeek=c.monthlyWeek,S.monthlyWeekday=c.monthlyWeekday):(S.monthlyPattern="date",S.monthlyDate=c.monthlyDate)),await r(S),n(),u({title:"",description:"",priority:"medium",type:"simple",recurrenceType:"daily",weekday:1,monthlyDate:1,monthlyPattern:"date",monthlyWeek:"first",monthlyWeekday:3,tags:[],exceptions:[],holidayHandling:"show"})}catch(S){console.error("   :",S),alert("   .")}finally{g(!1)}}};return s?l.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[l.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm transition-opacity",onClick:n}),l.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:l.jsxs("form",{onSubmit:W,className:"relative w-full max-w-2xl bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 transform transition-all",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"  "}),l.jsx("button",{type:"button",onClick:n,className:"p-2 text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 transition-colors",children:l.jsx(St,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),l.jsx("input",{type:"text",value:c.title,onChange:k=>u({...c,title:k.target.value}),placeholder:"   ",className:"w-full text-lg px-4 py-3 bg-gray-50 dark:bg-gray-700/50 border-0 rounded-xl focus:ring-2 focus:ring-blue-500 placeholder-gray-400 dark:text-white",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" ()"}),l.jsx("textarea",{value:c.description,onChange:k=>u({...c,description:k.target.value}),placeholder:" ",className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-700/50 border-0 rounded-xl focus:ring-2 focus:ring-blue-500 placeholder-gray-400 dark:text-white resize-none",rows:2})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(Gl,{className:"w-4 h-4 inline mr-1"}),""]}),l.jsx("div",{className:"flex gap-2",children:[{value:"urgent",label:"",color:"text-red-700 bg-red-100 dark:bg-red-900/40 border-red-200 dark:border-red-800"},{value:"high",label:"",color:"text-orange-700 bg-orange-100 dark:bg-orange-900/40 border-orange-200 dark:border-orange-800"},{value:"medium",label:"",color:"text-yellow-700 bg-yellow-100 dark:bg-yellow-900/40 border-yellow-200 dark:border-yellow-800"},{value:"low",label:"",color:"text-green-700 bg-green-100 dark:bg-green-900/40 border-green-200 dark:border-green-800"}].map(k=>l.jsxs("label",{className:`flex-1 flex items-center justify-center p-2 rounded-lg cursor-pointer transition-all border ${c.priority===k.value?`ring-2 ring-offset-1 ring-blue-500 ${k.color} font-bold`:"bg-gray-50 dark:bg-gray-700/50 text-gray-600 dark:text-gray-400 border-transparent hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[l.jsx("input",{type:"radio",name:"priority",value:k.value,checked:c.priority===k.value,onChange:S=>u({...c,priority:S.target.value}),className:"sr-only"}),l.jsx("span",{className:"text-sm",children:k.label})]},k.value))})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(nh,{className:"w-4 h-4 inline mr-1"})," "]}),l.jsxs("select",{value:c.recurrenceType,onChange:k=>u({...c,recurrenceType:k.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[l.jsx("option",{value:"daily",children:""}),l.jsx("option",{value:"weekly",children:""}),l.jsx("option",{value:"monthly",children:""})]})]}),c.recurrenceType==="weekly"&&l.jsxs("div",{className:"animate-fadeIn",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),l.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:z.map(k=>l.jsx("button",{type:"button",onClick:()=>u({...c,weekday:k.value}),className:`flex-1 min-w-[60px] py-2 rounded-lg text-sm font-medium transition-colors ${c.weekday===k.value?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300 ring-2 ring-blue-500":"bg-gray-50 dark:bg-gray-700/50 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:k.label},k.value))})]}),c.recurrenceType==="monthly"&&l.jsxs("div",{className:"space-y-4 animate-fadeIn",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),l.jsxs("div",{className:"flex gap-4",children:[l.jsxs("label",{className:"flex items-center p-3 rounded-lg border border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors flex-1",children:[l.jsx("input",{type:"radio",checked:c.monthlyPattern==="date",onChange:()=>u({...c,monthlyPattern:"date"}),className:"mr-3 w-4 h-4 text-blue-600"}),l.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"  (: 15)"})]}),l.jsxs("label",{className:"flex items-center p-3 rounded-lg border border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors flex-1",children:[l.jsx("input",{type:"radio",checked:c.monthlyPattern==="weekday",onChange:()=>u({...c,monthlyPattern:"weekday"}),className:"mr-3 w-4 h-4 text-blue-600"}),l.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"  (:  )"})]})]})]}),c.monthlyPattern==="date"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),l.jsxs("select",{value:c.monthlyDate,onChange:k=>u({...c,monthlyDate:parseInt(k.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[Array.from({length:31},(k,S)=>S+1).map(k=>l.jsxs("option",{value:k,children:[k,""]},k)),l.jsx("option",{value:-1,children:""}),l.jsx("option",{value:-2,children:"  "}),l.jsx("option",{value:-3,children:" "})]})]}),c.monthlyPattern==="weekday"&&l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),l.jsxs("select",{value:c.monthlyWeek,onChange:k=>u({...c,monthlyWeek:k.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[l.jsx("option",{value:"first",children:"  "}),l.jsx("option",{value:"second",children:"  "}),l.jsx("option",{value:"third",children:"  "}),l.jsx("option",{value:"fourth",children:"  "}),l.jsx("option",{value:"last",children:" "})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),l.jsx("select",{value:c.monthlyWeekday,onChange:k=>u({...c,monthlyWeekday:parseInt(k.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:z.map(k=>l.jsx("option",{value:k.value,children:k.label},k.value))})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),l.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{value:"before",label:" "},{value:"after",label:" "},{value:"show",label:" "}].map(k=>l.jsxs("label",{className:`flex items-center justify-center p-2 rounded-lg cursor-pointer border transition-all ${c.holidayHandling===k.value?"bg-blue-50 border-blue-200 text-blue-700 dark:bg-blue-900/30 dark:border-blue-800 dark:text-blue-300":"bg-white border-gray-200 text-gray-600 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:[l.jsx("input",{type:"radio",name:"holidayHandling",value:k.value,checked:c.holidayHandling===k.value,onChange:S=>u({...c,holidayHandling:S.target.value}),className:"sr-only"}),l.jsx("span",{className:"text-sm",children:k.label})]},k.value))})]}),l.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-100 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[l.jsx(th,{className:"w-4 h-4 inline mr-1"}),"  ( )"]}),l.jsxs("button",{type:"button",onClick:m,className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium bg-blue-50 text-blue-600 dark:bg-blue-900/20 dark:text-blue-300 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors",children:[l.jsx(Bt,{className:"w-3 h-3"})," "]})]}),c.exceptions.map((k,S)=>l.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/30 rounded-xl space-y-3 border border-gray-100 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("select",{value:k.type,onChange:A=>x(S,"type",A.target.value),className:"flex-1 px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white mr-2",children:[l.jsx("option",{value:"date",children:"  "}),l.jsx("option",{value:"weekday",children:"  "}),l.jsx("option",{value:"week",children:"  "}),l.jsx("option",{value:"month",children:"  "}),l.jsx("option",{value:"conflict",children:"  "})]}),l.jsx("button",{type:"button",onClick:()=>p(S),className:"p-1.5 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:l.jsx(an,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-6 gap-2",children:[k.type==="date"&&Array.from({length:31},(A,D)=>D+1).map(A=>l.jsxs("label",{className:"flex items-center space-x-2 p-1 hover:bg-white dark:hover:bg-gray-600 rounded cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:k.values.includes(A),onChange:D=>{const _=k.values,H=D.target.checked?[..._,A]:_.filter(I=>I!==A);b(S,H)},className:"rounded text-blue-600 focus:ring-blue-500"}),l.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:[A,""]})]},A)),k.type==="weekday"&&z.map(A=>l.jsxs("label",{className:"flex items-center space-x-2 p-1 hover:bg-white dark:hover:bg-gray-600 rounded cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:k.values.includes(A.value),onChange:D=>{const _=k.values,H=D.target.checked?[..._,A.value]:_.filter(I=>I!==A.value);b(S,H)},className:"rounded text-blue-600 focus:ring-blue-500"}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:A.label})]},A.value)),k.type==="week"&&[1,2,3,4,-1].map(A=>l.jsxs("label",{className:"flex items-center space-x-2 p-1 hover:bg-white dark:hover:bg-gray-600 rounded cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:k.values.includes(A),onChange:D=>{const _=k.values,H=D.target.checked?[..._,A]:_.filter(I=>I!==A);b(S,H)},className:"rounded text-blue-600 focus:ring-blue-500"}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:Vo(A)})]},A)),k.type==="month"&&Array.from({length:12},(A,D)=>D+1).map(A=>l.jsxs("label",{className:"flex items-center space-x-2 p-1 hover:bg-white dark:hover:bg-gray-600 rounded cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:k.values.includes(A),onChange:D=>{const _=k.values,H=D.target.checked?[..._,A]:_.filter(I=>I!==A);b(S,H)},className:"rounded text-blue-600 focus:ring-blue-500"}),l.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:[A,""]})]},A))]}),k.type==="conflict"&&l.jsxs("div",{className:"space-y-3",children:[(k.values||[]).map((A,D)=>l.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-700",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("span",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:["   ",D+1]}),l.jsx("button",{type:"button",onClick:()=>L(S,D),className:"text-red-500 hover:text-red-700 p-1",children:l.jsx(St,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-blue-800 dark:text-blue-200 mb-1",children:" "}),l.jsxs("select",{value:A.targetTemplateTitle,onChange:_=>T(S,D,"targetTemplateTitle",_.target.value),className:"w-full px-2 py-1 text-sm border border-blue-300 dark:border-blue-600 rounded focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 dark:text-white",children:[l.jsx("option",{value:"",children:" "}),i.map(_=>l.jsx("option",{value:_.title,children:_.title},_.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-blue-800 dark:text-blue-200 mb-1",children:" "}),l.jsxs("select",{value:A.scope,onChange:_=>T(S,D,"scope",_.target.value),className:"w-full px-2 py-1 text-sm border border-blue-300 dark:border-blue-600 rounded focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 dark:text-white",children:[l.jsx("option",{value:"same_date",children:"  "}),l.jsx("option",{value:"same_week",children:"  "}),l.jsx("option",{value:"same_month",children:"  "})]})]})]})]},D)),l.jsxs("button",{type:"button",onClick:()=>w(S),className:"w-full py-2 px-3 text-sm border-2 border-dashed border-blue-300 dark:border-blue-600 text-blue-600 dark:text-blue-400 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/30 flex items-center justify-center gap-2",children:[l.jsx(Bt,{className:"w-4 h-4"}),"  "]})]})]},S))]})]}),l.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200 dark:border-gray-700",children:[l.jsx("button",{type:"button",onClick:n,className:"px-5 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors",disabled:f,children:""}),l.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:shadow-lg hover:shadow-blue-500/30 transition-all duration-300 transform hover:-translate-y-0.5 font-medium disabled:opacity-50 disabled:cursor-not-allowed",disabled:f||!c.title.trim(),children:[l.jsx(Bt,{className:"w-4 h-4"}),f?" ...":""]})]})]})})]}):null},bj=()=>{const{recurringTemplates:s,recurringInstances:n,updateRecurringTemplate:r,deleteRecurringTemplate:i,cleanupDuplicateTemplates:c}=Qt(),[u,f]=O.useState("templates"),[g,m]=O.useState(!1),[p,x]=O.useState(!1),[b,w]=O.useState(null),[L,T]=O.useState({excludeWeeks:[],excludeDates:[]});O.useEffect(()=>{try{const I=localStorage.getItem("globalRecurringExceptions");I&&T(JSON.parse(I))}catch(I){console.error("   :",I)}},[]);const z=I=>{try{localStorage.setItem("globalRecurringExceptions",JSON.stringify(I)),T(I)}catch(le){console.error("   :",le)}},W=I=>{const le={...L},ie=le.excludeWeeks.indexOf(I);ie===-1?le.excludeWeeks.push(I):le.excludeWeeks.splice(ie,1),z(le)},k=s.filter(I=>I.isActive),S=s.filter(I=>!I.isActive),A=async I=>{const le=s.find(ie=>ie.id===I);le&&await r(I,{isActive:!le.isActive})},D=async I=>{confirm("   ?")&&await i(I)},_=I=>{w(I),x(!0)},H=I=>{if(I.recurrenceType==="weekly")return` ${["","","","","","",""][I.weekday||0]}`;if(I.recurrenceType==="monthly")if(I.monthlyPattern==="weekday"&&I.monthlyWeek&&I.monthlyWeekday!==void 0){const le=["","","","","","",""];return` ${{first:" ",second:" ",third:" ",fourth:" ",last:""}[I.monthlyWeek]}  ${le[I.monthlyWeekday]}`}else return I.monthlyDate===-1?" ":I.monthlyDate===-2?"   ":I.monthlyDate===-3?"  ":` ${I.monthlyDate}`;return""};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:" "}),l.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:shadow-lg hover:shadow-blue-500/30 transition-all duration-300 transform hover:-translate-y-0.5 font-medium",children:[l.jsx(Bt,{className:"w-4 h-4"}),"  "]})]}),l.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:l.jsxs("nav",{className:"flex justify-between",children:[l.jsx("button",{onClick:()=>f("templates"),className:`py-4 px-1 border-b-2 font-medium text-sm ${u==="templates"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400"}`,children:" "}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsx("button",{onClick:()=>f("exceptions"),className:`py-4 px-1 border-b-2 font-medium text-sm ${u==="exceptions"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400"}`,children:" "}),l.jsx("button",{onClick:()=>f("holidays"),className:`py-4 px-1 border-b-2 font-medium text-sm ${u==="holidays"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400"}`,children:" "})]})]})}),u==="templates"&&l.jsxs("div",{className:"space-y-6",children:[k.length>0&&l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[l.jsx(Lu,{className:"w-5 h-5 text-green-600"}),"   (",k.length,")"]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map(I=>l.jsx("div",{className:"card p-3 bg-green-50 dark:bg-green-900/10 border-green-200 dark:border-green-800",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-1 truncate",children:I.title}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300 whitespace-nowrap overflow-hidden text-ellipsis",children:H(I)})]}),l.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[l.jsx("span",{className:`px-2 py-1 rounded text-xs ${I.priority==="urgent"?"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300":I.priority==="high"?"bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-300":I.priority==="medium"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300":"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}`,children:I.priority==="urgent"?"":I.priority==="high"?"":I.priority==="medium"?"":""}),l.jsx("button",{onClick:()=>_(I),className:"p-1 hover:bg-blue-100 dark:hover:bg-blue-800 rounded",title:"",children:l.jsx(_o,{className:"w-4 h-4 text-blue-600"})}),l.jsx("button",{onClick:()=>A(I.id),className:"p-1 hover:bg-green-100 dark:hover:bg-green-800 rounded",title:"",children:l.jsx(Om,{className:"w-4 h-4 text-green-600"})}),l.jsx("button",{onClick:()=>D(I.id),className:"p-1 hover:bg-red-100 dark:hover:bg-red-800 rounded",title:"",children:l.jsx(an,{className:"w-4 h-4 text-red-600"})})]})]})},I.id))})]}),S.length>0&&l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[l.jsx(Om,{className:"w-5 h-5 text-gray-500"}),"   (",S.length,")"]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:S.map(I=>l.jsx("div",{className:"card p-3 bg-gray-50 dark:bg-gray-800 opacity-75",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h4",{className:"font-medium text-gray-600 dark:text-gray-300 mb-1 truncate",children:I.title}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap overflow-hidden text-ellipsis",children:H(I)})]}),l.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[l.jsx("button",{onClick:()=>A(I.id),className:"p-1 hover:bg-green-100 dark:hover:bg-green-800 rounded",title:"",children:l.jsx(Lu,{className:"w-4 h-4 text-green-600"})}),l.jsx("button",{onClick:()=>D(I.id),className:"p-1 hover:bg-red-100 dark:hover:bg-red-800 rounded",title:"",children:l.jsx(an,{className:"w-4 h-4 text-red-600"})})]})]})},I.id))})]}),s.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(mt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"  "}),l.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"      ."}),l.jsx("button",{onClick:()=>m(!0),className:"btn-primary",children:"   "})]})]}),u==="exceptions"&&l.jsx("div",{className:"space-y-6",children:l.jsxs("div",{className:"card p-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"    "}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"text-md font-medium text-gray-800 dark:text-gray-200 mb-3",children:"  "}),l.jsxs("div",{className:"flex gap-1 justify-between overflow-hidden",children:[l.jsx("div",{className:"text-center px-1 py-1 bg-blue-50 dark:bg-blue-900/30 rounded flex-1 min-w-0",children:l.jsx("div",{className:"font-medium text-blue-700 dark:text-blue-300 whitespace-nowrap overflow-hidden text-ellipsis",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""})}),l.jsx("div",{className:"text-center px-1 py-1 bg-green-50 dark:bg-green-900/30 rounded flex-1 min-w-0",children:l.jsx("div",{className:"font-medium text-green-700 dark:text-green-300 whitespace-nowrap overflow-hidden text-ellipsis",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""})}),l.jsx("div",{className:"text-center px-1 py-1 bg-yellow-50 dark:bg-yellow-900/30 rounded flex-1 min-w-0",children:l.jsx("div",{className:"font-medium text-yellow-700 dark:text-yellow-300 whitespace-nowrap overflow-hidden text-ellipsis",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""})}),l.jsx("div",{className:"text-center px-1 py-1 bg-purple-50 dark:bg-purple-900/30 rounded flex-1 min-w-0",children:l.jsx("div",{className:"font-medium text-purple-700 dark:text-purple-300 whitespace-nowrap overflow-hidden text-ellipsis",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""})}),l.jsx("div",{className:"text-center px-1 py-1 bg-red-50 dark:bg-red-900/30 rounded flex-1 min-w-0",children:l.jsx("div",{className:"font-medium text-red-700 dark:text-red-300 whitespace-nowrap overflow-hidden text-ellipsis",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""})})]}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-3",children:"*      . (4   4, 5   5)"})]}),l.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[l.jsx("h4",{className:"text-md font-medium text-gray-800 dark:text-gray-200 mb-3",children:"   "}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex gap-1 justify-between overflow-hidden",children:[l.jsxs("label",{className:"flex flex-col items-center space-y-1 px-1 py-1 bg-blue-50 dark:bg-blue-900/30 rounded cursor-pointer flex-1 min-w-0",children:[l.jsx("span",{className:"text-blue-700 dark:text-blue-300 whitespace-nowrap overflow-hidden text-ellipsis font-medium",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""}),l.jsx("input",{type:"checkbox",className:"rounded w-3 h-3",checked:L.excludeWeeks.includes(1),onChange:()=>W(1)})]}),l.jsxs("label",{className:"flex flex-col items-center space-y-1 px-1 py-1 bg-green-50 dark:bg-green-900/30 rounded cursor-pointer flex-1 min-w-0",children:[l.jsx("span",{className:"text-green-700 dark:text-green-300 whitespace-nowrap overflow-hidden text-ellipsis font-medium",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""}),l.jsx("input",{type:"checkbox",className:"rounded w-3 h-3",checked:L.excludeWeeks.includes(2),onChange:()=>W(2)})]}),l.jsxs("label",{className:"flex flex-col items-center space-y-1 px-1 py-1 bg-yellow-50 dark:bg-yellow-900/30 rounded cursor-pointer flex-1 min-w-0",children:[l.jsx("span",{className:"text-yellow-700 dark:text-yellow-300 whitespace-nowrap overflow-hidden text-ellipsis font-medium",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""}),l.jsx("input",{type:"checkbox",className:"rounded w-3 h-3",checked:L.excludeWeeks.includes(3),onChange:()=>W(3)})]}),l.jsxs("label",{className:"flex flex-col items-center space-y-1 px-1 py-1 bg-purple-50 dark:bg-purple-900/30 rounded cursor-pointer flex-1 min-w-0",children:[l.jsx("span",{className:"text-purple-700 dark:text-purple-300 whitespace-nowrap overflow-hidden text-ellipsis font-medium",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""}),l.jsx("input",{type:"checkbox",className:"rounded w-3 h-3",checked:L.excludeWeeks.includes(4),onChange:()=>W(4)})]}),l.jsxs("label",{className:"flex flex-col items-center space-y-1 px-1 py-1 bg-red-50 dark:bg-red-900/30 rounded cursor-pointer flex-1 min-w-0",children:[l.jsx("span",{className:"text-red-700 dark:text-red-300 whitespace-nowrap overflow-hidden text-ellipsis font-medium",style:{fontSize:"clamp(8px, 2.5vw, 12px)"},children:""}),l.jsx("input",{type:"checkbox",className:"rounded w-3 h-3",checked:L.excludeWeeks.includes(5),onChange:()=>W(5)})]})]}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"     .      ."}),L.excludeWeeks.length>0&&l.jsxs("div",{className:"mt-3 p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg",children:[l.jsxs("p",{className:"text-sm text-orange-700 dark:text-orange-300 font-medium",children:["  : ",L.excludeWeeks.map(I=>Vo(I)).join(", ")]}),l.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400 mt-1",children:"      ."})]})]}),l.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h4",{className:"text-md font-medium text-gray-800 dark:text-gray-200",children:"   "}),l.jsx("button",{className:"btn-secondary px-2 py-1 whitespace-nowrap",style:{fontSize:"clamp(10px, 2vw, 14px)"},children:"  "})]}),l.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-2 rounded-lg",children:l.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"         ."})})]})]})]})]})}),u==="holidays"&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(pw,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"  "}),l.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"      ."}),l.jsxs("div",{className:"card p-6 max-w-md mx-auto",children:[l.jsx("h4",{className:"font-medium mb-3",children:" "}),l.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-300 text-left space-y-2",children:[l.jsx("li",{children:"   "}),l.jsx("li",{children:"    "}),l.jsx("li",{children:"   "}),l.jsx("li",{children:"  "})]})]})]}),l.jsx("div",{className:"card p-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-1",children:" "}),l.jsx("p",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:s.length})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-1",children:""}),l.jsx("p",{className:"text-xl font-bold text-green-600 dark:text-green-400",children:k.length})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-1",children:" "}),l.jsx("p",{className:"text-xl font-bold text-purple-600 dark:text-purple-400",children:n.filter(I=>{const le=new Date().toDateString();return new Date(I.date).toDateString()===le}).length})]})]})}),l.jsx(xj,{isOpen:g,onClose:()=>m(!1)}),p&&b&&l.jsx(vj,{template:b,onClose:()=>{x(!1),w(null)},onSave:async I=>{await r(b.id,I),x(!1),w(null)}})]})},vj=({template:s,onClose:n,onSave:r})=>{const{recurringTemplates:i}=Qt(),[c,u]=O.useState({title:s.title,description:s.description||"",priority:s.priority,type:s.type,recurrenceType:s.recurrenceType,weekday:s.weekday||0,monthlyDate:s.monthlyDate||1,monthlyPattern:s.monthlyPattern||"date",monthlyWeek:s.monthlyWeek||"first",monthlyWeekday:s.monthlyWeekday||3,tags:s.tags||[],exceptions:s.exceptions||[],holidayHandling:s.holidayHandling||"show"}),[f,g]=O.useState(!1);O.useEffect(()=>{u({title:s.title,description:s.description||"",priority:s.priority,type:s.type,recurrenceType:s.recurrenceType,weekday:s.weekday||0,monthlyDate:s.monthlyDate||1,monthlyPattern:s.monthlyPattern||"date",monthlyWeek:s.monthlyWeek||"first",monthlyWeekday:s.monthlyWeekday||3,tags:s.tags||[],exceptions:s.exceptions||[],holidayHandling:s.holidayHandling||"show"})},[s]);const m=()=>{u(k=>({...k,exceptions:[...k.exceptions,{type:"date",values:[]}]}))},p=k=>{u(S=>({...S,exceptions:S.exceptions.filter((A,D)=>D!==k)}))},x=(k,S,A)=>{u(D=>({...D,exceptions:D.exceptions.map((_,H)=>H===k?{..._,[S]:A}:_)}))},b=(k,S)=>{u(A=>({...A,exceptions:A.exceptions.map((D,_)=>_===k?{...D,values:S}:D)}))},w=k=>{const A=c.exceptions[k].values||[],D={targetTemplateTitle:"",scope:"same_week"};b(k,[...A,D])},L=(k,S)=>{const D=c.exceptions[k].values||[];b(k,D.filter((_,H)=>H!==S))},T=(k,S,A,D)=>{const I=(c.exceptions[k].values||[]).map((le,ie)=>ie===S?{...le,[A]:D}:le);b(k,I)},z=[{value:0,label:""},{value:1,label:""},{value:2,label:""},{value:3,label:""},{value:4,label:""},{value:5,label:""},{value:6,label:""}],W=async k=>{k.preventDefault(),g(!0);try{const S={title:c.title.trim(),description:c.description.trim()||void 0,priority:c.priority,type:c.type,recurrenceType:c.recurrenceType,tags:c.tags,exceptions:c.exceptions,holidayHandling:c.holidayHandling,updatedAt:new Date};c.recurrenceType==="weekly"?S.weekday=c.weekday:c.recurrenceType==="monthly"&&(c.monthlyPattern==="weekday"?(S.monthlyPattern="weekday",S.monthlyWeek=c.monthlyWeek,S.monthlyWeekday=c.monthlyWeekday):(S.monthlyPattern="date",S.monthlyDate=c.monthlyDate)),await r(S),n()}catch(S){console.error("  :",S),alert("  .")}finally{g(!1)}};return l.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[l.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm transition-opacity",onClick:n}),l.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:l.jsxs("form",{onSubmit:W,className:"relative w-full max-w-2xl bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 transform transition-all",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"  "}),l.jsx("button",{type:"button",onClick:n,className:"p-2 text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 transition-colors",children:l.jsx(St,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),l.jsx("input",{type:"text",value:c.title,onChange:k=>u({...c,title:k.target.value}),className:"w-full text-lg px-4 py-3 bg-gray-50 dark:bg-gray-700/50 border-0 rounded-xl focus:ring-2 focus:ring-blue-500 placeholder-gray-400 dark:text-white",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),l.jsx("textarea",{value:c.description,onChange:k=>u({...c,description:k.target.value}),className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-700/50 border-0 rounded-xl focus:ring-2 focus:ring-blue-500 placeholder-gray-400 dark:text-white resize-none",rows:2})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(Gl,{className:"w-4 h-4 inline mr-1"}),""]}),l.jsx("div",{className:"flex gap-2",children:[{value:"urgent",label:"",color:"text-red-700 bg-red-100 dark:bg-red-900/40 border-red-200 dark:border-red-800"},{value:"high",label:"",color:"text-orange-700 bg-orange-100 dark:bg-orange-900/40 border-orange-200 dark:border-orange-800"},{value:"medium",label:"",color:"text-yellow-700 bg-yellow-100 dark:bg-yellow-900/40 border-yellow-200 dark:border-yellow-800"},{value:"low",label:"",color:"text-green-700 bg-green-100 dark:bg-green-900/40 border-green-200 dark:border-green-800"}].map(k=>l.jsxs("label",{className:`flex-1 flex items-center justify-center p-2 rounded-lg cursor-pointer transition-all border ${c.priority===k.value?`ring-2 ring-offset-1 ring-blue-500 ${k.color} font-bold`:"bg-gray-50 dark:bg-gray-700/50 text-gray-600 dark:text-gray-400 border-transparent hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[l.jsx("input",{type:"radio",name:"priority",value:k.value,checked:c.priority===k.value,onChange:S=>u({...c,priority:S.target.value}),className:"sr-only"}),l.jsx("span",{className:"text-sm",children:k.label})]},k.value))})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(nh,{className:"w-4 h-4 inline mr-1"})," "]}),l.jsxs("select",{value:c.recurrenceType,onChange:k=>u({...c,recurrenceType:k.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[l.jsx("option",{value:"daily",children:""}),l.jsx("option",{value:"weekly",children:""}),l.jsx("option",{value:"monthly",children:""})]})]}),c.recurrenceType==="weekly"&&l.jsxs("div",{className:"animate-fadeIn",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),l.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:z.map(k=>l.jsx("button",{type:"button",onClick:()=>u({...c,weekday:k.value}),className:`flex-1 min-w-[60px] py-2 rounded-lg text-sm font-medium transition-colors ${c.weekday===k.value?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300 ring-2 ring-blue-500":"bg-gray-50 dark:bg-gray-700/50 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:k.label},k.value))})]}),c.recurrenceType==="monthly"&&l.jsxs("div",{className:"space-y-4 animate-fadeIn",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),l.jsxs("div",{className:"flex gap-4",children:[l.jsxs("label",{className:"flex items-center p-3 rounded-lg border border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors flex-1",children:[l.jsx("input",{type:"radio",checked:c.monthlyPattern==="date",onChange:()=>u({...c,monthlyPattern:"date"}),className:"mr-3 w-4 h-4 text-blue-600"}),l.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"  (: 15)"})]}),l.jsxs("label",{className:"flex items-center p-3 rounded-lg border border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors flex-1",children:[l.jsx("input",{type:"radio",checked:c.monthlyPattern==="weekday",onChange:()=>u({...c,monthlyPattern:"weekday"}),className:"mr-3 w-4 h-4 text-blue-600"}),l.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"  (:  )"})]})]})]}),c.monthlyPattern==="date"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),l.jsxs("select",{value:c.monthlyDate,onChange:k=>u({...c,monthlyDate:parseInt(k.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[Array.from({length:31},(k,S)=>S+1).map(k=>l.jsxs("option",{value:k,children:[k,""]},k)),l.jsx("option",{value:-1,children:""}),l.jsx("option",{value:-2,children:"  "}),l.jsx("option",{value:-3,children:" "})]})]}),c.monthlyPattern==="weekday"&&l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),l.jsxs("select",{value:c.monthlyWeek,onChange:k=>u({...c,monthlyWeek:k.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[l.jsx("option",{value:"first",children:"  "}),l.jsx("option",{value:"second",children:"  "}),l.jsx("option",{value:"third",children:"  "}),l.jsx("option",{value:"fourth",children:"  "}),l.jsx("option",{value:"last",children:" "})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),l.jsx("select",{value:c.monthlyWeekday,onChange:k=>u({...c,monthlyWeekday:parseInt(k.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:z.map(k=>l.jsx("option",{value:k.value,children:k.label},k.value))})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),l.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{value:"before",label:" "},{value:"after",label:" "},{value:"show",label:" "}].map(k=>l.jsxs("label",{className:`flex items-center justify-center p-2 rounded-lg cursor-pointer border transition-all ${c.holidayHandling===k.value?"bg-blue-50 border-blue-200 text-blue-700 dark:bg-blue-900/30 dark:border-blue-800 dark:text-blue-300":"bg-white border-gray-200 text-gray-600 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:[l.jsx("input",{type:"radio",name:"holidayHandling",value:k.value,checked:c.holidayHandling===k.value,onChange:S=>u({...c,holidayHandling:S.target.value}),className:"sr-only"}),l.jsx("span",{className:"text-sm",children:k.label})]},k.value))})]}),l.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-100 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[l.jsx(th,{className:"w-4 h-4 inline mr-1"}),"  ( )"]}),l.jsxs("button",{type:"button",onClick:m,className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium bg-blue-50 text-blue-600 dark:bg-blue-900/20 dark:text-blue-300 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors",children:[l.jsx(Bt,{className:"w-3 h-3"})," "]})]}),c.exceptions.map((k,S)=>l.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/30 rounded-xl space-y-3 border border-gray-100 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("select",{value:k.type,onChange:A=>x(S,"type",A.target.value),className:"flex-1 px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white mr-2",children:[l.jsx("option",{value:"date",children:"  "}),l.jsx("option",{value:"weekday",children:"  "}),l.jsx("option",{value:"week",children:"  "}),l.jsx("option",{value:"month",children:"  "}),l.jsx("option",{value:"conflict",children:"  "})]}),l.jsx("button",{type:"button",onClick:()=>p(S),className:"p-1.5 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:l.jsx(an,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-6 gap-2",children:[k.type==="date"&&Array.from({length:31},(A,D)=>D+1).map(A=>l.jsxs("label",{className:"flex items-center space-x-2 p-1 hover:bg-white dark:hover:bg-gray-600 rounded cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:k.values.includes(A),onChange:D=>{const _=k.values,H=D.target.checked?[..._,A]:_.filter(I=>I!==A);b(S,H)},className:"rounded text-blue-600 focus:ring-blue-500"}),l.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:[A,""]})]},A)),k.type==="weekday"&&z.map(A=>l.jsxs("label",{className:"flex items-center space-x-2 p-1 hover:bg-white dark:hover:bg-gray-600 rounded cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:k.values.includes(A.value),onChange:D=>{const _=k.values,H=D.target.checked?[..._,A.value]:_.filter(I=>I!==A.value);b(S,H)},className:"rounded text-blue-600 focus:ring-blue-500"}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:A.label})]},A.value)),k.type==="week"&&[1,2,3,4,-1].map(A=>l.jsxs("label",{className:"flex items-center space-x-2 p-1 hover:bg-white dark:hover:bg-gray-600 rounded cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:k.values.includes(A),onChange:D=>{const _=k.values,H=D.target.checked?[..._,A]:_.filter(I=>I!==A);b(S,H)},className:"rounded text-blue-600 focus:ring-blue-500"}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:Vo(A)})]},A)),k.type==="month"&&Array.from({length:12},(A,D)=>D+1).map(A=>l.jsxs("label",{className:"flex items-center space-x-2 p-1 hover:bg-white dark:hover:bg-gray-600 rounded cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:k.values.includes(A),onChange:D=>{const _=k.values,H=D.target.checked?[..._,A]:_.filter(I=>I!==A);b(S,H)},className:"rounded text-blue-600 focus:ring-blue-500"}),l.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:[A,""]})]},A))]}),k.type==="conflict"&&l.jsxs("div",{className:"space-y-3",children:[(k.values||[]).map((A,D)=>l.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-700",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("span",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:["   ",D+1]}),l.jsx("button",{type:"button",onClick:()=>L(S,D),className:"text-red-500 hover:text-red-700 p-1",children:l.jsx(St,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-blue-800 dark:text-blue-200 mb-1",children:" "}),l.jsxs("select",{value:A.targetTemplateTitle,onChange:_=>T(S,D,"targetTemplateTitle",_.target.value),className:"w-full px-2 py-1 text-sm border border-blue-300 dark:border-blue-600 rounded focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 dark:text-white",children:[l.jsx("option",{value:"",children:" "}),i.map(_=>l.jsx("option",{value:_.title,children:_.title},_.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-blue-800 dark:text-blue-200 mb-1",children:" "}),l.jsxs("select",{value:A.scope,onChange:_=>T(S,D,"scope",_.target.value),className:"w-full px-2 py-1 text-sm border border-blue-300 dark:border-blue-600 rounded focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 dark:text-white",children:[l.jsx("option",{value:"same_date",children:"  "}),l.jsx("option",{value:"same_week",children:"  "}),l.jsx("option",{value:"same_month",children:"  "})]})]})]})]},D)),l.jsxs("button",{type:"button",onClick:()=>w(S),className:"w-full py-2 px-3 text-sm border-2 border-dashed border-blue-300 dark:border-blue-600 text-blue-600 dark:text-blue-400 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/30 flex items-center justify-center gap-2",children:[l.jsx(Bt,{className:"w-4 h-4"}),"  "]})]})]},S))]})]}),l.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200 dark:border-gray-700",children:[l.jsx("button",{type:"button",onClick:n,className:"px-5 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors",disabled:f,children:""}),l.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:shadow-lg hover:shadow-blue-500/30 transition-all duration-300 transform hover:-translate-y-0.5 font-medium disabled:opacity-50 disabled:cursor-not-allowed",disabled:f,children:[l.jsx(gs,{className:"w-4 h-4"}),f?" ...":""]})]})]})})]})},wj=({searchTerm:s="",priorityFilter:n="all",typeFilter:r="all",projectFilter:i="all",tagFilter:c=[]})=>{const{todos:u,toggleTodo:f,getRecurringTodos:g}=Qt(),[m,p]=O.useState(new Set(["today"])),[x,b]=O.useState("period"),[w,L]=O.useState("yesterday"),T=g(),z=[...u,...T];console.log("   -  :",z.length),console.log("   -  :",u.length),console.log("   -  :",T.length);const W=z.filter(R=>R.completed&&R.completedAt&&(s===""||R.title.toLowerCase().includes(s.toLowerCase())||R.description&&R.description.toLowerCase().includes(s.toLowerCase()))&&(n==="all"||R.priority===n)&&(r==="all"||R.type===r)&&(i==="all"||i==="longterm"&&R.project==="longterm"||i==="shortterm"&&R.project==="shortterm")&&(c.length===0||R.tags&&c.every(re=>R.tags?.includes(re)))),k=[];z.forEach(R=>{R.subTasks&&R.subTasks.length>0&&R.subTasks.filter(re=>re.completed&&re.completedAt&&re.completedAt!==null).forEach(re=>{const C=s===""||re.title.toLowerCase().includes(s.toLowerCase())||re.description&&re.description.toLowerCase().includes(s.toLowerCase()),M=n==="all"||re.priority===n;C&&M&&k.push({...re,type:"simple",recurrence:"none",isSubTask:!0,parentTitle:R.title,parentDescription:R.description,createdAt:re.createdAt,updatedAt:re.updatedAt})})});const S=[...W,...k].sort((R,re)=>{const C=xe=>{if(!xe)return 0;try{const X=new Date(xe).getTime();return isNaN(X)?0:X}catch{return 0}},M=C(R.completedAt);return C(re.completedAt)-M});console.log("   -  :",S.length),console.log("   -   :",S.filter(R=>R._isRecurringInstance).length);const A=S.find(R=>R.title==="");A?console.log("   -  :",{title:A.title,completed:A.completed,completedAt:A.completedAt,_isRecurringInstance:A._isRecurringInstance}):(console.log("   -    "),console.log("   -   :",S.map(R=>R.title)));const D=()=>{const R=new Date,re=new Date(R.getFullYear(),R.getMonth(),R.getDate()),C=new Date(re);C.setDate(C.getDate()-1);const M=new Date(re);M.setDate(re.getDate()-re.getDay());const Q=new Date(M);Q.setDate(M.getDate()-7),new Date(M).setDate(M.getDate()-1);const X=new Date(re.getFullYear(),re.getMonth(),1),ue=new Date(re.getFullYear(),re.getMonth()-1,1);new Date(re.getFullYear(),re.getMonth(),0);const K={today:[],yesterday:[],thisWeek:[],lastWeek:[],thisMonth:[],lastMonth:[],older:[]};return S.forEach(ee=>{if(!ee.completedAt)return;const oe=new Date(ee.completedAt),Ne=new Date(oe.getFullYear(),oe.getMonth(),oe.getDate());Ne.getTime()===re.getTime()?K.today.push(ee):Ne.getTime()===C.getTime()?K.yesterday.push(ee):oe>=M&&Ne<re?K.thisWeek.push(ee):oe>=Q&&oe<M?K.lastWeek.push(ee):oe>=X&&oe<Q?K.thisMonth.push(ee):oe>=ue&&oe<X?K.lastMonth.push(ee):oe<ue&&K.older.push(ee)}),Object.values(K).forEach(ee=>{ee.sort((oe,Ne)=>!oe.completedAt||!Ne.completedAt?0:new Date(Ne.completedAt).getTime()-new Date(oe.completedAt).getTime())}),K},_=()=>{const R={};S.forEach(C=>{if(!C.completedAt)return;const Q=new Date(C.completedAt).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",weekday:"short"});R[Q]||(R[Q]=[]),R[Q].push(C)}),Object.values(R).forEach(C=>{C.sort((M,Q)=>!M.completedAt||!Q.completedAt?0:new Date(Q.completedAt).getTime()-new Date(M.completedAt).getTime())});const re=Object.keys(R).sort((C,M)=>{const Q=new Date(R[C][0].completedAt);return new Date(R[M][0].completedAt).getTime()-Q.getTime()});return{groupedByDay:R,sortedKeys:re}},H=()=>{const R={};S.forEach(C=>{if(!C.completedAt)return;const M=new Date(C.completedAt),Q=new Date(M);Q.setDate(M.getDate()-M.getDay()),Q.setHours(0,0,0,0);const xe=new Date(Q);xe.setDate(Q.getDate()+6);const X=`${Q.toLocaleDateString("ko-KR",{month:"2-digit",day:"2-digit"})} ~ ${xe.toLocaleDateString("ko-KR",{month:"2-digit",day:"2-digit"})}`;R[X]||(R[X]=[]),R[X].push(C)}),Object.values(R).forEach(C=>{C.sort((M,Q)=>!M.completedAt||!Q.completedAt?0:new Date(Q.completedAt).getTime()-new Date(M.completedAt).getTime())});const re=Object.keys(R).sort((C,M)=>{const Q=new Date(R[C][0].completedAt);return new Date(R[M][0].completedAt).getTime()-Q.getTime()});return{groupedByWeek:R,sortedKeys:re}},I=()=>{const R={};S.forEach(C=>{if(!C.completedAt)return;const Q=new Date(C.completedAt).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit"});R[Q]||(R[Q]=[]),R[Q].push(C)}),Object.values(R).forEach(C=>{C.sort((M,Q)=>!M.completedAt||!Q.completedAt?0:new Date(Q.completedAt).getTime()-new Date(M.completedAt).getTime())});const re=Object.keys(R).sort((C,M)=>{const Q=new Date(R[C][0].completedAt);return new Date(R[M][0].completedAt).getTime()-Q.getTime()});return{groupedByMonth:R,sortedKeys:re}},le=R=>{const re=new Set(m);re.has(R)?re.delete(R):re.add(R),p(re)},ie=()=>{L(R=>{switch(R){case"yesterday":return"lastWeek";case"lastWeek":return"lastMonth";case"lastMonth":return"yesterday";default:return"yesterday"}})},be=R=>{const re={low:"text-gray-500 bg-gray-100 dark:bg-gray-800",medium:"text-blue-700 bg-blue-100 dark:bg-blue-900/30",high:"text-orange-700 bg-orange-100 dark:bg-orange-900/30",urgent:"text-red-700 bg-red-100 dark:bg-red-900/30"},C=()=>{f(R.id)};return l.jsx("div",{className:"border-l-2 border-green-500 bg-green-50 dark:bg-green-900/10 p-2 sm:p-3 rounded-r-lg",children:l.jsxs("div",{className:"flex items-start justify-between gap-2",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[l.jsx(xu,{className:"w-3 h-3 text-green-600 flex-shrink-0"}),l.jsx("h3",{className:"text-xs sm:text-sm font-medium text-green-800 dark:text-green-300 line-through truncate",children:R.isSubTask?` ${R.title} (${R.parentTitle})`:R.title})]}),l.jsxs("div",{className:"flex flex-wrap items-center gap-1 mb-1",children:[R.isSubTask?R.parentDescription&&l.jsx("span",{className:"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 px-1 py-0.5 rounded text-xs",children:R.parentDescription}):R.description&&l.jsx("span",{className:"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 px-1 py-0.5 rounded text-xs",children:R.description}),l.jsxs("span",{className:`px-1 py-0.5 rounded text-xs ${re[R.priority]}`,children:[R.priority==="low"&&"",R.priority==="medium"&&"",R.priority==="high"&&"",R.priority==="urgent"&&""]}),R.isSubTask&&l.jsx("span",{className:"bg-indigo-200 dark:bg-indigo-800 text-indigo-700 dark:text-indigo-300 px-1 py-0.5 rounded text-xs",children:""}),R._isRecurringInstance&&l.jsx("span",{className:"bg-purple-200 dark:bg-purple-800 text-purple-700 dark:text-purple-300 px-1 py-0.5 rounded text-xs",children:""}),R.type==="project"&&l.jsx("span",{className:"bg-green-200 dark:bg-green-800 text-green-700 dark:text-green-300 px-1 py-0.5 rounded text-xs",children:R.project==="longterm"?"":""})]}),R.completedAt&&l.jsx("div",{className:"text-xs text-green-600 dark:text-green-400",children:l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(La,{className:"w-3 h-3"}),b_(R.completedAt)," "]})})]}),l.jsx("div",{className:"flex items-start",children:l.jsx("button",{onClick:C,className:"p-1 hover:bg-green-100 dark:hover:bg-green-800 rounded transition-colors",title:" ",children:l.jsx(Ju,{className:"w-3 h-3 text-green-600 dark:text-green-400"})})})]})},R.id)},Ee=(R,re,C,M)=>{if(re.length===0)return null;const Q=m.has(C);return l.jsxs("div",{className:"mb-4",children:[l.jsxs("button",{onClick:()=>le(C),className:"w-full flex items-center justify-between p-2 sm:p-3 bg-gray-100 dark:bg-gray-800 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[l.jsx("div",{className:"w-4 h-4 flex-shrink-0",children:M}),l.jsxs("span",{className:"text-xs sm:text-sm font-medium text-gray-900 dark:text-white flex-1 leading-tight",children:[R," (",re.length,")"]})]}),Q?l.jsx(eh,{className:"w-4 h-4 flex-shrink-0"}):l.jsx(bs,{className:"w-4 h-4 flex-shrink-0"})]}),Q&&l.jsx("div",{className:"mt-2 space-y-2",children:re.map(be)})]},C)},_e=D(),ge=_(),je=H(),Ae=I(),P=S.length,ce=()=>{switch(w){case"yesterday":return{count:_e.yesterday.length,label:"",color:"text-orange-600 dark:text-orange-400"};case"lastWeek":return{count:_e.lastWeek.length,label:"",color:"text-indigo-600 dark:text-indigo-400"};case"lastMonth":return{count:_e.lastMonth.length,label:"",color:"text-pink-600 dark:text-pink-400"};default:return{count:_e.yesterday.length,label:"",color:"text-orange-600 dark:text-orange-400"}}},pe=()=>{if(x==="daily"){const{groupedByDay:R,sortedKeys:re}=ge;return l.jsx("div",{className:"space-y-4",children:re.map(C=>Ee(C,R[C],`day-${C}`,l.jsx(mt,{className:"w-5 h-5 text-blue-600"})))})}else if(x==="weekly"){const{groupedByWeek:R,sortedKeys:re}=je;return l.jsx("div",{className:"space-y-4",children:re.map(C=>Ee(C,R[C],`week-${C}`,l.jsx(mt,{className:"w-5 h-5 text-purple-600"})))})}else if(x==="monthly"){const{groupedByMonth:R,sortedKeys:re}=Ae;return l.jsx("div",{className:"space-y-4",children:re.map(C=>Ee(C,R[C],`month-${C}`,l.jsx(mt,{className:"w-5 h-5 text-indigo-600"})))})}return l.jsxs("div",{className:"space-y-4",children:[Ee("  ",_e.today,"today",l.jsx(xu,{className:"w-5 h-5 text-green-600"})),Ee("  ",_e.yesterday,"yesterday",l.jsx(mt,{className:"w-5 h-5 text-blue-600"})),Ee("   ",_e.thisWeek,"thisWeek",l.jsx(mt,{className:"w-5 h-5 text-purple-600"})),Ee("   ",_e.lastWeek,"lastWeek",l.jsx(mt,{className:"w-5 h-5 text-orange-600"})),Ee("   ",_e.thisMonth,"thisMonth",l.jsx(mt,{className:"w-5 h-5 text-indigo-600"})),Ee("   ",_e.lastMonth,"lastMonth",l.jsx(mt,{className:"w-5 h-5 text-pink-600"})),Ee("   ",_e.older,"older",l.jsx(La,{className:"w-5 h-5 text-gray-600"}))]})};return l.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white mb-1",children:" "}),l.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[" ",P,"  "]})]}),l.jsx("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-800 p-1 rounded-lg",children:[{key:"period",label:""},{key:"daily",label:""},{key:"weekly",label:""},{key:"monthly",label:""}].map(({key:R,label:re})=>l.jsx("button",{onClick:()=>b(R),className:`flex-1 px-2 py-1.5 text-xs sm:text-sm font-medium rounded-md transition-colors ${x===R?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:re},R))}),x==="period"&&l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 shadow-sm border",children:l.jsxs("div",{className:"grid grid-cols-4 gap-1",children:[l.jsxs("div",{className:"text-center px-2 py-2",children:[l.jsx("div",{className:"text-lg sm:text-xl font-bold text-green-600 dark:text-green-400",children:_e.today.length}),l.jsx("div",{className:"text-xs text-green-700 dark:text-green-300 leading-tight",children:""})]}),l.jsxs("div",{className:"text-center px-2 py-2",children:[l.jsx("div",{className:"text-lg sm:text-xl font-bold text-blue-600 dark:text-blue-400",children:_e.today.length+_e.yesterday.length+_e.thisWeek.length}),l.jsx("div",{className:"text-xs text-blue-700 dark:text-blue-300 leading-tight",children:" "})]}),l.jsxs("div",{className:"text-center px-2 py-2",children:[l.jsx("div",{className:"text-lg sm:text-xl font-bold text-purple-600 dark:text-purple-400",children:P-_e.lastMonth.length-_e.older.length}),l.jsx("div",{className:"text-xs text-purple-700 dark:text-purple-300 leading-tight",children:" "})]}),l.jsxs("button",{onClick:ie,className:"text-center px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors cursor-pointer",title:"      ",children:[l.jsx("div",{className:`text-lg sm:text-xl font-bold ${ce().color}`,children:ce().count}),l.jsx("div",{className:`text-xs leading-tight ${ce().color.replace("text-","text-").replace("600","700").replace("400","300")}`,children:ce().label})]})]})}),x==="daily"&&l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 shadow-sm border text-center",children:[l.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:ge.sortedKeys.length}),l.jsx("div",{className:"text-xs text-blue-700 dark:text-blue-300",children:" "})]}),x==="weekly"&&l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 shadow-sm border text-center",children:[l.jsx("div",{className:"text-lg font-bold text-purple-600 dark:text-purple-400",children:je.sortedKeys.length}),l.jsx("div",{className:"text-xs text-purple-700 dark:text-purple-300",children:" "})]}),x==="monthly"&&l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 shadow-sm border text-center",children:[l.jsx("div",{className:"text-lg font-bold text-indigo-600 dark:text-indigo-400",children:Ae.sortedKeys.length}),l.jsx("div",{className:"text-xs text-indigo-700 dark:text-indigo-300",children:" "})]}),l.jsx("div",{className:"space-y-4",children:pe()}),P===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(xu,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"   "}),l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"    ."})]})]})},_j=({employees:s,vacations:n,onEditVacation:r,onDeleteVacation:i})=>{const[c,u]=O.useState(new Date),[f,g]=O.useState(null),[m,p]=O.useState(!1),[x,b]=O.useState(null),[w,L]=O.useState(null),T=O.useRef(null),z=new Date(c.getFullYear(),c.getMonth(),1),W=new Date(c.getFullYear(),c.getMonth()+1,0),k=new Date(z);k.setDate(k.getDate()-z.getDay());const S=new Date(W);S.setDate(S.getDate()+(6-W.getDay()));const A=[],D=new Date(k);for(;D<=S;)A.push(new Date(D)),D.setDate(D.getDate()+1);const _=ge=>{const Ae=new Date(ge.getTime()-ge.getTimezoneOffset()*6e4).toISOString().split("T")[0];return n.filter(P=>P.date===Ae)},H=ge=>s.find(je=>je.id===ge),I=()=>{u(new Date(c.getFullYear(),c.getMonth()-1,1))},le=()=>{u(new Date(c.getFullYear(),c.getMonth()+1,1))},ie=ge=>{L(null),b(ge.targetTouches[0].clientX)},be=ge=>{L(ge.targetTouches[0].clientX)},Ee=()=>{if(!x||!w)return;const ge=x-w,je=ge>50,Ae=ge<-50;je&&le(),Ae&&I()},_e=ge=>{switch(ge){case"":return"bg-blue-100 text-blue-800 border-blue-200";case"":return"bg-green-100 text-green-800 border-green-200";case"":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"":return"bg-purple-100 text-purple-800 border-purple-200";case"":return"bg-red-100 text-red-800 border-red-200";case"":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden w-full max-w-full",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[l.jsx("button",{onClick:I,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:l.jsx(Fo,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})}),l.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:[c.getFullYear()," ",c.getMonth()+1,""]}),l.jsx("button",{onClick:le,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:l.jsx(bs,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})})]}),l.jsx("div",{className:"grid w-full border-b border-gray-200 dark:border-gray-700",style:{gridTemplateColumns:"0.7fr 1fr 1fr 1fr 1fr 1fr 0.7fr",minWidth:"100%",maxWidth:"100%"},children:["","","","","","",""].map((ge,je)=>l.jsx("div",{className:`p-3 text-sm font-medium text-center ${je===0||je===6?"text-gray-400 dark:text-gray-500":"text-gray-500 dark:text-gray-400"}`,children:ge},ge))}),l.jsx("div",{ref:T,className:"grid w-full",style:{gridTemplateColumns:"0.7fr 1fr 1fr 1fr 1fr 1fr 0.7fr",minWidth:"100%",maxWidth:"100%"},onTouchStart:ie,onTouchMove:be,onTouchEnd:Ee,children:A.map(ge=>{const je=_(ge),Ae=ge.getMonth()===c.getMonth(),P=ge.toDateString()===new Date().toDateString(),ce=ge.getDay()===0||ge.getDay()===6;return l.jsxs("div",{className:`min-h-[120px] border-b border-r border-gray-100 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 overflow-hidden ${ce?"p-1":"p-2"} ${Ae?"":"bg-gray-50 dark:bg-gray-900"} ${P?"bg-blue-50 dark:bg-blue-900/20":""} ${ce?"bg-gray-25 dark:bg-gray-850":""}`,style:{minWidth:0,maxWidth:"100%",width:"100%"},onClick:()=>{je.length>0&&(g(ge),p(!0))},children:[l.jsx("div",{className:`text-sm font-medium mb-1 ${Ae?P?"text-blue-600 dark:text-blue-400":"text-gray-900 dark:text-gray-100":"text-gray-400 dark:text-gray-600"}`,children:ge.getDate()}),l.jsxs("div",{className:"space-y-1 w-full overflow-hidden",children:[je.slice(0,ce?3:6).map(pe=>{const R=H(pe.employeeId);return l.jsx("div",{className:`text-xs rounded border cursor-pointer group ${_e(pe.type)} ${ce?"px-1 py-0.5":"px-2 py-1"}`,style:{minWidth:0,maxWidth:"100%",width:"100%",overflow:"hidden"},onClick:re=>{re.stopPropagation(),r(pe)},children:l.jsxs("div",{className:"flex items-center justify-between",style:{minWidth:0,maxWidth:"100%",width:"100%"},children:[l.jsxs("span",{className:"truncate",style:{minWidth:0,maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[R?.name," ",pe.type]}),l.jsxs("div",{className:"hidden group-hover:flex items-center space-x-1 flex-shrink-0",children:[l.jsx("button",{onClick:re=>{re.stopPropagation(),r(pe)},className:"p-1 hover:bg-white/50 rounded",children:l.jsx(_o,{className:"h-3 w-3"})}),l.jsx("button",{onClick:re=>{re.stopPropagation(),i(pe.id)},className:"p-1 hover:bg-white/50 rounded",children:l.jsx(an,{className:"h-3 w-3"})})]})]})},pe.id)}),je.length>(ce?3:6)&&l.jsxs("div",{className:`text-xs text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-700 rounded cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-600 ${ce?"px-1 py-0.5":"px-2 py-1"}`,style:{minWidth:0,maxWidth:"100%",width:"100%",overflow:"hidden"},children:["+",je.length-(ce?3:6)," "]})]})]},ge.toISOString())})}),m&&f&&l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>p(!1),children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl overflow-hidden w-full max-w-md max-h-[80vh]",onClick:ge=>ge.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[f.getFullYear()," ",f.getMonth()+1," ",f.getDate()," "]}),l.jsx("button",{onClick:()=>p(!1),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:l.jsx(St,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})})]}),l.jsx("div",{className:"p-4 max-h-96 overflow-y-auto",children:l.jsx("div",{className:"space-y-3",children:_(f).map(ge=>{const je=H(ge.employeeId);return l.jsx("div",{className:`p-3 rounded-lg border cursor-pointer hover:shadow-md transition-shadow ${_e(ge.type)}`,onClick:()=>{p(!1),r(ge)},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("div",{className:"font-medium text-sm",children:je?.name||"   "}),l.jsxs("div",{className:"text-xs opacity-75",children:[je?.team,"  ",ge.type]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{onClick:Ae=>{Ae.stopPropagation(),p(!1),r(ge)},className:"p-1 hover:bg-white/50 rounded",title:"",children:l.jsx(_o,{className:"h-4 w-4"})}),l.jsx("button",{onClick:Ae=>{Ae.stopPropagation(),confirm("   ?")&&(i(ge.id),p(!1))},className:"p-1 hover:bg-white/50 rounded text-red-600",title:"",children:l.jsx(an,{className:"h-4 w-4"})})]})]})},ge.id)})})}),l.jsx("div",{className:"flex justify-end p-4 border-t border-gray-200 dark:border-gray-700",children:l.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",children:""})})]})})]})},kj=({employees:s,vacation:n,onSave:r,onCancel:i})=>{const[c,u]=O.useState({employeeId:"",date:"",type:""}),[f,g]=O.useState({}),m=["","","","","",""];O.useEffect(()=>{if(n)u({employeeId:n.employeeId.toString(),date:n.date,type:n.type});else{const T=new Date,z=new Date(T.getTime()-T.getTimezoneOffset()*6e4);u({employeeId:"",date:z.toISOString().split("T")[0],type:""})}g({})},[n]);const p=(T,z)=>{u(W=>({...W,[T]:z})),f[T]&&g(W=>({...W,[T]:""}))},x=()=>{const T={};return c.employeeId||(T.employeeId=" ."),c.date||(T.date=" ."),c.type||(T.type="  ."),g(T),Object.keys(T).length===0},b=()=>{if(!x())return;const T={employeeId:parseInt(c.employeeId),date:c.date,type:c.type};r(T)},w=T=>{T.key==="Enter"&&T.ctrlKey?b():T.key==="Escape"&&i()},L=s.find(T=>T.id===parseInt(c.employeeId));return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md mx-4",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:n?" ":" "}),l.jsx("button",{onClick:i,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:l.jsx(St,{className:"h-5 w-5"})})]}),l.jsxs("div",{className:"p-6 space-y-4",onKeyDown:w,children:[l.jsxs("div",{children:[l.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(Yo,{className:"h-4 w-4 mr-2"}),""]}),l.jsxs("select",{value:c.employeeId,onChange:T=>p("employeeId",T.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 ${f.employeeId?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"}`,children:[l.jsx("option",{value:"",children:" "}),s.map(T=>l.jsxs("option",{value:T.id,children:[T.name," (",T.team,")"]},T.id))]}),f.employeeId&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:f.employeeId}),L&&l.jsxs("div",{className:"mt-2 flex items-center space-x-2 p-2 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[l.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-white text-xs font-semibold",style:{backgroundColor:L.color},children:L.name.charAt(0)}),l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[L.name,"  ",L.team,"  ",L.position]})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(mt,{className:"h-4 w-4 mr-2"}),""]}),l.jsx("input",{type:"date",value:c.date,onChange:T=>p("date",T.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 ${f.date?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"}`}),f.date&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:f.date})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(ko,{className:"h-4 w-4 mr-2"})," "]}),l.jsx("select",{value:c.type,onChange:T=>p("type",T.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 ${f.type?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"}`,children:m.map(T=>l.jsx("option",{value:T,children:T},T))}),f.type&&l.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:f.type})]})]}),l.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700",children:[l.jsx("button",{onClick:i,className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:""}),l.jsx("button",{onClick:b,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:n?"":""})]}),l.jsx("div",{className:"px-6 pb-4",children:l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:"Ctrl + Enter:  | Esc: "})})]})})},Nj=()=>{const{currentUser:s}=Nn(),[n,r]=O.useState([]),[i,c]=O.useState([]),[u,f]=O.useState(!0),[g,m]=O.useState(!1),[p,x]=O.useState(null),[b,w]=O.useState({selectedEmployees:[],vacationTypes:{:!0,:!0,:!0,:!0,:!0},dateRange:"all",startDate:"",endDate:""}),[L,T]=O.useState(!1);if(!$a(s?.email))return l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"  "}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"      ."})]})});const z=async()=>{f(!0);try{const[ie,be]=await Promise.all([gr.getEmployees(""),gr.getVacations("")]);r(ie),c(be)}catch(ie){console.error("  :",ie)}finally{f(!1)}},W=ie=>ie.filter(be=>{if(b.selectedEmployees.length>0&&!b.selectedEmployees.includes(be.employeeId)||!b.vacationTypes[be.type])return!1;const Ee=new Date(be.date),_e=new Date;if(b.dateRange!=="all")switch(b.dateRange){case"thisMonth":if(Ee.getMonth()!==_e.getMonth()||Ee.getFullYear()!==_e.getFullYear())return!1;break;case"lastMonth":const ge=new Date(_e.getFullYear(),_e.getMonth()-1);if(Ee.getMonth()!==ge.getMonth()||Ee.getFullYear()!==ge.getFullYear())return!1;break;case"thisYear":if(Ee.getFullYear()!==_e.getFullYear())return!1;break;case"custom":if(b.startDate&&Ee<new Date(b.startDate)||b.endDate&&Ee>new Date(b.endDate))return!1;break}return!0}),k=()=>{w({selectedEmployees:[],vacationTypes:{:!0,:!0,:!0,:!0,:!0},dateRange:"all",startDate:"",endDate:""})},S=ie=>{w(be=>({...be,selectedEmployees:be.selectedEmployees.includes(ie)?be.selectedEmployees.filter(Ee=>Ee!==ie):[...be.selectedEmployees,ie]}))},A=()=>{w(ie=>({...ie,selectedEmployees:ie.selectedEmployees.length===n.length?[]:n.map(be=>be.id)}))},D=ie=>{w(be=>({...be,vacationTypes:{...be.vacationTypes,[ie]:!be.vacationTypes[ie]}}))},_=()=>{x(null),m(!0)},H=ie=>{x(ie),m(!0)},I=async ie=>{if(confirm("   ?"))try{await gr.deleteVacation("",ie),await z()}catch(be){console.error("  :",be),alert("    .")}},le=async ie=>{try{p?await gr.updateVacation("",p.id,ie):await gr.addVacation("",ie),m(!1),await z()}catch(be){console.error("  :",be),alert("    .")}};return O.useEffect(()=>{z()},[]),u?l.jsxs("div",{className:"flex items-center justify-center h-64",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),l.jsx("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:"  ..."})]}):l.jsxs("div",{className:"space-y-6 w-full overflow-hidden",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900 dark:text-gray-100",children:" "}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:()=>T(!L),className:"flex items-center px-2 py-1.5 md:px-3 md:py-2 text-gray-600 dark:text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[l.jsx(Yp,{className:"h-4 w-4"}),l.jsx("span",{className:"hidden md:inline ml-1",children:""})]}),l.jsxs("button",{onClick:_,className:"flex items-center px-2 py-1.5 md:px-4 md:py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[l.jsx(Bt,{className:"h-4 w-4"}),l.jsx("span",{className:"hidden md:inline ml-1",children:" "})]})]})]}),L&&l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>T(!1),children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl overflow-hidden w-full max-w-md max-h-[80vh]",onClick:ie=>ie.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:" "}),l.jsx("button",{onClick:()=>T(!1),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:l.jsx(St,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})})]}),l.jsx("div",{className:"p-4 max-h-96 overflow-y-auto",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:" "}),l.jsx("button",{onClick:A,className:"text-sm text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300",children:b.selectedEmployees.length===n.length?" ":" "})]}),l.jsx("div",{className:"grid grid-cols-2 gap-1",children:n.map(ie=>l.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-1.5 rounded",children:[l.jsx("input",{type:"checkbox",checked:b.selectedEmployees.includes(ie.id),onChange:()=>S(ie.id),className:"w-3 h-3 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),l.jsx("div",{className:"w-4 h-4 rounded-full flex items-center justify-center text-white text-xs font-semibold flex-shrink-0",style:{backgroundColor:ie.color},children:ie.name.charAt(0)}),l.jsx("span",{className:"text-xs text-gray-900 dark:text-gray-100 truncate",children:ie.name})]},ie.id))}),l.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 block mb-2",children:" "}),l.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(b.vacationTypes).map(([ie,be])=>l.jsxs("label",{className:"flex items-center space-x-1 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 px-2 py-1 rounded text-xs border border-gray-200 dark:border-gray-600",children:[l.jsx("input",{type:"checkbox",checked:be,onChange:()=>D(ie),className:"w-3 h-3 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),l.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:ie})]},ie))})]})]})}),l.jsxs("div",{className:"flex justify-between p-4 border-t border-gray-200 dark:border-gray-700",children:[l.jsx("button",{onClick:k,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",children:""}),l.jsx("button",{onClick:()=>T(!1),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:""})]})]})}),l.jsx(_j,{employees:n,vacations:W(i),onEditVacation:H,onDeleteVacation:I}),g&&l.jsx(kj,{employees:n,vacation:p,onSave:le,onCancel:()=>m(!1)})]})};class Wx{notifications=[];listeners=[];constructor(){this.loadNotifications(),this.checkScheduledNotifications(),this.checkWeeklyReport(),setInterval(()=>{this.checkScheduledNotifications(),this.checkWeeklyReport()},6e4)}loadNotifications(){const n=localStorage.getItem("notifications");if(n)try{this.notifications=JSON.parse(n).map(r=>({...r,scheduledTime:new Date(r.scheduledTime),createdAt:new Date(r.createdAt)}))}catch(r){console.error("Failed to load notifications:",r)}}saveNotifications(){localStorage.setItem("notifications",JSON.stringify(this.notifications))}checkScheduledNotifications(){const n=new Date;this.notifications.filter(i=>i.scheduledTime<=n&&!i.isRead).forEach(i=>{this.showBrowserNotification(i),this.listeners.forEach(c=>c(i))})}showBrowserNotification(n){"Notification"in window&&Notification.permission==="granted"&&new Notification(n.title,{body:n.message,icon:"/favicon.ico",badge:"/favicon.ico",tag:n.tag||n.id})}showNotification(n){this.isSupported()&&Notification.permission==="granted"&&new Notification(n.title,{body:n.body,icon:"/favicon.ico",tag:n.tag})}isSupported(){return"Notification"in window}requestPermission(){return"Notification"in window?Notification.requestPermission():Promise.resolve("denied")}scheduleReminder(n,r){if(!r.enabled||!n.dueDate)return;let i=new Date(n.dueDate);if(r.dueReminderTiming!==void 0)i=new Date(i.getTime()-r.dueReminderTiming*6e4);else{i.setDate(i.getDate()-r.advanceDays);const[u,f]=r.time.split(":").map(Number);i.setHours(u,f,0,0)}if(i<=new Date)return;const c={id:`reminder_${n.id}_${Date.now()}`,todoId:n.id,type:"reminder",title:"  ",message:`"${n.title}"   .`,scheduledTime:i,isRead:!1,createdAt:new Date,tag:`reminder-${n.id}`};this.notifications=this.notifications.filter(u=>u.tag!==`reminder-${n.id}`),this.notifications.push(c),this.saveNotifications()}scheduleStartReminder(n,r){if(!r.enabled||!r.startReminder||!n.startDate)return;const i=new Date(n.startDate);if(i<=new Date)return;const c={id:`start_${n.id}_${Date.now()}`,todoId:n.id,type:"start_reminder",title:"  ",message:`"${n.title}"  .`,scheduledTime:i,isRead:!1,createdAt:new Date,tag:`start-${n.id}`};this.notifications=this.notifications.filter(u=>u.tag!==`start-${n.id}`),this.notifications.push(c),this.saveNotifications()}scheduleOverdueNotification(n){if(!n.dueDate||n.completed)return;const r=new Date(n.dueDate);r.setDate(r.getDate()+1),r.setHours(9,0,0,0);const i={id:`overdue_${n.id}_${Date.now()}`,todoId:n.id,type:"overdue",title:" ",message:`"${n.title}"  .`,scheduledTime:r,isRead:!1,createdAt:new Date,tag:`overdue-${n.id}`};this.notifications.push(i),this.saveNotifications()}suggestRecurringTask(n){if(n.recurrence==="none")return;const r={id:`recurring_${n.id}_${Date.now()}`,todoId:n.id,type:"recurring_suggestion",title:"  ",message:`"${n.title}"    ?`,scheduledTime:new Date,isRead:!1,createdAt:new Date,tag:`recurring-${n.id}`};this.notifications.push(r),this.saveNotifications(),this.listeners.forEach(i=>i(r))}showCompletionCelebration(n){const r=localStorage.getItem("notification-settings");if(r&&!JSON.parse(r).completionCelebration)return;const i={id:`completion_${n.id}_${Date.now()}`,todoId:n.id,type:"completion_celebration",title:" ! ",message:`"${n.title}"  !`,scheduledTime:new Date,isRead:!1,createdAt:new Date,tag:`completion-${n.id}`};this.showBrowserNotification(i)}checkWeeklyReport(){const n=new Date;if(n.getDay()===1&&n.getHours()===9&&n.getMinutes()===0){const r=localStorage.getItem("lastWeeklyReport"),i=n.toDateString();r!==i&&(this.generateWeeklyReport(),localStorage.setItem("lastWeeklyReport",i))}}generateWeeklyReport(){const n={id:`weekly_report_${Date.now()}`,type:"weekly_report",title:" ",message:"   !",scheduledTime:new Date,isRead:!1,createdAt:new Date,tag:"weekly-report"};this.notifications.push(n),this.saveNotifications(),this.showBrowserNotification(n)}markAsRead(n){const r=this.notifications.find(i=>i.id===n);r&&(r.isRead=!0,this.saveNotifications())}dismissNotification(n){this.notifications=this.notifications.filter(r=>r.id!==n),this.saveNotifications()}getUnreadNotifications(){return this.notifications.filter(n=>!n.isRead)}getAllNotifications(){return[...this.notifications].sort((n,r)=>r.createdAt.getTime()-n.createdAt.getTime())}addListener(n){this.listeners.push(n)}removeListener(n){this.listeners=this.listeners.filter(r=>r!==n)}clearNotificationsForTodo(n){this.notifications=this.notifications.filter(r=>r.todoId!==n),this.saveNotifications()}}const wo=new Wx,Tj=Object.freeze(Object.defineProperty({__proto__:null,NotificationManager:Wx,notificationManager:wo},Symbol.toStringTag,{value:"Module"})),jj=({onClose:s})=>{const[n,r]=O.useState("default"),[i,c]=O.useState(!1),[u,f]=O.useState({dueReminders:!0,dueReminderTiming:60,startReminder:!1,weeklyReport:!1,completionCelebration:!0,dailyReminder:!0,reminderTime:"09:00"});O.useEffect(()=>{r(Notification.permission),c(wo.isSupported());const x=localStorage.getItem("notification-settings");if(x){const b=JSON.parse(x);f({...u,...b,dueReminderTiming:b.dueReminderTiming??(b.advanceDays?b.advanceDays*24*60:60)})}},[]);const g=async()=>{const x=await wo.requestPermission();r(x?"granted":"denied")},m=(x,b)=>{const w={...u,[x]:b};f(w),localStorage.setItem("notification-settings",JSON.stringify(w))},p=async()=>{await wo.showNotification({title:" ",body:"  ! ",tag:"test"})};return i?l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-md w-full max-h-[90vh] overflow-hidden flex flex-col",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:" "}),l.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:l.jsx("span",{className:"text-xl",children:""})})]}),l.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto flex-1",children:[l.jsxs("div",{className:"space-y-3",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:" "}),n==="default"&&l.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("span",{className:"text-yellow-600 dark:text-yellow-400",children:""}),l.jsx("span",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"  "})]}),l.jsx("p",{className:"text-xs text-yellow-700 dark:text-yellow-300 mb-3",children:"      ."}),l.jsx("button",{onClick:g,className:"w-full px-3 py-2 bg-yellow-600 text-white text-sm rounded-lg hover:bg-yellow-700 transition-colors",children:"  "})]}),n==="granted"&&l.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("span",{className:"text-green-600 dark:text-green-400",children:""}),l.jsx("span",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:"  "})]}),l.jsx("button",{onClick:p,className:"w-full px-3 py-2 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition-colors",children:"  "})]}),n==="denied"&&l.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("span",{className:"text-red-600 dark:text-red-400",children:""}),l.jsx("span",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"  "})]}),l.jsx("p",{className:"text-xs text-red-700 dark:text-red-300",children:"     ."})]})]}),n==="granted"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:" "}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:" "}),l.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"    "})]}),l.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:u.dueReminders,onChange:x=>m("dueReminders",x.target.checked),className:"sr-only peer"}),l.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),u.dueReminders&&l.jsx("div",{className:"pl-4 border-l-2 border-gray-200 dark:border-gray-600",children:l.jsxs("select",{value:u.dueReminderTiming,onChange:x=>m("dueReminderTiming",Number(x.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:10,children:"10 "}),l.jsx("option",{value:30,children:"30 "}),l.jsx("option",{value:60,children:"1 "}),l.jsx("option",{value:180,children:"3 "}),l.jsx("option",{value:1440,children:"1 "}),l.jsx("option",{value:2880,children:"2 "})]})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:" "}),l.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"   "})]}),l.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:u.startReminder,onChange:x=>m("startReminder",x.target.checked),className:"sr-only peer"}),l.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:" "}),l.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"   "})]}),l.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:u.completionCelebration,onChange:x=>m("completionCelebration",x.target.checked),className:"sr-only peer"}),l.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:" "}),l.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"    "})]}),l.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:u.weeklyReport,onChange:x=>m("weeklyReport",x.target.checked),className:"sr-only peer"}),l.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:" "}),l.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"     "})]}),l.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:u.dailyReminder,onChange:x=>m("dailyReminder",x.target.checked),className:"sr-only peer"}),l.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),u.dailyReminder&&l.jsx("div",{className:"pl-4 border-l-2 border-gray-200 dark:border-gray-600",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:" "}),l.jsx("input",{type:"time",value:u.reminderTime,onChange:x=>m("reminderTime",x.target.value),className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})})]})]})]}),l.jsx("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0",children:l.jsx("button",{onClick:s,className:"w-full px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:""})})]})}):l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-md w-full p-6",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-4xl mb-4",children:""}),l.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"  "}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"     ."}),l.jsx("button",{onClick:s,className:"w-full px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:""})]})})})},Sj=()=>{const{currentUser:s,logout:n}=Nn(),{exportData:r,importData:i,clearCompleted:c,stats:u,syncing:f,syncWithCloud:g}=Qt(),{theme:m,setTheme:p}=wy(),{fontSizeLevel:x,setFontSizeLevel:b}=D1(),{customHolidays:w,addCustomHoliday:L,deleteCustomHoliday:T}=Wo(),[z,W]=O.useState(null),[k,S]=O.useState(!1),[A,D]=O.useState(!1),[_,H]=O.useState(""),[I,le]=O.useState(""),[ie,be]=O.useState(!1),Ee=async R=>{if(R.preventDefault(),!(!_||!I))try{await L(_,I,ie),H(""),le(""),be(!1)}catch(re){console.error("Failed to add holiday:",re),alert("  .")}},_e=async R=>{if(confirm("  ?"))try{await T(R)}catch(re){console.error("Failed to delete holiday:",re),alert("  .")}},ge=()=>{const R=r(),re=new Blob([R],{type:"application/json"}),C=URL.createObjectURL(re),M=document.createElement("a");M.href=C,M.download=`todos-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(M),M.click(),document.body.removeChild(M),URL.revokeObjectURL(C)},je=R=>{const re=R.target.files?.[0];if(!re)return;const C=new FileReader;C.onload=async M=>{try{const Q=M.target?.result;await i(Q)?(W(null),S(!0),setTimeout(()=>S(!1),3e3)):W("  .")}catch{W("   .")}},C.readAsText(re),R.target.value=""},Ae=()=>{const R=u?.completed||0;if(R===0){alert("  .");return}confirm(`  ${R} ?`)&&c()},P=()=>{try{const R=localStorage.getItem("todolist-app-todos");if(R)return`${(new Blob([R]).size/1024).toFixed(2)} KB`}catch(R){console.error("Storage size calculation failed:",R)}return"0 KB"},ce=async()=>{if(confirm("?"))try{await n()}catch(R){console.error("Logout failed:",R)}},pe=async()=>{try{await g()}catch(R){console.error("Sync failed:",R)}};return l.jsxs("div",{className:"space-y-8 max-w-4xl mx-auto pb-10",children:[l.jsxs("div",{className:"animate-fade-in",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2 tracking-tight",children:""}),l.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"    "})]}),l.jsxs("div",{className:"glass-card rounded-3xl p-8 animate-slide-in",style:{animationDelay:"0.1s"},children:[l.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-2xl bg-blue-50 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-400",children:l.jsx(Yo,{className:"w-5 h-5",strokeWidth:2})}),""]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-4 p-4 bg-white/50 dark:bg-gray-700/30 rounded-xl border border-gray-100 dark:border-gray-700/50 backdrop-blur-sm",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-900 dark:to-blue-800 rounded-full flex items-center justify-center shadow-inner",children:s?.photoURL?l.jsx("img",{src:s.photoURL,alt:"",className:"w-10 h-10 rounded-full object-cover"}):l.jsx("span",{className:"text-xl font-bold text-blue-600 dark:text-blue-300",children:s?.isAnonymous?"G":s?.email?.charAt(0).toUpperCase()||"U"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-base font-bold text-gray-900 dark:text-white truncate",children:s?.isAnonymous?" ":s?.displayName||""}),l.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:s?.isAnonymous?"   ":s?.email})]})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[!s?.isAnonymous&&l.jsxs("button",{onClick:pe,disabled:f,className:"flex items-center justify-center gap-2.5 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800 rounded-2xl hover:bg-blue-100 dark:hover:bg-blue-900/40 transition-all active:scale-[0.98] disabled:opacity-50 disabled:active:scale-100 group",children:[f?l.jsx(Mm,{className:"w-5 h-5 text-blue-600 animate-spin"}):l.jsx(Mm,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 group-hover:rotate-180 transition-transform duration-500"}),l.jsx("span",{className:"font-semibold text-blue-700 dark:text-blue-300",children:f?" ...":" "})]}),l.jsxs("button",{onClick:ce,className:"flex items-center justify-center gap-2.5 p-4 bg-red-50 dark:bg-red-900/10 border border-red-100 dark:border-red-900/30 rounded-2xl hover:bg-red-100 dark:hover:bg-red-900/30 transition-all active:scale-[0.98] group",children:[l.jsx(yw,{className:"w-5 h-5 text-red-600 dark:text-red-400 group-hover:-translate-x-1 transition-transform"}),l.jsx("span",{className:"font-semibold text-red-700 dark:text-red-300",children:""})]})]})]})]}),l.jsxs("div",{className:"glass-card rounded-3xl p-8 animate-slide-in",style:{animationDelay:"0.2s"},children:[l.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-2xl bg-purple-50 dark:bg-purple-900/30 flex items-center justify-center text-purple-600 dark:text-purple-400",children:l.jsx(xw,{className:"w-5 h-5",strokeWidth:2})}),""]}),l.jsx("div",{className:"grid grid-cols-3 gap-4",children:[{key:"light",label:"",icon:bw},{key:"dark",label:"",icon:vw},{key:"system",label:"",icon:ww}].map(R=>{const re=R.icon,C=m===R.key;return l.jsxs("button",{onClick:()=>p(R.key),className:`flex flex-col items-center justify-center gap-3 p-5 rounded-2xl border transition-all duration-300 ${C?"bg-blue-50 dark:bg-blue-900/30 border-blue-200 dark:border-blue-700 shadow-md scale-[1.02]":"bg-white/50 dark:bg-gray-700/30 border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50 hover:border-gray-200"}`,children:[l.jsx(re,{className:`w-6 h-6 ${C?"text-blue-600 dark:text-blue-400":"text-gray-400"}`}),l.jsx("span",{className:`text-sm font-semibold ${C?"text-blue-700 dark:text-blue-300":"text-gray-600 dark:text-gray-400"}`,children:R.label})]},R.key)})})]}),l.jsxs("div",{className:"glass-card rounded-3xl p-8 animate-slide-in",style:{animationDelay:"0.3s"},children:[l.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-2xl bg-indigo-50 dark:bg-indigo-900/30 flex items-center justify-center text-indigo-600 dark:text-indigo-400",children:l.jsx(_w,{className:"w-5 h-5",strokeWidth:2})})," "]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between bg-white/50 dark:bg-gray-700/30 p-6 rounded-xl border border-gray-100 dark:border-gray-700/50",children:[l.jsx("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:""}),l.jsx("div",{className:"flex gap-3 items-center flex-wrap justify-center",children:[1,2,3,4,5,6,7].map(R=>l.jsx("button",{onClick:()=>b(R),className:`w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300 ${x===R?"bg-blue-600 text-white shadow-lg shadow-blue-500/30 scale-110":"bg-white dark:bg-gray-600 text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-500"}`,"aria-label":`  ${R} `,children:l.jsx("span",{style:{fontSize:`${.5+R*.1}rem`,fontWeight:600},children:"A"})},R))}),l.jsx("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:""})]}),l.jsxs("div",{className:"p-5 border border-gray-200/60 dark:border-gray-700/60 rounded-xl bg-gray-50/50 dark:bg-gray-800/50 backdrop-blur-sm",children:[l.jsx("p",{className:"text-xs font-semibold text-gray-400 dark:text-gray-500 mb-2 uppercase tracking-wider",children:"Preview"}),l.jsx("p",{className:"text-base text-gray-800 dark:text-gray-200 leading-relaxed font-medium",children:"   . The quick brown fox jumps over the lazy dog."})]})]})]}),l.jsxs("div",{className:"glass-card rounded-3xl p-8 animate-slide-in",style:{animationDelay:"0.4s"},children:[l.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-2xl bg-red-50 dark:bg-red-900/30 flex items-center justify-center text-red-600 dark:text-red-400",children:l.jsx(mt,{className:"w-5 h-5",strokeWidth:2})})," "]}),l.jsxs("form",{onSubmit:Ee,className:"flex flex-col sm:flex-row gap-3 mb-6",children:[l.jsxs("div",{className:"flex-1 flex gap-3",children:[l.jsx("input",{type:"date",value:_,onChange:R=>H(R.target.value),className:"px-4 py-2.5 border border-gray-200 dark:border-gray-700 rounded-xl bg-white/80 dark:bg-gray-800/80 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",required:!0}),l.jsx("input",{type:"text",value:I,onChange:R=>le(R.target.value),placeholder:" ",className:"flex-1 px-4 py-2.5 border border-gray-200 dark:border-gray-700 rounded-xl bg-white/80 dark:bg-gray-800/80 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",required:!0})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"flex items-center h-full px-3 bg-white/50 dark:bg-gray-700/30 rounded-xl border border-gray-200 dark:border-gray-700",children:[l.jsx("input",{type:"checkbox",id:"recurringHoliday",checked:ie,onChange:R=>be(R.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800"}),l.jsx("label",{htmlFor:"recurringHoliday",className:"ml-2 text-sm font-medium text-gray-700 dark:text-gray-300 whitespace-nowrap cursor-pointer select-none",children:" "})]}),l.jsx("button",{type:"submit",className:"px-4 py-2.5 bg-blue-600 text-white rounded-xl hover:bg-blue-700 active:scale-95 transition-all shadow-md shadow-blue-500/20 flex items-center justify-center min-w-[3rem]",title:"",children:l.jsx(Bt,{className:"w-5 h-5"})})]})]}),l.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto pr-1 custom-scrollbar",children:w.length===0?l.jsx("div",{className:"text-center py-8 bg-gray-50/50 dark:bg-gray-800/30 rounded-xl border border-dashed border-gray-200 dark:border-gray-700",children:l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"  ."})}):w.map(R=>l.jsxs("div",{className:"group flex items-center justify-between p-3 bg-white/60 dark:bg-gray-800/40 rounded-xl border border-gray-100 dark:border-gray-700/50 hover:border-blue-200 dark:hover:border-blue-800 transition-all hover:shadow-sm",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-50 dark:bg-red-900/20 flex items-center justify-center text-red-600 dark:text-red-400 font-bold text-sm border border-red-100 dark:border-red-800/30",children:R.date.split("-")[2]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:R.name}),R.isRecurring&&l.jsx("span",{className:"text-[10px] px-2 py-0.5 bg-blue-100 text-blue-700 dark:bg-blue-900/40 dark:text-blue-300 rounded-full font-semibold border border-blue-200 dark:border-blue-800/50",children:""})]}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:R.date})]})]}),l.jsx("button",{onClick:()=>_e(R.id),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors opacity-0 group-hover:opacity-100 focus:opacity-100",title:"",children:l.jsx(an,{className:"w-4 h-4"})})]},R.id))})]}),l.jsxs("div",{className:"glass-card rounded-3xl p-8 animate-slide-in",style:{animationDelay:"0.5s"},children:[l.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-2xl bg-green-50 dark:bg-green-900/30 flex items-center justify-center text-green-600 dark:text-green-400",children:l.jsx(kw,{className:"w-5 h-5",strokeWidth:2})})," "]}),l.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[{label:" ",value:u?.total||0,color:"text-blue-600 dark:text-blue-400",bg:"bg-blue-50 dark:bg-blue-900/20"},{label:"",value:u?.completed||0,color:"text-green-600 dark:text-green-400",bg:"bg-green-50 dark:bg-green-900/20"},{label:"",value:u?.pending||0,color:"text-orange-600 dark:text-orange-400",bg:"bg-orange-50 dark:bg-orange-900/20"},{label:"",value:P(),color:"text-purple-600 dark:text-purple-400",bg:"bg-purple-50 dark:bg-purple-900/20"}].map((R,re)=>l.jsxs("div",{className:`flex flex-col items-center justify-center p-4 rounded-xl ${R.bg} border border-transparent hover:border-current transition-all duration-300`,children:[l.jsx("div",{className:`text-2xl font-bold ${R.color} mb-1`,children:R.value}),l.jsx("div",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:R.label})]},re))})]}),l.jsxs("div",{className:"glass-card rounded-3xl p-8 animate-slide-in",style:{animationDelay:"0.6s"},children:[l.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-2xl bg-orange-50 dark:bg-orange-900/30 flex items-center justify-center text-orange-600 dark:text-orange-400",children:l.jsx(Nw,{className:"w-5 h-5",strokeWidth:2})})," "]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[l.jsxs("button",{onClick:ge,className:"flex flex-col items-center justify-center gap-3 p-6 bg-white/50 dark:bg-gray-700/30 border border-gray-200 dark:border-gray-700 rounded-2xl hover:bg-blue-50 dark:hover:bg-blue-900/20 hover:border-blue-200 dark:hover:border-blue-800 transition-all group",children:[l.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-50 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-400 group-hover:scale-110 transition-transform duration-300",children:l.jsx(Tw,{className:"w-6 h-6"})}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-base font-bold text-gray-900 dark:text-white group-hover:text-blue-700 dark:group-hover:text-blue-300",children:""}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"JSON  "})]})]}),l.jsxs("div",{className:"relative group",children:[l.jsx("input",{type:"file",accept:".json",onChange:je,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),l.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 p-6 bg-white/50 dark:bg-gray-700/30 border border-gray-200 dark:border-gray-700 rounded-2xl group-hover:bg-green-50 dark:group-hover:bg-green-900/20 group-hover:border-green-200 dark:group-hover:border-green-800 transition-all h-full",children:[l.jsx("div",{className:"w-12 h-12 rounded-full bg-green-50 dark:bg-green-900/30 flex items-center justify-center text-green-600 dark:text-green-400 group-hover:scale-110 transition-transform duration-300",children:l.jsx(jw,{className:"w-6 h-6"})}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-base font-bold text-gray-900 dark:text-white group-hover:text-green-700 dark:group-hover:text-green-300",children:""}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"JSON  "})]})]})]}),l.jsxs("button",{onClick:Ae,className:"flex flex-col items-center justify-center gap-3 p-6 bg-white/50 dark:bg-gray-700/30 border border-gray-200 dark:border-gray-700 rounded-2xl hover:bg-orange-50 dark:hover:bg-orange-900/20 hover:border-orange-200 dark:hover:border-orange-800 transition-all group",children:[l.jsx("div",{className:"w-12 h-12 rounded-full bg-orange-50 dark:bg-orange-900/30 flex items-center justify-center text-orange-600 dark:text-orange-400 group-hover:scale-110 transition-transform duration-300",children:l.jsx(an,{className:"w-6 h-6"})}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-base font-bold text-gray-900 dark:text-white group-hover:text-orange-700 dark:group-hover:text-orange-300",children:""}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"  "})]})]})]}),(z||k)&&l.jsxs("div",{className:`mt-6 p-4 rounded-2xl border flex items-center gap-4 animate-fade-in ${z?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-800 dark:text-red-200":"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800 text-green-800 dark:text-green-200"}`,children:[l.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${z?"bg-red-100 dark:bg-red-900/40":"bg-green-100 dark:bg-green-900/40"}`,children:z?l.jsx(Sw,{className:"w-5 h-5"}):l.jsx(gs,{className:"w-5 h-5"})}),l.jsx("span",{className:"font-medium",children:z||"  ."})]})]}),l.jsxs("div",{className:"glass-card rounded-3xl p-8 animate-slide-in",style:{animationDelay:"0.7s"},children:[l.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-2xl bg-yellow-50 dark:bg-yellow-900/30 flex items-center justify-center text-yellow-600 dark:text-yellow-400",children:l.jsx(Im,{className:"w-5 h-5",strokeWidth:2})}),""]}),l.jsxs("button",{onClick:()=>D(!0),className:"w-full flex items-center justify-between p-5 bg-white/50 dark:bg-gray-700/30 border border-gray-200 dark:border-gray-700 rounded-2xl hover:bg-blue-50 dark:hover:bg-blue-900/20 hover:border-blue-200 dark:hover:border-blue-800 transition-all group",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"w-12 h-12 rounded-full bg-yellow-50 dark:bg-yellow-900/20 flex items-center justify-center text-yellow-600 dark:text-yellow-400 group-hover:scale-110 transition-transform",children:l.jsx(Im,{className:"w-6 h-6"})}),l.jsxs("div",{className:"text-left",children:[l.jsx("div",{className:"text-base font-bold text-gray-900 dark:text-white group-hover:text-blue-700 dark:group-hover:text-blue-300 transition-colors",children:" "}),l.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mt-0.5",children:" ,    "})]})]}),l.jsx(bs,{className:"w-5 h-5 text-gray-400 group-hover:text-blue-500 group-hover:translate-x-1 transition-all"})]})]}),l.jsxs("div",{className:"text-center py-6 animate-fade-in",style:{animationDelay:"0.8s"},children:[l.jsx("p",{className:"text-sm font-medium text-gray-400 dark:text-gray-500",children:"ToDo List App v1.0.0"}),l.jsx("p",{className:"text-xs text-gray-300 dark:text-gray-600 mt-1",children:"Designed for simplicity & productivity"})]}),A&&l.jsx(jj,{onClose:()=>D(!1)})]})},Px=({onClick:s})=>{const{theme:n}=wy();return l.jsxs("button",{onClick:s,className:"fixed bottom-20 right-4 z-50 group","aria-label":" ",children:[l.jsx("div",{className:"absolute inset-0 rounded-full bg-blue-500 blur-lg opacity-40 group-hover:opacity-60 transition-opacity duration-300 animate-pulse"}),l.jsx("div",{className:`
        relative flex items-center justify-center 
        w-14 h-14 rounded-full
        bg-gradient-to-r from-blue-600 to-indigo-600
        text-white shadow-lg shadow-blue-500/40
        transform transition-all duration-300
        group-hover:scale-110 group-active:scale-95
        group-hover:shadow-blue-500/60
      `,children:l.jsx(Bt,{className:"w-7 h-7 transition-transform duration-300 group-hover:rotate-90",strokeWidth:2.5})})]})},Dj=Object.freeze(Object.defineProperty({__proto__:null,default:Px},Symbol.toStringTag,{value:"Module"})),Ej=({isOpen:s,onClose:n,onSelectTemplate:r})=>{const{currentUser:i}=Nn(),[c,u]=O.useState([]),[f,g]=O.useState(!1),[m,p]=O.useState(null),[x,b]=O.useState(!1),[w,L]=O.useState({name:"",description:"",category:"shortterm",subTasks:[],defaultPriority:"medium",tags:[]});O.useEffect(()=>{if(!i?.uid)return;De.log("   ",{uid:i.uid});const _=Oe.subscribeProjectTemplates(i.uid,H=>{De.log("   ",{count:H.length}),u(H)});return()=>_()},[i?.uid]),O.useEffect(()=>{s||(p(null),g(!1),L({name:"",description:"",category:"shortterm",subTasks:[],defaultPriority:"medium",tags:[]}))},[s]);const T=async()=>{if(!(!w.name.trim()||!i?.uid)){b(!0);try{De.log("  ",{template:w}),await Oe.addProjectTemplate(w,i.uid),L({name:"",description:"",category:"shortterm",subTasks:[],defaultPriority:"medium",tags:[]}),g(!1)}catch(_){De.error("  :",_),alert("    .")}finally{b(!1)}}},z=async()=>{if(!(!m||!i?.uid)){b(!0);try{De.log(" ",{template:m});const{id:_,createdAt:H,updatedAt:I,...le}=m;await Oe.updateProjectTemplate(_,le,i.uid),p(null)}catch(_){De.error("  :",_),alert("    .")}finally{b(!1)}}},W=async _=>{if(!(!confirm("  ?")||!i?.uid)){b(!0);try{De.log(" ",{templateId:_}),await Oe.deleteProjectTemplate(_,i.uid)}catch(H){De.error("  :",H),alert("    .")}finally{b(!1)}}},k=async _=>{if(i?.uid){b(!0);try{const{id:H,createdAt:I,updatedAt:le,...ie}=_,be={...ie,name:`${_.name} ()`};De.log(" ",{duplicated:be}),await Oe.addProjectTemplate(be,i.uid)}catch(H){De.error("  :",H),alert("    .")}finally{b(!1)}}},S=(_,H)=>{const I={title:"",completed:!1,priority:"medium"};H({..._,subTasks:[..._.subTasks,I]})},A=(_,H,I,le)=>{const ie=_.subTasks.map((be,Ee)=>Ee===H?{...be,...I}:be);le({..._,subTasks:ie})},D=(_,H,I)=>{I({..._,subTasks:_.subTasks.filter((le,ie)=>ie!==H)})};return s?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"  "}),l.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:l.jsx(St,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:[l.jsx("div",{className:"mb-6",children:l.jsxs("button",{onClick:()=>g(!0),className:"btn-primary flex items-center gap-2",children:[l.jsx(Bt,{className:"w-4 h-4"}),"  "]})}),f&&l.jsxs("div",{className:"mb-6 p-4 border border-gray-200 dark:border-gray-700 rounded-lg",children:[l.jsx("h3",{className:"text-lg font-medium mb-4",children:" "}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:" "}),l.jsx("input",{type:"text",value:w.name,onChange:_=>L({...w,name:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:": 7   "})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:""}),l.jsxs("select",{value:w.category,onChange:_=>L({...w,category:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[l.jsx("option",{value:"shortterm",children:" "}),l.jsx("option",{value:"longterm",children:" "})]})]})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:""}),l.jsx("textarea",{value:w.description,onChange:_=>L({...w,description:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",rows:3,placeholder:" "})]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("label",{className:"block text-sm font-medium",children:" "}),l.jsxs("button",{onClick:()=>S(w,L),className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[l.jsx(Bt,{className:"w-3 h-3"})," "]})]}),l.jsx("div",{className:"space-y-2",children:w.subTasks.map((_,H)=>l.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 dark:bg-gray-700 rounded",children:[l.jsx("input",{type:"checkbox",checked:_.completed,onChange:I=>{const le=new Date;A(w,H,{completed:I.target.checked,completedAt:I.target.checked?le:null},L)},className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),l.jsx("input",{type:"text",value:_.title,onChange:I=>A(w,H,{title:I.target.value},L),className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:ring-1 focus:ring-blue-500 dark:bg-gray-600 dark:text-white",placeholder:""}),l.jsxs("select",{value:_.priority,onChange:I=>A(w,H,{priority:I.target.value},L),className:"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded dark:bg-gray-600 dark:text-white",children:[l.jsx("option",{value:"low",children:""}),l.jsx("option",{value:"medium",children:""}),l.jsx("option",{value:"high",children:""}),l.jsx("option",{value:"urgent",children:""})]}),_.completed&&_.completedAt&&l.jsxs("span",{className:"text-xs text-green-600 dark:text-green-400",children:[": ",new Date(_.completedAt).toLocaleString()]}),l.jsx("button",{onClick:()=>D(w,H,L),className:"p-1 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/20 rounded",children:l.jsx(St,{className:"w-3 h-3"})})]},H))})]}),l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:""}),l.jsxs("button",{onClick:T,disabled:x,className:"btn-primary flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[x?l.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):l.jsx(zu,{className:"w-4 h-4"}),x?" ...":""]})]})]}),m&&l.jsxs("div",{className:"mb-6 p-4 border border-blue-200 dark:border-blue-700 rounded-lg bg-blue-50 dark:bg-blue-900/20",children:[l.jsx("h3",{className:"text-lg font-medium mb-4 text-blue-800 dark:text-blue-200",children:" "}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:" "}),l.jsx("input",{type:"text",value:m.name,onChange:_=>p({...m,name:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:": 7   "})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:""}),l.jsxs("select",{value:m.category,onChange:_=>p({...m,category:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[l.jsx("option",{value:"shortterm",children:" "}),l.jsx("option",{value:"longterm",children:" "})]})]})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:""}),l.jsx("textarea",{value:m.description,onChange:_=>p({...m,description:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",rows:3,placeholder:" "})]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("label",{className:"block text-sm font-medium",children:" "}),l.jsxs("button",{onClick:()=>S(m,p),className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[l.jsx(Bt,{className:"w-3 h-3"})," "]})]}),l.jsx("div",{className:"space-y-2",children:m.subTasks.map((_,H)=>l.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 dark:bg-gray-700 rounded",children:[l.jsx("input",{type:"checkbox",checked:_.completed,onChange:I=>{const le=new Date;A(m,H,{completed:I.target.checked,completedAt:I.target.checked?le:null},p)},className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),l.jsx("input",{type:"text",value:_.title,onChange:I=>A(m,H,{title:I.target.value},p),className:"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded focus:ring-1 focus:ring-blue-500 dark:bg-gray-600 dark:text-white",placeholder:""}),l.jsxs("select",{value:_.priority,onChange:I=>A(m,H,{priority:I.target.value},p),className:"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded dark:bg-gray-600 dark:text-white",children:[l.jsx("option",{value:"low",children:""}),l.jsx("option",{value:"medium",children:""}),l.jsx("option",{value:"high",children:""}),l.jsx("option",{value:"urgent",children:""})]}),_.completed&&_.completedAt&&l.jsxs("span",{className:"text-xs text-green-600 dark:text-green-400",children:[": ",new Date(_.completedAt).toLocaleString()]}),l.jsx("button",{onClick:()=>D(m,H,p),className:"p-1 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/20 rounded",children:l.jsx(St,{className:"w-3 h-3"})})]},H))})]}),l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx("button",{onClick:()=>p(null),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:""}),l.jsxs("button",{onClick:z,disabled:x,className:"btn-primary flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[x?l.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):l.jsx(zu,{className:"w-4 h-4"}),x?" ...":" "]})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:c.map(_=>l.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-start justify-between mb-2",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:_.name}),l.jsx("span",{className:`text-xs px-2 py-1 rounded ${_.category==="longterm"?"bg-purple-100 text-purple-700 dark:bg-purple-900/20 dark:text-purple-300":"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-300"}`,children:_.category==="longterm"?"":""})]}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:()=>{p(_)},disabled:x,className:"p-1 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-900/20 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:"",children:l.jsx(zp,{className:"w-3 h-3"})}),l.jsx("button",{onClick:()=>k(_),disabled:x,className:"p-1 text-green-600 hover:bg-green-100 dark:hover:bg-green-900/20 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:"",children:l.jsx(Dw,{className:"w-3 h-3"})}),l.jsx("button",{onClick:()=>W(_.id),disabled:x,className:"p-1 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/20 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:"",children:l.jsx(an,{className:"w-3 h-3"})})]})]}),_.description&&l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:_.description}),l.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-3",children:[" : ",_.subTasks.length,""]}),r&&l.jsx("button",{onClick:()=>{r(_),n()},className:"w-full btn-secondary text-sm",children:"  "})]},_.id))}),c.length===0&&!f&&l.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[l.jsx("p",{children:"  ."}),l.jsx("p",{className:"text-sm",children:"    ."})]})]})]})}):null},Cj=({isOpen:s,onClose:n,initialDate:r})=>{const{addTodo:i,allTags:c}=Qt(),{currentUser:u}=Nn(),[f,g]=O.useState(""),[m,p]=O.useState(!1),[x,b]=O.useState(""),[w,L]=O.useState(!0),[T,z]=O.useState([]),[W,k]=O.useState(""),[S,A]=O.useState(!1),D={startDate:Ut(r||new Date,"yyyy-MM-dd"),startTime:"",dueDate:"",dueTime:"",priority:"medium",tags:[],recurrence:"none",recurrenceDay:new Date().getDay(),recurrenceDate:new Date().getDate(),weekOfMonth:1,monthlyRecurrenceType:"by_date",holidayHandling:"show",showStartTime:!1,showDueDate:!1,type:"simple",projectCategory:"shortterm",subTasks:[],description:""},[_,H]=O.useState(D),[I,le]=O.useState({}),[ie,be]=O.useState(""),Ee=O.useRef(null);O.useEffect(()=>{s&&Ee.current&&Ee.current.focus(),s&&H(C=>({...C,startDate:Ut(r||new Date,"yyyy-MM-dd")}))},[s,r]),O.useEffect(()=>{if(!u?.uid||!s)return;const C=Oe.subscribeProjectTemplates(u.uid,M=>{z(M)});return()=>C()},[u?.uid,s]);const _e=C=>{let M;if(typeof C=="string"){if(!C){k("");return}M=T.find(Q=>Q.id===C)}else M=C;M&&(k(M.id),g(M.name),H(Q=>({...Q,type:"project",projectCategory:M.category,priority:M.defaultPriority,tags:[...Q.tags,...M.tags||[]],subTasks:M.subTasks.map(xe=>({id:crypto.randomUUID(),title:xe.title})),description:M.description||""})))},ge=(C,M)=>{H(Q=>({...Q,[C]:M})),I[C]&&le(Q=>{const xe={...Q};return delete xe[C],xe})},je=()=>{x.trim()&&!_.tags.includes(x.trim())&&(ge("tags",[..._.tags,x.trim()]),b(""),p(!1))},Ae=C=>{_.tags.includes(C)?ge("tags",_.tags.filter(M=>M!==C)):ge("tags",[..._.tags,C])},P=()=>{if(!ie.trim())return;const C={id:crypto.randomUUID(),title:ie.trim()};ge("subTasks",[..._.subTasks,C]),be("")},ce=C=>{ge("subTasks",_.subTasks.filter(M=>M.id!==C))},pe=C=>{const M=new Date;let Q=M,xe="",X="medium",ue=[];C.includes("")?Q=M:C.includes("")?Q=Ml(M,1):C.includes("")&&(Q=Ml(M,2)),C.includes("!")?X="urgent":C.includes("!")?X="high":C.includes("!")&&(X="low");const K=C.match(/#(\S+)/g);return K&&(ue=K.map(ee=>ee.slice(1))),{startDate:Ut(Q,"yyyy-MM-dd"),startTime:xe,priority:X,tags:ue}},R=C=>{if(C.preventDefault(),!f.trim()){le(Q=>({...Q,text:"  "}));return}const M={title:f,completed:!1,..._,startDate:new Date(`${_.startDate}T${_.startTime||"00:00"}`),dueDate:_.showDueDate&&_.dueDate?new Date(`${_.dueDate}T${_.dueTime||"23:59"}`):void 0,project:_.type==="project"?_.projectCategory:void 0,subTasks:_.type==="project"?_.subTasks.map(Q=>({...Q,completed:!1,priority:"medium",createdAt:new Date,updatedAt:new Date})):void 0,recurrence:_.recurrence==="none"?void 0:{type:_.recurrence,interval:1,days:_.recurrence==="weekly"?[_.recurrenceDay]:void 0,monthDay:_.recurrence==="monthly"&&_.monthlyRecurrenceType==="by_date"?_.recurrenceDate:void 0,weekOfMonth:_.recurrence==="monthly"&&_.monthlyRecurrenceType==="by_weekday"?_.weekOfMonth:void 0,dayOfWeek:_.recurrence==="monthly"&&_.monthlyRecurrenceType==="by_weekday"?_.recurrenceDay:void 0,holidayHandling:_.holidayHandling}};i(M),n(),g(""),H(D)},re=[{value:0,label:""},{value:1,label:""},{value:2,label:""},{value:3,label:""},{value:4,label:""},{value:5,label:""},{value:6,label:""}];return s?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[l.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:n}),l.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:l.jsxs("div",{className:"relative w-full max-w-2xl bg-white dark:bg-gray-800 rounded-2xl shadow-2xl overflow-hidden",children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:" "}),l.jsx("button",{onClick:n,className:"p-2 text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700",children:l.jsx(St,{className:"w-5 h-5"})})]}),l.jsxs("form",{onSubmit:R,className:"p-6 max-h-[80vh] overflow-y-auto",children:[l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx($p,{className:"w-4 h-4 inline mr-1"})," *"]}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{ref:Ee,type:"text",value:f,onChange:C=>{if(g(C.target.value),w&&_.type==="simple"){const M=pe(C.target.value);H(Q=>({...Q,...M}))}},placeholder:w&&_.type==="simple"?":   2  ! #":" ",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white ${I.text?"border-red-500":"border-gray-300 dark:border-gray-600"}`}),_.type==="simple"&&l.jsx("button",{type:"button",onClick:()=>L(!w),className:`absolute right-2 top-1/2 -translate-y-1/2 text-xs px-2 py-1 rounded-md transition-colors ${w?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-500 dark:bg-gray-600 dark:text-gray-400"}`,children:w?" ON":"OFF"})]}),I.text&&l.jsx("p",{className:"mt-1 text-sm text-red-600",children:I.text})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:""}),l.jsx("textarea",{value:_.description,onChange:C=>ge("description",C.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white resize-none",placeholder:"    "})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(Bp,{className:"w-4 h-4 inline mr-1"}),""]}),l.jsxs("select",{value:_.type,onChange:C=>ge("type",C.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[l.jsx("option",{value:"simple",children:" "}),l.jsx("option",{value:"project",children:""})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(Gl,{className:"w-4 h-4 inline mr-1"}),""]}),l.jsxs("select",{value:_.priority,onChange:C=>ge("priority",C.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[l.jsx("option",{value:"low",children:""}),l.jsx("option",{value:"medium",children:""}),l.jsx("option",{value:"high",children:""}),l.jsx("option",{value:"urgent",children:""})]})]})]}),_.type==="project"&&l.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 dark:bg-gray-700/30 rounded-xl border border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:" "}),l.jsxs("button",{type:"button",onClick:()=>A(!0),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 font-medium flex items-center gap-1",children:[l.jsx(Ew,{className:"w-3 h-3"})," "]})]}),T.length>0&&l.jsxs("select",{value:W,onChange:C=>_e(C.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm dark:bg-gray-700 dark:text-white",children:[l.jsx("option",{value:"",children:"  "}),T.map(C=>l.jsxs("option",{value:C.id,children:[C.name," (",C.subTasks.length," )"]},C.id))]}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",value:"shortterm",checked:_.projectCategory==="shortterm",onChange:C=>ge("projectCategory",C.target.value),className:"mr-2"}),l.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:" "})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",value:"longterm",checked:_.projectCategory==="longterm",onChange:C=>ge("projectCategory",C.target.value),className:"mr-2"}),l.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:" "})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(qp,{className:"w-4 h-4 inline mr-1"}),"  (",_.subTasks.length,")"]}),l.jsx("div",{className:"space-y-2 mb-2",children:_.subTasks.map((C,M)=>l.jsxs("div",{className:"flex items-center gap-2 bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700",children:[l.jsx("span",{className:"text-xs text-gray-500 font-mono",children:M+1}),l.jsx("span",{className:"flex-1 text-sm text-gray-700 dark:text-gray-300",children:C.title}),l.jsx("button",{type:"button",onClick:()=>ce(C.id),className:"text-red-400 hover:text-red-600",children:l.jsx(an,{className:"w-4 h-4"})})]},C.id))}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",value:ie,onChange:C=>be(C.target.value),onKeyPress:C=>C.key==="Enter"&&(C.preventDefault(),P()),placeholder:"  ...",className:"flex-1 px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"}),l.jsx("button",{type:"button",onClick:P,className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:""})]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(mt,{className:"w-4 h-4 inline mr-1"})," "]}),l.jsx("input",{type:"date",value:_.startDate,onChange:C=>ge("startDate",C.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(La,{className:"w-4 h-4 inline mr-1"})," "]}),l.jsx("input",{type:"time",value:_.startTime,onChange:C=>ge("startTime",C.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]})]}),l.jsxs("div",{className:"border-t border-gray-100 dark:border-gray-700 pt-4",children:[l.jsxs("button",{type:"button",onClick:()=>ge("showDueDate",!_.showDueDate),className:"flex items-center text-sm text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors mb-2",children:[_.showDueDate?l.jsx(Hp,{className:"w-4 h-4 mr-1"}):l.jsx(eh,{className:"w-4 h-4 mr-1"}),_.showDueDate?"  ":"   ()"]}),_.showDueDate&&l.jsxs("div",{className:"grid grid-cols-2 gap-4 animate-fadeIn",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),l.jsx("input",{type:"date",value:_.dueDate,onChange:C=>ge("dueDate",C.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),l.jsx("input",{type:"time",value:_.dueTime,onChange:C=>ge("dueTime",C.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(ko,{className:"w-4 h-4 inline mr-1"}),""]}),l.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[c.map(C=>l.jsxs("button",{type:"button",onClick:()=>Ae(C),className:`px-3 py-1 rounded-full text-sm transition-colors ${_.tags.includes(C)?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:["#",C]},C)),l.jsx("button",{type:"button",onClick:()=>p(!0),className:"px-3 py-1 rounded-full text-sm border border-dashed border-gray-300 text-gray-500 hover:border-gray-400 hover:text-gray-600 transition-colors",children:"+  "})]}),m&&l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",value:x,onChange:C=>b(C.target.value),placeholder:"  ",className:"flex-1 px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",onKeyPress:C=>C.key==="Enter"&&(C.preventDefault(),je())}),l.jsx("button",{type:"button",onClick:je,className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:""})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[l.jsx(nh,{className:"w-4 h-4 inline mr-1"})," "]}),l.jsxs("select",{value:_.recurrence,onChange:C=>ge("recurrence",C.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[l.jsx("option",{value:"none",children:" "}),l.jsx("option",{value:"daily",children:""}),l.jsx("option",{value:"weekly",children:""}),l.jsx("option",{value:"monthly",children:""}),l.jsx("option",{value:"yearly",children:""})]})]}),_.recurrence==="weekly"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),l.jsx("select",{value:_.recurrenceDay,onChange:C=>ge("recurrenceDay",parseInt(C.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:re.map(C=>l.jsx("option",{value:C.value,children:C.label},C.value))})]}),_.recurrence==="monthly"&&l.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 dark:bg-gray-700/30 rounded-xl",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",checked:_.monthlyRecurrenceType==="by_date",onChange:()=>H(C=>({...C,monthlyRecurrenceType:"by_date"})),className:"mr-2"}),l.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"  (:  15)"})]}),l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"radio",checked:_.monthlyRecurrenceType==="by_weekday",onChange:()=>H(C=>({...C,monthlyRecurrenceType:"by_weekday"})),className:"mr-2"}),l.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"  (:   )"})]})]})]}),_.monthlyRecurrenceType==="by_date"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),l.jsxs("select",{value:_.recurrenceDate,onChange:C=>ge("recurrenceDate",parseInt(C.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[Array.from({length:31},(C,M)=>M+1).map(C=>l.jsxs("option",{value:C,children:[C,""]},C)),l.jsx("option",{value:-1,children:""})]})]}),_.monthlyRecurrenceType==="by_weekday"&&l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),l.jsxs("select",{value:_.weekOfMonth,onChange:C=>ge("weekOfMonth",parseInt(C.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[l.jsx("option",{value:1,children:""}),l.jsx("option",{value:2,children:""}),l.jsx("option",{value:3,children:""}),l.jsx("option",{value:4,children:""}),l.jsx("option",{value:-1,children:""})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),l.jsx("select",{value:_.recurrenceDay,onChange:C=>ge("recurrenceDay",parseInt(C.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:re.map(C=>l.jsx("option",{value:C.value,children:C.label},C.value))})]})]})]}),_.recurrence!=="none"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:" "}),l.jsxs("select",{value:_.holidayHandling,onChange:C=>ge("holidayHandling",C.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",children:[l.jsx("option",{value:"show",children:"  ()"}),l.jsx("option",{value:"skip",children:" (  )"}),l.jsx("option",{value:"next_day",children:"  "}),l.jsx("option",{value:"prev_day",children:"  "})]}),l.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"*       ."})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:[l.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:""}),l.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[l.jsx(Bt,{className:"w-4 h-4"}),""]})]})]})]})})]}),l.jsx(Ej,{isOpen:S,onClose:()=>A(!1),onSelectTemplate:_e})]}):null},Aj=({searchTerm:s,onSearchChange:n,priorityFilter:r,onPriorityFilterChange:i,typeFilter:c,onTypeFilterChange:u,projectFilter:f,onProjectFilterChange:g,tagFilter:m,onTagFilterChange:p,completionDateFilter:x,onCompletionDateFilterChange:b,onClearFilters:w,searchInputRef:L,availableTags:T})=>{const[z,W]=O.useState(!1),k=r!=="all"||c!=="all"||f!=="all"||s.length>0||m.length>0||x!=="all",S=A=>{m.includes(A)?p(m.filter(D=>D!==A)):p([...m,A])};return l.jsxs("div",{className:"mb-6 relative z-30",children:[l.jsxs("div",{className:"flex gap-3",children:[l.jsxs("div",{className:"relative flex-1 group",children:[l.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l.jsx(Cw,{className:"h-4 w-4 text-gray-400 group-focus-within:text-blue-500 transition-colors"})}),l.jsx("input",{ref:L,type:"text",value:s,onChange:A=>n(A.target.value),className:"block w-full pl-10 pr-3 py-2.5 bg-white/50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 backdrop-blur-sm transition-all duration-200 text-sm placeholder-gray-400 dark:text-white shadow-sm hover:bg-white/80 dark:hover:bg-gray-800/80",placeholder:" ..."})]}),l.jsxs("button",{onClick:()=>W(!z),className:`flex items-center gap-2 px-4 py-2.5 rounded-xl border transition-all duration-200 ${k||z?"bg-blue-500 text-white border-blue-600 shadow-md shadow-blue-500/20":"bg-white/50 dark:bg-gray-800/50 border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-300 hover:bg-white dark:hover:bg-gray-800 backdrop-blur-sm shadow-sm"}`,children:[l.jsx(Yp,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium hidden sm:inline",children:""}),k&&l.jsx("span",{className:"bg-white/20 text-white text-[10px] px-1.5 py-0.5 rounded-full font-bold",children:"ON"})]}),k&&l.jsx("button",{onClick:w,className:"flex items-center justify-center w-10 h-10 rounded-xl bg-gray-100 text-gray-500 hover:bg-red-50 hover:text-red-500 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-red-900/30 dark:hover:text-red-400 transition-colors border border-transparent hover:border-red-200 dark:hover:border-red-800",title:" ",children:l.jsx(St,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:`
        absolute top-full left-0 right-0 mt-2 p-5 
        glass-panel shadow-xl transform origin-top transition-all duration-300 ease-out
        ${z?"opacity-100 scale-100 translate-y-0":"opacity-0 scale-95 -translate-y-2 pointer-events-none"}
      `,children:[l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-6",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:""}),l.jsxs("select",{value:r,onChange:A=>i(A.target.value),className:"w-full px-3 py-2 bg-white/50 dark:bg-gray-900/50 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 text-sm transition-colors",children:[l.jsx("option",{value:"all",children:""}),l.jsx("option",{value:"urgent",children:" "}),l.jsx("option",{value:"high",children:" "}),l.jsx("option",{value:"medium",children:" "}),l.jsx("option",{value:"low",children:" "})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:""}),l.jsxs("select",{value:c,onChange:A=>u(A.target.value),className:"w-full px-3 py-2 bg-white/50 dark:bg-gray-900/50 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 text-sm transition-colors",children:[l.jsx("option",{value:"all",children:""}),l.jsx("option",{value:"simple",children:"  "}),l.jsx("option",{value:"project",children:" "})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:" "}),l.jsxs("select",{value:f,onChange:A=>g(A.target.value),className:"w-full px-3 py-2 bg-white/50 dark:bg-gray-900/50 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 text-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:c!=="project"&&c!=="all",children:[l.jsx("option",{value:"all",children:""}),l.jsx("option",{value:"longterm",children:"  "}),l.jsx("option",{value:"shortterm",children:"  "})]})]}),l.jsxs("div",{className:"space-y-2 sm:col-span-2 lg:col-span-1",children:[l.jsxs("label",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider flex items-center gap-1",children:[l.jsx(ko,{className:"w-3 h-3"}),""]}),l.jsx("div",{className:"p-2 bg-white/50 dark:bg-gray-900/50 border border-gray-200 dark:border-gray-700 rounded-lg max-h-32 overflow-y-auto custom-scrollbar",children:T.length>0?l.jsx("div",{className:"space-y-1",children:T.map(A=>l.jsxs("label",{className:"flex items-center gap-2 px-2 py-1.5 hover:bg-gray-100 dark:hover:bg-gray-800 rounded cursor-pointer transition-colors",children:[l.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${m.includes(A)?"bg-blue-500 border-blue-500 text-white":"border-gray-300 dark:border-gray-600"}`,children:m.includes(A)&&l.jsx(gs,{className:"w-3 h-3"})}),l.jsx("input",{type:"checkbox",checked:m.includes(A),onChange:()=>S(A),className:"hidden"}),l.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 truncate",children:A})]},A))}):l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center py-2",children:" "})})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("label",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider flex items-center gap-1",children:[l.jsx(mt,{className:"w-3 h-3"}),""]}),l.jsxs("select",{value:x,onChange:A=>b(A.target.value),className:"w-full px-3 py-2 bg-white/50 dark:bg-gray-900/50 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 text-sm transition-colors",children:[l.jsx("option",{value:"all",children:""}),l.jsx("option",{value:"today",children:" "}),l.jsx("option",{value:"yesterday",children:" "}),l.jsx("option",{value:"thisWeek",children:"  "}),l.jsx("option",{value:"lastWeek",children:"  "}),l.jsx("option",{value:"thisMonth",children:"  "})]})]})]}),k&&l.jsx("div",{className:"mt-5 pt-4 border-t border-gray-200/50 dark:border-gray-700/50",children:l.jsxs("div",{className:"flex flex-wrap gap-2",children:[m.length>0&&l.jsxs("div",{className:"flex items-center gap-1 px-2.5 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-full text-xs font-medium border border-blue-200 dark:border-blue-800",children:[l.jsx(ko,{className:"w-3 h-3"}),m.length," "]}),x!=="all"&&l.jsxs("div",{className:"flex items-center gap-1 px-2.5 py-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded-full text-xs font-medium border border-green-200 dark:border-green-800",children:[l.jsx(mt,{className:"w-3 h-3"}),x==="today"&&" ",x==="yesterday"&&" ",x==="thisWeek"&&"  ",x==="lastWeek"&&"  ",x==="thisMonth"&&"  "]})]})})]})]})},Rj=({currentView:s,isSidebarOpen:n,onToggleSidebar:r,searchInputRef:i,isMobile:c})=>{const{currentUser:u}=Nn(),{allTags:f}=Qt(),[g,m]=O.useState(!1),[p,x]=O.useState(null),[b,w]=O.useState(new Date),[L,T]=O.useState(""),[z,W]=O.useState("all"),[k,S]=O.useState("all"),[A,D]=O.useState("all"),[_,H]=O.useState([]),[I,le]=O.useState("all"),ie=Ae=>{w(Ae)},be=()=>{w(s==="week"?Ae=>ly(Ae):s==="month"?Ae=>oy(Ae):Ae=>ry(Ae))},Ee=()=>{w(s==="week"?Ae=>iy(Ae,1):s==="month"?Ae=>cy(Ae,1):Ae=>Ml(Ae,1))},_e=()=>{w(new Date)},ge=()=>{T(""),W("all"),S("all"),D("all"),H([]),le("all")},je=Ae=>{x(Ae)};return l.jsxs("main",{className:`flex-1 min-w-0 transition-all duration-300 ease-in-out ${n?"lg:ml-64":"lg:ml-20"}`,children:[l.jsx("header",{className:"bg-white/70 dark:bg-gray-900/70 backdrop-blur-md border-b border-white/20 dark:border-white/10 sticky top-0 z-20",children:l.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 py-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-lg lg:hidden",children:l.jsx(Aw,{className:"w-6 h-6 text-gray-600"})}),l.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[s==="today"&&"Today",s==="week"&&"Weekly Calendar",s==="month"&&"Monthly Calendar",s==="settings"&&"Settings",s==="analytics"&&"Analytics",s==="recurring"&&"Recurring Tasks",s==="history"&&"History",s==="vacation"&&"Vacation Management"]})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("button",{onClick:()=>m(!0),className:"hidden sm:flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors shadow-sm hover:shadow-md",children:[l.jsx(Bt,{className:"w-5 h-5"}),l.jsx("span",{className:"font-medium",children:" "})]}),l.jsx("div",{className:"h-8 w-px bg-gray-200 hidden sm:block"}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"text-right hidden sm:block",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:u?.displayName||"User"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:u?.email||"user@example.com"})]}),l.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-100 flex items-center justify-center overflow-hidden border border-indigo-200",children:u?.photoURL?l.jsx("img",{src:u.photoURL,alt:"Profile",className:"w-full h-full object-cover"}):l.jsx(Yo,{className:"w-6 h-6 text-indigo-600"})})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"w-full",children:l.jsx(Aj,{searchTerm:L,onSearchChange:T,priorityFilter:z,onPriorityFilterChange:W,typeFilter:k,onTypeFilterChange:S,projectFilter:A,onProjectFilterChange:D,tagFilter:_,onTagFilterChange:H,completionDateFilter:I,onCompletionDateFilterChange:le,onClearFilters:ge,availableTags:f,searchInputRef:i})}),(s==="today"||s==="week"||s==="month")&&l.jsxs("div",{className:"flex items-center justify-center gap-4 glass-panel p-2",children:[l.jsx("button",{onClick:be,className:"p-1 hover:bg-gray-200 rounded-full",children:l.jsx(Fo,{className:"w-5 h-5 text-gray-600"})}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(mt,{className:"w-5 h-5 text-indigo-600"}),l.jsx("span",{className:"text-lg font-medium text-gray-900 dark:text-white",children:s==="week"?`${Ut(ih(b,{weekStartsOn:0}),"M d",{locale:fn})} - ${Ut(oh(b,{weekStartsOn:0}),"M d",{locale:fn})}`:s==="month"?Ut(b,"yyyy M",{locale:fn}):Ut(b,"yyyy M d (EEE)",{locale:fn})})]}),l.jsx("button",{onClick:Ee,className:"p-1 hover:bg-gray-200 rounded-full",children:l.jsx(bs,{className:"w-5 h-5 text-gray-600"})}),l.jsx("button",{onClick:_e,className:"px-3 py-1 text-sm font-medium text-indigo-600 dark:text-indigo-400 hover:bg-indigo-50 dark:hover:bg-indigo-900/30 rounded-md border border-indigo-200 dark:border-indigo-500/30 ml-2",children:"Today"})]})]})]})}),l.jsx("div",{className:"p-4 sm:p-6 lg:p-8 max-w-[1920px] mx-auto",children:s==="today"?l.jsx(Zu,{currentView:"today",searchTerm:L,priorityFilter:z,typeFilter:k,projectFilter:A,tagFilter:_,completionDateFilter:I,selectedDate:b,onDateChange:ie,onEdit:je}):s==="week"?l.jsx(mj,{currentDate:b,onDateChange:ie,searchTerm:L,priorityFilter:z,typeFilter:k,projectFilter:A,tagFilter:_,completionDateFilter:I,onAddTodo:()=>m(!0),isMobile:c}):s==="month"?l.jsxs("div",{className:"space-y-8",children:[l.jsx(pj,{currentDate:b,onDateChange:ie,searchTerm:L,priorityFilter:z,typeFilter:k,projectFilter:A,tagFilter:_,completionDateFilter:I,onAddTodo:()=>m(!0),isMobile:c}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[l.jsx(Zu,{currentView:"month",onEdit:je}),l.jsx("div",{className:"hidden lg:block",children:l.jsx(Lp,{})})]})]}):s==="analytics"?l.jsxs("div",{className:"w-full space-y-8",children:[l.jsx(yj,{}),l.jsx(Lp,{})]}):s==="recurring"?l.jsx(bj,{}):s==="history"?l.jsx(wj,{searchTerm:L,priorityFilter:z,typeFilter:k,projectFilter:A,tagFilter:_}):s==="vacation"?l.jsx(Nj,{}):s==="settings"?l.jsx(Sj,{}):null}),l.jsx("div",{className:"md:hidden",children:l.jsx(Px,{onClick:()=>m(!0)})}),l.jsx(Cj,{isOpen:g,onClose:()=>m(!1)}),p&&l.jsx(qh,{isOpen:!!p,onClose:()=>x(null),todo:p})]})},Oj=O.lazy(()=>Wa(()=>import("./LoginScreen-CbIkiRta.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url)),Mj=O.lazy(()=>Wa(()=>import("./Sidebar-D1PGWEuW.js"),__vite__mapDeps([5,1,2,3,4]),import.meta.url)),Ij=O.lazy(()=>Wa(()=>import("./PWAInstallPrompt-DJFxaMQ9.js"),__vite__mapDeps([6,1,2,3,4]),import.meta.url));O.lazy(()=>Wa(()=>Promise.resolve().then(()=>Dj),void 0,import.meta.url));const Uj=O.lazy(()=>Wa(()=>import("./ErrorBoundary-n7WkWmgO.js"),__vite__mapDeps([7,1,2,3,4]),import.meta.url)),Lj=O.lazy(()=>Wa(()=>import("./OfflineNotification-D02yQjhr.js"),__vite__mapDeps([8,1,2,3,4]),import.meta.url)),zj=O.lazy(()=>Wa(()=>import("./BottomNavigation-BxSfy3al.js"),__vite__mapDeps([9,1,2,3,4]),import.meta.url)),Yh=()=>l.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50 dark:bg-gray-900",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});function Hj({currentView:s,setCurrentView:n,isSidebarOpen:r,setIsSidebarOpen:i,searchInputRef:c,addTodoModalRef:u,isMobile:f,forceMobile:g,setForceMobile:m}){const p=O1("AppInner");return C1(),O.useEffect(()=>p,[]),l.jsx(O.Suspense,{fallback:l.jsx(Yh,{}),children:l.jsxs("div",{className:`h-screen flex bg-gray-50 dark:bg-gray-900 ${f?"flex-col":""}`,children:[f&&r&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-40",onClick:()=>i(!1)}),l.jsx(Mj,{currentView:s,onViewChange:n,isOpen:r,onToggle:()=>i(!r),isMobile:f,forceMobile:g,onToggleForceMobile:m}),l.jsx("div",{className:`flex-1 flex flex-col min-w-0 overflow-y-auto overflow-x-hidden ${f?"pb-20":""}`,children:l.jsx(Rj,{currentView:s,isSidebarOpen:r,onToggleSidebar:()=>i(!r),searchInputRef:c,addTodoModalRef:u,isMobile:f})}),f&&l.jsx(zj,{currentView:s,onViewChange:n,onToggleSidebar:()=>i(!0)}),l.jsx(Lj,{}),l.jsx(Ij,{})]})})}function $j(){const{currentUser:s,loading:n}=Nn(),[r,i]=O.useState("today"),[c,u]=O.useState(!0),[f,g]=O.useState(!1),[m,p]=O.useState(null),x=O.useRef(null),b=O.useRef(null);O.useEffect(()=>{z1(),Ip();const S=setInterval(()=>{R1.measureMemoryUsage()},5e3),A=setInterval(()=>{Fx.getErrorStats().total>0},1e4),D=setInterval(()=>{const H=Ip().checks.filter(I=>I.status==="fail");H.length>0&&De.error("Critical security issues detected:",H)},3e4);return()=>{clearInterval(S),clearInterval(A),clearInterval(D)}},[]),O.useEffect(()=>{const S=()=>{const H=window.innerWidth;if(m!==null){g(m),u(!m);return}const I=H<=768,le="ontouchstart"in window||navigator.maxTouchPoints>0,ie=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),be=H>768&&H<=1024&&le,Ee=window.matchMedia("(max-width: 768px)").matches,_e=window.matchMedia("(pointer: coarse)").matches,ge=H<=500&&le&&ie||le&&ie&&window.devicePixelRatio>=2||navigator.userAgent.includes("iPhone")||navigator.userAgent.includes("Android")||Ee&&le||_e&&ie;let je=!1;ge||Ee||I||be?je=!0:je=!1,g(je),u(!je)};S();let A;const D=()=>{clearTimeout(A),A=setTimeout(S,100)};window.addEventListener("resize",D),window.addEventListener("orientationchange",()=>{setTimeout(S,200)});const _=setTimeout(S,300);return()=>{window.removeEventListener("resize",D),window.removeEventListener("orientationchange",S),clearTimeout(A),clearTimeout(_)}},[m]);const w=()=>{b.current?.open()},L=()=>{x.current?.focus()},T=()=>{u(!c)},z=()=>{i("today")},W=()=>{i("week")},k=()=>{i("month")};return n?l.jsx(Yh,{}):s?l.jsx("div",{children:l.jsx(j1,{onOpenAddTodo:w,onFocusSearch:L,onToggleSidebar:T,onSwitchToTodayView:z,onSwitchToWeekView:W,onSwitchToMonthView:k,children:l.jsx(Hj,{currentView:r,setCurrentView:i,isSidebarOpen:c,setIsSidebarOpen:u,searchInputRef:x,addTodoModalRef:b,isMobile:f,forceMobile:m,setForceMobile:p})})}):l.jsx(Oj,{})}function Bj(){return l.jsx(O.Suspense,{fallback:l.jsx(Yh,{}),children:l.jsx(Uj,{children:l.jsx(uk,{children:l.jsx(ek,{children:l.jsx(E1,{children:l.jsx(T1,{children:l.jsx(ik,{children:l.jsx(dk,{children:l.jsx($j,{})})})})})})})})})}p_.createRoot(document.getElementById("root")).render(l.jsx(O.StrictMode,{children:l.jsx(Bj,{})}));export{wy as a,Qt as b,Bh as c,Vj as d,Fx as e,De as f,$a as i,l as j,Nn as u};
